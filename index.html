<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Open Case Studies: Exploring global patterns of obesity across rural and urban regions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies: Exploring global patterns of obesity across rural and urban regions</h1>

</div>


<p><img src="img/mainplot.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="section" class="section level2 disclaimer_block">
<h2></h2>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most approrpriate way to analyze a given dataset, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Body mass index (<a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html">BMI</a>) is often used as a proxy for <strong>adiposity</strong> and is measured as an individual’s weight in kilograms (kg) or pounds (lbs) divided by the individual’s height in meters (<span class="math inline">\(m^2\)</span>) squared. There are different categories of weight defined using different BMI thresholds as defined by the <a href="http://www.euro.who.int/en/health-topics/disease-prevention/nutrition/a-healthy-lifestyle/body-mass-index-bmi">World Health Organization</a> (WHO), the <a href="https://www.cdc.gov/obesity/adult/defining.html">Centers for Disease Control and Prevention</a>, and the <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf">National Institutes of Health</a>. For example, these are the categories defined by the WHO:</p>
<p><img src="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg" width="90%" style="display: block; margin: auto;" /></p>
<div id="source" class="section level6">
<h6>[<a href="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg">source</a>]</h6>
<p>The following chart can help you identify your estimate of BMI: <img src="http://content.everydayhealth.com/mayodiet/images/BMI-chart.jpg" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-1" class="section level6">
<h6>[<a href="http://diet.mayoclinic.org/diet/eat/what-is-your-bmi?xid=nl_MayoClinicDiet_20160426">source</a>]</h6>
<p>Previous work has shown higher BMI (&gt;30) is associated with <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf">higher rates of all-causes of mortality</a>, as well as increased rates of type 2 diabetes, cancer, heart disease, and stroke. <strong>SCH – maybe more refs and URLs here </strong>?</p>
<p>Recently, an <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf">article</a> published in <a href="https://www.nature.com"><em>Nature</em></a> evaluated and compared the Body-Mass Index (BMI) of populations in rural and urban communities around the world:</p>
<p><img src="img/paper.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level4 reference_block">
<h4></h4>
<p>NCD Risk Factor Collaboration (NCD-RisC). Rising rural body-mass index is the main driver of the global obesity epidemic in adults. <em>Nature</em> <strong>569</strong>, 260–264 (2019).</p>
</div>
<div id="section-2" class="section level4">
<h4></h4>
<p>The article challenged the widely-held view that increased urbanization was one of the major reasons for increased global obesity rates. This view came about because many countries around the world have shown increased urbanization levels in parallel with increased obesity rates. However, the NCD-RisC argued that this might not be the case; and that in fact for most regions around the world, BMI measurements are increasing in rural populations just as much, if not more so, than urban populations. Furthermore, this study suggested that obesity has particularly increased in female populations in rural regions: <b>“We noted a persistently higher rural BMI, especially for women”</b>.</p>
<p>In this case study, we will evaluate the data reported in this article to explore regional and gender specific differences in the obesity rates around the world in 1985 and 2017. Most importantly we will test if there is a difference in obesity rates between rural and urban communities and if there has been a change in obesity over time for these regions, particularly for females. To do this we will test if there is a difference between the average BMI for each group.</p>
</div>
<div id="main-questions" class="section level3">
<h3>Main Questions</h3>
<div id="section-3" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions are: </u></b></p>
<ol style="list-style-type: decimal">
<li>Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females?</li>
<li>How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females?</li>
<li>How do different countries vary in terms of estimates of BMI? In particular, how does the United States compare to the rest of the world?</li>
</ol>
</div>
<div id="section-4" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level3">
<h3>Learning Objectives</h3>
<p>In this case study, we will walk you through importing data from a pdf, cleaning, wrangling and visualizing the data, and <b> comparing two groups </b> using well-established and commonly used packages, including <code>stringr</code>, <code>tidyr</code>, <code>dplyr</code>, <code>purrr</code>, and <code>ggplot2</code> from the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>. Specificially, the tidyverse is</p>
<blockquote>
<p>“an opinionated collection of R packages designed for data science. All packages share an underlying philosophy and common APIs”.</p>
</blockquote>
<p>Another way of putting it is that it’s a set of packages that are useful specifically for data manipulation, exploration and visualization with a common philosophy. While some students may be familiar with previous packages from the R programming language, these packages make data science in R especially efficient.</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>We will begin by loading the packages that we will need with a brief explanation:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(pdftools)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">library</span>(cowplot)</a></code></pre></div>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here">here</a></td>
<td>to easily load and save data with relative paths</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/pdftools/pdftools.pdf">pdftools</a></td>
<td>to read a text from pdf into R</td>
</tr>
<tr class="odd">
<td><a href="https://stringr.tidyverse.org/articles/stringr.html">stringr</a></td>
<td>to manipulate the text data</td>
</tr>
<tr class="even">
<td><a href="https://readr.tidyverse.org/">readr</a></td>
<td>to manipulate the text data within the pdf into individual lines</td>
</tr>
<tr class="odd">
<td><a href="https://dplyr.tidyverse.org/">dplyr</a></td>
<td>to arrange/filter/select subsets of the data</td>
</tr>
<tr class="even">
<td><a href="https://tibble.tidyverse.org/">tibble</a></td>
<td>to create data objects that we can manipulate with <code>dplyr</code>/<code>stringr</code>/<code>tidyr</code>/<code>purrr</code></td>
</tr>
<tr class="odd">
<td><a href="https://magrittr.tidyverse.org/articles/magrittr.html">magrittr</a></td>
<td>to use the <code>%&lt;&gt;%</code> piping operator</td>
</tr>
<tr class="even">
<td><a href="https://www.tidyverse.org/blog/2017/10/glue-1.2.0/">glue</a></td>
<td>to paste or combine character strings and data together</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/">purrr</a></td>
<td>to perform functions on all columns of a tibble</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/">tidyr</a></td>
<td>to convert data from ‘wide’ to ‘long’ format</td>
</tr>
<tr class="odd">
<td><a href="https://ggplot2.tidyverse.org/">ggplot2</a></td>
<td>to make visualizations with multiple layers</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html">ggrepel</a></td>
<td>to allow labels in figures not to overlap</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html">cowplot</a></td>
<td>to allow plots to be combined <strong>sch – should we consider using patchwork or do we think cowplot is OK?</strong></td>
</tr>
</tbody>
</table>
<hr />
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using (e.g. <code>stringr::str_detect()</code>). Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level3">
<h3>Context</h3>
<p>The measurement of BMI has some <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/pdf/nt-50-117.pdf">limitations</a> that are well recognized, as it does not account for the composition of body mass, the location of body fat, or the contribution of body frame size. However, <a href="https://journals.lww.com/acsm-healthfitness/Fulltext/2016/07000/THE_BENEFITS_OF_BODY_MASS_INDEX_AND_WAIST.8.aspx#pdf-link">BMI has been a useful health indicator</a> for risk for many diseases and conditions particularly when combined with other risk factor information.</p>
</div>
</div>
<div id="what-are-the-data" class="section level2">
<h2>What are the data?</h2>
<p>We will be using data located within a table of the <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf">supplementary material</a> for the NCD-RisC paper referenced above. This is a pdf that can be found freely available online. Here is a screenshot of the first page of the PDF:</p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>You can see that the data contain average BMI estimates for both men and women in countries at the national level, as well as the average BMI estimates for the rural and urban areas of these countries in both 1985 and 2017.</p>
<p>The data within the parentheses are the 95% <a href="https://en.wikipedia.org/wiki/Credible_interval"><strong>credible interval</strong></a> (CIs) ranges for the average BMI estimates. The authors provide these CIs as a guide to understand how likely the estimate is for the true population mean BMI. A wider range suggests that the estimate is less accurate, as there are more possible values for the true mean with credible evidence.</p>
<p><u>Note:</u> While <a href="https://www.genderspectrum.org/quick-links/understanding-gender/">gender</a> and <a href="https://www.who.int/genomics/gender/en/index1.html">sex</a> are not actually binary, the data presented that is used in this analysis only contain data for groups of individuals described as men or women.</p>
</div>
<div id="data-import" class="section level2">
<h2>Data Import</h2>
<p>First let’s download the data from the PDF file. We use <code>file.exists()</code> from base R to check if the file we want to download already exists. If not, then we download it using the function <code>utils::download.file()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))){</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  url &lt;-<span class="st"> &quot;https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf&quot;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  utils<span class="op">::</span><span class="kw">download.file</span>(url, <span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a></code></pre></div>
<p>Now that we have downloaded the PDF file, we will read it in to R using the <code>pdftools</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">pdf_obesity &lt;-<span class="st"> </span>pdftools<span class="op">::</span><span class="kw">pdf_text</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a></code></pre></div>
<p>Let’s take a look at the data – the <code>summary()</code> function from base R helps us to look at the structure of R objects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">summary</span>(pdf_obesity)</a></code></pre></div>
<pre><code>   Length     Class      Mode 
       63 character character </code></pre>
<p>We can see that we have 63 elements that are character strings. You may also notice that the original PDF has 63 pages. Let’s take a look at some of these elements.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pdf_obesity[<span class="dv">1</span>] <span class="co"># this looks like the first page</span></a></code></pre></div>
<pre><code>[1] &quot;Letter                                                                                https://doi.org/10.1038/s41586-019-1171-x\nRising rural body-mass index is the main driver of\nthe global obesity epidemic in adults\nNCD Risk Factor Collaboration (NCD-RisC)*\n*A list of authors and their affiliations appears in the online version of the paper.\n2 6 0 | N A T U RE | V O L 5 6 9 | 9 M A Y 2 0 1 9\n&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pdf_obesity[<span class="dv">2</span>] <span class="co"># this looks like the second page</span></a></code></pre></div>
<pre><code>[1] &quot;Supplementary Information. Statistical model for estimating BMI trends by rural and urban\nplace of residence.\n                                          1\n&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">pdf_obesity[<span class="dv">55</span>] </a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># this looks like data in a the table we want</span></a></code></pre></div>
<p><img src="img/page55.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We can see that the output looks pretty similar to the pages of the pdf, but the spacing is a bit awkward. Note that the way the data is displayed is partially influenced by the width setting of the RStudio window.</p>
<p>We are interested in a supplementary Table 3. which has multiple pages and includes the same header on each page; we can use that to determine what elements of our <code>pdf_obesity</code> character strings include our table. We will use the <code>str_detect()</code> function from the <code>stringr</code> package to search for the elements that contain text that is consistently in the header. The output of of this function will show which elements of the object (in this case pages of the pdf) include this pattern indicated as a “TRUE” or “FALSE”.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">stringr<span class="op">::</span><span class="kw">str_detect</span>(<span class="dt">pattern =</span> <span class="st">&quot;Age-standardised mean BMI&quot;</span>, <span class="dt">string =</span> pdf_obesity)</a></code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[45] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[56]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># &quot;Age-standardised mean BMI&quot; is part of the header in the table on every page.</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># This shows the pages that contain our table of interest (as TRUE values).</span></a></code></pre></div>
<p>Now we will extract just the data for the table now and call it rural_urban. To do this we will use the <code>str_subset()</code> function of the stringr package.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">rural_urban &lt;-stringr<span class="op">::</span><span class="kw">str_subset</span>(<span class="dt">pattern =</span><span class="st">&quot;Age-standardised mean BMI&quot;</span>, </a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                                  <span class="dt">string =</span>pdf_obesity)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">str</span>(rural_urban) </a></code></pre></div>
<pre><code> chr [1:10] &quot;                                                                          2                                    &quot;| __truncated__ ...</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># The str() function is similar to the summary function</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># There are 10 pages worth of elements in our rural_urban object</span></a></code></pre></div>
<p>Let’s check the first and last page:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">cat</span>(rural_urban[<span class="dv">1</span>]) </a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># Using the cat() function which stands for Concatenate And Print </span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co"># This will allow for the &quot;\n&quot; values to be shown as spaces</span></a></code></pre></div>
<p><img src="img/first_page_in_R.png" width="90%" style="display: block; margin: auto;" /></p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This looks the same as the beginning… how about the end?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">cat</span>(rural_urban[<span class="dv">10</span>])</a></code></pre></div>
<p><img src="img/last_page_in_R.png" width="90%" style="display: block; margin: auto;" /></p>
<p><img src="img/last_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great! Our rural_urban object looks like it contains the entire Supplementary 3 table, as both the beginning and the end include the data we expected.</p>
</div>
<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>At this point we have large strings now for each page of the table, but this is not very convenient to work with. Now we will wrangle the data into a more usable form. Ideally we would like our data to be in some sort of tabular form.</p>
<div id="separate-the-data-into-lines" class="section level3">
<h3>Separate the data into lines</h3>
<p>First it would be useful to separate the data into lines or rows of the table.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">rural_urban &lt;-readr<span class="op">::</span><span class="kw">read_lines</span>(rural_urban)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">str</span>(rural_urban) </a></code></pre></div>
<pre><code> chr [1:461] &quot;                                                                          2                                    &quot;| __truncated__ ...</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># now we have 461 lines</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">rural_urban[<span class="dv">6</span>] </a></code></pre></div>
<pre><code>[1] &quot;Afghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># we can see that line 6 shows the data for females in Afghanistan  </span></a></code></pre></div>
</div>
<div id="removing-excess-white-space" class="section level3">
<h3>Removing excess white-space</h3>
<p>We also have a lot of white-space… let’s get rid of the excess white spaces using <code>str_squish()</code> also from the <code>stringr</code> package.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">rural_urban&lt;-stringr<span class="op">::</span><span class="kw">str_squish</span>(rural_urban) </a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;2 2&quot;                                                                                                                    
[2] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                    
[3] &quot;Country Sex&quot;                                                                                                            
[4] &quot;National Rural Urban National Rural Urban&quot;                                                                              
[5] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[6] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;</code></pre>
<p>Now it is much easier to see the data.</p>
<p>If we look at the end of the first page of the table and the start of the second we can see that the header information is repeated, as well as a line with the page number and an empty line, and a line that says “2 2”.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">rural_urban[<span class="dv">44</span><span class="op">:</span><span class="dv">56</span>]</a></code></pre></div>
<pre><code> [1] &quot;Benin Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;  
 [2] &quot;Men 24.3 (21.8-26.8) na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* 26.7 (24.3-29.2)&quot;                                    
 [3] &quot;Bermuda Women 25.4 (22.2-28.6) na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* 28.5 (25.3-31.6)&quot;                          
 [4] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;          
 [5] &quot;Bhutan Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot; 
 [6] &quot;51&quot;                                                                                                                 
 [7] &quot;&quot;                                                                                                                   
 [8] &quot;2 2&quot;                                                                                                                
 [9] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                
[10] &quot;Country Sex&quot;                                                                                                        
[11] &quot;National Rural Urban National Rural Urban&quot;                                                                          
[12] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;          
[13] &quot;Bolivia Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;</code></pre>
<p>Although the header was necessary on all of the pages of the pdf version of the table, we only need that information once in our data.</p>
</div>
<div id="removing-unnecessary-repeated-header-information" class="section level3">
<h3>Removing unnecessary repeated header information</h3>
<p>So, let’s remove all the header information and the page number lines from the rural_urban object, then we will make a single line header for the beginning. One way to do this is to find all lines that include either “women” or “men” and only keep this data. First let’s see how many lines include “women” or “men”. We can do this by first identifying the lines that contain these patterns and then check the length of the resulting vector for the line numbers that contain these patterns.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<pre><code>  [1]   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21
 [18]  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38
 [35]  39  40  41  42  43  44  45  46  47  48  55  56  57  58  59  60  61
 [52]  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78
 [69]  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
 [86]  96  97  98 105 106 107 108 109 110 111 112 113 114 115 116 117 118
[103] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135
[120] 136 137 138 139 140 141 142 143 144 145 146 147 148 155 156 157 158
[137] 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175
[154] 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192
[171] 193 194 195 196 197 198 205 206 207 208 209 210 211 212 213 214 215
[188] 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232
[205] 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 255
[222] 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272
[239] 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289
[256] 290 291 292 293 294 295 296 297 298 305 306 307 308 309 310 311 312
[273] 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
[290] 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346
[307] 347 348 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369
[324] 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386
[341] 387 388 389 390 391 392 393 394 395 396 397 398 405 406 407 408 409
[358] 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426
[375] 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
[392] 444 445 446 447 448 455 456 457 458</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">length</span>(stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>))</a></code></pre></div>
<pre><code>[1] 400</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># Here the &quot;|&quot; indicates that we are looking for either  &quot;Women&quot; or &quot;Men&quot;</span></a></code></pre></div>
<p>OK, so this looks correct. This includes most lines but there are gaps where are header is located. It looks like there are 400 lines in our table that aren’t headers.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">rural_urban &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<p>We can check our data now using either head() or glimpse().</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">dplyr<span class="op">::</span><span class="kw">glimpse</span>(rural_urban)</a></code></pre></div>
<pre><code> chr [1:400] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot; ...</code></pre>
<p>Great, now our rural_urban object 400 lines instead of 461, like it did before when it contained the redundant header information.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[2] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;              
[4] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;    
[5] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;              
[6] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;    </code></pre>
<p>The <code>head()</code> function shows us the first rows or lines of the data, while the <code>glimpse()</code> function provides us information about the total size of the object and shows us the first line or row.</p>
<p>Great! So now our data looks much better but we need to add back our header and we would like this to only be a single line to make it easy to transform our data into a table or table-like object.</p>
<p>Here is what our header used to look like:</p>
<p><img src="img/last_page.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="dealing-with-spacing" class="section level3">
<h3>Dealing with spacing</h3>
<p>First let’s try splitting our header-less data into columns based on spaces using the <code>str_split()</code> function, where we specify that we are splitting the data based on the pattern of a space (the space is included in quotes):</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">(<span class="kw">str_split</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot; &quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,] </a></code></pre></div>
<pre><code>      [,1]          [,2]    [,3]          [,4]          [,5]         
 [1,] &quot;Men&quot;         &quot;20.2&quot;  &quot;(17.8-22.7)&quot; &quot;19.7&quot;        &quot;(17.2-22.2)&quot;
 [2,] &quot;Afghanistan&quot; &quot;Women&quot; &quot;20.6&quot;        &quot;(18.4-22.8)&quot; &quot;20.1&quot;       
 [3,] &quot;Men&quot;         &quot;25.2&quot;  &quot;(23.9-26.5)&quot; &quot;25.0&quot;        &quot;(23.7-26.4)&quot;
 [4,] &quot;Albania&quot;     &quot;Women&quot; &quot;26.0&quot;        &quot;(24.1-27.9)&quot; &quot;26.1&quot;       
 [5,] &quot;Men&quot;         &quot;22.1&quot;  &quot;(20.8-23.3)&quot; &quot;21.8&quot;        &quot;(20.5-23.1)&quot;
 [6,] &quot;Algeria&quot;     &quot;Women&quot; &quot;24.0&quot;        &quot;(22.2-25.7)&quot; &quot;23.3&quot;       
 [7,] &quot;Men&quot;         &quot;33.7&quot;  &quot;(32.7-34.7)&quot; &quot;32.6&quot;        &quot;(31.7-33.5)&quot;
 [8,] &quot;American&quot;    &quot;Samoa&quot; &quot;Women&quot;       &quot;34.3&quot;        &quot;(33.1-35.6)&quot;
 [9,] &quot;Men&quot;         &quot;25.0&quot;  &quot;(22.5-27.4)&quot; &quot;25.3&quot;        &quot;(22.8-27.7)&quot;
[10,] &quot;Andorra&quot;     &quot;Women&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.4&quot;       
      [,6]          [,7]          [,8]          [,9]         
 [1,] &quot;22.4&quot;        &quot;(20.0-25.0)&quot; &quot;22.8&quot;        &quot;(20.3-25.3)&quot;
 [2,] &quot;(17.8-22.4)&quot; &quot;23.2&quot;        &quot;(20.9-25.4)&quot; &quot;24.4&quot;       
 [3,] &quot;25.4&quot;        &quot;(24.0-26.7)&quot; &quot;27.0&quot;        &quot;(26.0-27.9)&quot;
 [4,] &quot;(24.1-28.1)&quot; &quot;25.9&quot;        &quot;(23.9-27.8)&quot; &quot;26.0&quot;       
 [5,] &quot;22.3&quot;        &quot;(21.0-23.6)&quot; &quot;25.1&quot;        &quot;(24.5-25.7)&quot;
 [6,] &quot;(21.4-25.1)&quot; &quot;24.8&quot;        &quot;(22.9-26.6)&quot; &quot;27.4&quot;       
 [7,] &quot;34.0&quot;        &quot;(32.9-35.1)&quot; &quot;34.3&quot;        &quot;(33.0-35.6)&quot;
 [8,] &quot;34.1&quot;        &quot;(33.0-35.2)&quot; &quot;34.4&quot;        &quot;(33.0-35.8)&quot;
 [9,] &quot;25.0&quot;        &quot;(22.5-27.4)&quot; &quot;26.8&quot;        &quot;(24.4-29.2)&quot;
[10,] &quot;(22.2-28.7)&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.3&quot;       
      [,10]         [,11]         [,12]         [,13]        
 [1,] &quot;22.5&quot;        &quot;(20.0-25.0)&quot; &quot;23.6&quot;        &quot;(21.0-26.1)&quot;
 [2,] &quot;(23.3-25.4)&quot; &quot;23.6&quot;        &quot;(22.5-24.8)&quot; &quot;26.3&quot;       
 [3,] &quot;26.9&quot;        &quot;(25.9-27.9)&quot; &quot;27.0&quot;        &quot;(26.0-28.0)&quot;
 [4,] &quot;(24.8-27.2)&quot; &quot;26.2&quot;        &quot;(24.8-27.5)&quot; &quot;25.9&quot;       
 [5,] &quot;24.8&quot;        &quot;(24.1-25.4)&quot; &quot;25.2&quot;        &quot;(24.6-25.9)&quot;
 [6,] &quot;(26.7-28.0)&quot; &quot;27.0&quot;        &quot;(26.3-27.8)&quot; &quot;27.5&quot;       
 [7,] &quot;34.6&quot;        &quot;(33.1-35.9)&quot; &quot;34.2&quot;        &quot;(32.9-35.6)&quot;
 [8,] &quot;35.3&quot;        &quot;(33.7-36.9)&quot; &quot;35.0&quot;        &quot;(33.1-36.9)&quot;
 [9,] &quot;26.8&quot;        &quot;(24.3-29.2)&quot; &quot;26.8&quot;        &quot;(24.3-29.3)&quot;
[10,] &quot;(22.1-28.6)&quot; &quot;25.2&quot;        &quot;(21.9-28.5)&quot; &quot;25.3&quot;       
      [,14]         [,15]         [,16] [,17] [,18]
 [1,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [2,] &quot;(25.1-27.4)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [3,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [4,] &quot;(24.6-27.2)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [5,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [6,] &quot;(26.7-28.2)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [7,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [8,] &quot;35.4&quot;        &quot;(33.7-37.1)&quot; &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [9,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
[10,] &quot;(22.1-28.6)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   </code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Here we will take a look at just the first 10 lines using the [1:10,]</span></a></code></pre></div>
<p>This almost worked, but unfortunately country names that have spaces will be a problem. We can see that American Samoa has been divided into two columns and all subsequent columns are shifted.</p>
<p>So now let’s try to extract the country information, by separating the country information from the sex information when the sex is female.</p>
<p>Sex always starts with either a capital “W” if the gender is female. #We need to use a space before the “W” otherwise we will split some of the country names if the names starts with “W”.</p>
<p>Here we will also introduce the concept of piping, which uses the <code>%&gt;%</code>. This is really useful when we have multiple steps, which we will show soon.</p>
<p>So first we will select just the data for Women and then split this data based on the pattern &quot; Women&quot; (Note that the space is included - so that it is not within the country data).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">Women &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) </a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="co"># First let&#39;s subset the data to only the lines that contain &quot;Women&quot;</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"></a>
<a class="sourceLine" id="cb41-4" data-line-number="4">country_split &lt;-Women <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern=</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="st">  </span><span class="kw">unlist</span>() </a>
<a class="sourceLine" id="cb41-7" data-line-number="7"></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="co">#we can do the same thing with two pipes:</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co"># first we select the &quot;Women&quot; data and then we split the data by &quot; Women&quot;</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co"># finally we assign the output of both steps to the object country_split</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12"></a>
<a class="sourceLine" id="cb41-13" data-line-number="13">country_split &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-14" data-line-number="14"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern=</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-15" data-line-number="15"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb41-16" data-line-number="16"></a>
<a class="sourceLine" id="cb41-17" data-line-number="17"><span class="kw">head</span>(country_split)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan&quot;                                                                                           
[2] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Albania&quot;                                                                                               
[4] &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;
[5] &quot;Algeria&quot;                                                                                               
[6] &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;</code></pre>
<p>Now we can see that Country is always the odd rows and the rest of the data is the rest of the rows. We can select the odd rows using the <b> Modulus (Remainder from division) operator</b>. This operator looks like this <code>%%</code>. All odd values such as 3, 7, or 15 when divided by 2 would leave a remainder of 1. We will select just these rows using the <code>filter()</code> function of <code>dplyr</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">country &lt;-<span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </a></code></pre></div>
<p>We can take a look to make sure that all the country names look as expected:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">country</a></code></pre></div>
<div id="section-5" class="section level4 scrollable">
<h4></h4>
<pre><code># A tibble: 200 x 1
   country_split      
   &lt;chr&gt;              
 1 Afghanistan        
 2 Albania            
 3 Algeria            
 4 American Samoa     
 5 Andorra            
 6 Angola             
 7 Antigua and Barbuda
 8 Argentina          
 9 Armenia            
10 Australia          
# … with 190 more rows</code></pre>
</div>
<div id="section-6" class="section level4">
<h4></h4>
<p>Looks good!</p>
<p>The even rows are the rows with the data for women. These row values have a remainder of 0 when divided by 2.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">Women_BMI &lt;-<span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="kw">head</span>(Women_BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  country_split                                                            
  &lt;chr&gt;                                                                    
1 &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23…
2 &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26…
3 &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27…
4 &quot; 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35…
5 &quot; 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25…
6 &quot; 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23…</code></pre>
<p>Great! Now we have a list of the countries that can be used for both the male and female data.</p>
<p>It’s always a good idea to check that your data objects are the size you expect when wrangling. We can do so with the <code>dim()</code> function, which shows us the dimensions of data objects.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">dim</span>(Women_BMI)</a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<p>Great! There are 200 rows like we expected.</p>
<p>We do however need to add &quot; Women&quot; back to this data.</p>
<p>To do this we will use the <code>glue()</code> function of the <code>glue</code> package.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">Women &lt;-glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;Women{Women_BMI$country_split}&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code>Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)
Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)
Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)
Women 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (33.1-36.9) 35.4 (33.7-37.1)
Women 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (21.9-28.5) 25.3 (22.1-28.6)
Women 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (20.0-26.7) 25.7 (22.4-29.1)</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># here we will paste &quot; Women&quot; in fromt of the Women_BMI data</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="co"># note that there will be a space in between</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="co"># This is because the space is already in front of the first BMI value</span></a></code></pre></div>
<p>Let’s grab the male data:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># remember our rural_urban object contains male data for the odd rows</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"></a>
<a class="sourceLine" id="cb53-3" data-line-number="3">Men &lt;-<span class="kw">tibble</span>(rural_urban) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb53-5" data-line-number="5"><span class="kw">head</span>(Men<span class="op">$</span>rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co"># Again let&#39;s make sure we have the correct number of rows </span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"></a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">dim</span>(Men) </a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<p>How about our number of columns?</p>
<p>If we try splitting our data by space again, will it have the expected number of columns? What about the rows that contain na* values?</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># Let&#39;s just take the Men data that contains na* values</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="co"># This column is called rural_urban</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3">unknown &lt;-Men <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(<span class="dt">pattern =</span><span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, <span class="dt">string =</span> rural_urban)) </a>
<a class="sourceLine" id="cb57-4" data-line-number="4"></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="co"># Now we can try splitting by a space</span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6">tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(unknown<span class="op">$</span>rural_urban, <span class="st">&quot; &quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code># A tibble: 5 x 12
  V1    V2    V3     V4    V5     V6    V7    V8    V9    V10   V11   V12  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Men   24.3  (21.8… na*   24.3   (21.… 26.7  (24.… na*   26.7  (24.… &quot;&quot;   
2 Men   22.4  (21.4… 21.5  (20.2… 22.4  (21.… 24.8  (23.… na*   24.8  (23.…
3 Men   32.6  (32.0… na*   32.6   (32.… 32.9  (31.… na*   32.9  (31.… &quot;&quot;   
4 Men   22.8  (22.2… na*   22.8   (22.… 24.4  (23.… na*   24.4  (23.… &quot;&quot;   
5 Men   29.6  (28.1… 29.6  (28.1… na*   32.3  (31.… 32.3  (31.… na*   &quot;&quot;   </code></pre>
</div>
</div>
<div id="dealing-with-na-values" class="section level3">
<h3>Dealing with NA values</h3>
<p>So close! Notice that the &quot;na*&quot; values have shifted the subsequent values within the columns because typically there is a space between the BMI and the credible intervals. Here we can see this data in our original pdf:</p>
<p><img src="img/missing_pdf.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We need to replace our na* values with something that includes a space so that when we separate our data by space we will have two values instead of one when we have an na* . Therefore, na* na* should work.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">class</span>(Men<span class="op">$</span>rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="co"># In order to use the functions within the stringr package, </span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="co"># our Men data needs to be of character class</span></a>
<a class="sourceLine" id="cb61-3" data-line-number="3">Men&lt;-<span class="kw">as.character</span>(Men<span class="op">$</span>rural_urban) </a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="co"># This function allows us to change the factor data </span></a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="co"># within Men$rural_urban to the character class</span></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="co"># We are also changing the structure so that the data </span></a>
<a class="sourceLine" id="cb61-7" data-line-number="7"><span class="co"># is not within a vector called rural_urban</span></a>
<a class="sourceLine" id="cb61-8" data-line-number="8">Men&lt;-stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Men, </a>
<a class="sourceLine" id="cb61-9" data-line-number="9">                              <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb61-10" data-line-number="10">                              <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb61-11" data-line-number="11"><span class="co"># The \\ are necessary because the * is a special character </span></a>
<a class="sourceLine" id="cb61-12" data-line-number="12"><span class="co"># The * would typically indicate any possible value, </span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13"><span class="co"># but here we actually want a &quot;*&quot; instead</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"><span class="co"># Thus the double backslash does that for us</span></a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="co"># Here we are replacing all occurences of the na* values </span></a>
<a class="sourceLine" id="cb61-16" data-line-number="16"><span class="co">#(thus str_replace_all instead of str_replace) with na* na*. </span></a></code></pre></div>
<p>Let’s check that it worked…</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">Men[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Men 20.7 (19.4-22.1) 20.3 (18.9-21.7) 21.7 (20.3-23.1) 22.7 (22.0-23.3) 22.1 (21.3-22.8) 23.4 (22.7-24.1)&quot;
 [2] &quot;Men 24.3 (21.8-26.8) na* na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* na* 26.7 (24.3-29.2)&quot;                  
 [3] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;
 [4] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;
 [5] &quot;Men 24.9 (23.5-26.2) 24.8 (23.4-26.2) 25.0 (23.6-26.4) 26.8 (25.7-27.8) 26.7 (25.7-27.8) 26.8 (25.7-27.9)&quot;
 [6] &quot;Men 20.6 (19.2-22.0) 20.3 (18.8-21.7) 21.4 (20.0-22.9) 22.6 (21.9-23.4) 21.9 (20.9-22.8) 23.2 (22.3-24.0)&quot;
 [7] &quot;Men 23.3 (22.5-24.0) 22.2 (21.4-23.0) 23.7 (22.9-24.5) 26.2 (25.7-26.7) 25.0 (24.3-25.6) 26.4 (25.9-26.9)&quot;
 [8] &quot;Men 24.0 (22.5-25.4) 23.7 (22.1-25.1) 24.2 (22.7-25.7) 27.1 (26.4-27.7) 26.6 (26.0-27.3) 27.2 (26.5-27.9)&quot;
 [9] &quot;Men 25.0 (23.8-26.4) 24.9 (23.5-26.4) 25.1 (23.8-26.5) 27.0 (25.8-28.1) 27.0 (25.7-28.3) 27.0 (25.7-28.2)&quot;
[10] &quot;Men 20.2 (18.8-21.5) 20.0 (18.6-21.4) 21.4 (19.9-22.9) 22.2 (21.4-23.0) 21.8 (21.0-22.6) 23.1 (22.1-24.1)&quot;
[11] &quot;Men 20.2 (17.7-22.6) 20.1 (17.6-22.5) 21.2 (18.7-23.6) 22.1 (19.8-24.5) 22.0 (19.6-24.3) 23.2 (20.8-25.6)&quot;</code></pre>
<p>Great!</p>
<p>Now for the Women data object</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">class</span>(Women)</a></code></pre></div>
<pre><code>[1] &quot;glue&quot;      &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co"># the female data is already character type</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2">Women&lt;-stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Women, </a>
<a class="sourceLine" id="cb66-3" data-line-number="3">                                <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb66-4" data-line-number="4">                                <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb66-5" data-line-number="5">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;
 [2] &quot;Women 25.4 (22.2-28.6) na* na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* na* 28.5 (25.3-31.6)&quot;                  
 [3] &quot;Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot;
 [4] &quot;Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;
 [5] &quot;Women 25.5 (23.5-27.4) 25.7 (23.7-27.7) 25.1 (23.1-27.0) 25.7 (24.4-27.1) 26.0 (24.6-27.5) 25.3 (23.9-26.8)&quot;
 [6] &quot;Women 24.2 (22.2-26.2) 23.7 (21.5-25.8) 25.6 (23.5-27.7) 26.2 (25.3-27.1) 25.0 (23.8-26.2) 27.0 (26.0-28.2)&quot;
 [7] &quot;Women 24.0 (23.2-25.0) 23.1 (22.1-24.1) 24.4 (23.5-25.4) 26.9 (26.2-27.5) 26.4 (25.7-27.2) 26.9 (26.3-27.6)&quot;
 [8] &quot;Women 23.6 (21.4-25.6) 22.9 (20.7-25.0) 24.0 (21.8-26.1) 27.4 (26.6-28.1) 27.0 (26.1-27.8) 27.5 (26.7-28.2)&quot;
 [9] &quot;Women 25.2 (23.4-27.1) 25.5 (23.4-27.6) 25.0 (23.1-26.9) 25.6 (24.1-27.1) 26.0 (24.2-27.8) 25.5 (23.9-27.1)&quot;
[10] &quot;Women 19.9 (18.7-21.2) 19.6 (18.4-20.9) 22.0 (20.7-23.3) 22.2 (21.4-23.1) 21.1 (20.2-22.0) 24.7 (23.7-25.7)&quot;
[11] &quot;Women 19.6 (17.5-21.7) 19.5 (17.4-21.6) 21.7 (19.5-23.8) 21.1 (20.3-22.0) 20.7 (19.8-21.6) 24.0 (23.0-24.9)&quot;</code></pre>
<p>Great, now we can split our data by spaces.</p>
</div>
<div id="splitting-the-data" class="section level3">
<h3>Splitting the data</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">Men &lt;-tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Men, <span class="st">&quot; &quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="co"># Note here we need to use the column of Women that has the data</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  V1    V2    V3     V4    V5     V6    V7    V8    V9    V10   V11   V12  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Men   20.2  (17.8… 19.7  (17.2… 22.4  (20.… 22.8  (20.… 22.5  (20.… 23.6 
2 Men   25.2  (23.9… 25.0  (23.7… 25.4  (24.… 27.0  (26.… 26.9  (25.… 27.0 
3 Men   22.1  (20.8… 21.8  (20.5… 22.3  (21.… 25.1  (24.… 24.8  (24.… 25.2 
4 Men   33.7  (32.7… 32.6  (31.7… 34.0  (32.… 34.3  (33.… 34.6  (33.… 34.2 
5 Men   25.0  (22.5… 25.3  (22.8… 25.0  (22.… 26.8  (24.… 26.8  (24.… 26.8 
6 Men   20.5  (17.9… 20.2  (17.6… 21.4  (18.… 22.6  (20.… 22.0  (19.… 23.2 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">Women&lt;-<span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Women, <span class="st">&quot; &quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="co"># Note here we need to use the column of Women that has the data</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  V1    V2    V3     V4    V5     V6    V7    V8    V9    V10   V11   V12  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Women 20.6  (18.4… 20.1  (17.8… 23.2  (20.… 24.4  (23.… 23.6  (22.… 26.3 
2 Women 26.0  (24.1… 26.1  (24.1… 25.9  (23.… 26.0  (24.… 26.2  (24.… 25.9 
3 Women 24.0  (22.2… 23.3  (21.4… 24.8  (22.… 27.4  (26.… 27.0  (26.… 27.5 
4 Women 34.3  (33.1… 34.1  (33.0… 34.4  (33.… 35.3  (33.… 35.0  (33.… 35.4 
5 Women 25.2  (22.0… 25.4  (22.2… 25.2  (22.… 25.3  (22.… 25.2  (21.… 25.3 
6 Women 21.3  (18.0… 20.9  (17.6… 22.7  (19.… 24.4  (21.… 23.3  (20.… 25.7 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>,] </a></code></pre></div>
<pre><code># A tibble: 11 x 13
   V1    V2    V3     V4    V5    V6    V7    V8    V9    V10   V11   V12  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Women 20.6  (19.1… 20.1  (18.… 21.8  (20.… 24.3  (23.… 23.2  (22.… 25.5 
 2 Women 25.4  (22.2… na*   na*   25.4  (22.… 28.5  (25.… na*   na*   28.5 
 3 Women 20.7  (18.4… 20.3  (18.… 23.0  (20.… 24.6  (23.… 23.8  (22.… 25.9 
 4 Women 23.8  (22.3… 23.0  (21.… 24.6  (23.… 27.9  (26.… 27.0  (25.… 28.3 
 5 Women 25.5  (23.5… 25.7  (23.… 25.1  (23.… 25.7  (24.… 26.0  (24.… 25.3 
 6 Women 24.2  (22.2… 23.7  (21.… 25.6  (23.… 26.2  (25.… 25.0  (23.… 27.0 
 7 Women 24.0  (23.2… 23.1  (22.… 24.4  (23.… 26.9  (26.… 26.4  (25.… 26.9 
 8 Women 23.6  (21.4… 22.9  (20.… 24.0  (21.… 27.4  (26.… 27.0  (26.… 27.5 
 9 Women 25.2  (23.4… 25.5  (23.… 25.0  (23.… 25.6  (24.… 26.0  (24.… 25.5 
10 Women 19.9  (18.7… 19.6  (18.… 22.0  (20.… 22.2  (21.… 21.1  (20.… 24.7 
11 Women 19.6  (17.5… 19.5  (17.… 21.7  (19.… 21.1  (20.… 20.7  (19.… 24.0 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="co"># We can see that our na values look correct</span></a></code></pre></div>
<p>Looks good!</p>
</div>
<div id="adding-new-header" class="section level3">
<h3>Adding new header</h3>
<p>We can see from our pdf and our object called header what the header was like. Let’s also make a new single line header, but let’s wait to add Country:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="co">#header</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2">new_header &lt;-<span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>,<span class="st">&quot;National_BMI_1985&quot;</span>, <span class="st">&quot;National_BMI_1985_CI&quot;</span>, <span class="st">&quot;Rural_BMI_1985&quot;</span>, </a>
<a class="sourceLine" id="cb75-3" data-line-number="3">               <span class="st">&quot;Rural_BMI_1985_CI&quot;</span>, <span class="st">&quot;Urban_BMI_1985&quot;</span>, <span class="st">&quot;Urban_BMI_1985_CI&quot;</span>, <span class="st">&quot;National_BMI_2017&quot;</span>,</a>
<a class="sourceLine" id="cb75-4" data-line-number="4">               <span class="st">&quot;National_BMI_2017_CI&quot;</span>,<span class="st">&quot;Rural_BMI_2017&quot;</span>, <span class="st">&quot;Rural_BMI_2017_CI&quot;</span>, <span class="st">&quot;Urban_BMI_2017&quot;</span>, </a>
<a class="sourceLine" id="cb75-5" data-line-number="5">               <span class="st">&quot;Urban_BMI_2017_CI&quot;</span>)</a></code></pre></div>
<p>Let’s change the names of our columns of our tibbles to this new header for our Men and Women data</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">names</span>(Women)&lt;-new_header</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">names</span>(Men)&lt;-new_header</a></code></pre></div>
<p>Now we will add our country data to both our Men and Women tibbles using the <code>bind_cols()</code> function:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">Women &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Women)</a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="co"># This will add the country as a new column to the Women data object on the left </span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3">Men &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Men) </a>
<a class="sourceLine" id="cb77-4" data-line-number="4"><span class="co"># This will add the country as a new column to the Men data object on the left </span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  country_split Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghanistan   Women 20.6             (18.4-22.8)      20.1          
2 Albania       Women 26.0             (24.1-27.9)      26.1          
3 Algeria       Women 24.0             (22.2-25.7)      23.3          
4 American Sam… Women 34.3             (33.1-35.6)      34.1          
5 Andorra       Women 25.2             (22.0-28.4)      25.4          
6 Angola        Women 21.3             (18.0-24.6)      20.9          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="changing-variable-names" class="section level3">
<h3>Changing variable names</h3>
<p>Here we will change the variable name of the country data to country, currently it is called country_split. Here we will also introduce the concept of the assignment pipe. In this case our pipe operator looks like this <code>%&lt;&gt;%</code> . Using this fancier pipe requires another package, called <code>magrittr</code>. The other simpler pipe options from this package are loaded with <code>tidyverse</code> (if you used <code>library(tidyverse)</code> which loads most tidyverse packages), but not this fancier version.</p>
<p>The <code>&gt;</code> portion of the pipe still behaves like a normal pipe, while the <code>&lt;</code> portion of the pipe makes an assignment to whatever the <code>&lt;</code>is pointing to, just like when we use the typical assignment operator <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="co"># library(magrittr) </span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="co"># We can&#39;t use the `%&lt;&gt;%` unless we load the magrittr package</span></a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="co"># We have already done this but we include this for illustrative purposes.</span></a>
<a class="sourceLine" id="cb79-4" data-line-number="4"><span class="co"># Here we will just use the traditional assignment strategy</span></a>
<a class="sourceLine" id="cb79-5" data-line-number="5"></a>
<a class="sourceLine" id="cb79-6" data-line-number="6">Women&lt;-dplyr<span class="op">::</span><span class="kw">rename</span>(Women, <span class="dt">Country =</span> country_split) </a>
<a class="sourceLine" id="cb79-7" data-line-number="7"><span class="co"># We have renamed the country_split variable to be called Country</span></a>
<a class="sourceLine" id="cb79-8" data-line-number="8"></a>
<a class="sourceLine" id="cb79-9" data-line-number="9"><span class="co"># Here we reassign Men using the pipe strategy</span></a>
<a class="sourceLine" id="cb79-10" data-line-number="10">Men <span class="op">%&lt;&gt;%</span><span class="kw">rename</span>(<span class="dt">Country =</span> country_split) </a>
<a class="sourceLine" id="cb79-11" data-line-number="11"><span class="co"># We have renamed the country_split variable to to be called country</span></a>
<a class="sourceLine" id="cb79-12" data-line-number="12"><span class="co"># We have also reassigned Men to the data object </span></a>
<a class="sourceLine" id="cb79-13" data-line-number="13"><span class="co"># which has the country variable renamed</span></a></code></pre></div>
</div>
<div id="joining-the-data" class="section level3">
<h3>Joining the data</h3>
<p>Now we can combine our Men and Women data using the <code>full_join()</code> function of <code>dplyr</code>. This will put all the male data first (x) and all the female data second (y).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">BMI&lt;-dplyr<span class="op">::</span><span class="kw">full_join</span>(<span class="dt">x =</span> Men, <span class="dt">y =</span> Women)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="co"># Let&#39;s check the size of our BMI data... it should have 400 rows (obs).</span></a>
<a class="sourceLine" id="cb80-3" data-line-number="3"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American Samoa&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; ...
 $ National_BMI_1985   : chr  &quot;20.2&quot; &quot;25.2&quot; &quot;22.1&quot; &quot;33.7&quot; ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(23.9-26.5)&quot; &quot;(20.8-23.3)&quot; &quot;(32.7-34.7)&quot; ...
 $ Rural_BMI_1985      : chr  &quot;19.7&quot; &quot;25.0&quot; &quot;21.8&quot; &quot;32.6&quot; ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(23.7-26.4)&quot; &quot;(20.5-23.1)&quot; &quot;(31.7-33.5)&quot; ...
 $ Urban_BMI_1985      : chr  &quot;22.4&quot; &quot;25.4&quot; &quot;22.3&quot; &quot;34.0&quot; ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(24.0-26.7)&quot; &quot;(21.0-23.6)&quot; &quot;(32.9-35.1)&quot; ...
 $ National_BMI_2017   : chr  &quot;22.8&quot; &quot;27.0&quot; &quot;25.1&quot; &quot;34.3&quot; ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(26.0-27.9)&quot; &quot;(24.5-25.7)&quot; &quot;(33.0-35.6)&quot; ...
 $ Rural_BMI_2017      : chr  &quot;22.5&quot; &quot;26.9&quot; &quot;24.8&quot; &quot;34.6&quot; ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(25.9-27.9)&quot; &quot;(24.1-25.4)&quot; &quot;(33.1-35.9)&quot; ...
 $ Urban_BMI_2017      : chr  &quot;23.6&quot; &quot;27.0&quot; &quot;25.2&quot; &quot;34.2&quot; ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-25.9)&quot; &quot;(32.9-35.6)&quot; ...</code></pre>
</div>
<div id="sorting-the-data" class="section level3">
<h3>Sorting the data</h3>
<p>Now Lets sort the data by country:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">BMI &lt;-dplyr<span class="op">::</span><span class="kw">arrange</span>(BMI, Country)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="kw">head</span>(BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Men   20.2             (17.8-22.7)      19.7          
2 Afghan… Women 20.6             (18.4-22.8)      20.1          
3 Albania Men   25.2             (23.9-26.5)      25.0          
4 Albania Women 26.0             (24.1-27.9)      26.1          
5 Algeria Men   22.1             (20.8-23.3)      21.8          
6 Algeria Women 24.0             (22.2-25.7)      23.3          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Our data is looking great!</p>
<p>Now we might want to make sure that our observations for each variable look the way we want. In other words, if we want to make plots about National BMI in 1985 then we would need our values to be numeric. Looking at our BMI data using <code>str()</code>, we can see the type of data for each of our variables listed just after variable name and the “:” colon. Looks like none of our BMI data is actually numeric, but of the class character. Let’s change that now.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : chr  &quot;20.2&quot; &quot;20.6&quot; &quot;25.2&quot; &quot;26.0&quot; ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : chr  &quot;19.7&quot; &quot;20.1&quot; &quot;25.0&quot; &quot;26.1&quot; ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : chr  &quot;22.4&quot; &quot;23.2&quot; &quot;25.4&quot; &quot;25.9&quot; ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : chr  &quot;22.8&quot; &quot;24.4&quot; &quot;27.0&quot; &quot;26.0&quot; ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : chr  &quot;22.5&quot; &quot;23.6&quot; &quot;26.9&quot; &quot;26.2&quot; ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : chr  &quot;23.6&quot; &quot;26.3&quot; &quot;27.0&quot; &quot;25.9&quot; ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>We could change these values to be numeric with 6 lines of code like this:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">BMI<span class="op">$</span>National_BMI_<span class="dv">1985</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-2" data-line-number="2">BMI<span class="op">$</span>Rural_BMI_<span class="dv">1985</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-3" data-line-number="3">BMI<span class="op">$</span>Urban_BMI_<span class="dv">1985</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-4" data-line-number="4"></a>
<a class="sourceLine" id="cb86-5" data-line-number="5">BMI<span class="op">$</span>National_BMI_<span class="dv">2017</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-6" data-line-number="6">BMI<span class="op">$</span>Rural_BMI_<span class="dv">2017</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-7" data-line-number="7">BMI<span class="op">$</span>Urban_BMI_<span class="dv">2017</span><span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb86-8" data-line-number="8"></a>
<a class="sourceLine" id="cb86-9" data-line-number="9"><span class="co">#  And if we did this we would see these variables </span></a>
<a class="sourceLine" id="cb86-10" data-line-number="10"><span class="co">#  show as &quot;num&quot; which stands for numeric</span></a>
<a class="sourceLine" id="cb86-11" data-line-number="11"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : num  20.2 20.6 25.2 26 22.1 24 33.7 34.3 25 25.2 ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : num  19.7 20.1 25 26.1 21.8 23.3 32.6 34.1 25.3 25.4 ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : num  22.4 23.2 25.4 25.9 22.3 24.8 34 34.4 25 25.2 ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : num  22.8 24.4 27 26 25.1 27.4 34.3 35.3 26.8 25.3 ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : num  22.5 23.6 26.9 26.2 24.8 27 34.6 35 26.8 25.2 ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : num  23.6 26.3 27 25.9 25.2 27.5 34.2 35.4 26.8 25.3 ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>Or we can use a more automated way with the <code>map()</code> function of the <code>purrr</code> package:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">BMI_numeric &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(purrr<span class="op">::</span><span class="kw">map</span>(</a>
<a class="sourceLine" id="cb88-2" data-line-number="2">  (BMI <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">matches</span>(<span class="st">&quot;CI|Sex|Country&quot;</span>))), as.numeric)) </a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="co"># The map function of the purrr package allows us to apply the </span></a>
<a class="sourceLine" id="cb88-4" data-line-number="4"><span class="co"># as.numeric() function to all the selected columns of BMI </span></a>
<a class="sourceLine" id="cb88-5" data-line-number="5"><span class="co"># We have selected those that dont contain CI, Sex, or Country in the column name </span></a>
<a class="sourceLine" id="cb88-6" data-line-number="6"><span class="co"># If you are familiar with apply(), this function is very similar</span></a>
<a class="sourceLine" id="cb88-7" data-line-number="7">BMI_numeric <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Country =</span>BMI<span class="op">$</span>Country, <span class="dt">Sex =</span>BMI<span class="op">$</span>Sex)</a>
<a class="sourceLine" id="cb88-8" data-line-number="8"><span class="kw">head</span>(BMI_numeric)</a></code></pre></div>
<pre><code># A tibble: 6 x 8
  National_BMI_19… Rural_BMI_1985 Urban_BMI_1985 National_BMI_20…
             &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
1             20.2           19.7           22.4             22.8
2             20.6           20.1           23.2             24.4
3             25.2           25             25.4             27  
4             26             26.1           25.9             26  
5             22.1           21.8           22.3             25.1
6             24             23.3           24.8             27.4
# … with 4 more variables: Rural_BMI_2017 &lt;dbl&gt;, Urban_BMI_2017 &lt;dbl&gt;,
#   Country &lt;chr&gt;, Sex &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="co"># In this case our numeric data is class dbl</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="co"># This means double-precision floating point numbers (with decimals)</span></a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="co"># The alternative numeric option is the integar class</span></a></code></pre></div>
<p>It is generally useful to get the data in what is called <b>long</b> format for other analyses, and particularly for plotting.</p>
<p>For a more detailed description about this, please see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html">case study</a>.</p>
<p>Basically what the long format will have more rows and fewer columns. Thus we can combine or “gather” some columns together. In our case we can put all the different BMI data together in one long column. We will create a new column that tells us what each row of the new BMI column represents. In other words, it will tell us what the original column was.</p>
<p>To do this we will use the <code>gather()</code> function of the <code>tidyr</code> package:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">BMI_long &lt;-tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">data =</span>BMI_numeric, <span class="dt">key =</span> class_BMI, <span class="dt">value =</span> BMI, National_BMI_<span class="dv">1985</span><span class="op">:</span>Urban_BMI_<span class="dv">2017</span>, <span class="dt">factor_key =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="co"># The data value indicates what data you start with</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="co"># The key indicates the new name of the column that will now contain </span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="co"># information about the values of the columns we will put together</span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="co"># The value is the name of the column for the values for </span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="co"># all the columns that are being put together</span></a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="co"># The &quot;:&quot; can be used to indentify the start and end of the column names</span></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="co"># that you are putting together</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"><span class="co"># The factor_key paramater determines if the newly created key column </span></a>
<a class="sourceLine" id="cb91-10" data-line-number="10"><span class="co"># should be evaluated as a factor or not</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   class_BMI           BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;
1 Afghanistan Men   National_BMI_1985  20.2
2 Afghanistan Women National_BMI_1985  20.6
3 Albania     Men   National_BMI_1985  25.2
4 Albania     Women National_BMI_1985  26  
5 Algeria     Men   National_BMI_1985  22.1
6 Algeria     Women National_BMI_1985  24  </code></pre>
<p>It would be useful to parse the 1985 and the 2017 data. We can do so by separating the parts of the class_BMI column using the <code>separate()</code> function of the <code>tidyr</code> package. In our case we will replace the class_BMI column with two new columns.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">BMI_long<span class="op">%&lt;&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">separate</span>(class_BMI, <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;Year&quot;</span>)) </a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co"># We will separate the class_BMI column of the BMI_long tibble</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3"><span class="co"># This is based on the underscores and create two new columns</span></a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="co"># The first column will be called Region</span></a>
<a class="sourceLine" id="cb93-5" data-line-number="5"><span class="co"># It will contain the 1st part of the class_BMI data before the 1st underscore</span></a>
<a class="sourceLine" id="cb93-6" data-line-number="6"><span class="co"># The 2nd column will be called Year</span></a>
<a class="sourceLine" id="cb93-7" data-line-number="7"><span class="co"># It will contain the 3rd part of the data based on underscores</span></a>
<a class="sourceLine" id="cb93-8" data-line-number="8"><span class="co"># The middle part of the column will not be used to create any new columns</span></a>
<a class="sourceLine" id="cb93-9" data-line-number="9"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan Men   National 1985   20.2
2 Afghanistan Women National 1985   20.6
3 Albania     Men   National 1985   25.2
4 Albania     Women National 1985   26  
5 Algeria     Men   National 1985   22.1
6 Algeria     Women National 1985   24  </code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="co"># Let&#39;s see how the dimensions of the BMI data have changed in long format:</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="kw">dim</span>(BMI_numeric)</a></code></pre></div>
<pre><code>[1] 400   8</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">dim</span>(BMI_long)</a></code></pre></div>
<pre><code>[1] 2400    5</code></pre>
<div id="section-7" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Why exactly are there 2,400 rows now?</p>
</div>
<div id="section-8" class="section level4">
<h4></h4>
<p>Great! our data is very usable now in this format!</p>
</div>
</div>
</div>
<div id="data-exploration" class="section level2">
<h2>Data Exploration</h2>
<p>Now that our data is clean and in a format that we can work with, we can start to take a look at the data and how different groups might compare.</p>
<p>Statistically speaking there are tests that can allow us to evaluate if the means of the groups are different. First let’s see how our data looks in general.</p>
<div id="general-summary" class="section level3">
<h3>General summary</h3>
<p>Start here if not working through data import and wrangling</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">summary</span>(BMI_numeric)</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985 Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.7   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.50     1st Qu.:20.9   1st Qu.:22.43   1st Qu.:24.07    
 Median :24.00     Median :23.4   Median :24.30   Median :26.15    
 Mean   :23.68     Mean   :23.3   Mean   :24.24   Mean   :26.00    
 3rd Qu.:25.23     3rd Qu.:25.1   3rd Qu.:25.40   3rd Qu.:27.43    
 Max.   :34.30     Max.   :34.1   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :6      NA&#39;s   :2                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :19.80   Min.   :21.50   Length:400         Length:400        
 1st Qu.:23.30   1st Qu.:24.80   Class :character   Class :character  
 Median :26.00   Median :26.30   Mode  :character   Mode  :character  
 Mean   :25.61   Mean   :26.37                                        
 3rd Qu.:27.30   3rd Qu.:27.60                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :8       NA&#39;s   :2                                            </code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="co"># We can see that the mean  BMI estimates are larger in 2017</span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="co"># Is this a meaningful increase?</span></a></code></pre></div>
<p>OK, so our means are fairly similar, but we can see some differences. The question is if those differences are meaningful. This is difficult to determine without a statistical test.</p>
<p>Lets look at the data separately by gender:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="co">#Women:</span></a>
<a class="sourceLine" id="cb102-2" data-line-number="2">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb102-3" data-line-number="3"><span class="st">  </span><span class="kw">subset</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb102-4" data-line-number="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.70   Min.   :19.70   Min.   :21.00    
 1st Qu.:22.00     1st Qu.:21.20   1st Qu.:22.85   1st Qu.:24.40    
 Median :24.25     Median :23.90   Median :24.60   Median :26.10    
 Mean   :24.00     Mean   :23.59   Mean   :24.63   Mean   :26.38    
 3rd Qu.:25.50     3rd Qu.:25.40   3rd Qu.:25.60   3rd Qu.:28.00    
 Max.   :34.30     Max.   :34.10   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :20.40   Min.   :21.60   Length:200         Length:200        
 1st Qu.:23.70   1st Qu.:25.30   Class :character   Class :character  
 Median :26.20   Median :26.40   Mode  :character   Mode  :character  
 Mean   :25.98   Mean   :26.84                                        
 3rd Qu.:27.60   3rd Qu.:28.25                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :4       NA&#39;s   :1                                            </code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="co">#Men</span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="st">  </span><span class="kw">subset</span>(Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.50     Min.   :18.40   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.10     1st Qu.:20.80   1st Qu.:22.10   1st Qu.:23.30    
 Median :23.60     Median :23.20   Median :24.10   Median :26.20    
 Mean   :23.36     Mean   :23.01   Mean   :23.84   Mean   :25.61    
 3rd Qu.:25.00     3rd Qu.:24.90   3rd Qu.:25.10   3rd Qu.:27.10    
 Max.   :33.70     Max.   :32.60   Max.   :34.00   Max.   :34.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017   Country              Sex           
 Min.   :19.80   Min.   :21.5   Length:200         Length:200        
 1st Qu.:22.60   1st Qu.:23.8   Class :character   Class :character  
 Median :25.75   Median :26.3   Mode  :character   Mode  :character  
 Mean   :25.24   Mean   :25.9                                        
 3rd Qu.:27.00   3rd Qu.:27.2                                        
 Max.   :34.60   Max.   :34.2                                        
 NA&#39;s   :4       NA&#39;s   :1                                           </code></pre>
<p>It looks like mean BMIs have increased in all regions for both men and women. It is unclear though if this change is statistically significant.</p>
</div>
<div id="distributions" class="section level3">
<h3>Distributions</h3>
<p>In order to apply a statistical test to compare the means, one of the first things to do is to plot the frequency of the different possible values. This is called a <b>distribution</b>. See <a href="http://onlinestatbook.com/2/introduction/distributions.html">here</a> for more information about distributions. To plot the distribution of a dataset we can use the <code>hist()</code> function to create a histogram.</p>
<p>If the data were what we call <b>normally distributed</b> or followed a <b> Gaussian distribution </b> then the distribution should be equally centered around the mean and would look something like this:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">norm_BMI_ex_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">norm_data =</span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">24</span>))</a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="co"># The rnorm() function allows us to make a vector of normally distributed data</span></a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="co"># centered around the mean of 24</span></a>
<a class="sourceLine" id="cb106-4" data-line-number="4"><span class="kw">head</span>(norm_BMI_ex_data)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  norm_data
      &lt;dbl&gt;
1      22.9
2      24.5
3      23.9
4      22.8
5      23.7
6      26.3</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">hist</span>(norm_BMI_ex_data<span class="op">$</span>norm_data)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-60-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Alternatively we can plot this using the <code>geom_hist()</code> function of the <code>ggplot2</code> package. The <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package creates plots by using layers. Notice in the following code how there is a plus sign between the <code>ggplot()</code> function and the <code>geom_histogram()</code> function. With ggplot2 we select what data we would like to plot using the first function (<code>ggplot()</code>) and then we add on additional layers of complexity (these layers can even involve different data). In this case the <code>geom_histrogram()</code> function initiates the plotting of a histogram with the data that was identified in the <code>ggplot()</code> function. We will see later how we can add many layers to plots with <code>ggplot2</code>. For additional information on using ggplot2, see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html">case study</a>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">norm_BMI_ex_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> norm_data)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-61-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="co"># We are using the column called norm_data within norm_BMI_ex_data</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="co"># With ggplot2 we must first specify the data with ggplot() </span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="co"># The geom_histogram() function specifies what type of plot to create</span></a></code></pre></div>
<p>Let’s see how our data looks:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">BMI_long<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>OK, so the data looks like it is what we call <b>right-skewed</b> because the tail of the distribution is longer on the right side (in other words, it is a bit wider on that side), but it looks fairly normally distributed. See <a href="http://onlinestatbook.com/2/glossary/skew.html">here</a> for more information about skewed distributions.</p>
<p>If we parse our data, what does it look like? The easiest way to do this is to use some other functions of the <code>ggplot2</code> package, particularly the <code>facet_wrap()</code> function, which will allow us to look at differences in the distribution of the BMI data by year, gender, and region. We can sequentially divide our plots by deeper levels using multiple variables and the <code>+</code> plus sign within <code>facet_wrap()</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-63-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb113-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-63-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb114-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-63-3.png" width="90%" style="display: block; margin: auto;" /></p>
<p>OK, so some of these plots look pretty similar to our normal distribution plot, like the Women 2017 Urban plot (although it is right-skewed). However some of the other plots, like the Men 2017 Urban plot, look very different. These plots show what is called a <a href="http://onlinestatbook.com/2/introduction/distributions.html">bimodal distribution</a>, meaning that there appear to be two peaks, or in other words two different values (and values near each of these) that are the most frequent.</p>
</div>
<div id="quantile-quantile-plots" class="section level3">
<h3>Quantile-Quantile Plots</h3>
<p>Let’s use a method called the quantile-quantile plot to determine if the data is indeed normally distributed. These plots are called <b>Q-Q plots</b>. This method allows us to test the fit of known theoretical distributions (like the normal distribution) with our observed distribution. To do this we will plot the quantiles of our data on the y-axis and the quantiles of the theoretical normal distribution on the x-axis. If the quantiles line up then we can say that our data is fairly normal. What exactly is a <b>quantile</b>? This is a division of the data distribution into roughly equal portions. See <a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html">here</a> for more information about Q-Q plots.</p>
<p>Here is an example of a Q-Q plot for the normally distributed data that we just created using the <code>stat_qq()</code> function of the <code>ggplot2</code> package:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1">norm_BMI_ex_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb115-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>norm_data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb115-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-64-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we can see that the quantiles are fairly similar between the observed and theoretical data. We see that the points mostly fall on the line, however there are some points that are a bit further from the line as we get to the extreme quantiles. Notice that the sample quantiles (which will be fairly similar to our real BMI data quantiles) on the y-axis has the same range as the values that we created. So values that are bellow 22 for example are represented as the points bellow 22 on the y-axis. As expected we see that about half the points are bellow our mean of 24.</p>
<p>If we were to use different data that had a range of different values our y-axis would shift according to the range of values. For example the Orange data within the installation of R includes data about the circumference of orange trees in millimeters. Here we can see that the quantiles are quite different but reflect the range of orange tree circumferences.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="kw">range</span>(Orange<span class="op">$</span>circumference)</a></code></pre></div>
<pre><code>[1]  30 214</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">Orange<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>circumference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb118-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s take a look at our BMI data:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb119-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb119-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-66-1.png" width="90%" style="display: block; margin: auto;" /> This is a little hard to see, some plots look pretty good, but while others seem to be skewed, lets take a closer look.</p>
<p>For the sake of simplicity, we are going to focus on the data from the women. This is because women were identified in the paper to have larger increases in BMI. If we want to perform tests on these groups (women in each region and year) specifically, then we need to look at the distribution of each of these subsets.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb120-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb120-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that at the extremes of our quantiles, for most of our data, our tails are not very similar to the theoretical distribution. We can can also determine that our data is right- or positive-skewed because the extreme values are above the line that indicates a perfect match between the theoretical and observed data.</p>
<p>The rural data looks more normal than the urban data, but if we were to use statistical tests that rely on normality, this would require that both groups are normally distributed.</p>
<p>Finally, some statisticians also use the <a href="http://www.statistics4u.info/fundstat_eng/ee_shapiro_wilk_test.html">Shapiro-Wilk test for normality</a> when the Q-Q plot is a bit unclear. Many statisticians however would conclude from the Q-Q plots that normality appears to be violated in our data.</p>
</div>
<div id="shapiro-wilk-test" class="section level3">
<h3>Shapiro-Wilk test</h3>
<p>For illustrative purposes we will show how we can use the <code>dplyr</code> <code>summarize()</code> and <code>group_by()</code> functions to perform the Shapiro-Wilk test for all the subsets we are interested in.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">norm_BMI_ex_data<span class="op">$</span>norm_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="st">  </span><span class="kw">shapiro.test</span>() </a></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  .
W = 0.98914, p-value = 0.1334</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="co"># example of the test output for normal data - the p value is not &lt; 0.05</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2"></a>
<a class="sourceLine" id="cb123-3" data-line-number="3">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb123-6" data-line-number="6"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National  0.0000478  
2 1985  Rural     0.000679   
3 1985  Urban     0.000000332
4 2017  National  0.00363    
5 2017  Rural     0.0108     
6 2017  Urban     0.0000130  </code></pre>
<p>We see that all the data does not appear to be normally distributed.</p>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<p>We can use statistical tests like the <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">student t-test</a> to determine if <a href="http://onlinestatbook.com/2/estimation/difference_means.html">two means are significantly different</a>.</p>
<div id="hypothesis-testing" class="section level3">
<h3>Hypothesis testing</h3>
<p>With the t-test, we perform what is called <b> two means hypothesis tests </b>. We define what is called the <b> null hypothesis </b>, which is what we assume by default or the baseline, that there is no difference in the two means:</p>
<pre><code>                                    Ho: μ1 = μ2
                                    
                           μ1 is the true mean of one group
                           μ2 is the true mean of the other group
                           </code></pre>
<p>Thus like in law, we fail to reject the null this null hypothesis, unless we have enough evidence to suggest that we should reject it - similarly to the idea that we by default assume that individuals are not guilty until proven otherwise. If we reject the null hypothesis, we then accept an <b> alternative hypothesis </b>, this can vary for different statistical tests, but in the case of the t-test we evaluate if the two means are not equal:</p>
<pre><code>                                    Ha: μ1 ≠ μ2
                                    </code></pre>
<p>Remember that we can’t know the true mean for our populations of interest, instead we approximate or estimate our means based on the sample that we have in our data.</p>
<p>When we use a statistical test to evaluate hypotheses like these, we use what we call the p-value. The p-value is a measure of the strength of the evidence for our null hypothesis. It is common practice to consider a p-value &lt; 0.05 a strong enough evidence against the null hypothesis to reject it. Alternatively if the p-value &gt; 0.5 then there is not enough evidence to reject the null hypothesis. We will use the p-values from our statistical tests to decide how to interpret the results of our tests.</p>
<p>We are interested in comparing the means of female rural and urban BMI measurements for both years.</p>
<p>There are two possible classes of statistical tests that we could run to compare the means of these two groups:</p>
<ol style="list-style-type: decimal">
<li>Parametric</li>
<li>Nonparametric</li>
</ol>
<p>Parametric tests are based on assumptions about the distribution of the data, while Nonparametric tests do not rely on this assumption. It is called “parametric” because aspects about the distribution of the data like the mean are called <b>parameters</b> when we describe a population. In parametric tests we estimate the parameters of the true population of interest using a sample of that population. These estimates are called <b>statistics</b>. See <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960">here</a> for more information about the difference between these two classes of tests.</p>
</div>
<div id="parametric-two-sample-mean-tests" class="section level3">
<h3>Parametric two sample mean tests</h3>
<p>Often when comparing two groups we might perform a two sample t-test to determine if the means of each group is different. The two sample t-test however, relies on several <u><b>assumptions</b></u>:</p>
<ol style="list-style-type: decimal">
<li>The data for both groups is <a href="http://onlinestatbook.com/2/introduction/distributions.html">normally distributed</a></li>
<li>The <a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance">variance</a> of both groups is similar</li>
<li>The number of observations is similar for both groups - thus they are <a href="https://www.statisticshowto.datasciencecentral.com/balanced-and-unbalanced-designs/">balanced</a></li>
<li>The observations are <a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf">independent</a> (meaning that observations do not influence each other)</li>
</ol>
<p>If these assumptions are violated, this doesn’t necessarily mean we can’t perform a t-test. It just means we may need to consider the following options:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/">Transformation</a> of the data to make it more normally distributed</li>
<li><a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/">Welch’s t-test</a> also call the unequal variance t-test we may need to modify the way we perform the <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">t-test</a> to account for the difference in the variance in the two groups</li>
<li><a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html">Permutation/resampling methods</a> to deal with violations of normality or imbalance.</li>
</ol>
<p>Alternatively, we can use a nonparametric test which is model free and does not rely on assumptions about the parameters of the data. These tests are often a good option when multiple assumptions are violated are when sample sizes are small. We will explore these options.</p>
<p>Our data has a balance of observations for both groups - in fact they are equal, thus that assumption is not violated. If it were violated, we would want to consider using permutation methods which are also a good option for violations of normality. To learn more about these methods see <a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html">here</a>.</p>
<p>If we needed to check if our samples were imbalanced, we could use the <code>table()</code> function:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">table</span>(BMI_long<span class="op">$</span>Sex, BMI_long<span class="op">$</span>Region, BMI_long<span class="op">$</span>Year)</a></code></pre></div>
<pre><code>, ,  = 1985

       
        National Rural Urban
  Men        200   200   200
  Women      200   200   200

, ,  = 2017

       
        National Rural Urban
  Men        200   200   200
  Women      200   200   200</code></pre>
<p>We can see that the number of observations for each possible group of interest is the same.</p>
<p>The t-test is also fairly robust to non-normality if the data is relatively large, due to what is called the <a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/">central limit theorem</a>, which states that as samples get larger, they approximate a normal distribution.</p>
<p>We have an n of 200, which should be sufficient but let’s investigate the nonparametric tests further.</p>
<p>Often we would check if the variance of the rural and urban data is equal using the <code>var.test()</code> function. However this is an F test and assumes that the data is normally distributed. Instead we will use the <code>mood.test()</code> function which performs the <a href="https://files.eric.ed.gov/fulltext/ED065559.pdf">Mood’s two-sample test for a difference in scale parameters</a> and does not assume that the data is normally distributed. We will also introduce the <code>pull()</code> function of the <code>dplyr</code> package.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="co">#pull() will allow us to take the BMI column after we filter BMI_long</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"></a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="kw">mood.test</span>(dplyr<span class="op">::</span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb129-4" data-line-number="4">                             Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb129-5" data-line-number="5">                             Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb129-6" data-line-number="6">                             Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb129-7" data-line-number="7">          dplyr<span class="op">::</span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long,</a>
<a class="sourceLine" id="cb129-8" data-line-number="8">                             Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb129-9" data-line-number="9">                             Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb129-10" data-line-number="10">                             Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  dplyr::pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;,  and dplyr::pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;,     Region == &quot;Rural&quot;), BMI) and     Region == &quot;Urban&quot;), BMI)
Z = 2.9189, p-value = 0.003513
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="co"># p value &lt;.05, conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb131-2" data-line-number="2"><span class="co"># reject the null: no difference in the spread of the distributions</span></a>
<a class="sourceLine" id="cb131-3" data-line-number="3"></a>
<a class="sourceLine" id="cb131-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb131-5" data-line-number="5">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb131-6" data-line-number="6">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb131-7" data-line-number="7">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb131-8" data-line-number="8">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb131-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb131-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
Z = 3.1305, p-value = 0.001745
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="co"># p value &lt;.05, conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb133-2" data-line-number="2"><span class="co"># reject the null: no difference in the variance of the distributions</span></a>
<a class="sourceLine" id="cb133-3" data-line-number="3"></a>
<a class="sourceLine" id="cb133-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb133-5" data-line-number="5">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb133-6" data-line-number="6">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb133-7" data-line-number="7">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb133-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb133-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb133-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
Z = -0.24228, p-value = 0.8086
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1"><span class="co"># p value &gt;.05, conclude that variance is equal</span></a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="co"># fail to reject the null the null: no difference in the variance of the distributions</span></a>
<a class="sourceLine" id="cb135-3" data-line-number="3"></a>
<a class="sourceLine" id="cb135-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb135-5" data-line-number="5">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb135-6" data-line-number="6">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb135-7" data-line-number="7">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb135-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb135-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb135-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
Z = 1.5317, p-value = 0.1256
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1"><span class="co"># p value &gt;.05, conclude that variance is equal</span></a>
<a class="sourceLine" id="cb137-2" data-line-number="2"><span class="co"># fail to reject the null the null: no difference in the variance of the distributions</span></a></code></pre></div>
<p>Our p value is less than .05 for both tests, thus we reject our null hypothesis that there is no difference in the variance. Therefore, we conclude that the variance is not equal and that our data also violates this assumption.</p>
<p>We will perform a special t.test where we account for the fact that our variance is not equal.</p>
<p>Another important consideration is that the data is what we call <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/">paired</a>, meaning that the measurements from the rural and urban areas are not independent. That is because we have a rural and urban measurement mean for nearly every country. Thus these values may be more similar to one another if they come from the same country. This is also true for the male and female measurements from the same country or the values in the same countries from 1985 and later in 2017. However, we are assuming that measurements between different countries are independent, thus this assumption is not violated, making it reasonable to perform the Welch’s or paired t-test.</p>
<p>When we perform a paired t-test our hypothesis is slightly different from the typical student’s t-test. In this case we are testing the differences among the pairs of observations and how close these differences are to zero. Our null hypothesis is that the mean of the differences is equal to zero:</p>
<pre><code>                                    Ho: μd = 0
                                    
                           μd is the true mean differences 
                           between paired observations of the two groups</code></pre>
<p>The alternative hypothesis is that the mean of the differences is not equal to zero</p>
<pre><code>                                    Ha: μd ≠ 0
                                    
                           μd is the true mean differences 
                           between paired observations of the two groups</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb140-2" data-line-number="2">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb140-3" data-line-number="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb140-4" data-line-number="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb140-5" data-line-number="5">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb140-6" data-line-number="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb140-7" data-line-number="7">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -10.356, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.0573625 -0.7190478
sample estimates:
mean of the differences 
             -0.8882051 </code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"></a>
<a class="sourceLine" id="cb142-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb142-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>,</a>
<a class="sourceLine" id="cb142-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb142-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb142-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb142-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb142-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -14.095, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.1870263 -0.8956268
sample estimates:
mean of the differences 
              -1.041327 </code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb144-2" data-line-number="2"></a>
<a class="sourceLine" id="cb144-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb144-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb144-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb144-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb144-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb144-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb144-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
t = -22.119, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.591762 -2.167422
sample estimates:
mean of the differences 
              -2.379592 </code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb146-2" data-line-number="2"></a>
<a class="sourceLine" id="cb146-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb146-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb146-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb146-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb146-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb146-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb146-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -24.378, df = 198, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.383938 -2.027118
sample estimates:
mean of the differences 
              -2.205528 </code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="co"># the t value shows us that the directionality of the difference</span></a>
<a class="sourceLine" id="cb148-3" data-line-number="3"><span class="co"># the t value was negative thus BMI was lower in 1985 (1st group) </span></a>
<a class="sourceLine" id="cb148-4" data-line-number="4"><span class="co"># compared to 2017 (2nd group)</span></a></code></pre></div>
<div id="section-9" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Looking at the t value, was global BMI lower in Rural or Urban areas in 1985?</p>
</div>
<div id="section-10" class="section level4">
<h4></h4>
<p>Now we will try transform our data to make it more normally distributed. One way to do this is to take the logarithm of the data values. Then we will see how this influences the results. Again we will focus on the data for women.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1"><span class="co"># create a new column with the log version of the BMI variable using mutate()</span></a>
<a class="sourceLine" id="cb149-2" data-line-number="2"></a>
<a class="sourceLine" id="cb149-3" data-line-number="3">BMI_long_log &lt;-<span class="st"> </span><span class="kw">mutate</span>(BMI_long, <span class="dt">log_BMI=</span><span class="kw">log</span>(<span class="kw">pull</span>(BMI_long,BMI)))</a>
<a class="sourceLine" id="cb149-4" data-line-number="4"></a>
<a class="sourceLine" id="cb149-5" data-line-number="5">BMI_long_log <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb149-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb149-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>log_BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb149-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb149-9" data-line-number="9"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb149-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">BMI_long_log <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(log_BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National     0.00315 
2 1985  Rural        0.0105  
3 1985  Urban        0.000334
4 2017  National     0.293   
5 2017  Rural        0.0784  
6 2017  Urban        0.00416 </code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="co"># recall what it was before</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National  0.0000478  
2 1985  Rural     0.000679   
3 1985  Urban     0.000000332
4 2017  National  0.00363    
5 2017  Rural     0.0108     
6 2017  Urban     0.0000130  </code></pre>
<p>The data appears to be more similar to the normal distribution, although not quite. Again, our sample size of 200 is quite large and the t-test is generally quite robust to violations of normality with large n, thus the modified t-test to account for unequal variance might be a good option using the log normalized data, as it is at least more normally distributed.</p>
<p>Let’s see the results of the t-test with the transformed data:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb154-2" data-line-number="2">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb154-3" data-line-number="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb154-4" data-line-number="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb154-5" data-line-number="5">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb154-6" data-line-number="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb154-7" data-line-number="7">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -10.058, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.04242774 -0.02851589
sample estimates:
mean of the differences 
            -0.03547182 </code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb156-2" data-line-number="2"></a>
<a class="sourceLine" id="cb156-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb156-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb156-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb156-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb156-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb156-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb156-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -13.962, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.05214677 -0.03923811
sample estimates:
mean of the differences 
            -0.04569244 </code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2"></a>
<a class="sourceLine" id="cb158-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb158-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb158-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb158-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb158-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb158-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb158-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Rural&quot;), log_BMI)
t = -22.369, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.10617051 -0.08896626
sample estimates:
mean of the differences 
            -0.09756839 </code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2"></a>
<a class="sourceLine" id="cb160-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb160-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb160-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb160-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb160-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb160-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb160-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -23.977, df = 198, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.09377834 -0.07952498
sample estimates:
mean of the differences 
            -0.08665166 </code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a></code></pre></div>
<p>We can see that our results are quite similar to that of the original data, however the t values are slightly smaller. In other cases we may see a much more dramatic influence of transforming our data.</p>
<p>Now, let’s take a look at nonparametric tests, which are also a great option when the assumptions of the t-test are violated.</p>
</div>
</div>
<div id="nonparametric-two-sample-tests" class="section level3">
<h3>Nonparametric two sample tests</h3>
<p>There are multiple nonparametric options to consider when the assumptions of the [t-test] are violated. The <a href="http://www.biostathandbook.com/wilcoxonsignedrank.html">Wilcoxon signed rank test</a> (for paired data - the alternative is <a href="http://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/BS704_Nonparametric4.html">Wilcoxon rank sum test</a> (also called the Mann-Whitney U test) for independent samples) and the <a href="https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/ks2samp.htm">two-sample Kolmogorov-Smirnov test</a> (KS) both do not assume normality (has both paired and unpaired methods). Thus these tests should be considered when the data of either groups does not appear to be normally distributed and particularly when the number of samples is low.</p>
<p>Importantly the KS test does not assume normality or equal variance, while the Wilcoxon signed rank test does assume equal variance. Here is how you would perform these tests. However in our case, because the variance is not equal between some of our groups of interest, the KS test would be more appropriate. Both the t-test and the KS test evaluate if the distributions of the two groups are identical, however the KS test does not particularly test any aspect of the distribution like the mean, therefore there are no confidence intervals in the output using this test.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb163-2" data-line-number="2">                    Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb163-3" data-line-number="3">                    Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb163-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb163-5" data-line-number="5">                    Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb163-6" data-line-number="6">                    Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb163-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
D = 0.20006, p-value = 0.0007385
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb165-2" data-line-number="2">                    Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb165-3" data-line-number="3">                    Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb165-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb165-5" data-line-number="5">                    Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb165-6" data-line-number="6">                    Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb165-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
D = 0.19914, p-value = 0.0007779
alternative hypothesis: two-sided</code></pre>
<p>What about the difference in female BMI from 1985 to 2017 for both regions? Recall that the variance was equal for these comparisons.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb167-2" data-line-number="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb167-3" data-line-number="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb167-4" data-line-number="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb167-5" data-line-number="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb167-6" data-line-number="6">                       Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb167-7" data-line-number="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
V = 273, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb169-2" data-line-number="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb169-3" data-line-number="3">                        Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb169-4" data-line-number="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb169-5" data-line-number="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb169-6" data-line-number="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb169-7" data-line-number="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 189, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>There is a significant difference across time for both regions, as we saw with the t-test. There is also a significant difference by region for each year. However, the p-values are a bit larger for the KS test results than we saw with the t-test.</p>
</div>
<div id="multiple-testing-correction" class="section level3">
<h3>Multiple Testing Correction</h3>
<p>Let’s take a look back at the questions we wanted to answer: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
<p>It’s important to note that ultimately we wanted to test 4 different tests to answer question 1 and 2:</p>
<ol style="list-style-type: decimal">
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 1985?</li>
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 2017?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Rural areas?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Urban areas?</li>
</ol>
<p>When we test multiple questions like this, we need to correct for the multiple tests that we are performing.</p>
<p>The more we test data, the more likely we are to see a significant finding just by <a href="https://www.stat.berkeley.edu/~mgoldman/Section0402.pdf">random chance</a> even when the finding is in fact not real. It all comes down to probability.</p>
<div id="probability" class="section level4">
<h4>Probability</h4>
<p>You may recall that probability is the chance that an event will happen and it ranges from 0 to 1. You can also think of it as a percentage of 0% (probability =0) to 100% (probability = 1) of chance that an event will happen.</p>
<p><img src="https://www.mathsisfun.com/data/images/probability-line.svg" /> <a href="https://www.mathsisfun.com/data/images/probability-line.svg" class="uri">https://www.mathsisfun.com/data/images/probability-line.svg</a></p>
<p>If we consider flipping a coin, the probability of an event happening (heads) is always equal to 1 ( or 100% chance) minus the probability of the event not happening (tails instead of heads) because the total probability can not exceed 100%.</p>
<pre><code>    probability of 1 (100% chance) = the probabilty of heads (50% chance)
                                     + the probability of tails (50% chance)
                                   
                                 1 = P(heads) + P(tails)
        probability of one outcome = 1 - the probability of the other outcome
                          P(heads) = 1 - P(tails) 
                                    or
                          P(tails) = 1 - P(heads)</code></pre>
<p>If we think about the probability of getting significant or nonsignificant results we can think of it like this:</p>
<pre><code>                                 1 = P(signifiant results) 
                                      + P(no significant results)
            P(significant results) = 1 - P(no significant results)</code></pre>
</div>
</div>
<div id="alpha" class="section level3">
<h3>Alpha</h3>
<p>Alpha is the amount of risk that you are willing to accept that a statistical test result is actually a false positive, in other words we reject the null hypothesis when the null hypothesis is true. This is also called <a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html">type 1 error</a>. A significance threshold of .05 is customary and it means that we are accepting a 5% chance that our result is actually a false positive.</p>
<pre><code>                             alpha = probability of false significant results 
                                       or
                                 α = P(Making a type 1 error)
                                        </code></pre>
<p>Remember that in our statistical tests if the p-value &lt; alpha it is considered significant and if p-value &gt; alpha it is considered not significant</p>
<p>But what really is the <a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8">p-value</a>?</p>
</div>
<div id="p-values" class="section level3">
<h3>p-values</h3>
<p>The p in p-value stands for <b>probability</b> - the probability that we would obtain the statistics (for example the t in our student t-tests based on the means of our groups of comparison) just by random chance alone. Therefore a p-value of 0.02 means that there is a 2 percent chance that out data may look the way it does just because of random chance and not because there is really a difference in the means of the groups of interest.</p>
<p>So then if alpha is the threshold for the p-value for obtaining false significant results then the probability of not making incorrect conclusions is 1 - alpha:</p>
<pre><code>             P(Not making an error) = 1 - α</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="co">#P(Not making an error) = 1 - α</span></a>
<a class="sourceLine" id="cb175-2" data-line-number="2"><span class="dv">1</span><span class="fl">-.05</span> </a></code></pre></div>
<pre><code>[1] 0.95</code></pre>
<p>OK so if we use an alpha of .05 we are accepting that 95% of the time we will not make a Type 1 error and 5 % of the time we will just by random chance.<br />
Taking this one step further:</p>
<pre><code>                 P(Making an error) = 1 - P(Not making an error)
                 P(Making an error) = 1 - (1 - α)
                              </code></pre>
<p>Here we can see that this checks out:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="co">#P(Making an error) = 1 - (1 - α)</span></a>
<a class="sourceLine" id="cb178-2" data-line-number="2"><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="fl">-.05</span>)</a></code></pre></div>
<pre><code>[1] 0.05</code></pre>
<p>So what happens if we perform multiple tests?</p>
<p>The probability of not making a type 1 error would remain the same for each test. Therefore we need to multiply the probabilities together each time to determine the over all probability of making an error across multiple tests. See <a href="http://mathforum.org/library/drmath/view/74065.html">here</a> about why we multiply probabilities together.</p>
<pre><code>    P(Not making an error in m tests) = (1 - α)^m
P(Making at least 1 error in m tests) = 1 - (1 - α)^m</code></pre>
<p>Let’s consider if we performed 10 different statistical tests and if we as usual considered the significance threshold alpha of .05:</p>
<p>So the probability of getting 1 significant result with 10 tests is:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - ((1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α))</span></a>
<a class="sourceLine" id="cb181-2" data-line-number="2"><span class="co">#this is the same as:</span></a>
<a class="sourceLine" id="cb181-3" data-line-number="3"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - (1 - α)^10</span></a>
<a class="sourceLine" id="cb181-4" data-line-number="4"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">10</span></a></code></pre></div>
<pre><code>[1] 0.4012631</code></pre>
<p>So there is a 40% chance that that there will be a significant finding simply due to random chance alone.</p>
<p>What about 100 tests?</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="co">#P(Making at least 1 error in 100 tests) = 1 - (1 - α)^100</span></a>
<a class="sourceLine" id="cb183-2" data-line-number="2"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">100</span></a></code></pre></div>
<pre><code>[1] 0.9940795</code></pre>
<p>Yikes!! That is almost a 100% chance that there will be a significant finding simply due to chance alone!</p>
<p>Much of this explanation is described in this <a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf">lecture</a></p>
<p>One way to correct for this is multiple testing issue is using the <a href="http://mathworld.wolfram.com/BonferroniCorrection.html">Bonferroni method</a>.</p>
<p>In this method we would divide our significance threshold (generally 0.05) by the number of tests.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">4</span> <span class="co"># 4 tests</span></a></code></pre></div>
<pre><code>[1] 0.0125</code></pre>
<p>Our new significance threshold is now 0.0125. Thus our p-values should be less than this value for us to reject the null that there is no difference in means. In all cases, our p-values were less than 0.0125. So we see a significant difference in the means of the groups after multiple testing correction for our different tests.</p>
<p>Again, it would be reasonable to use the t-test because it is robust to deviations in normality when samples are relatively large. We can see that we obtained the same results regardless of the test that we used. However, if sample sizes are small (generally speaking n&lt;15 for each group), then these nonparametric options are useful to know.</p>
<p>The D values in the output of our KS tests, show the magnitude of distance in the difference between the distributions of the groups tested. You may notice that the D value is larger for the tests of BMI across time rather then across region. In these tests the p-value was also smaller.</p>
</div>
</div>
<div id="data-visualization" class="section level2">
<h2>Data Visualization</h2>
<p>Again we will utilize <code>ggplot2</code> to create plots to look at the directional and magnitude of the differences in BMI we are interested in. If you need additional information please see <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html">here</a>. The top two lines of the code for the following plots, filter the data to only specific values of interest. Then we layer what is called a jitter on top of a box plot. A jitter is essentially a dot plot but with some variation on the location of the points so that they do not line up vertically which can make the individual points difficult to see.</p>
<p>Our first main question was: Is there a difference between rural and urban BMI estimates around the world? Let’s look at the national mean BMI estimates for each of the years:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb187-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb187-3" data-line-number="3">         Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb187-4" data-line-number="4">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb187-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb187-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb187-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-81-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1"><span class="co"># the width determines how wide the points are plotted</span></a>
<a class="sourceLine" id="cb188-2" data-line-number="2"></a>
<a class="sourceLine" id="cb188-3" data-line-number="3">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb188-5" data-line-number="5">         Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb188-6" data-line-number="6">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb188-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb188-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb188-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-81-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Our 2nd main question was: How have BMI estimates changed from 1985 to 2017? Let’s look at the change in rural and urban mean BMI estimates over time:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co">#this time we will add titles for Rural and Urban using ggtitle()</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb189-4" data-line-number="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb189-5" data-line-number="5">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb189-6" data-line-number="6"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb189-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb189-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb189-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb189-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Rural&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-82-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb190-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb190-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb190-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb190-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb190-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb190-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Urban&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-82-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s put the plots together to see how the change over the years differs between the regions. We will use again use <code>facet_wrap()</code> to do this:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb191-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb191-4" data-line-number="4">         Region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Urban&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-5" data-line-number="5"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb191-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="co"># we would also get national data without `Region %in% c(&quot;Rural&quot;, &quot;Urban&quot;))`</span></a></code></pre></div>
<p>Indeed the change in BMI over time looks bigger in the rural areas!</p>
<p>One third main questions was: How do the different countries compare? Or in other words what do the individual dots represent in our box plots? We will take a look using <code>geom_label()</code>:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb193-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb193-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb193-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb193-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb193-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb193-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we include all country names this is a bit too much… so perhaps we should focus on just the extreme BMI values using <code>filter()</code> function of the<code>dplyr</code> package. We will also use the <code>ggrepel</code> package to have our labels not overlap each other.</p>
<p>Part of the third question was: How does the United States of America compare? So let’s label the data points for the United states.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb194-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb194-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb194-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-8" data-line-number="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb194-9" data-line-number="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb194-10" data-line-number="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb194-11" data-line-number="11"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb194-12" data-line-number="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb194-13" data-line-number="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb194-14" data-line-number="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb194-15" data-line-number="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb194-16" data-line-number="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb194-17" data-line-number="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb194-18" data-line-number="18"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb194-19" data-line-number="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And let’s fill the box plots with color and outline in black:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb195-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb195-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb195-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> Year)) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-8" data-line-number="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb195-9" data-line-number="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb195-10" data-line-number="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb195-11" data-line-number="11"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb195-12" data-line-number="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb195-13" data-line-number="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-14" data-line-number="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-15" data-line-number="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb195-16" data-line-number="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb195-17" data-line-number="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb195-18" data-line-number="18"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb195-19" data-line-number="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="overall-differences" class="section level3">
<h3>Overall differences</h3>
<p>Let’s take a look at all the data together, including the data for men:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Region)) <span class="op">+</span></a>
<a class="sourceLine" id="cb196-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Region)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb196-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex)   </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>That’s useful, but let’s look at the individual points and include our country labels, to do so lets change our United States of America label to USA:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1">BMI_long<span class="op">$</span>Country &lt;-BMI_long<span class="op">$</span>Country <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb197-3" data-line-number="3"></a>
<a class="sourceLine" id="cb197-4" data-line-number="4"></a>
<a class="sourceLine" id="cb197-5" data-line-number="5"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Year)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Year)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Region) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-9" data-line-number="9"><span class="st">  </span><span class="co"># This will add a horizontal dashed line to indicate the obesity BMI threshold</span></a>
<a class="sourceLine" id="cb197-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long), </a>
<a class="sourceLine" id="cb197-11" data-line-number="11">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb197-12" data-line-number="12">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-13" data-line-number="13"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb197-14" data-line-number="14"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb197-15" data-line-number="15"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb197-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb197-17" data-line-number="17">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb197-18" data-line-number="18">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-19" data-line-number="19"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb197-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb197-21" data-line-number="21">            <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb197-22" data-line-number="22">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb197-23" data-line-number="23"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb197-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb197-25" data-line-number="25">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb197-26" data-line-number="26">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb197-27" data-line-number="27">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb197-28" data-line-number="28">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb197-29" data-line-number="29">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb197-30" data-line-number="30">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb197-31" data-line-number="31">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb197-32" data-line-number="32"><span class="st">  </span><span class="co"># This changes the size of x axis labels for the facet </span></a>
<a class="sourceLine" id="cb197-33" data-line-number="33"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Differences in BMI Over Time and Across Region Type and Gender&quot;</span>) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1">  <span class="co"># Add a  plot title</span></a></code></pre></div>
<p>Here we can see that overall BMI appears to be increasing globally over time. Additionally we can see that this is occurring not just in urban areas, but also in rural areas. The US is consistently above the median in all strata of the data. In general, the female data shows higher BMI values than the male data. The rural USA BMI appears to be higher than the urban BMI for both men and women. Many countries have average BMI estimates above the obesity threshold of 30. Thus it appears that education and outreach programs for weight management should focus on both rural and urban areas and both genders. Education and assistance for women may be especially helpful.</p>
</div>
<div id="differences-in-rate-of-change" class="section level3">
<h3>Differences in rate of change</h3>
<p>How does the rate of change in BMI differ between groups? Which group might especially need attention?</p>
<p>First let’s calculate the differences in BMI from 2017 and 1985 and add this to our BMI_long data object:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1">BMI_numeric<span class="op">$</span>Rural_difference &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2"><span class="st">     </span>BMI_numeric<span class="op">$</span>Rural_BMI_<span class="dv">2017</span> <span class="op">-</span><span class="st"> </span>BMI_numeric<span class="op">$</span>Rural_BMI_<span class="dv">1985</span></a>
<a class="sourceLine" id="cb199-3" data-line-number="3"></a>
<a class="sourceLine" id="cb199-4" data-line-number="4">BMI_numeric<span class="op">$</span>Urban_difference &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb199-5" data-line-number="5"><span class="st">     </span>BMI_numeric<span class="op">$</span>Urban_BMI_<span class="dv">2017</span> <span class="op">-</span><span class="st"> </span>BMI_numeric<span class="op">$</span>Urban_BMI_<span class="dv">1985</span></a>
<a class="sourceLine" id="cb199-6" data-line-number="6"></a>
<a class="sourceLine" id="cb199-7" data-line-number="7">BMI_numeric<span class="op">$</span>National_difference &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb199-8" data-line-number="8"><span class="st">     </span>BMI_numeric<span class="op">$</span>National_BMI_<span class="dv">2017</span> <span class="op">-</span><span class="st"> </span>BMI_numeric<span class="op">$</span>National_BMI_<span class="dv">1985</span></a>
<a class="sourceLine" id="cb199-9" data-line-number="9"></a>
<a class="sourceLine" id="cb199-10" data-line-number="10">BMI_diff_long &lt;-<span class="st"> </span>BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb199-11" data-line-number="11"><span class="st">  </span><span class="kw">select</span>(Country<span class="op">:</span><span class="st"> </span>National_difference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb199-12" data-line-number="12"><span class="kw">gather</span>(<span class="dt">key =</span> Type, <span class="dt">value =</span> Difference , Rural_difference<span class="op">:</span>National_difference)</a>
<a class="sourceLine" id="cb199-13" data-line-number="13"></a>
<a class="sourceLine" id="cb199-14" data-line-number="14"><span class="kw">head</span>(BMI_diff_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Type             Difference
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;
1 Afghanistan Men   Rural_difference     2.8   
2 Afghanistan Women Rural_difference     3.5   
3 Albania     Men   Rural_difference     1.90  
4 Albania     Women Rural_difference     0.1000
5 Algeria     Men   Rural_difference     3     
6 Algeria     Women Rural_difference     3.70  </code></pre>
<p>Let’s replace “United states of America” with “USA” and make a plot with this data to compare the change in BMI:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1">BMI_diff_long<span class="op">$</span>Country &lt;-BMI_diff_long<span class="op">$</span>Country <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb201-2" data-line-number="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb201-3" data-line-number="3"></a>
<a class="sourceLine" id="cb201-4" data-line-number="4"></a>
<a class="sourceLine" id="cb201-5" data-line-number="5"><span class="kw">ggplot</span>(BMI_diff_long, <span class="kw">aes</span>(<span class="dt">x =</span> Type, <span class="dt">y =</span> Difference, <span class="dt">col =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb201-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long), </a>
<a class="sourceLine" id="cb201-9" data-line-number="9">              <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb201-10" data-line-number="10">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-11" data-line-number="11"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb201-12" data-line-number="12"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb201-13" data-line-number="13"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb201-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb201-15" data-line-number="15">              <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb201-16" data-line-number="16">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-17" data-line-number="17"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb201-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb201-19" data-line-number="19">            <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference,<span class="dt">label=</span>Country), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb201-20" data-line-number="20"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb201-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb201-22" data-line-number="22">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb201-23" data-line-number="23">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb201-24" data-line-number="24">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb201-25" data-line-number="25">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb201-26" data-line-number="26">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb201-27" data-line-number="27">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb201-28" data-line-number="28">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb201-29" data-line-number="29"><span class="st">        </span><span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb201-30" data-line-number="30"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Change in BMI Over Time and Across Region Type and Gender&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-90-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">        <span class="co"># Add a plot title  </span></a></code></pre></div>
<p>We can now see that the rate of change from 1985 to 2017 appears to be larger in the women compared to the men in all regions. The group with the largest increase in the USA is the women living in rural areas.</p>
<p>Let’s check the difference with some statistical tests:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="co">#first lets look at the normality of the difference in BMI</span></a>
<a class="sourceLine" id="cb203-2" data-line-number="2">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb203-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb203-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb203-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Type)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="co"># interesting...the spread of difference is much broader for women than for men </span></a>
<a class="sourceLine" id="cb204-2" data-line-number="2"><span class="co"># some women in some countries especially need help with obesity</span></a>
<a class="sourceLine" id="cb204-3" data-line-number="3"><span class="co"># while other countries are actually showing a loss of BMI</span></a>
<a class="sourceLine" id="cb204-4" data-line-number="4"><span class="co"># these countries are the points on our previous plot with a difference below 0</span></a>
<a class="sourceLine" id="cb204-5" data-line-number="5"></a>
<a class="sourceLine" id="cb204-6" data-line-number="6"><span class="co">#Let&#39;s see who:</span></a>
<a class="sourceLine" id="cb204-7" data-line-number="7">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(Difference)</a></code></pre></div>
<pre><code># A tibble: 1,200 x 4
   Country        Sex   Type                Difference
   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
 1 Greece         Women Rural_difference        -1.5  
 2 Greece         Women National_difference     -1.3  
 3 Greece         Women Urban_difference        -1.20 
 4 Italy          Women Rural_difference        -1.10 
 5 Czech Republic Women Rural_difference        -0.8  
 6 Spain          Women Rural_difference        -0.800
 7 Lithuania      Women Urban_difference        -0.700
 8 Spain          Women Urban_difference        -0.700
 9 Lithuania      Women National_difference     -0.700
10 Spain          Women National_difference     -0.700
# … with 1,190 more rows</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="co"># In general, people appear to have lost weight in Greece</span></a>
<a class="sourceLine" id="cb206-2" data-line-number="2"></a>
<a class="sourceLine" id="cb206-3" data-line-number="3"><span class="co"># Let&#39;s look at Q-Q plots:</span></a>
<a class="sourceLine" id="cb206-4" data-line-number="4">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb206-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>Difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb206-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb206-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Type)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="co"># ok so some of the data for Men looks fairly normal but not as much for Women</span></a>
<a class="sourceLine" id="cb207-2" data-line-number="2"></a>
<a class="sourceLine" id="cb207-3" data-line-number="3"><span class="co"># Now we will check the variance</span></a>
<a class="sourceLine" id="cb207-4" data-line-number="4"></a>
<a class="sourceLine" id="cb207-5" data-line-number="5"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb207-6" data-line-number="6">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb207-7" data-line-number="7">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb207-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb207-9" data-line-number="9">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb207-10" data-line-number="10">                      Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
Z = 3.5379, p-value = 0.0004033
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb209-2" data-line-number="2"></a>
<a class="sourceLine" id="cb209-3" data-line-number="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb209-4" data-line-number="4">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb209-5" data-line-number="5">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb209-6" data-line-number="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb209-7" data-line-number="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb209-8" data-line-number="8">                      Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
Z = 0.59121, p-value = 0.5544
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="co">#fail to reject the null the null - conclude that variance is equal</span></a>
<a class="sourceLine" id="cb211-2" data-line-number="2"></a>
<a class="sourceLine" id="cb211-3" data-line-number="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb211-4" data-line-number="4">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb211-5" data-line-number="5">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb211-6" data-line-number="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb211-7" data-line-number="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb211-8" data-line-number="8">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),     Difference) and     Difference)
Z = 10.843, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb213-2" data-line-number="2"></a>
<a class="sourceLine" id="cb213-3" data-line-number="3"></a>
<a class="sourceLine" id="cb213-4" data-line-number="4"><span class="co"># let&#39;s compare the groups</span></a>
<a class="sourceLine" id="cb213-5" data-line-number="5"><span class="co"># this is again still paired data</span></a>
<a class="sourceLine" id="cb213-6" data-line-number="6"><span class="co"># this is because each value of &quot;Rural_difference&quot; and &quot;Urban_difference&quot; correspond to the same country</span></a>
<a class="sourceLine" id="cb213-7" data-line-number="7"></a>
<a class="sourceLine" id="cb213-8" data-line-number="8"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb213-9" data-line-number="9">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb213-10" data-line-number="10">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb213-11" data-line-number="11">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb213-12" data-line-number="12">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb213-13" data-line-number="13">                    Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb213-14" data-line-number="14">        <span class="dt">paired =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
D = 0.16534, p-value = 0.009043
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb215-2" data-line-number="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>,</a>
<a class="sourceLine" id="cb215-3" data-line-number="3">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb215-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb215-5" data-line-number="5">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb215-6" data-line-number="6">                    Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb215-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
D = 0.14586, p-value = 0.02995
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb217-2" data-line-number="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb217-3" data-line-number="3">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb217-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb217-5" data-line-number="5">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb217-6" data-line-number="6">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb217-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),     Difference) and     Difference)
D = 0.35204, p-value = 5.645e-11
alternative hypothesis: two-sided</code></pre>
<p>Now we have performed seven comparisons (4 earlier) so we should apply our multiple testing correction</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">7</span></a></code></pre></div>
<pre><code>[1] 0.007142857</code></pre>
<p>We see that there is a significant difference in the change in BMI Rural communities between men and women. This change is larger for women.</p>
<p>Importantly- we noticed that it appears to be specific countries where BMI shows a particular increase especially for women. Which countries are those? how does that compare with the US? Clearly the US is among the countries with the highest differences.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb221-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Type                Difference
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 USA     Men   Rural_difference          3.10
2 USA     Women Rural_difference          3.5 
3 USA     Men   Urban_difference          3.1 
4 USA     Women Urban_difference          3.40
5 USA     Men   National_difference       3.10
6 USA     Women National_difference       3.4 </code></pre>
<p>In the US, focus should be placed on <b> both urban and rural </b> women to improve this public health issue.</p>
<p>Here we can see the countries have the largest differences in BMI from 1985-2017:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Difference<span class="op">&gt;</span><span class="fl">4.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>Difference)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Type                Difference
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Egypt       Women Rural_difference          5.9 
2 Honduras    Women National_difference       5.60
3 Honduras    Women Rural_difference          5.5 
4 Egypt       Women National_difference       5.10
5 Saint Lucia Women Rural_difference          5   
6 Honduras    Women Urban_difference          4.9 </code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="co">#here we sorted by the highest to lowest values of BMI Difference</span></a></code></pre></div>
<p>However it is important to see what the mean BMI values are were for these countries in 2017. It could be that the average was underweight in 1985… let’s take a look.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb226-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, Difference<span class="op">&gt;</span><span class="fl">4.9</span>), Country), </a>
<a class="sourceLine" id="cb226-3" data-line-number="3">                    Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, Difference<span class="op">&gt;</span><span class="fl">4.9</span>), Sex),</a>
<a class="sourceLine" id="cb226-4" data-line-number="4">                    Year <span class="op">==</span><span class="st">&quot;2017&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb226-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>BMI)</a></code></pre></div>
<pre><code># A tibble: 9 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Egypt       Women Urban    2017   32.3
2 Egypt       Women National 2017   31.7
3 Egypt       Women Rural    2017   31.3
4 Saint Lucia Women National 2017   30.5
5 Saint Lucia Women Rural    2017   30.5
6 Saint Lucia Women Urban    2017   30.5
7 Honduras    Women Urban    2017   28.3
8 Honduras    Women National 2017   27.7
9 Honduras    Women Rural    2017   26.9</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1"><span class="co">#Here is the data just for the changes in BMI in Egypt</span></a>
<a class="sourceLine" id="cb228-2" data-line-number="2"><span class="kw">filter</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;Egypt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb228-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>Difference)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Type                Difference
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Egypt   Women Rural_difference          5.9 
2 Egypt   Women National_difference       5.10
3 Egypt   Women Urban_difference          4.20
4 Egypt   Men   Urban_difference          2.60
5 Egypt   Men   Rural_difference          2.5 
6 Egypt   Men   National_difference       2.5 </code></pre>
<p>Thus rural women in Egypt had the greatest increase in BMI from 1985 to 2017 in this data (5.9) and the average BMI is now over the obesity threshold of 30.</p>
<p>The data suggests that rural women in Egypt and other countries may especially benefit from dietary resources and our interventions and programs to assist with weight management.</p>
<p>Now let’s make a plot that summarizes our findings. To do this we will simplify the other plots we made and then combine them together.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1"><span class="co"># simplified national means plot</span></a>
<a class="sourceLine" id="cb230-2" data-line-number="2">Means_plot&lt;-BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-4" data-line-number="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb230-5" data-line-number="5">         Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-8" data-line-number="8"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Year) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-12" data-line-number="12"><span class="st">                </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-13" data-line-number="13">                       Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb230-14" data-line-number="14">                       Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>),</a>
<a class="sourceLine" id="cb230-15" data-line-number="15">                <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb230-16" data-line-number="16">                <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb230-17" data-line-number="17">                <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-19" data-line-number="19"><span class="st">                            </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-20" data-line-number="20">                                   Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb230-21" data-line-number="21">                                   Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb230-22" data-line-number="22">                                   Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb230-23" data-line-number="23">                             <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb230-24" data-line-number="24">                             <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb230-25" data-line-number="25">                             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-26" data-line-number="26"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb230-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-28" data-line-number="28"><span class="st">                          </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-29" data-line-number="29">                                 Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb230-30" data-line-number="30">                                 Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)),</a>
<a class="sourceLine" id="cb230-31" data-line-number="31">                          <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb230-32" data-line-number="32">                          <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-33" data-line-number="33"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb230-34" data-line-number="34"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb230-35" data-line-number="35"><span class="st">  </span><span class="co"># This will make thebackground of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb230-36" data-line-number="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb230-37" data-line-number="37">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb230-38" data-line-number="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb230-39" data-line-number="39">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb230-40" data-line-number="40">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb230-41" data-line-number="41">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb230-42" data-line-number="42">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb230-43" data-line-number="43">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb230-44" data-line-number="44">   </a>
<a class="sourceLine" id="cb230-45" data-line-number="45"><span class="co">#Simplified difference plot </span></a>
<a class="sourceLine" id="cb230-46" data-line-number="46">BMI_diff_long<span class="op">$</span>Type &lt;-BMI_diff_long<span class="op">$</span>Type <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-47" data-line-number="47"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;_difference&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb230-48" data-line-number="48"></a>
<a class="sourceLine" id="cb230-49" data-line-number="49">Diff_plot&lt;-BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-50" data-line-number="50"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-51" data-line-number="51">         Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-52" data-line-number="52"><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Type, <span class="dt">y =</span> Difference, <span class="dt">col =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-53" data-line-number="53"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-54" data-line-number="54"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-55" data-line-number="55"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-56" data-line-number="56"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-57" data-line-number="57"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-58" data-line-number="58">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb230-59" data-line-number="59">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb230-60" data-line-number="60">    <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb230-61" data-line-number="61">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-62" data-line-number="62"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-63" data-line-number="63"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb230-64" data-line-number="64">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb230-65" data-line-number="65">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb230-66" data-line-number="66">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb230-67" data-line-number="67">    <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb230-68" data-line-number="68">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-69" data-line-number="69"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb230-70" data-line-number="70"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-71" data-line-number="71"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>),</a>
<a class="sourceLine" id="cb230-72" data-line-number="72">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb230-73" data-line-number="73">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>),</a>
<a class="sourceLine" id="cb230-74" data-line-number="74">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb230-75" data-line-number="75">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-76" data-line-number="76"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb230-77" data-line-number="77"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb230-78" data-line-number="78"><span class="st">    </span><span class="co"># This will make the background of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb230-79" data-line-number="79"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb230-80" data-line-number="80">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb230-81" data-line-number="81">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb230-82" data-line-number="82">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb230-83" data-line-number="83">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb230-84" data-line-number="84">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb230-85" data-line-number="85">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb230-86" data-line-number="86">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb230-87" data-line-number="87">  <span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb230-88" data-line-number="88"></a>
<a class="sourceLine" id="cb230-89" data-line-number="89"><span class="co">#add labels</span></a>
<a class="sourceLine" id="cb230-90" data-line-number="90">Diff_plot&lt;-Diff_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-91" data-line-number="91"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Change in BMI by region&quot;</span>, </a>
<a class="sourceLine" id="cb230-92" data-line-number="92">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb230-93" data-line-number="93">             <span class="dt">y =</span> <span class="st">&quot;Change in BMI </span><span class="ch">\n</span><span class="st"> (1985 to 2017)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-94" data-line-number="94"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb230-95" data-line-number="95"></a>
<a class="sourceLine" id="cb230-96" data-line-number="96">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-97" data-line-number="97"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mean BMI over time&quot;</span>, </a>
<a class="sourceLine" id="cb230-98" data-line-number="98">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb230-99" data-line-number="99">             <span class="dt">y =</span> <span class="st">&quot;Mean BMI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-100" data-line-number="100"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb230-101" data-line-number="101"></a>
<a class="sourceLine" id="cb230-102" data-line-number="102"></a>
<a class="sourceLine" id="cb230-103" data-line-number="103"></a>
<a class="sourceLine" id="cb230-104" data-line-number="104">obesity_text&lt;-<span class="kw">tibble</span>(<span class="dt">Year=</span><span class="kw">c</span>(<span class="dv">1985</span>),<span class="dt">BMI=</span><span class="kw">c</span>(<span class="dv">31</span>),<span class="dt">Sex=</span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>),<span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;Obesity&quot;</span>))</a>
<a class="sourceLine" id="cb230-105" data-line-number="105"></a>
<a class="sourceLine" id="cb230-106" data-line-number="106">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-107" data-line-number="107"><span class="st">             </span><span class="kw">geom_text</span>(<span class="dt">data =</span> obesity_text,</a>
<a class="sourceLine" id="cb230-108" data-line-number="108">                       <span class="dt">label=</span><span class="kw">pull</span>(obesity_text,label), </a>
<a class="sourceLine" id="cb230-109" data-line-number="109">                       <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb230-110" data-line-number="110">                       <span class="kw">aes</span>( <span class="dt">fontface =</span><span class="st">&quot;bold.italic&quot;</span>, <span class="dt">size =</span> <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb230-111" data-line-number="111"></a>
<a class="sourceLine" id="cb230-112" data-line-number="112">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(Means_plot, Diff_plot, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great, now we have put two plots together using the <code>plot_grid()</code> function of the <code>cowplot</code> package. This way we can clearly communicate two messages. The first being that BMI has increased over time globally and that many countries including the United States of America are approaching a mean BMI that is above the obesity threshold of 30. We can also see that women on average have larger BMI values than males, but that both genders show increased levels over time. In the second plot we can see that the increase in BMI is not just happening in urban communities, but in both rural and urban communities and particularly in women.</p>
<p>Our plot visually explores all of our main questions: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have evaluated BMI average estimates from 200 different countries around the world. To do so we imported data from a pdf using the <code>pdftools</code> package. We used <code>tidyverse</code> packages such as <code>dplyr</code>, <code>stringr</code>, and <code>tidy</code> to clean the data and get it in a workable format. Our statistical analysis focused on evaluating differences in BMI in females around the world across time and between rural and urban areas. We found a significant difference both between years and between the type of community among women globally using <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">t-tests</a> and <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960">nonparametric</a> tests. Thus BMI has increased in women since 1985. Although BMI estimates are significantly higher in Urban areas compared to rural areas, BMI estimates have increased in both regions. We learned that there are assumptions and considerations to keep in mind when performing tests that compare two groups.</p>
<p><u> We learned that the t-test relies on:</u> 1) normality of the data for both groups (this is not as much of an issue if the number of observations is relatively large total n&gt;30) 2) equal variance between the two groups (make sure you do the correct test if the data is not normal) 3) balanced sample sizes of the two groups 4) independent observations (or independent paired observations)</p>
<p>We learned that we can evaluate if our data is <a href="https://www.physiology.org/doi/full/10.1152/advan.00064.2017">normally distributed</a> by plotting the distribution and by creating Q-Q plots.</p>
<p><u>We learned that if our data is not normally distributed, we can consider these options:</u> 1) We can still perform a t-test if our n is large 2) We can transform the data before performing a t-test 3) We can use a nonparametric test (Wilcoxon signed rank test, the Wilcoxon rank sum test, and the Two-sample Kolmogorov-Smirnov (KS) test) 4) We can perform a t-test with resampling methods (which should be especially considered when the groups are imbalanced)</p>
<p>We learned that if our groups do not have equal variance, that we need to use a modified t-test to account for this or the correct nonparametric test that does not rely on this assumption (Two-sample Kolmogorov-Smirnov test).</p>
<p>We also learned that if our groups are not well balanced, that we can consider resampling methods.</p>
<p>Finally its also important to remember that when we have <a href="https://www.statisticshowto.datasciencecentral.com/paired-data/">paired data</a> and intend to compare means, we should perform a paired test (<a href="https://stattrek.com/hypothesis-test/paired-means.aspx#example1">paired t-test</a>, Wilcoxon signed rank test, or paired KS test). Our data used in this case study was paired because observations were taken for the same countries for different categories of populations - thus, we wanted to compare these populations within the same country (male vs female, rural vs urban etc.). Other examples would be in a case-control study (if samples are matched for various demographics) or a study with repeated measures (for example, symptom measures from the same individual before and after a treatment).</p>
<p>Using the <code>ggplot2</code> package we were able to visualize trends in the data. Importantly, the largest increase appears to be in the rural areas particularly for women. We were also able to identify how the US compared to other countries and which countries showed the largest increase in BMI over time. Analyses like this are important for defining which groups could benefit the most from interventions, education, and policy changes when attempting to mitigate public health challenges. You can see in the <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf">article</a> that this data came from that many additional considerations would be involved to perform such an analysis.</p>
<div id="suggested-homework" class="section level3">
<h3>Suggested Homework</h3>
<p>Students can evaluate the change in BMI over time using the global data available for each year between 2015 and 2017. The data can be found <a href="http://www.ncdrisc.org/downloads/bmi/NCD_RisC_Lancet_2017_BMI_age_standardised_world.csv">here</a>.</p>
</div>
<div id="helpful-links" class="section level3">
<h3>Helpful Links</h3>
<p><a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html">BMI</a><br />
<a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html">Long and Wide Data Formats</a><br />
<a href="http://onlinestatbook.com/2/introduction/distributions.html">Distributions</a> <a href="http://onlinestatbook.com/2/introduction/distributions.html">Normal Distribution</a> <a href="http://onlinestatbook.com/2/glossary/skew.html">Skewed Distributions</a><br />
<a href="http://onlinestatbook.com/2/introduction/distributions.html">Bimodal Distribution</a><br />
<a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html">ggplot2</a><br />
<a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html">Q-Q Plots</a><br />
<a href="http://www.statistics4u.info/fundstat_eng/ee_shapiro_wilk_test.html">Shapiro-Wilk Test</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">Student t-test</a><br />
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/">Paired Data</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/">Welch’s t-test</a><br />
<a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960">Parametric and Nonparametric Methods</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance">Variance</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/balanced-and-unbalanced-designs/">Balanced Study Design</a><br />
<a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf">Independent Observations</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/">Transformation</a><br />
<a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html">Permutation/Resampling Methods</a><br />
<a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/">Central Limit Theorem</a><br />
<a href="https://files.eric.ed.gov/fulltext/ED065559.pdf">Mood’s Two-Sample Scale Test</a><br />
<a href="http://www.biostathandbook.com/wilcoxonsignedrank.html">Wilcoxon Signed Rank Test</a><br />
<a href="http://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/BS704_Nonparametric4.html">Wilcoxon Rank Sum Test</a><br />
<a href="https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/ks2samp.htm">Two-sample Kolmogorov-Smirnov Test</a><br />
<a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html">Type 1 Error</a><br />
<a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8">p-value</a><br />
<a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf">Multiple Testing</a><br />
<a href="http://mathworld.wolfram.com/BonferroniCorrection.html">Bonferroni Method of Multiple Testing Correction</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXM6IEV4cGxvcmluZyBnbG9iYWwgcGF0dGVybnMgb2Ygb2Jlc2l0eSBhY3Jvc3MgcnVyYWwgYW5kIHVyYmFuIHJlZ2lvbnMiCmNzczogc3R5bGUuY3NzCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgc2VsZl9jb250YWluZWQ6IHllcwogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBoaWdobGlnaHQ6IHRhbmdvCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogIHBkZl9kb2N1bWVudDoKICAgIHRvYzogeWVzCiAgd29yZF9kb2N1bWVudDoKICAgIHRvYzogeWVzCi0tLQoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldChpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIGZpZy5hbGlnbiA9ICJjZW50ZXIiLCBvdXQud2lkdGggPSAnOTAlJykKbGlicmFyeShoZXJlKQpsaWJyYXJ5KGtuaXRyKQpgYGAKCiAKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJtYWlucGxvdC5wbmciKSkKYGBgCgojIyB7LmRpc2NsYWltZXJfYmxvY2t9CgoqKkRpc2NsYWltZXIqKjogVGhlIHB1cnBvc2Ugb2YgdGhlIFtPcGVuIENhc2UgU3R1ZGllc10oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvKSBwcm9qZWN0IGlzICoqdG8gZGVtb25zdHJhdGUgdGhlIHVzZSBvZiB2YXJpb3VzIGRhdGEgc2NpZW5jZSBtZXRob2RzLCB0b29scywgYW5kIHNvZnR3YXJlIGluIHRoZSBjb250ZXh0IG9mIG1lc3N5LCByZWFsLXdvcmxkIGRhdGEqKi4gQSBnaXZlbiBjYXNlIHN0dWR5IGRvZXMgbm90IGNvdmVyIGFsbCBhc3BlY3RzIG9mIHRoZSByZXNlYXJjaCBwcm9jZXNzLCBpcyBub3QgY2xhaW1pbmcgdG8gYmUgdGhlIG1vc3QgYXBwcm9ycHJpYXRlIHdheSB0byBhbmFseXplIGEgZ2l2ZW4gZGF0YXNldCwgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBpbiB0aGUgY29udGV4dCBvZiBtYWtpbmcgcG9saWN5IGRlY2lzaW9ucyB3aXRob3V0IGV4dGVybmFsIGNvbnN1bHRhdGlvbiBmcm9tIHNjaWVudGlmaWMgZXhwZXJ0cy4gCgojIyBNb3RpdmF0aW9uCgpCb2R5IG1hc3MgaW5kZXggKFtCTUldKGh0dHBzOi8vd3d3LmNkYy5nb3YvaGVhbHRoeXdlaWdodC9hc3Nlc3NpbmcvYm1pL2FkdWx0X2JtaS9pbmRleC5odG1sKSkgaXMgb2Z0ZW4gdXNlZCBhcyBhIHByb3h5IGZvciAqKmFkaXBvc2l0eSoqIGFuZCBpcyBtZWFzdXJlZCBhcyBhbiBpbmRpdmlkdWFsJ3Mgd2VpZ2h0IGluIGtpbG9ncmFtcyAoa2cpIG9yIHBvdW5kcyAobGJzKSBkaXZpZGVkIGJ5IHRoZSBpbmRpdmlkdWFsJ3MgaGVpZ2h0IGluIG1ldGVycyAoJG1eMiQpIHNxdWFyZWQuClRoZXJlIGFyZSBkaWZmZXJlbnQgY2F0ZWdvcmllcyBvZiB3ZWlnaHQgZGVmaW5lZCB1c2luZyBkaWZmZXJlbnQgQk1JIHRocmVzaG9sZHMgYXMgZGVmaW5lZCBieSB0aGUgW1dvcmxkIEhlYWx0aCBPcmdhbml6YXRpb25dKGh0dHA6Ly93d3cuZXVyby53aG8uaW50L2VuL2hlYWx0aC10b3BpY3MvZGlzZWFzZS1wcmV2ZW50aW9uL251dHJpdGlvbi9hLWhlYWx0aHktbGlmZXN0eWxlL2JvZHktbWFzcy1pbmRleC1ibWkpIChXSE8pLCB0aGUgW0NlbnRlcnMgZm9yIERpc2Vhc2UgQ29udHJvbCBhbmQgUHJldmVudGlvbl0oaHR0cHM6Ly93d3cuY2RjLmdvdi9vYmVzaXR5L2FkdWx0L2RlZmluaW5nLmh0bWwpLCBhbmQgdGhlIFtOYXRpb25hbCBJbnN0aXR1dGVzIG9mIEhlYWx0aF0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKS4gCkZvciBleGFtcGxlLCB0aGVzZSBhcmUgdGhlIGNhdGVnb3JpZXMgZGVmaW5lZCBieSB0aGUgV0hPOiAKCmBgYHtyLCBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygiaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQks1MzU0NTYvYmluL2JtaV9XSE8uanBnIikKYGBgCgojIyMjIyMgW1tzb3VyY2VdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvYm9va3MvTkJLNTM1NDU2L2Jpbi9ibWlfV0hPLmpwZyldCgpUaGUgZm9sbG93aW5nIGNoYXJ0IGNhbiBoZWxwIHlvdSBpZGVudGlmeSB5b3VyIGVzdGltYXRlIG9mIEJNSToKYGBge3IsIGVjaG89RkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwOi8vY29udGVudC5ldmVyeWRheWhlYWx0aC5jb20vbWF5b2RpZXQvaW1hZ2VzL0JNSS1jaGFydC5qcGciKQpgYGAKCiMjIyMjIyBbW3NvdXJjZV0oaHR0cDovL2RpZXQubWF5b2NsaW5pYy5vcmcvZGlldC9lYXQvd2hhdC1pcy15b3VyLWJtaT94aWQ9bmxfTWF5b0NsaW5pY0RpZXRfMjAxNjA0MjYpXQoKUHJldmlvdXMgd29yayBoYXMgc2hvd24gaGlnaGVyIEJNSSAoPjMwKSBpcyBhc3NvY2lhdGVkIHdpdGggW2hpZ2hlciByYXRlcyBvZiBhbGwtY2F1c2VzIG9mIG1vcnRhbGl0eV0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKSwgYXMgd2VsbCBhcyBpbmNyZWFzZWQgcmF0ZXMgb2YgdHlwZSAyIGRpYWJldGVzLCBjYW5jZXIsIGhlYXJ0IGRpc2Vhc2UsIGFuZCBzdHJva2UuICoqU0NIIC0tIG1heWJlIG1vcmUgcmVmcyBhbmQgVVJMcyBoZXJlICoqPwoKUmVjZW50bHksIGFuIFthcnRpY2xlXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL3M0MTU4Ni0wMTktMTE3MS14LnBkZikgcHVibGlzaGVkIGluIFsqTmF0dXJlKl0oaHR0cHM6Ly93d3cubmF0dXJlLmNvbSkgZXZhbHVhdGVkIGFuZCBjb21wYXJlZCB0aGUgQm9keS1NYXNzIEluZGV4IChCTUkpIG9mIHBvcHVsYXRpb25zIGluIHJ1cmFsIGFuZCB1cmJhbiBjb21tdW5pdGllcyBhcm91bmQgdGhlIHdvcmxkOiAKCmBgYHtyLCAgZWNobz1GQUxTRSwgb3V0LndpZHRoPScxMDAlJ30Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInBhcGVyLnBuZyIpKQpgYGAKCiMjIyMgey5yZWZlcmVuY2VfYmxvY2t9Ck5DRCBSaXNrIEZhY3RvciBDb2xsYWJvcmF0aW9uIChOQ0QtUmlzQykuIFJpc2luZyBydXJhbCBib2R5LW1hc3MgaW5kZXggaXMgdGhlIG1haW4gZHJpdmVyIG9mIHRoZSBnbG9iYWwgb2Jlc2l0eSBlcGlkZW1pYyBpbiBhZHVsdHMuICpOYXR1cmUqICoqNTY5KiosIDI2MOKAkzI2NCAoMjAxOSkuIAoKIyMjIwoKVGhlIGFydGljbGUgY2hhbGxlbmdlZCB0aGUgd2lkZWx5LWhlbGQgdmlldyB0aGF0IGluY3JlYXNlZCB1cmJhbml6YXRpb24gd2FzIG9uZSBvZiB0aGUgbWFqb3IgcmVhc29ucyBmb3IgaW5jcmVhc2VkIGdsb2JhbCBvYmVzaXR5IHJhdGVzLiAKVGhpcyB2aWV3IGNhbWUgYWJvdXQgYmVjYXVzZSBtYW55IGNvdW50cmllcyBhcm91bmQgdGhlIHdvcmxkIGhhdmUgc2hvd24gaW5jcmVhc2VkIHVyYmFuaXphdGlvbiBsZXZlbHMgaW4gcGFyYWxsZWwgd2l0aCBpbmNyZWFzZWQgb2Jlc2l0eSByYXRlcy4gCkhvd2V2ZXIsIHRoZSBOQ0QtUmlzQyBhcmd1ZWQgdGhhdCB0aGlzIG1pZ2h0IG5vdCBiZSB0aGUgY2FzZTsgYW5kIHRoYXQgaW4gZmFjdCBmb3IgbW9zdCByZWdpb25zIGFyb3VuZCB0aGUgd29ybGQsIEJNSSBtZWFzdXJlbWVudHMgYXJlIGluY3JlYXNpbmcgaW4gcnVyYWwgcG9wdWxhdGlvbnMganVzdCBhcyBtdWNoLCBpZiBub3QgbW9yZSBzbywgdGhhbiB1cmJhbiBwb3B1bGF0aW9ucy4gCkZ1cnRoZXJtb3JlLCB0aGlzIHN0dWR5IHN1Z2dlc3RlZCB0aGF0IG9iZXNpdHkgaGFzIHBhcnRpY3VsYXJseSBpbmNyZWFzZWQgaW4gZmVtYWxlIHBvcHVsYXRpb25zIGluIHJ1cmFsIHJlZ2lvbnM6IDxiPiJXZSBub3RlZCBhIHBlcnNpc3RlbnRseSBoaWdoZXIgcnVyYWwgQk1JLCBlc3BlY2lhbGx5IGZvciB3b21lbiI8L2I+LgoKSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIGV2YWx1YXRlIHRoZSBkYXRhIHJlcG9ydGVkIGluIHRoaXMgYXJ0aWNsZSB0byBleHBsb3JlIHJlZ2lvbmFsIGFuZCBnZW5kZXIgc3BlY2lmaWMgZGlmZmVyZW5jZXMgaW4gdGhlIG9iZXNpdHkgcmF0ZXMgYXJvdW5kIHRoZSB3b3JsZCBpbiAxOTg1IGFuZCAyMDE3LiAKTW9zdCBpbXBvcnRhbnRseSB3ZSB3aWxsIHRlc3QgaWYgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGluIG9iZXNpdHkgcmF0ZXMgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gY29tbXVuaXRpZXMgYW5kIGlmIHRoZXJlIGhhcyBiZWVuIGEgY2hhbmdlIGluIG9iZXNpdHkgb3ZlciB0aW1lIGZvciB0aGVzZSByZWdpb25zLCBwYXJ0aWN1bGFybHkgZm9yIGZlbWFsZXMuIApUbyBkbyB0aGlzIHdlIHdpbGwgdGVzdCBpZiB0aGVyZSBpcyBhIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgYXZlcmFnZSBCTUkgZm9yIGVhY2ggZ3JvdXAuCgojIyMgTWFpbiBRdWVzdGlvbnMKIyMjIyB7Lm1haW5fcXVlc3Rpb25fYmxvY2t9Cgo8Yj48dT4gT3VyIG1haW4gcXVlc3Rpb25zIGFyZTogPC91PjwvYj4KCjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMikgSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PyBBZ2FpbiwgSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwozKSBIb3cgZG8gZGlmZmVyZW50IGNvdW50cmllcyB2YXJ5IGluIHRlcm1zIG9mIGVzdGltYXRlcyBvZiBCTUk/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoZSBVbml0ZWQgU3RhdGVzIGNvbXBhcmUgdG8gdGhlIHJlc3Qgb2YgdGhlIHdvcmxkPwoKIyMjIwoKIyMjIExlYXJuaW5nIE9iamVjdGl2ZXMgCgpJbiB0aGlzIGNhc2Ugc3R1ZHksIHdlIHdpbGwgd2FsayB5b3UgdGhyb3VnaCBpbXBvcnRpbmcgZGF0YSBmcm9tIGEgcGRmLCBjbGVhbmluZywgd3JhbmdsaW5nIGFuZCB2aXN1YWxpemluZyB0aGUgZGF0YSwgYW5kIDxiPiBjb21wYXJpbmcgdHdvIGdyb3VwcyA8L2I+IHVzaW5nIHdlbGwtZXN0YWJsaXNoZWQgYW5kIGNvbW1vbmx5IHVzZWQgcGFja2FnZXMsIGluY2x1ZGluZyBgc3RyaW5ncmAsIGB0aWR5cmAsIGBkcGx5cmAsIGBwdXJycmAsIGFuZCBgZ2dwbG90MmAgZnJvbSB0aGUgW2B0aWR5dmVyc2VgXShodHRwczovL3d3dy50aWR5dmVyc2Uub3JnLykuIApTcGVjaWZpY2lhbGx5LCB0aGUgdGlkeXZlcnNlIGlzCgo+ICJhbiBvcGluaW9uYXRlZCBjb2xsZWN0aW9uIG9mIFIgcGFja2FnZXMgZGVzaWduZWQgZm9yIGRhdGEgc2NpZW5jZS4gQWxsIHBhY2thZ2VzIHNoYXJlIGFuIHVuZGVybHlpbmcgcGhpbG9zb3BoeSBhbmQgY29tbW9uIEFQSXMiLgoKQW5vdGhlciB3YXkgb2YgcHV0dGluZyBpdCBpcyB0aGF0IGl0J3MgYSBzZXQgb2YgcGFja2FnZXMgdGhhdCBhcmUgdXNlZnVsIHNwZWNpZmljYWxseSBmb3IgZGF0YSBtYW5pcHVsYXRpb24sIGV4cGxvcmF0aW9uIGFuZCB2aXN1YWxpemF0aW9uIHdpdGggYSBjb21tb24gcGhpbG9zb3BoeS4KV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBwYWNrYWdlcyBmcm9tIHRoZSBSIHByb2dyYW1taW5nIGxhbmd1YWdlLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgZWZmaWNpZW50LgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjIwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3RpZHl2ZXJzZS50aWR5dmVyc2Uub3JnL2xvZ28ucG5nIikKYGBgCgpXZSB3aWxsIGJlZ2luIGJ5IGxvYWRpbmcgdGhlIHBhY2thZ2VzIHRoYXQgd2Ugd2lsbCBuZWVkIHdpdGggYSBicmllZiBleHBsYW5hdGlvbjoKCmBgYHtyfQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkocGRmdG9vbHMpCmxpYnJhcnkoc3RyaW5ncikKbGlicmFyeShyZWFkcikKbGlicmFyeShkcGx5cikKbGlicmFyeSh0aWJibGUpCmxpYnJhcnkobWFncml0dHIpCmxpYnJhcnkoZ2x1ZSkKbGlicmFyeShwdXJycikKbGlicmFyeSh0aWR5cikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KGdncmVwZWwpCmxpYnJhcnkoY293cGxvdCkKYGBgCgoKIFBhY2thZ2UgICB8IFVzZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKLS0tLS0tLS0tLSB8LS0tLS0tLS0tLS0tLQpbaGVyZV0oaHR0cHM6Ly9naXRodWIuY29tL2plbm55YmMvaGVyZV9oZXJlKSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEgd2l0aCByZWxhdGl2ZSBwYXRocwpbcGRmdG9vbHNdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9wZGZ0b29scy9wZGZ0b29scy5wZGYpICAgfCB0byByZWFkIGEgdGV4dCBmcm9tIHBkZiBpbnRvIFIgICAKW3N0cmluZ3JdKGh0dHBzOi8vc3RyaW5nci50aWR5dmVyc2Uub3JnL2FydGljbGVzL3N0cmluZ3IuaHRtbCkgICAgfCB0byBtYW5pcHVsYXRlIHRoZSB0ZXh0IGRhdGEKW3JlYWRyXShodHRwczovL3JlYWRyLnRpZHl2ZXJzZS5vcmcvKSAgICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgdGV4dCBkYXRhIHdpdGhpbiB0aGUgcGRmIGludG8gaW5kaXZpZHVhbCBsaW5lcyAgCltkcGx5cl0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnLykgICAgICB8IHRvIGFycmFuZ2UvZmlsdGVyL3NlbGVjdCBzdWJzZXRzIG9mIHRoZSBkYXRhIApbdGliYmxlXShodHRwczovL3RpYmJsZS50aWR5dmVyc2Uub3JnLykgICAgIHwgdG8gY3JlYXRlIGRhdGEgb2JqZWN0cyB0aGF0IHdlIGNhbiBtYW5pcHVsYXRlIHdpdGggYGRwbHlyYC9gc3RyaW5ncmAvYHRpZHlyYC9gcHVycnJgClttYWdyaXR0cl0oaHR0cHM6Ly9tYWdyaXR0ci50aWR5dmVyc2Uub3JnL2FydGljbGVzL21hZ3JpdHRyLmh0bWwpICAgfCB0byB1c2UgdGhlIGAlPD4lYCBwaXBpbmcgb3BlcmF0b3IKW2dsdWVdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvYmxvZy8yMDE3LzEwL2dsdWUtMS4yLjAvKSAgfCB0byBwYXN0ZSBvciBjb21iaW5lIGNoYXJhY3RlciBzdHJpbmdzIGFuZCBkYXRhIHRvZ2V0aGVyCltwdXJycl0oaHR0cHM6Ly9wdXJyci50aWR5dmVyc2Uub3JnLykgICAgICB8IHRvIHBlcmZvcm0gZnVuY3Rpb25zIG9uIGFsbCBjb2x1bW5zIG9mIGEgdGliYmxlClt0aWR5cl0oaHR0cHM6Ly90aWR5ci50aWR5dmVyc2Uub3JnLykgICAgICB8IHRvIGNvbnZlcnQgZGF0YSBmcm9tICd3aWRlJyB0byAnbG9uZycgZm9ybWF0CltnZ3Bsb3QyXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pICAgIHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucyB3aXRoIG11bHRpcGxlIGxheWVycwpbZ2dyZXBlbF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCkgICAgfCB0byBhbGxvdyBsYWJlbHMgaW4gZmlndXJlcyBub3QgdG8gb3ZlcmxhcApbY293cGxvdF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2Nvd3Bsb3QvdmlnbmV0dGVzL2ludHJvZHVjdGlvbi5odG1sKSB8IHRvIGFsbG93IHBsb3RzIHRvIGJlIGNvbWJpbmVkICoqc2NoIC0tIHNob3VsZCB3ZSBjb25zaWRlciB1c2luZyBwYXRjaHdvcmsgb3IgZG8gd2UgdGhpbmsgY293cGxvdCBpcyBPSz8qKgpfX18KClRoZSBmaXJzdCB0aW1lIHdlIHVzZSBhIGZ1bmN0aW9uLCB3ZSB3aWxsIHVzZSB0aGUgYDo6YCB0byBpbmRpY2F0ZSB3aGljaCBwYWNrYWdlIHdlIGFyZSB1c2luZyAoZS5nLiBgc3RyaW5ncjo6c3RyX2RldGVjdCgpYCkuIFVubGVzcyB3ZSBoYXZlIG92ZXJsYXBwaW5nIGZ1bmN0aW9uIG5hbWVzLCB0aGlzIGlzIG5vdCBuZWNlc3NhcnksIGJ1dCB3ZSB3aWxsIGluY2x1ZGUgaXQgaGVyZSB0byBiZSBpbmZvcm1hdGl2ZSBhYm91dCB3aGVyZSB0aGUgZnVuY3Rpb25zIHdlIHdpbGwgdXNlIGNvbWUgZnJvbS4KCiMjIyBDb250ZXh0CgpUaGUgbWVhc3VyZW1lbnQgb2YgQk1JIGhhcyBzb21lIFtsaW1pdGF0aW9uc10oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNDg5MDg0MS9wZGYvbnQtNTAtMTE3LnBkZikgdGhhdCBhcmUgd2VsbCByZWNvZ25pemVkLCBhcyBpdCBkb2VzIG5vdCBhY2NvdW50IGZvciB0aGUgY29tcG9zaXRpb24gb2YgYm9keSBtYXNzLCB0aGUgbG9jYXRpb24gb2YgYm9keSBmYXQsIG9yIHRoZSBjb250cmlidXRpb24gb2YgYm9keSBmcmFtZSBzaXplLiBIb3dldmVyLCBbQk1JIGhhcyBiZWVuIGEgdXNlZnVsIGhlYWx0aCBpbmRpY2F0b3JdKGh0dHBzOi8vam91cm5hbHMubHd3LmNvbS9hY3NtLWhlYWx0aGZpdG5lc3MvRnVsbHRleHQvMjAxNi8wNzAwMC9USEVfQkVORUZJVFNfT0ZfQk9EWV9NQVNTX0lOREVYX0FORF9XQUlTVC44LmFzcHgjcGRmLWxpbmspIGZvciByaXNrIGZvciBtYW55IGRpc2Vhc2VzIGFuZCBjb25kaXRpb25zIHBhcnRpY3VsYXJseSB3aGVuIGNvbWJpbmVkIHdpdGggb3RoZXIgcmlzayBmYWN0b3IgaW5mb3JtYXRpb24uCgojIyBXaGF0IGFyZSB0aGUgZGF0YT8KCldlIHdpbGwgYmUgdXNpbmcgZGF0YSBsb2NhdGVkIHdpdGhpbiBhIHRhYmxlIG9mIHRoZSBbc3VwcGxlbWVudGFyeSBtYXRlcmlhbF0oaHR0cHM6Ly9zdGF0aWMtY29udGVudC5zcHJpbmdlci5jb20vZXNtL2FydCUzQTEwLjEwMzglMkZzNDE1ODYtMDE5LTExNzEteC9NZWRpYU9iamVjdHMvNDE1ODZfMjAxOV8xMTcxX01PRVNNMV9FU00ucGRmKSBmb3IgdGhlIE5DRC1SaXNDIHBhcGVyIHJlZmVyZW5jZWQgYWJvdmUuIFRoaXMgaXMgYSBwZGYgdGhhdCBjYW4gYmUgZm91bmQgZnJlZWx5IGF2YWlsYWJsZSBvbmxpbmUuIEhlcmUgaXMgYSBzY3JlZW5zaG90IG9mIHRoZSBmaXJzdCBwYWdlIG9mIHRoZSBQREY6IAoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwiZmlyc3RfcGFnZS5wbmciKSkKYGBgCgpZb3UgY2FuIHNlZSB0aGF0IHRoZSBkYXRhIGNvbnRhaW4gYXZlcmFnZSBCTUkgZXN0aW1hdGVzIGZvciBib3RoIG1lbiBhbmQgd29tZW4gaW4gY291bnRyaWVzIGF0IHRoZSBuYXRpb25hbCBsZXZlbCwgYXMgd2VsbCBhcyB0aGUgYXZlcmFnZSBCTUkgZXN0aW1hdGVzIGZvciB0aGUgcnVyYWwgYW5kIHVyYmFuIGFyZWFzIG9mIHRoZXNlIGNvdW50cmllcyBpbiBib3RoIDE5ODUgYW5kIDIwMTcuCgpUaGUgZGF0YSB3aXRoaW4gdGhlIHBhcmVudGhlc2VzIGFyZSB0aGUgOTUlIFsqKmNyZWRpYmxlIGludGVydmFsKipdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NyZWRpYmxlX2ludGVydmFsKSAoQ0lzKSByYW5nZXMgZm9yIHRoZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZXMuIFRoZSBhdXRob3JzIHByb3ZpZGUgdGhlc2UgQ0lzIGFzIGEgZ3VpZGUgdG8gdW5kZXJzdGFuZCBob3cgbGlrZWx5IHRoZSBlc3RpbWF0ZSBpcyBmb3IgdGhlIHRydWUgcG9wdWxhdGlvbiBtZWFuIEJNSS4gQSB3aWRlciByYW5nZSBzdWdnZXN0cyB0aGF0IHRoZSBlc3RpbWF0ZSBpcyBsZXNzIGFjY3VyYXRlLCBhcyB0aGVyZSBhcmUgbW9yZSBwb3NzaWJsZSB2YWx1ZXMgZm9yIHRoZSB0cnVlIG1lYW4gd2l0aCBjcmVkaWJsZSBldmlkZW5jZS4KCjx1Pk5vdGU6PC91PiBXaGlsZSBbZ2VuZGVyXShodHRwczovL3d3dy5nZW5kZXJzcGVjdHJ1bS5vcmcvcXVpY2stbGlua3MvdW5kZXJzdGFuZGluZy1nZW5kZXIvKSBhbmQgW3NleF0oaHR0cHM6Ly93d3cud2hvLmludC9nZW5vbWljcy9nZW5kZXIvZW4vaW5kZXgxLmh0bWwpIGFyZSBub3QgYWN0dWFsbHkgYmluYXJ5LCB0aGUgZGF0YSBwcmVzZW50ZWQgdGhhdCBpcyB1c2VkIGluIHRoaXMgYW5hbHlzaXMgb25seSBjb250YWluIGRhdGEgZm9yIGdyb3VwcyBvZiBpbmRpdmlkdWFscyBkZXNjcmliZWQgYXMgbWVuIG9yIHdvbWVuLiAKCiMjIERhdGEgSW1wb3J0CgpGaXJzdCBsZXQncyBkb3dubG9hZCB0aGUgZGF0YSBmcm9tIHRoZSBQREYgZmlsZS4gCldlIHVzZSBgZmlsZS5leGlzdHMoKWAgZnJvbSBiYXNlIFIgdG8gY2hlY2sgaWYgdGhlIGZpbGUgd2Ugd2FudCB0byBkb3dubG9hZCBhbHJlYWR5IGV4aXN0cy4gCklmIG5vdCwgdGhlbiB3ZSBkb3dubG9hZCBpdCB1c2luZyB0aGUgZnVuY3Rpb24gYHV0aWxzOjpkb3dubG9hZC5maWxlKClgLiAKCmBgYHtyfQppZighZmlsZS5leGlzdHMoaGVyZSgiZG9jcyIsICJwYXBlcl9zdXBwbGVtZW50LnBkZiIpKSl7CiAgdXJsIDwtICJodHRwczovL3N0YXRpYy1jb250ZW50LnNwcmluZ2VyLmNvbS9lc20vYXJ0JTNBMTAuMTAzOCUyRnM0MTU4Ni0wMTktMTE3MS14L01lZGlhT2JqZWN0cy80MTU4Nl8yMDE5XzExNzFfTU9FU00xX0VTTS5wZGYiCiAgdXRpbHM6OmRvd25sb2FkLmZpbGUodXJsLCBoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCn0KYGBgCgpOb3cgdGhhdCB3ZSBoYXZlIGRvd25sb2FkZWQgdGhlIFBERiBmaWxlLCB3ZSB3aWxsIHJlYWQgaXQgaW4gdG8gUiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlOgoKYGBge3J9CnBkZl9vYmVzaXR5IDwtIHBkZnRvb2xzOjpwZGZfdGV4dChoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCmBgYAoKCkxldCdzIHRha2UgYSBsb29rIGF0IHRoZSBkYXRhIC0tIHRoZSBgc3VtbWFyeSgpYCBmdW5jdGlvbiBmcm9tIGJhc2UgUiBoZWxwcyB1cyB0byBsb29rIGF0IHRoZSBzdHJ1Y3R1cmUgb2YgUiBvYmplY3RzLgoKYGBge3J9CnN1bW1hcnkocGRmX29iZXNpdHkpCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHdlIGhhdmUgNjMgZWxlbWVudHMgdGhhdCBhcmUgY2hhcmFjdGVyIHN0cmluZ3MuIFlvdSBtYXkgYWxzbyBub3RpY2UgdGhhdCB0aGUgb3JpZ2luYWwgUERGIGhhcyA2MyBwYWdlcy4gTGV0J3MgdGFrZSBhIGxvb2sgYXQgc29tZSBvZiB0aGVzZSBlbGVtZW50cy4KCmBgYHtyfQpwZGZfb2Jlc2l0eVsxXSAjIHRoaXMgbG9va3MgbGlrZSB0aGUgZmlyc3QgcGFnZQpwZGZfb2Jlc2l0eVsyXSAjIHRoaXMgbG9va3MgbGlrZSB0aGUgc2Vjb25kIHBhZ2UKYGBgCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpwZGZfb2Jlc2l0eVs1NV0gCiMgdGhpcyBsb29rcyBsaWtlIGRhdGEgaW4gYSB0aGUgdGFibGUgd2Ugd2FudApgYGAKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iMTAwJSJ9CmxpYnJhcnkoaGVyZSkKa25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInBhZ2U1NS5wbmciKSkKYGBgCgoKV2UgY2FuIHNlZSB0aGF0IHRoZSBvdXRwdXQgbG9va3MgcHJldHR5IHNpbWlsYXIgdG8gdGhlIHBhZ2VzIG9mIHRoZSBwZGYsIGJ1dCB0aGUgc3BhY2luZyBpcyBhIGJpdCBhd2t3YXJkLiBOb3RlIHRoYXQgdGhlIHdheSB0aGUgZGF0YSBpcyBkaXNwbGF5ZWQgaXMgcGFydGlhbGx5IGluZmx1ZW5jZWQgYnkgdGhlIHdpZHRoIHNldHRpbmcgb2YgdGhlIFJTdHVkaW8gd2luZG93LiAgCgpXZSBhcmUgaW50ZXJlc3RlZCBpbiBhIHN1cHBsZW1lbnRhcnkgVGFibGUgMy4gd2hpY2ggaGFzIG11bHRpcGxlIHBhZ2VzIGFuZCBpbmNsdWRlcyB0aGUgc2FtZSBoZWFkZXIgb24gZWFjaCBwYWdlOyB3ZSBjYW4gdXNlIHRoYXQgdG8gZGV0ZXJtaW5lIHdoYXQgZWxlbWVudHMgb2Ygb3VyIGBwZGZfb2Jlc2l0eWAgY2hhcmFjdGVyIHN0cmluZ3MgaW5jbHVkZSBvdXIgdGFibGUuIFdlIHdpbGwgdXNlIHRoZSBgc3RyX2RldGVjdCgpYCBmdW5jdGlvbiBmcm9tIHRoZSBgc3RyaW5ncmAgcGFja2FnZSB0byBzZWFyY2ggZm9yIHRoZSBlbGVtZW50cyB0aGF0IGNvbnRhaW4gdGV4dCB0aGF0IGlzIGNvbnNpc3RlbnRseSBpbiB0aGUgaGVhZGVyLiBUaGUgb3V0cHV0IG9mIG9mIHRoaXMgZnVuY3Rpb24gd2lsbCBzaG93IHdoaWNoIGVsZW1lbnRzIG9mIHRoZSBvYmplY3QgKGluIHRoaXMgY2FzZSBwYWdlcyBvZiB0aGUgcGRmKSBpbmNsdWRlIHRoaXMgcGF0dGVybiBpbmRpY2F0ZWQgYXMgYSAiVFJVRSIgb3IgIkZBTFNFIi4KCmBgYHtyfQpzdHJpbmdyOjpzdHJfZGV0ZWN0KHBhdHRlcm4gPSAiQWdlLXN0YW5kYXJkaXNlZCBtZWFuIEJNSSIsIHN0cmluZyA9IHBkZl9vYmVzaXR5KQojICJBZ2Utc3RhbmRhcmRpc2VkIG1lYW4gQk1JIiBpcyBwYXJ0IG9mIHRoZSBoZWFkZXIgaW4gdGhlIHRhYmxlIG9uIGV2ZXJ5IHBhZ2UuCiMgVGhpcyBzaG93cyB0aGUgcGFnZXMgdGhhdCBjb250YWluIG91ciB0YWJsZSBvZiBpbnRlcmVzdCAoYXMgVFJVRSB2YWx1ZXMpLgpgYGAKCk5vdyB3ZSB3aWxsIGV4dHJhY3QganVzdCB0aGUgZGF0YSBmb3IgdGhlIHRhYmxlIG5vdyBhbmQgY2FsbCBpdCBydXJhbF91cmJhbi4gVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYHN0cl9zdWJzZXQoKWAgZnVuY3Rpb24gb2YgdGhlIHN0cmluZ3IgcGFja2FnZS4KCmBgYHtyfQpydXJhbF91cmJhbiA8LXN0cmluZ3I6OnN0cl9zdWJzZXQocGF0dGVybiA9IkFnZS1zdGFuZGFyZGlzZWQgbWVhbiBCTUkiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZyA9cGRmX29iZXNpdHkpCgpzdHIocnVyYWxfdXJiYW4pIAojIFRoZSBzdHIoKSBmdW5jdGlvbiBpcyBzaW1pbGFyIHRvIHRoZSBzdW1tYXJ5IGZ1bmN0aW9uCiMgVGhlcmUgYXJlIDEwIHBhZ2VzIHdvcnRoIG9mIGVsZW1lbnRzIGluIG91ciBydXJhbF91cmJhbiBvYmplY3QKCmBgYAoKCkxldCdzIGNoZWNrIHRoZSBmaXJzdCBhbmQgbGFzdCBwYWdlOgoKYGBge3IsIGV2YWw9RkFMU0V9CmNhdChydXJhbF91cmJhblsxXSkgCiMgVXNpbmcgdGhlIGNhdCgpIGZ1bmN0aW9uIHdoaWNoIHN0YW5kcyBmb3IgQ29uY2F0ZW5hdGUgQW5kIFByaW50IAojIFRoaXMgd2lsbCBhbGxvdyBmb3IgdGhlICJcbiIgdmFsdWVzIHRvIGJlIHNob3duIGFzIHNwYWNlcwpgYGAKCgpgYGB7ciwgZWNobyA9IEZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJmaXJzdF9wYWdlX2luX1IucG5nIikpCmBgYAoKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImZpcnN0X3BhZ2UucG5nIikpCmBgYAoKVGhpcyBsb29rcyB0aGUgc2FtZSBhcyB0aGUgYmVnaW5uaW5nLi4uIGhvdyBhYm91dCB0aGUgZW5kPwoKYGBge3IsIGV2YWwgPUZBTFNFfQpjYXQocnVyYWxfdXJiYW5bMTBdKQpgYGAKCgpgYGB7ciwgZWNobyA9IEZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJsYXN0X3BhZ2VfaW5fUi5wbmciKSkKYGBgCgoKYGBge3IsIGVjaG8gPSBGQUxTRSB9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImxhc3RfcGFnZS5wbmciKSkKYGBgCgoKR3JlYXQhIE91ciBydXJhbF91cmJhbiBvYmplY3QgbG9va3MgbGlrZSBpdCBjb250YWlucyB0aGUgZW50aXJlIFN1cHBsZW1lbnRhcnkgMyB0YWJsZSwgYXMgYm90aCB0aGUgYmVnaW5uaW5nIGFuZCB0aGUgZW5kIGluY2x1ZGUgdGhlIGRhdGEgd2UgZXhwZWN0ZWQuCgojIyBEYXRhIFdyYW5nbGluZwoKQXQgdGhpcyBwb2ludCB3ZSBoYXZlIGxhcmdlIHN0cmluZ3Mgbm93IGZvciBlYWNoIHBhZ2Ugb2YgdGhlIHRhYmxlLCBidXQgdGhpcyBpcyBub3QgdmVyeSBjb252ZW5pZW50IHRvIHdvcmsgd2l0aC4gTm93IHdlIHdpbGwgd3JhbmdsZSB0aGUgZGF0YSBpbnRvIGEgbW9yZSB1c2FibGUgZm9ybS4gSWRlYWxseSB3ZSB3b3VsZCBsaWtlIG91ciBkYXRhIHRvIGJlIGluIHNvbWUgc29ydCBvZiB0YWJ1bGFyIGZvcm0uCgojIyMgU2VwYXJhdGUgdGhlIGRhdGEgaW50byBsaW5lcwoKRmlyc3QgaXQgd291bGQgYmUgdXNlZnVsIHRvIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gbGluZXMgb3Igcm93cyBvZiB0aGUgdGFibGUuCmBgYHtyfQpydXJhbF91cmJhbiA8LXJlYWRyOjpyZWFkX2xpbmVzKHJ1cmFsX3VyYmFuKQpzdHIocnVyYWxfdXJiYW4pIAojIG5vdyB3ZSBoYXZlIDQ2MSBsaW5lcwpydXJhbF91cmJhbls2XSAKIyB3ZSBjYW4gc2VlIHRoYXQgbGluZSA2IHNob3dzIHRoZSBkYXRhIGZvciBmZW1hbGVzIGluIEFmZ2hhbmlzdGFuICAKYGBgCgojIyMgUmVtb3ZpbmcgZXhjZXNzIHdoaXRlLXNwYWNlCgpXZSBhbHNvIGhhdmUgYSBsb3Qgb2Ygd2hpdGUtc3BhY2UuLi4gbGV0J3MgZ2V0IHJpZCBvZiB0aGUgZXhjZXNzIHdoaXRlIHNwYWNlcyB1c2luZyBgc3RyX3NxdWlzaCgpYCBhbHNvIGZyb20gdGhlIGBzdHJpbmdyYCBwYWNrYWdlLgoKYGBge3J9CnJ1cmFsX3VyYmFuPC1zdHJpbmdyOjpzdHJfc3F1aXNoKHJ1cmFsX3VyYmFuKSAKaGVhZChydXJhbF91cmJhbikKYGBgCgpOb3cgaXQgaXMgbXVjaCBlYXNpZXIgdG8gc2VlIHRoZSBkYXRhLgoKSWYgd2UgbG9vayBhdCB0aGUgZW5kIG9mIHRoZSBmaXJzdCBwYWdlIG9mIHRoZSB0YWJsZSBhbmQgdGhlIHN0YXJ0IG9mIHRoZSBzZWNvbmQgd2UgY2FuIHNlZSB0aGF0IHRoZSBoZWFkZXIgaW5mb3JtYXRpb24gaXMgcmVwZWF0ZWQsIGFzIHdlbGwgYXMgYSBsaW5lIHdpdGggdGhlIHBhZ2UgbnVtYmVyIGFuZCBhbiBlbXB0eSBsaW5lLCBhbmQgYSBsaW5lIHRoYXQgc2F5cyAiMiAyIi4KYGBge3J9CnJ1cmFsX3VyYmFuWzQ0OjU2XQpgYGAKCkFsdGhvdWdoIHRoZSBoZWFkZXIgd2FzIG5lY2Vzc2FyeSBvbiBhbGwgb2YgdGhlIHBhZ2VzIG9mIHRoZSBwZGYgdmVyc2lvbiBvZiB0aGUgdGFibGUsIHdlIG9ubHkgbmVlZCB0aGF0IGluZm9ybWF0aW9uIG9uY2UgaW4gb3VyIGRhdGEuCgojIyMgUmVtb3ZpbmcgdW5uZWNlc3NhcnkgcmVwZWF0ZWQgaGVhZGVyIGluZm9ybWF0aW9uCgpTbywgbGV0J3MgcmVtb3ZlIGFsbCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uIGFuZCB0aGUgcGFnZSBudW1iZXIgbGluZXMgZnJvbSB0aGUgcnVyYWxfdXJiYW4gb2JqZWN0LCB0aGVuIHdlIHdpbGwgbWFrZSBhIHNpbmdsZSBsaW5lIGhlYWRlciBmb3IgdGhlIGJlZ2lubmluZy4KT25lIHdheSB0byBkbyB0aGlzIGlzIHRvIGZpbmQgYWxsIGxpbmVzIHRoYXQgaW5jbHVkZSBlaXRoZXIgIndvbWVuIiBvciAibWVuIiBhbmQgb25seSBrZWVwIHRoaXMgZGF0YS4KRmlyc3QgbGV0J3Mgc2VlIGhvdyBtYW55IGxpbmVzIGluY2x1ZGUgIndvbWVuIiBvciAibWVuIi4gV2UgY2FuIGRvIHRoaXMgYnkgZmlyc3QgaWRlbnRpZnlpbmcgdGhlIGxpbmVzIHRoYXQgY29udGFpbiB0aGVzZSBwYXR0ZXJucyBhbmQgdGhlbiBjaGVjayB0aGUgbGVuZ3RoIG9mIHRoZSByZXN1bHRpbmcgdmVjdG9yIGZvciB0aGUgbGluZSBudW1iZXJzIHRoYXQgY29udGFpbiB0aGVzZSBwYXR0ZXJucy4KCmBgYHtyfQpzdHJpbmdyOjpzdHJfd2hpY2goc3RyaW5nID0gcnVyYWxfdXJiYW4sIHBhdHRlcm4gPSAiV29tZW58TWVuIikKbGVuZ3RoKHN0cmluZ3I6OnN0cl93aGljaChzdHJpbmcgPSBydXJhbF91cmJhbiwgcGF0dGVybiA9ICJXb21lbnxNZW4iKSkKIyBIZXJlIHRoZSAifCIgaW5kaWNhdGVzIHRoYXQgd2UgYXJlIGxvb2tpbmcgZm9yIGVpdGhlciAgIldvbWVuIiBvciAiTWVuIgpgYGAKCk9LLCBzbyB0aGlzIGxvb2tzIGNvcnJlY3QuIFRoaXMgaW5jbHVkZXMgbW9zdCBsaW5lcyBidXQgdGhlcmUgYXJlIGdhcHMgd2hlcmUgYXJlIGhlYWRlciBpcyBsb2NhdGVkLiBJdCBsb29rcyBsaWtlIHRoZXJlIGFyZSA0MDAgbGluZXMgaW4gb3VyIHRhYmxlIHRoYXQgYXJlbid0IGhlYWRlcnMuCgpgYGB7cn0KcnVyYWxfdXJiYW4gPC0gc3RyX3N1YnNldChzdHJpbmcgPSBydXJhbF91cmJhbiwgcGF0dGVybiA9ICJXb21lbnxNZW4iKQpgYGAKCldlIGNhbiBjaGVjayBvdXIgZGF0YSBub3cgdXNpbmcgZWl0aGVyIGhlYWQoKSBvciBnbGltcHNlKCkuCmBgYHtyfQpkcGx5cjo6Z2xpbXBzZShydXJhbF91cmJhbikKYGBgCgpHcmVhdCwgbm93IG91ciBydXJhbF91cmJhbiBvYmplY3QgNDAwIGxpbmVzIGluc3RlYWQgb2YgNDYxLCBsaWtlIGl0IGRpZCBiZWZvcmUgd2hlbiBpdCBjb250YWluZWQgdGhlIHJlZHVuZGFudCBoZWFkZXIgaW5mb3JtYXRpb24uCgpgYGB7cn0KaGVhZChydXJhbF91cmJhbikKYGBgCgpUaGUgYGhlYWQoKWAgZnVuY3Rpb24gc2hvd3MgdXMgdGhlIGZpcnN0IHJvd3Mgb3IgbGluZXMgb2YgdGhlIGRhdGEsIHdoaWxlIHRoZSBgZ2xpbXBzZSgpYCBmdW5jdGlvbiBwcm92aWRlcyB1cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdG90YWwgc2l6ZSBvZiB0aGUgb2JqZWN0IGFuZCBzaG93cyB1cyB0aGUgZmlyc3QgbGluZSBvciByb3cuCgpHcmVhdCEgU28gbm93IG91ciBkYXRhIGxvb2tzIG11Y2ggYmV0dGVyIGJ1dCB3ZSBuZWVkIHRvIGFkZCBiYWNrIG91ciBoZWFkZXIgYW5kIHdlIHdvdWxkIGxpa2UgdGhpcyB0byBvbmx5IGJlIGEgc2luZ2xlIGxpbmUgdG8gbWFrZSBpdCBlYXN5IHRvIHRyYW5zZm9ybSBvdXIgZGF0YSBpbnRvIGEgdGFibGUgb3IgdGFibGUtbGlrZSBvYmplY3QuCgpIZXJlIGlzIHdoYXQgb3VyIGhlYWRlciB1c2VkIHRvIGxvb2sgbGlrZToKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImxhc3RfcGFnZS5wbmciKSkKYGBgCgojIyMgRGVhbGluZyB3aXRoIHNwYWNpbmcKCkZpcnN0IGxldCdzIHRyeSBzcGxpdHRpbmcgb3VyIGhlYWRlci1sZXNzIGRhdGEgaW50byBjb2x1bW5zIGJhc2VkIG9uIHNwYWNlcyB1c2luZyB0aGUgYHN0cl9zcGxpdCgpYCBmdW5jdGlvbiwgd2hlcmUgd2Ugc3BlY2lmeSB0aGF0IHdlIGFyZSBzcGxpdHRpbmcgdGhlIGRhdGEgYmFzZWQgb24gdGhlIHBhdHRlcm4gb2YgYSBzcGFjZSAodGhlIHNwYWNlIGlzIGluY2x1ZGVkIGluIHF1b3Rlcyk6CmBgYHtyfQooc3RyX3NwbGl0KHN0cmluZyA9IHJ1cmFsX3VyYmFuLCBwYXR0ZXJuID0gIiAiLCBzaW1wbGlmeSA9IFRSVUUpKVsxOjEwLF0gCiMgSGVyZSB3ZSB3aWxsIHRha2UgYSBsb29rIGF0IGp1c3QgdGhlIGZpcnN0IDEwIGxpbmVzIHVzaW5nIHRoZSBbMToxMCxdCmBgYAoKVGhpcyBhbG1vc3Qgd29ya2VkLCBidXQgdW5mb3J0dW5hdGVseSBjb3VudHJ5IG5hbWVzIHRoYXQgaGF2ZSBzcGFjZXMgd2lsbCBiZSBhIHByb2JsZW0uIFdlIGNhbiBzZWUgdGhhdCBBbWVyaWNhbiBTYW1vYSBoYXMgYmVlbiBkaXZpZGVkIGludG8gdHdvIGNvbHVtbnMgYW5kIGFsbCBzdWJzZXF1ZW50IGNvbHVtbnMgYXJlIHNoaWZ0ZWQuCgoKU28gbm93IGxldCdzIHRyeSB0byBleHRyYWN0IHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uLCBieSBzZXBhcmF0aW5nIHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIGZyb20gdGhlIHNleCBpbmZvcm1hdGlvbiB3aGVuIHRoZSBzZXggaXMgZmVtYWxlLiAKClNleCBhbHdheXMgc3RhcnRzIHdpdGggZWl0aGVyIGEgY2FwaXRhbCAiVyIgaWYgdGhlIGdlbmRlciBpcyBmZW1hbGUuICNXZSBuZWVkIHRvIHVzZSBhIHNwYWNlIGJlZm9yZSB0aGUgIlciIG90aGVyd2lzZSB3ZSB3aWxsIHNwbGl0IHNvbWUgb2YgdGhlIGNvdW50cnkgbmFtZXMgaWYgdGhlIG5hbWVzIHN0YXJ0cyB3aXRoICJXIi4gCgpIZXJlIHdlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGNvbmNlcHQgb2YgcGlwaW5nLCB3aGljaCB1c2VzIHRoZSBgJT4lYC4gVGhpcyBpcyByZWFsbHkgdXNlZnVsIHdoZW4gd2UgaGF2ZSBtdWx0aXBsZSBzdGVwcywgd2hpY2ggd2Ugd2lsbCBzaG93IHNvb24uCgpTbyBmaXJzdCB3ZSB3aWxsIHNlbGVjdCBqdXN0IHRoZSBkYXRhIGZvciBXb21lbiBhbmQgdGhlbiBzcGxpdCB0aGlzIGRhdGEgYmFzZWQgb24gdGhlIHBhdHRlcm4gIiBXb21lbiIgKE5vdGUgdGhhdCB0aGUgc3BhY2UgaXMgaW5jbHVkZWQgLSBzbyB0aGF0IGl0IGlzIG5vdCB3aXRoaW4gdGhlIGNvdW50cnkgZGF0YSkuCgpgYGB7cn0KCldvbWVuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIHBhdHRlcm4gPSAiV29tZW4iKSAKIyBGaXJzdCBsZXQncyBzdWJzZXQgdGhlIGRhdGEgdG8gb25seSB0aGUgbGluZXMgdGhhdCBjb250YWluICJXb21lbiIKCmNvdW50cnlfc3BsaXQgPC1Xb21lbiAlPiUKICBzdHJpbmdyOjpzdHJfc3BsaXQocGF0dGVybj0gIiBXb21lbiIpICU+JQogIHVubGlzdCgpIAoKCiN3ZSBjYW4gZG8gdGhlIHNhbWUgdGhpbmcgd2l0aCB0d28gcGlwZXM6CiMgZmlyc3Qgd2Ugc2VsZWN0IHRoZSAiV29tZW4iIGRhdGEgYW5kIHRoZW4gd2Ugc3BsaXQgdGhlIGRhdGEgYnkgIiBXb21lbiIKIyBmaW5hbGx5IHdlIGFzc2lnbiB0aGUgb3V0cHV0IG9mIGJvdGggc3RlcHMgdG8gdGhlIG9iamVjdCBjb3VudHJ5X3NwbGl0Cgpjb3VudHJ5X3NwbGl0IDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIHBhdHRlcm4gPSAiV29tZW4iKSAlPiUKICBzdHJpbmdyOjpzdHJfc3BsaXQocGF0dGVybj0gIiBXb21lbiIpICU+JQogIHVubGlzdCgpCgpoZWFkKGNvdW50cnlfc3BsaXQpCmBgYAoKTm93IHdlIGNhbiBzZWUgdGhhdCBDb3VudHJ5IGlzIGFsd2F5cyB0aGUgb2RkIHJvd3MgYW5kIHRoZSByZXN0IG9mIHRoZSBkYXRhIGlzIHRoZSByZXN0IG9mIHRoZSByb3dzLiAKV2UgY2FuIHNlbGVjdCB0aGUgb2RkIHJvd3MgdXNpbmcgdGhlIDxiPiBNb2R1bHVzIChSZW1haW5kZXIgZnJvbSBkaXZpc2lvbikgb3BlcmF0b3I8L2I+LiAKVGhpcyBvcGVyYXRvciBsb29rcyBsaWtlIHRoaXMgYCUlYC4gCkFsbCBvZGQgdmFsdWVzIHN1Y2ggYXMgMywgNywgb3IgMTUgd2hlbiBkaXZpZGVkIGJ5IDIgd291bGQgbGVhdmUgYSByZW1haW5kZXIgb2YgMS4gCldlIHdpbGwgc2VsZWN0IGp1c3QgdGhlc2Ugcm93cyB1c2luZyB0aGUgYGZpbHRlcigpYCBmdW5jdGlvbiBvZiBgZHBseXJgLgoKYGBge3J9CmNvdW50cnkgPC10aWJibGUoY291bnRyeV9zcGxpdCkgJT4lIAogIGRwbHlyOjpmaWx0ZXIocm93X251bWJlcigpICUlIDIgPT0gMSkgCmBgYAoKV2UgY2FuIHRha2UgYSBsb29rIHRvIG1ha2Ugc3VyZSB0aGF0IGFsbCB0aGUgY291bnRyeSBuYW1lcyBsb29rIGFzIGV4cGVjdGVkOgpgYGB7ciwgZXZhbD0gRkFMU0V9CmNvdW50cnkKYGBgCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyLCBlY2hvID0gRkFMU0V9CmNvdW50cnkKYGBgCiMjIyMKCkxvb2tzIGdvb2QhCgpUaGUgZXZlbiByb3dzIGFyZSB0aGUgcm93cyB3aXRoIHRoZSBkYXRhIGZvciB3b21lbi4KVGhlc2Ugcm93IHZhbHVlcyBoYXZlIGEgcmVtYWluZGVyIG9mIDAgd2hlbiBkaXZpZGVkIGJ5IDIuCgpgYGB7cn0KV29tZW5fQk1JIDwtdGliYmxlKGNvdW50cnlfc3BsaXQpICU+JSAKICBkcGx5cjo6ZmlsdGVyKHJvd19udW1iZXIoKSAlJSAyID09IDApCmhlYWQoV29tZW5fQk1JKQpgYGAKCkdyZWF0ISBOb3cgd2UgaGF2ZSBhIGxpc3Qgb2YgdGhlIGNvdW50cmllcyB0aGF0IGNhbiBiZSB1c2VkIGZvciBib3RoIHRoZSBtYWxlIGFuZCBmZW1hbGUgZGF0YS4gCgoKSXQncyBhbHdheXMgYSBnb29kIGlkZWEgdG8gY2hlY2sgdGhhdCB5b3VyIGRhdGEgb2JqZWN0cyBhcmUgdGhlIHNpemUgeW91IGV4cGVjdCB3aGVuIHdyYW5nbGluZy4gCldlIGNhbiBkbyBzbyB3aXRoIHRoZSBgZGltKClgIGZ1bmN0aW9uLCB3aGljaCBzaG93cyB1cyB0aGUgZGltZW5zaW9ucyBvZiBkYXRhIG9iamVjdHMuCgpgYGB7cn0KZGltKFdvbWVuX0JNSSkKYGBgCkdyZWF0ISBUaGVyZSBhcmUgMjAwIHJvd3MgbGlrZSB3ZSBleHBlY3RlZC4gCgpXZSBkbyBob3dldmVyIG5lZWQgdG8gYWRkICIgV29tZW4iIGJhY2sgdG8gdGhpcyBkYXRhLgoKVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYGdsdWUoKWAgZnVuY3Rpb24gb2YgdGhlIGBnbHVlYCBwYWNrYWdlLiAKCmBgYHtyfQpXb21lbiA8LWdsdWU6OmdsdWUoIldvbWVue1dvbWVuX0JNSSRjb3VudHJ5X3NwbGl0fSIpCmhlYWQoV29tZW4pCiMgaGVyZSB3ZSB3aWxsIHBhc3RlICIgV29tZW4iIGluIGZyb210IG9mIHRoZSBXb21lbl9CTUkgZGF0YQojIG5vdGUgdGhhdCB0aGVyZSB3aWxsIGJlIGEgc3BhY2UgaW4gYmV0d2VlbgojIFRoaXMgaXMgYmVjYXVzZSB0aGUgc3BhY2UgaXMgYWxyZWFkeSBpbiBmcm9udCBvZiB0aGUgZmlyc3QgQk1JIHZhbHVlCmBgYAoKCkxldCdzIGdyYWIgdGhlIG1hbGUgZGF0YToKCmBgYHtyfQojIHJlbWVtYmVyIG91ciBydXJhbF91cmJhbiBvYmplY3QgY29udGFpbnMgbWFsZSBkYXRhIGZvciB0aGUgb2RkIHJvd3MKCk1lbiA8LXRpYmJsZShydXJhbF91cmJhbikgJT4lIAogIGRwbHlyOjpmaWx0ZXIocm93X251bWJlcigpICUlIDIgPT0gMSkgCmhlYWQoTWVuJHJ1cmFsX3VyYmFuKQoKIyBBZ2FpbiBsZXQncyBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgY29ycmVjdCBudW1iZXIgb2Ygcm93cyAKCmRpbShNZW4pIApgYGAKSG93IGFib3V0IG91ciBudW1iZXIgb2YgY29sdW1ucz8gCgpJZiB3ZSB0cnkgc3BsaXR0aW5nIG91ciBkYXRhIGJ5IHNwYWNlIGFnYWluLCB3aWxsIGl0IGhhdmUgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBjb2x1bW5zPyBXaGF0IGFib3V0IHRoZSByb3dzIHRoYXQgY29udGFpbiBuYSogdmFsdWVzPwpgYGB7cn0KIyBMZXQncyBqdXN0IHRha2UgdGhlIE1lbiBkYXRhIHRoYXQgY29udGFpbnMgbmEqIHZhbHVlcwojIFRoaXMgY29sdW1uIGlzIGNhbGxlZCBydXJhbF91cmJhbgp1bmtub3duIDwtTWVuICU+JWZpbHRlcihzdHJfZGV0ZWN0KHBhdHRlcm4gPSJuYVxcKiIsIHN0cmluZyA9IHJ1cmFsX3VyYmFuKSkgCgojIE5vdyB3ZSBjYW4gdHJ5IHNwbGl0dGluZyBieSBhIHNwYWNlCnRpYmJsZTo6YXNfdGliYmxlKHN0cl9zcGxpdCh1bmtub3duJHJ1cmFsX3VyYmFuLCAiICIsIHNpbXBsaWZ5ID0gVFJVRSkpCgpgYGAKCiMjIyBEZWFsaW5nIHdpdGggTkEgdmFsdWVzCgpTbyBjbG9zZSEgTm90aWNlIHRoYXQgdGhlICJuYSoiIHZhbHVlcyAgaGF2ZSBzaGlmdGVkIHRoZSBzdWJzZXF1ZW50IHZhbHVlcyB3aXRoaW4gdGhlIGNvbHVtbnMgYmVjYXVzZSB0eXBpY2FsbHkgdGhlcmUgaXMgYSBzcGFjZSBiZXR3ZWVuIHRoZSBCTUkgYW5kIHRoZSBjcmVkaWJsZSBpbnRlcnZhbHMuIEhlcmUgd2UgY2FuIHNlZSB0aGlzIGRhdGEgaW4gb3VyIG9yaWdpbmFsIHBkZjoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iMTAwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsIm1pc3NpbmdfcGRmLnBuZyIpKQpgYGAKCldlIG5lZWQgdG8gcmVwbGFjZSBvdXIgbmEqIHZhbHVlcyAgd2l0aCBzb21ldGhpbmcgdGhhdCBpbmNsdWRlcyBhIHNwYWNlIHNvIHRoYXQgd2hlbiB3ZSBzZXBhcmF0ZSBvdXIgZGF0YSBieSBzcGFjZSB3ZSB3aWxsIGhhdmUgdHdvIHZhbHVlcyBpbnN0ZWFkIG9mIG9uZSB3aGVuIHdlIGhhdmUgYW4gbmEqIC4gVGhlcmVmb3JlLCBuYSogbmEqIHNob3VsZCB3b3JrLgoKYGBge3J9CmNsYXNzKE1lbiRydXJhbF91cmJhbikKIyBJbiBvcmRlciB0byB1c2UgdGhlIGZ1bmN0aW9ucyB3aXRoaW4gdGhlIHN0cmluZ3IgcGFja2FnZSwgCiMgb3VyIE1lbiBkYXRhIG5lZWRzIHRvIGJlIG9mIGNoYXJhY3RlciBjbGFzcwpNZW48LWFzLmNoYXJhY3RlcihNZW4kcnVyYWxfdXJiYW4pIAojIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHVzIHRvIGNoYW5nZSB0aGUgZmFjdG9yIGRhdGEgCiMgd2l0aGluIE1lbiRydXJhbF91cmJhbiB0byB0aGUgY2hhcmFjdGVyIGNsYXNzCiMgV2UgYXJlIGFsc28gY2hhbmdpbmcgdGhlIHN0cnVjdHVyZSBzbyB0aGF0IHRoZSBkYXRhIAojIGlzIG5vdCB3aXRoaW4gYSB2ZWN0b3IgY2FsbGVkIHJ1cmFsX3VyYmFuCk1lbjwtc3RyaW5ncjo6c3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9IE1lbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAibmFcXCoiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSAibmFcXCogbmFcXCoiKSAKIyBUaGUgXFwgYXJlIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSAqIGlzIGEgc3BlY2lhbCBjaGFyYWN0ZXIgCiMgVGhlICogd291bGQgdHlwaWNhbGx5IGluZGljYXRlIGFueSBwb3NzaWJsZSB2YWx1ZSwgCiMgYnV0IGhlcmUgd2UgYWN0dWFsbHkgd2FudCBhICIqIiBpbnN0ZWFkCiMgVGh1cyB0aGUgZG91YmxlIGJhY2tzbGFzaCBkb2VzIHRoYXQgZm9yIHVzCiMgSGVyZSB3ZSBhcmUgcmVwbGFjaW5nIGFsbCBvY2N1cmVuY2VzIG9mIHRoZSBuYSogdmFsdWVzIAojKHRodXMgc3RyX3JlcGxhY2VfYWxsIGluc3RlYWQgb2Ygc3RyX3JlcGxhY2UpIHdpdGggbmEqIG5hKi4gCmBgYAoKTGV0J3MgY2hlY2sgdGhhdCBpdCB3b3JrZWQuLi4KYGBge3J9Ck1lblsyMDozMF0KYGBgCgpHcmVhdCEKCk5vdyBmb3IgdGhlIFdvbWVuIGRhdGEgb2JqZWN0CmBgYHtyfQpjbGFzcyhXb21lbikKIyB0aGUgZmVtYWxlIGRhdGEgaXMgYWxyZWFkeSBjaGFyYWN0ZXIgdHlwZQpXb21lbjwtc3RyaW5ncjo6c3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9IFdvbWVuLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIm5hXFwqIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSAibmFcXCogbmFcXCoiKSAKV29tZW5bMjA6MzBdCmBgYAoKCkdyZWF0LCBub3cgd2UgY2FuIHNwbGl0IG91ciBkYXRhIGJ5IHNwYWNlcy4KCiMjIyBTcGxpdHRpbmcgdGhlIGRhdGEKCgpgYGB7cn0KTWVuIDwtdGliYmxlOjphc190aWJibGUoc3RyX3NwbGl0KE1lbiwgIiAiLCBzaW1wbGlmeSA9IFRSVUUpKQojIE5vdGUgaGVyZSB3ZSBuZWVkIHRvIHVzZSB0aGUgY29sdW1uIG9mIFdvbWVuIHRoYXQgaGFzIHRoZSBkYXRhCmhlYWQoTWVuKQpXb21lbjwtYXNfdGliYmxlKHN0cl9zcGxpdChXb21lbiwgIiAiLCBzaW1wbGlmeSA9IFRSVUUpKQojIE5vdGUgaGVyZSB3ZSBuZWVkIHRvIHVzZSB0aGUgY29sdW1uIG9mIFdvbWVuIHRoYXQgaGFzIHRoZSBkYXRhCmhlYWQoV29tZW4pCldvbWVuWzIwOjMwLF0gCiMgV2UgY2FuIHNlZSB0aGF0IG91ciBuYSB2YWx1ZXMgbG9vayBjb3JyZWN0CmBgYAogTG9va3MgZ29vZCEKIAogCiMjIyBBZGRpbmcgbmV3IGhlYWRlcgoKV2UgY2FuIHNlZSBmcm9tIG91ciBwZGYgYW5kIG91ciBvYmplY3QgY2FsbGVkIGhlYWRlciB3aGF0IHRoZSBoZWFkZXIgd2FzIGxpa2UuIExldCdzIGFsc28gbWFrZSBhIG5ldyBzaW5nbGUgbGluZSBoZWFkZXIsIGJ1dCBsZXQncyB3YWl0IHRvIGFkZCBDb3VudHJ5OgoKYGBge3J9CiNoZWFkZXIKbmV3X2hlYWRlciA8LWMoIlNleCIsIk5hdGlvbmFsX0JNSV8xOTg1IiwgIk5hdGlvbmFsX0JNSV8xOTg1X0NJIiwgIlJ1cmFsX0JNSV8xOTg1IiwgCiAgICAgICAgICAgICAgICJSdXJhbF9CTUlfMTk4NV9DSSIsICJVcmJhbl9CTUlfMTk4NSIsICJVcmJhbl9CTUlfMTk4NV9DSSIsICJOYXRpb25hbF9CTUlfMjAxNyIsCiAgICAgICAgICAgICAgICJOYXRpb25hbF9CTUlfMjAxN19DSSIsIlJ1cmFsX0JNSV8yMDE3IiwgIlJ1cmFsX0JNSV8yMDE3X0NJIiwgIlVyYmFuX0JNSV8yMDE3IiwgCiAgICAgICAgICAgICAgICJVcmJhbl9CTUlfMjAxN19DSSIpCmBgYAoKCkxldCdzIGNoYW5nZSB0aGUgbmFtZXMgb2Ygb3VyIGNvbHVtbnMgb2Ygb3VyIHRpYmJsZXMgdG8gdGhpcyBuZXcgaGVhZGVyIGZvciBvdXIgTWVuIGFuZCBXb21lbiBkYXRhCgpgYGB7cn0KbmFtZXMoV29tZW4pPC1uZXdfaGVhZGVyCm5hbWVzKE1lbik8LW5ld19oZWFkZXIKYGBgCgoKTm93IHdlIHdpbGwgYWRkIG91ciBjb3VudHJ5IGRhdGEgdG8gYm90aCBvdXIgTWVuIGFuZCBXb21lbiB0aWJibGVzIHVzaW5nIHRoZSBgYmluZF9jb2xzKClgIGZ1bmN0aW9uOgoKYGBge3J9CldvbWVuIDwtIGRwbHlyOjpiaW5kX2NvbHMoY291bnRyeSwgV29tZW4pCiMgVGhpcyB3aWxsIGFkZCB0aGUgY291bnRyeSBhcyBhIG5ldyBjb2x1bW4gdG8gdGhlIFdvbWVuIGRhdGEgb2JqZWN0IG9uIHRoZSBsZWZ0IApNZW4gPC0gZHBseXI6OmJpbmRfY29scyhjb3VudHJ5LCBNZW4pIAojIFRoaXMgd2lsbCBhZGQgdGhlIGNvdW50cnkgYXMgYSBuZXcgY29sdW1uIHRvIHRoZSBNZW4gZGF0YSBvYmplY3Qgb24gdGhlIGxlZnQgCmhlYWQoV29tZW4pCmBgYAoKIyMjIENoYW5naW5nIHZhcmlhYmxlIG5hbWVzCkhlcmUgd2Ugd2lsbCBjaGFuZ2UgdGhlIHZhcmlhYmxlIG5hbWUgb2YgdGhlIGNvdW50cnkgZGF0YSB0byBjb3VudHJ5LCBjdXJyZW50bHkgaXQgaXMgY2FsbGVkIGNvdW50cnlfc3BsaXQuIEhlcmUgd2Ugd2lsbCBhbHNvIGludHJvZHVjZSB0aGUgY29uY2VwdCBvZiB0aGUgYXNzaWdubWVudCBwaXBlLiBJbiB0aGlzIGNhc2Ugb3VyIHBpcGUgb3BlcmF0b3IgbG9va3MgbGlrZSB0aGlzIGAlPD4lYCAuICBVc2luZyB0aGlzIGZhbmNpZXIgcGlwZSByZXF1aXJlcyBhbm90aGVyIHBhY2thZ2UsICBjYWxsZWQgYG1hZ3JpdHRyYC4gVGhlIG90aGVyIHNpbXBsZXIgcGlwZSBvcHRpb25zIGZyb20gdGhpcyBwYWNrYWdlIGFyZSBsb2FkZWQgd2l0aCBgdGlkeXZlcnNlYCAoaWYgeW91IHVzZWQgYGxpYnJhcnkodGlkeXZlcnNlKWAgd2hpY2ggbG9hZHMgbW9zdCB0aWR5dmVyc2UgcGFja2FnZXMpLCBidXQgbm90IHRoaXMgZmFuY2llciB2ZXJzaW9uLiAKClRoZSBgPmAgcG9ydGlvbiBvZiB0aGUgcGlwZSBzdGlsbCBiZWhhdmVzIGxpa2UgYSBub3JtYWwgcGlwZSwgd2hpbGUgdGhlIGA8YCBwb3J0aW9uIG9mIHRoZSBwaXBlIG1ha2VzIGFuIGFzc2lnbm1lbnQgdG8gd2hhdGV2ZXIgdGhlIGA8YGlzIHBvaW50aW5nIHRvLCBqdXN0IGxpa2Ugd2hlbiB3ZSB1c2UgdGhlIHR5cGljYWwgYXNzaWdubWVudCBvcGVyYXRvciBgPC1gLiAKCmBgYHtyfQojIGxpYnJhcnkobWFncml0dHIpIAojIFdlIGNhbid0IHVzZSB0aGUgYCU8PiVgIHVubGVzcyB3ZSBsb2FkIHRoZSBtYWdyaXR0ciBwYWNrYWdlCiMgV2UgaGF2ZSBhbHJlYWR5IGRvbmUgdGhpcyBidXQgd2UgaW5jbHVkZSB0aGlzIGZvciBpbGx1c3RyYXRpdmUgcHVycG9zZXMuCiMgSGVyZSB3ZSB3aWxsIGp1c3QgdXNlIHRoZSB0cmFkaXRpb25hbCBhc3NpZ25tZW50IHN0cmF0ZWd5CgpXb21lbjwtZHBseXI6OnJlbmFtZShXb21lbiwgQ291bnRyeSA9IGNvdW50cnlfc3BsaXQpIAojIFdlIGhhdmUgcmVuYW1lZCB0aGUgY291bnRyeV9zcGxpdCB2YXJpYWJsZSB0byBiZSBjYWxsZWQgQ291bnRyeQoKIyBIZXJlIHdlIHJlYXNzaWduIE1lbiB1c2luZyB0aGUgcGlwZSBzdHJhdGVneQpNZW4gJTw+JXJlbmFtZShDb3VudHJ5ID0gY291bnRyeV9zcGxpdCkgCiMgV2UgaGF2ZSByZW5hbWVkIHRoZSBjb3VudHJ5X3NwbGl0IHZhcmlhYmxlIHRvIHRvIGJlIGNhbGxlZCBjb3VudHJ5CiMgV2UgaGF2ZSBhbHNvIHJlYXNzaWduZWQgTWVuIHRvIHRoZSBkYXRhIG9iamVjdCAKIyB3aGljaCBoYXMgdGhlIGNvdW50cnkgdmFyaWFibGUgcmVuYW1lZApgYGAKCgojIyMgSm9pbmluZyB0aGUgZGF0YQoKTm93IHdlIGNhbiBjb21iaW5lIG91ciBNZW4gYW5kIFdvbWVuIGRhdGEgdXNpbmcgdGhlIGBmdWxsX2pvaW4oKWAgZnVuY3Rpb24gb2YgYGRwbHlyYC4gClRoaXMgd2lsbCBwdXQgYWxsIHRoZSBtYWxlIGRhdGEgZmlyc3QgKHgpIGFuZCBhbGwgdGhlIGZlbWFsZSBkYXRhIHNlY29uZCAoeSkuCgpgYGB7cn0KQk1JPC1kcGx5cjo6ZnVsbF9qb2luKHggPSBNZW4sIHkgPSBXb21lbikKIyBMZXQncyBjaGVjayB0aGUgc2l6ZSBvZiBvdXIgQk1JIGRhdGEuLi4gaXQgc2hvdWxkIGhhdmUgNDAwIHJvd3MgKG9icykuCnN0cihCTUkpCmBgYAoKCiMjIyBTb3J0aW5nIHRoZSBkYXRhCgpOb3cgTGV0cyBzb3J0IHRoZSBkYXRhIGJ5IGNvdW50cnk6CgpgYGB7cn0KQk1JIDwtZHBseXI6OmFycmFuZ2UoQk1JLCBDb3VudHJ5KQpoZWFkKEJNSSkKCmBgYAoKT3VyIGRhdGEgaXMgbG9va2luZyBncmVhdCEgCgpOb3cgd2UgbWlnaHQgd2FudCB0byBtYWtlIHN1cmUgdGhhdCBvdXIgb2JzZXJ2YXRpb25zIGZvciBlYWNoIHZhcmlhYmxlIGxvb2sgdGhlIHdheSB3ZSB3YW50LiAKSW4gb3RoZXIgd29yZHMsIGlmIHdlIHdhbnQgdG8gbWFrZSBwbG90cyBhYm91dCBOYXRpb25hbCBCTUkgaW4gMTk4NSB0aGVuIHdlIHdvdWxkIG5lZWQgb3VyIHZhbHVlcyB0byBiZSBudW1lcmljLiBMb29raW5nIGF0IG91ciBCTUkgZGF0YSB1c2luZyBgc3RyKClgLCB3ZSBjYW4gc2VlIHRoZSB0eXBlIG9mIGRhdGEgZm9yIGVhY2ggb2Ygb3VyIHZhcmlhYmxlcyBsaXN0ZWQganVzdCBhZnRlciB2YXJpYWJsZSBuYW1lIGFuZCB0aGUgIjoiIGNvbG9uLiBMb29rcyBsaWtlIG5vbmUgb2Ygb3VyIEJNSSBkYXRhIGlzIGFjdHVhbGx5IG51bWVyaWMsIGJ1dCBvZiB0aGUgY2xhc3MgY2hhcmFjdGVyLiBMZXQncyBjaGFuZ2UgdGhhdCBub3cuCgpgYGB7ciwgd2FybmluZz1GQUxTRSwgZXZhbH0Kc3RyKEJNSSkKYGBgCgpXZSBjb3VsZCBjaGFuZ2UgdGhlc2UgdmFsdWVzIHRvIGJlIG51bWVyaWMgd2l0aCA2IGxpbmVzIG9mIGNvZGUgbGlrZSB0aGlzOgoKYGBge3IsIGV2YWwgPSBUUlVFfQpCTUkkTmF0aW9uYWxfQk1JXzE5ODUlPD4lIGFzLm51bWVyaWMKQk1JJFJ1cmFsX0JNSV8xOTg1JTw+JSBhcy5udW1lcmljCkJNSSRVcmJhbl9CTUlfMTk4NSU8PiUgYXMubnVtZXJpYwoKQk1JJE5hdGlvbmFsX0JNSV8yMDE3JTw+JSBhcy5udW1lcmljCkJNSSRSdXJhbF9CTUlfMjAxNyU8PiUgYXMubnVtZXJpYwpCTUkkVXJiYW5fQk1JXzIwMTclPD4lIGFzLm51bWVyaWMKCiMgIEFuZCBpZiB3ZSBkaWQgdGhpcyB3ZSB3b3VsZCBzZWUgdGhlc2UgdmFyaWFibGVzIAojICBzaG93IGFzICJudW0iIHdoaWNoIHN0YW5kcyBmb3IgbnVtZXJpYwpzdHIoQk1JKQpgYGAKCk9yIHdlIGNhbiB1c2UgYSBtb3JlIGF1dG9tYXRlZCB3YXkgd2l0aCB0aGUgYG1hcCgpYCBmdW5jdGlvbiBvZiB0aGUgYHB1cnJyYCBwYWNrYWdlOgpgYGB7cn0KQk1JX251bWVyaWMgPC0gYXNfdGliYmxlKHB1cnJyOjptYXAoCiAgKEJNSSAlPiUgc2VsZWN0KC1tYXRjaGVzKCJDSXxTZXh8Q291bnRyeSIpKSksIGFzLm51bWVyaWMpKSAKIyBUaGUgbWFwIGZ1bmN0aW9uIG9mIHRoZSBwdXJyciBwYWNrYWdlIGFsbG93cyB1cyB0byBhcHBseSB0aGUgCiMgYXMubnVtZXJpYygpIGZ1bmN0aW9uIHRvIGFsbCB0aGUgc2VsZWN0ZWQgY29sdW1ucyBvZiBCTUkgCiMgV2UgaGF2ZSBzZWxlY3RlZCB0aG9zZSB0aGF0IGRvbnQgY29udGFpbiBDSSwgU2V4LCBvciBDb3VudHJ5IGluIHRoZSBjb2x1bW4gbmFtZSAKIyBJZiB5b3UgYXJlIGZhbWlsaWFyIHdpdGggYXBwbHkoKSwgdGhpcyBmdW5jdGlvbiBpcyB2ZXJ5IHNpbWlsYXIKQk1JX251bWVyaWMgJTw+JSBtdXRhdGUoQ291bnRyeSA9Qk1JJENvdW50cnksIFNleCA9Qk1JJFNleCkKaGVhZChCTUlfbnVtZXJpYykKIyBJbiB0aGlzIGNhc2Ugb3VyIG51bWVyaWMgZGF0YSBpcyBjbGFzcyBkYmwKIyBUaGlzIG1lYW5zIGRvdWJsZS1wcmVjaXNpb24gZmxvYXRpbmcgcG9pbnQgbnVtYmVycyAod2l0aCBkZWNpbWFscykKIyBUaGUgYWx0ZXJuYXRpdmUgbnVtZXJpYyBvcHRpb24gaXMgdGhlIGludGVnYXIgY2xhc3MKYGBgCgoKSXQgaXMgZ2VuZXJhbGx5IHVzZWZ1bCB0byBnZXQgdGhlIGRhdGEgaW4gd2hhdCBpcyBjYWxsZWQgPGI+bG9uZzwvYj4gZm9ybWF0IGZvciBvdGhlciBhbmFseXNlcywgYW5kIHBhcnRpY3VsYXJseSBmb3IgcGxvdHRpbmcuIAoKRm9yIGEgbW9yZSBkZXRhaWxlZCBkZXNjcmlwdGlvbiBhYm91dCB0aGlzLCBwbGVhc2Ugc2VlIHRoaXMgW2Nhc2Ugc3R1ZHldKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpLgoKQmFzaWNhbGx5IHdoYXQgdGhlIGxvbmcgZm9ybWF0IHdpbGwgaGF2ZSBtb3JlIHJvd3MgYW5kIGZld2VyIGNvbHVtbnMuClRodXMgd2UgY2FuIGNvbWJpbmUgb3IgImdhdGhlciIgc29tZSBjb2x1bW5zIHRvZ2V0aGVyLgpJbiBvdXIgY2FzZSB3ZSBjYW4gcHV0IGFsbCB0aGUgZGlmZmVyZW50IEJNSSBkYXRhIHRvZ2V0aGVyIGluIG9uZSBsb25nIGNvbHVtbi4KV2Ugd2lsbCBjcmVhdGUgYSBuZXcgY29sdW1uIHRoYXQgdGVsbHMgdXMgd2hhdCBlYWNoIHJvdyBvZiB0aGUgbmV3IEJNSSBjb2x1bW4gcmVwcmVzZW50cy4KSW4gb3RoZXIgd29yZHMsIGl0IHdpbGwgdGVsbCB1cyB3aGF0IHRoZSBvcmlnaW5hbCBjb2x1bW4gd2FzLgoKVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYGdhdGhlcigpYCBmdW5jdGlvbiBvZiB0aGUgYHRpZHlyYCBwYWNrYWdlOgoKYGBge3J9CkJNSV9sb25nIDwtdGlkeXI6OmdhdGhlcihkYXRhID1CTUlfbnVtZXJpYywga2V5ID0gY2xhc3NfQk1JLCB2YWx1ZSA9IEJNSSwgTmF0aW9uYWxfQk1JXzE5ODU6VXJiYW5fQk1JXzIwMTcsIGZhY3Rvcl9rZXkgPSBGQUxTRSkgCiMgVGhlIGRhdGEgdmFsdWUgaW5kaWNhdGVzIHdoYXQgZGF0YSB5b3Ugc3RhcnQgd2l0aAojIFRoZSBrZXkgaW5kaWNhdGVzIHRoZSBuZXcgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgd2lsbCBub3cgY29udGFpbiAKIyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdmFsdWVzIG9mIHRoZSBjb2x1bW5zIHdlIHdpbGwgcHV0IHRvZ2V0aGVyCiMgVGhlIHZhbHVlIGlzIHRoZSBuYW1lIG9mIHRoZSBjb2x1bW4gZm9yIHRoZSB2YWx1ZXMgZm9yIAojIGFsbCB0aGUgY29sdW1ucyB0aGF0IGFyZSBiZWluZyBwdXQgdG9nZXRoZXIKIyBUaGUgIjoiIGNhbiBiZSB1c2VkIHRvIGluZGVudGlmeSB0aGUgc3RhcnQgYW5kIGVuZCBvZiB0aGUgY29sdW1uIG5hbWVzCiMgdGhhdCB5b3UgYXJlIHB1dHRpbmcgdG9nZXRoZXIKIyBUaGUgZmFjdG9yX2tleSBwYXJhbWF0ZXIgZGV0ZXJtaW5lcyBpZiB0aGUgbmV3bHkgY3JlYXRlZCBrZXkgY29sdW1uIAojIHNob3VsZCBiZSBldmFsdWF0ZWQgYXMgYSBmYWN0b3Igb3Igbm90CmhlYWQoQk1JX2xvbmcpCmBgYAoKSXQgd291bGQgYmUgdXNlZnVsIHRvIHBhcnNlIHRoZSAxOTg1IGFuZCB0aGUgMjAxNyBkYXRhLiBXZSBjYW4gZG8gc28gYnkgc2VwYXJhdGluZyB0aGUgcGFydHMgb2YgdGhlIGNsYXNzX0JNSSBjb2x1bW4gdXNpbmcgdGhlIGBzZXBhcmF0ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYHRpZHlyYCBwYWNrYWdlLiAKSW4gb3VyIGNhc2Ugd2Ugd2lsbCByZXBsYWNlIHRoZSBjbGFzc19CTUkgY29sdW1uIHdpdGggdHdvIG5ldyBjb2x1bW5zLgoKYGBge3J9CkJNSV9sb25nJTw+JSB0aWR5cjo6c2VwYXJhdGUoY2xhc3NfQk1JLCBjKCJSZWdpb24iLCBOQSwgIlllYXIiKSkgCiMgV2Ugd2lsbCBzZXBhcmF0ZSB0aGUgY2xhc3NfQk1JIGNvbHVtbiBvZiB0aGUgQk1JX2xvbmcgdGliYmxlCiMgVGhpcyBpcyBiYXNlZCBvbiB0aGUgdW5kZXJzY29yZXMgYW5kIGNyZWF0ZSB0d28gbmV3IGNvbHVtbnMKIyBUaGUgZmlyc3QgY29sdW1uIHdpbGwgYmUgY2FsbGVkIFJlZ2lvbgojIEl0IHdpbGwgY29udGFpbiB0aGUgMXN0IHBhcnQgb2YgdGhlIGNsYXNzX0JNSSBkYXRhIGJlZm9yZSB0aGUgMXN0IHVuZGVyc2NvcmUKIyBUaGUgMm5kIGNvbHVtbiB3aWxsIGJlIGNhbGxlZCBZZWFyCiMgSXQgd2lsbCBjb250YWluIHRoZSAzcmQgcGFydCBvZiB0aGUgZGF0YSBiYXNlZCBvbiB1bmRlcnNjb3JlcwojIFRoZSBtaWRkbGUgcGFydCBvZiB0aGUgY29sdW1uIHdpbGwgbm90IGJlIHVzZWQgdG8gY3JlYXRlIGFueSBuZXcgY29sdW1ucwpoZWFkKEJNSV9sb25nKQoKIyBMZXQncyBzZWUgaG93IHRoZSBkaW1lbnNpb25zIG9mIHRoZSBCTUkgZGF0YSBoYXZlIGNoYW5nZWQgaW4gbG9uZyBmb3JtYXQ6CgpkaW0oQk1JX251bWVyaWMpCmRpbShCTUlfbG9uZykKCgpgYGAKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPHU+UXVlc3Rpb24gb3Bwb3J0dW5pdHk6PC91PiBXaHkgZXhhY3RseSBhcmUgdGhlcmUgMiw0MDAgcm93cyBub3c/CgojIyMjCgoKR3JlYXQhIG91ciBkYXRhIGlzIHZlcnkgdXNhYmxlIG5vdyBpbiB0aGlzIGZvcm1hdCEKCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpzYXZlKEJNSV9udW1lcmljLCBCTUlfbG9uZywgZmlsZSA9IGhlcmUoImRhdGEiLCJXcmFuZ2xlZF9kYXRhLnJkYSIpKQoKYGBgCiMjIERhdGEgRXhwbG9yYXRpb24KCk5vdyB0aGF0IG91ciBkYXRhIGlzIGNsZWFuIGFuZCBpbiBhIGZvcm1hdCB0aGF0IHdlIGNhbiB3b3JrIHdpdGgsIHdlIGNhbiBzdGFydCB0byB0YWtlIGEgbG9vayBhdCB0aGUgZGF0YSBhbmQgaG93IGRpZmZlcmVudCBncm91cHMgbWlnaHQgY29tcGFyZS4KClN0YXRpc3RpY2FsbHkgc3BlYWtpbmcgdGhlcmUgYXJlIHRlc3RzIHRoYXQgY2FuIGFsbG93IHVzIHRvIGV2YWx1YXRlIGlmIHRoZSBtZWFucyBvZiB0aGUgZ3JvdXBzIGFyZSBkaWZmZXJlbnQuIEZpcnN0IGxldCdzIHNlZSBob3cgb3VyIGRhdGEgbG9va3MgaW4gZ2VuZXJhbC4KCiMjIyBHZW5lcmFsIHN1bW1hcnkKU3RhcnQgaGVyZSBpZiBub3Qgd29ya2luZyB0aHJvdWdoIGRhdGEgaW1wb3J0IGFuZCB3cmFuZ2xpbmcKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmxvYWQoaGVyZSgiZGF0YSIsICJXcmFuZ2xlZF9kYXRhLnJkYSIpKQpgYGAKCmBgYHtyfQpzdW1tYXJ5KEJNSV9udW1lcmljKQojIFdlIGNhbiBzZWUgdGhhdCB0aGUgbWVhbiAgQk1JIGVzdGltYXRlcyBhcmUgbGFyZ2VyIGluIDIwMTcKIyBJcyB0aGlzIGEgbWVhbmluZ2Z1bCBpbmNyZWFzZT8KYGBgCk9LLCBzbyBvdXIgbWVhbnMgYXJlIGZhaXJseSBzaW1pbGFyLCBidXQgd2UgY2FuIHNlZSBzb21lIGRpZmZlcmVuY2VzLiAKVGhlIHF1ZXN0aW9uIGlzIGlmIHRob3NlIGRpZmZlcmVuY2VzIGFyZSBtZWFuaW5nZnVsLiAKVGhpcyBpcyBkaWZmaWN1bHQgdG8gZGV0ZXJtaW5lIHdpdGhvdXQgYSBzdGF0aXN0aWNhbCB0ZXN0LgoKTGV0cyBsb29rIGF0IHRoZSBkYXRhIHNlcGFyYXRlbHkgYnkgZ2VuZGVyOgoKYGBge3J9CiNXb21lbjoKQk1JX251bWVyaWMgJT4lIAogIHN1YnNldChTZXggPT0gIldvbWVuIikgJT4lIAogIHN1bW1hcnkoKQpgYGAKCmBgYHtyfQojTWVuCkJNSV9udW1lcmljICU+JSAKICBzdWJzZXQoU2V4ID09ICJNZW4iKSAlPiUgCiAgc3VtbWFyeSgpCmBgYAoKSXQgbG9va3MgbGlrZSBtZWFuIEJNSXMgaGF2ZSBpbmNyZWFzZWQgaW4gYWxsIHJlZ2lvbnMgZm9yIGJvdGggbWVuIGFuZCB3b21lbi4gSXQgaXMgdW5jbGVhciB0aG91Z2ggaWYgdGhpcyBjaGFuZ2UgaXMgc3RhdGlzdGljYWxseSBzaWduaWZpY2FudC4KCgojIyMgRGlzdHJpYnV0aW9ucwoKSW4gb3JkZXIgdG8gYXBwbHkgYSBzdGF0aXN0aWNhbCB0ZXN0IHRvIGNvbXBhcmUgdGhlIG1lYW5zLCBvbmUgb2YgdGhlIGZpcnN0IHRoaW5ncyAgdG8gZG8gaXMgdG8gcGxvdCB0aGUgZnJlcXVlbmN5IG9mIHRoZSBkaWZmZXJlbnQgcG9zc2libGUgdmFsdWVzLiBUaGlzIGlzIGNhbGxlZCBhIDxiPmRpc3RyaWJ1dGlvbjwvYj4uIFNlZSBbaGVyZV0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpIGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGRpc3RyaWJ1dGlvbnMuIFRvIHBsb3QgdGhlIGRpc3RyaWJ1dGlvbiBvZiBhIGRhdGFzZXQgd2UgY2FuIHVzZSB0aGUgYGhpc3QoKWAgZnVuY3Rpb24gdG8gY3JlYXRlIGEgaGlzdG9ncmFtLgoKSWYgdGhlIGRhdGEgd2VyZSB3aGF0IHdlIGNhbGwgPGI+bm9ybWFsbHkgZGlzdHJpYnV0ZWQ8L2I+ICBvciAgZm9sbG93ZWQgYSA8Yj4gR2F1c3NpYW4gZGlzdHJpYnV0aW9uIDwvYj4gdGhlbiB0aGUgZGlzdHJpYnV0aW9uIHNob3VsZCBiZSBlcXVhbGx5IGNlbnRlcmVkIGFyb3VuZCB0aGUgbWVhbiBhbmQgd291bGQgbG9vayBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBge3J9Cm5vcm1fQk1JX2V4X2RhdGEgPC0gdGliYmxlKG5vcm1fZGF0YSA9cm5vcm0obiA9IDIwMCwgbWVhbiA9IDI0KSkKIyBUaGUgcm5vcm0oKSBmdW5jdGlvbiBhbGxvd3MgdXMgdG8gbWFrZSBhIHZlY3RvciBvZiBub3JtYWxseSBkaXN0cmlidXRlZCBkYXRhCiMgY2VudGVyZWQgYXJvdW5kIHRoZSBtZWFuIG9mIDI0CmhlYWQobm9ybV9CTUlfZXhfZGF0YSkKaGlzdChub3JtX0JNSV9leF9kYXRhJG5vcm1fZGF0YSkKCmBgYAoKQWx0ZXJuYXRpdmVseSB3ZSBjYW4gcGxvdCB0aGlzIHVzaW5nIHRoZSBgZ2VvbV9oaXN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZS4gVGhlIFtnZ3Bsb3QyXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pIHBhY2thZ2UgY3JlYXRlcyBwbG90cyBieSB1c2luZyBsYXllcnMuIE5vdGljZSBpbiB0aGUgZm9sbG93aW5nIGNvZGUgaG93IHRoZXJlIGlzIGEgcGx1cyBzaWduIGJldHdlZW4gdGhlIGBnZ3Bsb3QoKWAgZnVuY3Rpb24gYW5kIHRoZSBgZ2VvbV9oaXN0b2dyYW0oKWAgZnVuY3Rpb24uIFdpdGggZ2dwbG90MiB3ZSBzZWxlY3Qgd2hhdCBkYXRhIHdlIHdvdWxkIGxpa2UgdG8gcGxvdCB1c2luZyB0aGUgZmlyc3QgZnVuY3Rpb24gKGBnZ3Bsb3QoKWApIGFuZCB0aGVuIHdlIGFkZCBvbiBhZGRpdGlvbmFsIGxheWVycyBvZiBjb21wbGV4aXR5ICh0aGVzZSBsYXllcnMgY2FuIGV2ZW4gaW52b2x2ZSBkaWZmZXJlbnQgZGF0YSkuIEluIHRoaXMgY2FzZSB0aGUgYGdlb21faGlzdHJvZ3JhbSgpYCBmdW5jdGlvbiBpbml0aWF0ZXMgdGhlIHBsb3R0aW5nIG9mIGEgaGlzdG9ncmFtIHdpdGggdGhlIGRhdGEgdGhhdCB3YXMgaWRlbnRpZmllZCBpbiB0aGUgYGdncGxvdCgpYCBmdW5jdGlvbi4gV2Ugd2lsbCBzZWUgbGF0ZXIgaG93IHdlIGNhbiBhZGQgbWFueSBsYXllcnMgdG8gcGxvdHMgd2l0aCBgZ2dwbG90MmAuIEZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9uIHVzaW5nIGdncGxvdDIsIHNlZSB0aGlzIFtjYXNlIHN0dWR5XShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKS4KCmBgYHtyfQpub3JtX0JNSV9leF9kYXRhICU+JSAKICBnZ3Bsb3QyOjpnZ3Bsb3QoYWVzKHggPSBub3JtX2RhdGEpKSArIAogIGdncGxvdDI6Omdlb21faGlzdG9ncmFtKCkgCgojIFdlIGFyZSB1c2luZyB0aGUgY29sdW1uIGNhbGxlZCBub3JtX2RhdGEgd2l0aGluIG5vcm1fQk1JX2V4X2RhdGEKIyBXaXRoIGdncGxvdDIgd2UgbXVzdCBmaXJzdCBzcGVjaWZ5IHRoZSBkYXRhIHdpdGggZ2dwbG90KCkgCiMgVGhlIGdlb21faGlzdG9ncmFtKCkgZnVuY3Rpb24gc3BlY2lmaWVzIHdoYXQgdHlwZSBvZiBwbG90IHRvIGNyZWF0ZQpgYGAKCkxldCdzIHNlZSBob3cgb3VyIGRhdGEgbG9va3M6CmBgYHtyfQpCTUlfbG9uZyU+JSAKICBnZ3Bsb3QoYWVzKHggPSBCTUkpKSArIAogIGdlb21faGlzdG9ncmFtKCkgCmBgYAoKT0ssIHNvIHRoZSBkYXRhIGxvb2tzIGxpa2UgaXQgaXMgd2hhdCB3ZSBjYWxsIDxiPnJpZ2h0LXNrZXdlZDwvYj4gYmVjYXVzZSB0aGUgdGFpbCBvZiB0aGUgZGlzdHJpYnV0aW9uIGlzIGxvbmdlciBvbiB0aGUgcmlnaHQgc2lkZSAoaW4gb3RoZXIgd29yZHMsIGl0IGlzIGEgYml0IHdpZGVyIG9uIHRoYXQgc2lkZSksIGJ1dCBpdCBsb29rcyBmYWlybHkgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuIFNlZSBbaGVyZV0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2dsb3NzYXJ5L3NrZXcuaHRtbCkgZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgc2tld2VkIGRpc3RyaWJ1dGlvbnMuCgpJZiB3ZSBwYXJzZSBvdXIgZGF0YSwgd2hhdCBkb2VzIGl0IGxvb2sgbGlrZT8gVGhlIGVhc2llc3Qgd2F5IHRvIGRvIHRoaXMgaXMgdG8gdXNlIHNvbWUgb3RoZXIgZnVuY3Rpb25zIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZSwgcGFydGljdWxhcmx5IHRoZSBgZmFjZXRfd3JhcCgpYCBmdW5jdGlvbiwgd2hpY2ggd2lsbCBhbGxvdyB1cyB0byBsb29rIGF0IGRpZmZlcmVuY2VzIGluIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIEJNSSBkYXRhIGJ5IHllYXIsIGdlbmRlciwgYW5kIHJlZ2lvbi4gV2UgY2FuIHNlcXVlbnRpYWxseSBkaXZpZGUgb3VyIHBsb3RzIGJ5IGRlZXBlciBsZXZlbHMgdXNpbmcgbXVsdGlwbGUgdmFyaWFibGVzIGFuZCB0aGUgYCtgIHBsdXMgc2lnbiB3aXRoaW4gYGZhY2V0X3dyYXAoKWAuCgpgYGB7ciwgZXZhbCA9IFRSVUV9CkJNSV9sb25nICU+JQogIGdncGxvdChhZXMoeD1CTUkpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCkKCkJNSV9sb25nICU+JQogIGdncGxvdChhZXMoeD1CTUkpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFllYXIpIAoKQk1JX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyh4PUJNSSkpICsKICBnZW9tX2hpc3RvZ3JhbSgpICsKICBmYWNldF93cmFwKH4gU2V4ICsgWWVhciArIFJlZ2lvbikgCgpgYGAKCk9LLCBzbyBzb21lIG9mIHRoZXNlIHBsb3RzIGxvb2sgcHJldHR5IHNpbWlsYXIgdG8gb3VyIG5vcm1hbCBkaXN0cmlidXRpb24gcGxvdCwgbGlrZSB0aGUgV29tZW4gMjAxNyBVcmJhbiBwbG90IChhbHRob3VnaCBpdCBpcyByaWdodC1za2V3ZWQpLgpIb3dldmVyIHNvbWUgb2YgdGhlIG90aGVyIHBsb3RzLCBsaWtlIHRoZSBNZW4gMjAxNyBVcmJhbiBwbG90LCBsb29rIHZlcnkgZGlmZmVyZW50LiBUaGVzZSBwbG90cyBzaG93IHdoYXQgaXMgY2FsbGVkIGEgW2JpbW9kYWwgZGlzdHJpYnV0aW9uXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCksIG1lYW5pbmcgdGhhdCB0aGVyZSBhcHBlYXIgdG8gYmUgdHdvIHBlYWtzLCBvciBpbiBvdGhlciB3b3JkcyB0d28gZGlmZmVyZW50IHZhbHVlcyAoYW5kIHZhbHVlcyBuZWFyIGVhY2ggb2YgdGhlc2UpIHRoYXQgYXJlIHRoZSBtb3N0IGZyZXF1ZW50LgoKIyMjIFF1YW50aWxlLVF1YW50aWxlIFBsb3RzCgpMZXQncyB1c2UgYSBtZXRob2QgY2FsbGVkIHRoZSAgcXVhbnRpbGUtcXVhbnRpbGUgcGxvdCB0byBkZXRlcm1pbmUgaWYgdGhlIGRhdGEgaXMgaW5kZWVkIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLiBUaGVzZSBwbG90cyBhcmUgY2FsbGVkIDxiPlEtUSBwbG90czwvYj4uIFRoaXMgbWV0aG9kIGFsbG93cyB1cyB0byB0ZXN0IHRoZSBmaXQgb2Yga25vd24gdGhlb3JldGljYWwgZGlzdHJpYnV0aW9ucyAobGlrZSB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbikgd2l0aCBvdXIgb2JzZXJ2ZWQgZGlzdHJpYnV0aW9uLiBUbyBkbyB0aGlzIHdlIHdpbGwgcGxvdCB0aGUgcXVhbnRpbGVzIG9mIG91ciBkYXRhIG9uIHRoZSB5LWF4aXMgYW5kIHRoZSBxdWFudGlsZXMgb2YgdGhlIHRoZW9yZXRpY2FsIG5vcm1hbCBkaXN0cmlidXRpb24gb24gdGhlIHgtYXhpcy4gSWYgdGhlIHF1YW50aWxlcyBsaW5lIHVwIHRoZW4gd2UgY2FuIHNheSB0aGF0IG91ciBkYXRhIGlzIGZhaXJseSBub3JtYWwuIFdoYXQgZXhhY3RseSBpcyBhIDxiPnF1YW50aWxlPC9iPj8gVGhpcyBpcyBhIGRpdmlzaW9uIG9mIHRoZSBkYXRhIGRpc3RyaWJ1dGlvbiBpbnRvIHJvdWdobHkgZXF1YWwgcG9ydGlvbnMuIFNlZSBbaGVyZV0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2FkdmFuY2VkX2dyYXBocy9xLXFfcGxvdHMuaHRtbCkgZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgUS1RIHBsb3RzLgoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgUS1RIHBsb3QgZm9yIHRoZSBub3JtYWxseSBkaXN0cmlidXRlZCBkYXRhIHRoYXQgd2UganVzdCBjcmVhdGVkIHVzaW5nIHRoZSBgc3RhdF9xcSgpYCBmdW5jdGlvbiBvZiAgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlOgoKYGBge3J9Cgpub3JtX0JNSV9leF9kYXRhICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1ub3JtX2RhdGEpKSArCiAgc3RhdF9xcSgpICsgIyB0byBhZGQgdGhlIGxpbmUgd2UgbmVlZCB0byBhbHNvIGluY2x1ZGUgc3RhdF9xcV9saW5lKCkKICBzdGF0X3FxX2xpbmUoKQoKCgpgYGAKCkhlcmUgd2UgY2FuIHNlZSB0aGF0IHRoZSBxdWFudGlsZXMgYXJlIGZhaXJseSBzaW1pbGFyIGJldHdlZW4gdGhlIG9ic2VydmVkIGFuZCB0aGVvcmV0aWNhbCBkYXRhLiBXZSBzZWUgdGhhdCB0aGUgcG9pbnRzIG1vc3RseSBmYWxsIG9uIHRoZSBsaW5lLCBob3dldmVyIHRoZXJlIGFyZSBzb21lIHBvaW50cyB0aGF0IGFyZSBhIGJpdCBmdXJ0aGVyIGZyb20gdGhlIGxpbmUgYXMgd2UgZ2V0IHRvIHRoZSBleHRyZW1lIHF1YW50aWxlcy4gTm90aWNlIHRoYXQgdGhlIHNhbXBsZSBxdWFudGlsZXMgKHdoaWNoIHdpbGwgYmUgZmFpcmx5IHNpbWlsYXIgdG8gb3VyIHJlYWwgQk1JIGRhdGEgcXVhbnRpbGVzKSBvbiB0aGUgeS1heGlzIGhhcyB0aGUgc2FtZSByYW5nZSBhcyB0aGUgdmFsdWVzIHRoYXQgd2UgY3JlYXRlZC4gU28gdmFsdWVzIHRoYXQgYXJlIGJlbGxvdyAyMiBmb3IgZXhhbXBsZSBhcmUgcmVwcmVzZW50ZWQgYXMgdGhlIHBvaW50cyBiZWxsb3cgMjIgb24gdGhlIHktYXhpcy4gQXMgZXhwZWN0ZWQgd2Ugc2VlIHRoYXQgYWJvdXQgaGFsZiB0aGUgcG9pbnRzIGFyZSBiZWxsb3cgb3VyIG1lYW4gb2YgMjQuCgpJZiB3ZSB3ZXJlIHRvIHVzZSBkaWZmZXJlbnQgZGF0YSB0aGF0IGhhZCBhIHJhbmdlIG9mIGRpZmZlcmVudCB2YWx1ZXMgb3VyIHktYXhpcyB3b3VsZCBzaGlmdCBhY2NvcmRpbmcgdG8gdGhlIHJhbmdlIG9mIHZhbHVlcy4gRm9yIGV4YW1wbGUgdGhlIE9yYW5nZSBkYXRhIHdpdGhpbiB0aGUgaW5zdGFsbGF0aW9uIG9mIFIgaW5jbHVkZXMgZGF0YSBhYm91dCB0aGUgY2lyY3VtZmVyZW5jZSBvZiBvcmFuZ2UgdHJlZXMgaW4gbWlsbGltZXRlcnMuIEhlcmUgd2UgY2FuIHNlZSB0aGF0IHRoZSBxdWFudGlsZXMgYXJlIHF1aXRlIGRpZmZlcmVudCBidXQgcmVmbGVjdCB0aGUgcmFuZ2Ugb2Ygb3JhbmdlIHRyZWUgY2lyY3VtZmVyZW5jZXMuCmBgYHtyfQpyYW5nZShPcmFuZ2UkY2lyY3VtZmVyZW5jZSkKT3JhbmdlJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPWNpcmN1bWZlcmVuY2UpKSArCiAgc3RhdF9xcSgpICsgIyB0byBhZGQgdGhlIGxpbmUgd2UgbmVlZCB0byBhbHNvIGluY2x1ZGUgc3RhdF9xcV9saW5lKCkKICBzdGF0X3FxX2xpbmUoKQpgYGAKCgpMZXQncyB0YWtlIGEgbG9vayBhdCBvdXIgQk1JIGRhdGE6CgpgYGB7cn0KCkJNSV9sb25nICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1CTUkpKSArCiAgc3RhdF9xcSgpICsgIyB0byBhZGQgdGhlIGxpbmUgd2UgbmVlZCB0byBhbHNvIGluY2x1ZGUgc3RhdF9xcV9saW5lKCkKICBzdGF0X3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFllYXIgKyBSZWdpb24pCmBgYApUaGlzIGlzIGEgbGl0dGxlIGhhcmQgdG8gc2VlLCBzb21lIHBsb3RzIGxvb2sgcHJldHR5IGdvb2QsIGJ1dCB3aGlsZSBvdGhlcnMgc2VlbSB0byBiZSBza2V3ZWQsIGxldHMgdGFrZSBhIGNsb3NlciBsb29rLgoKRm9yIHRoZSBzYWtlIG9mIHNpbXBsaWNpdHksIHdlIGFyZSBnb2luZyB0byBmb2N1cyBvbiB0aGUgZGF0YSBmcm9tIHRoZSB3b21lbi4gIFRoaXMgaXMgYmVjYXVzZSB3b21lbiB3ZXJlIGlkZW50aWZpZWQgaW4gdGhlIHBhcGVyIHRvIGhhdmUgbGFyZ2VyIGluY3JlYXNlcyBpbiBCTUkuIElmIHdlIHdhbnQgdG8gcGVyZm9ybSB0ZXN0cyBvbiB0aGVzZSBncm91cHMgKHdvbWVuIGluIGVhY2ggcmVnaW9uIGFuZCB5ZWFyKSBzcGVjaWZpY2FsbHksIHRoZW4gd2UgbmVlZCB0byBsb29rIGF0IHRoZSBkaXN0cmlidXRpb24gb2YgZWFjaCBvZiB0aGVzZSBzdWJzZXRzLgoKYGBge3J9CgpCTUlfbG9uZyAlPiUKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1CTUkpKSArCiAgc3RhdF9xcSgpICsgIyB0byBhZGQgdGhlIGxpbmUgd2UgbmVlZCB0byBhbHNvIGluY2x1ZGUgc3RhdF9xcV9saW5lKCkKICBzdGF0X3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IFllYXIgKyBSZWdpb24pCmBgYAoKCgpXZSBjYW4gc2VlIHRoYXQgYXQgdGhlIGV4dHJlbWVzIG9mIG91ciBxdWFudGlsZXMsIGZvciBtb3N0IG9mIG91ciBkYXRhLCBvdXIgdGFpbHMgYXJlIG5vdCB2ZXJ5IHNpbWlsYXIgdG8gdGhlIHRoZW9yZXRpY2FsIGRpc3RyaWJ1dGlvbi4gV2UgY2FuIGNhbiBhbHNvIGRldGVybWluZSB0aGF0IG91ciBkYXRhIGlzIHJpZ2h0LSBvciBwb3NpdGl2ZS1za2V3ZWQgYmVjYXVzZSB0aGUgZXh0cmVtZSB2YWx1ZXMgYXJlIGFib3ZlIHRoZSBsaW5lIHRoYXQgaW5kaWNhdGVzIGEgcGVyZmVjdCBtYXRjaCBiZXR3ZWVuIHRoZSB0aGVvcmV0aWNhbCBhbmQgb2JzZXJ2ZWQgZGF0YS4KCiBUaGUgcnVyYWwgZGF0YSBsb29rcyBtb3JlIG5vcm1hbCB0aGFuIHRoZSB1cmJhbiBkYXRhLCBidXQgaWYgd2Ugd2VyZSB0byB1c2Ugc3RhdGlzdGljYWwgdGVzdHMgdGhhdCByZWx5IG9uIG5vcm1hbGl0eSwgdGhpcyB3b3VsZCByZXF1aXJlIHRoYXQgYm90aCBncm91cHMgYXJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLiAKIApGaW5hbGx5LCBzb21lIHN0YXRpc3RpY2lhbnMgYWxzbyB1c2UgdGhlIFtTaGFwaXJvLVdpbGsgdGVzdCBmb3Igbm9ybWFsaXR5XShodHRwOi8vd3d3LnN0YXRpc3RpY3M0dS5pbmZvL2Z1bmRzdGF0X2VuZy9lZV9zaGFwaXJvX3dpbGtfdGVzdC5odG1sKSB3aGVuIHRoZSBRLVEgcGxvdCBpcyBhIGJpdCB1bmNsZWFyLiBNYW55IHN0YXRpc3RpY2lhbnMgaG93ZXZlciB3b3VsZCBjb25jbHVkZSBmcm9tIHRoZSBRLVEgcGxvdHMgdGhhdCBub3JtYWxpdHkgYXBwZWFycyB0byBiZSB2aW9sYXRlZCBpbiBvdXIgZGF0YS4gCgojIyMgU2hhcGlyby1XaWxrIHRlc3QKCkZvciBpbGx1c3RyYXRpdmUgcHVycG9zZXMgd2Ugd2lsbCBzaG93IGhvdyB3ZSBjYW4gdXNlIHRoZSBgZHBseXJgIGBzdW1tYXJpemUoKWAgYW5kIGBncm91cF9ieSgpYCBmdW5jdGlvbnMgdG8gcGVyZm9ybSB0aGUgU2hhcGlyby1XaWxrIHRlc3QgZm9yIGFsbCB0aGUgc3Vic2V0cyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4KCmBgYHtyfQoKbm9ybV9CTUlfZXhfZGF0YSRub3JtX2RhdGEgJT4lIAogIHNoYXBpcm8udGVzdCgpIAojIGV4YW1wbGUgb2YgdGhlIHRlc3Qgb3V0cHV0IGZvciBub3JtYWwgZGF0YSAtIHRoZSBwIHZhbHVlIGlzIG5vdCA8IDAuMDUKCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JSAKICBncm91cF9ieShZZWFyLCBSZWdpb24pICU+JSAKICBzdW1tYXJpemUoc2hhcGlyb190ZXN0ID0gc2hhcGlyby50ZXN0KEJNSSkkcC52YWx1ZSkKCmBgYAoKV2Ugc2VlIHRoYXQgYWxsIHRoZSBkYXRhIGRvZXMgbm90IGFwcGVhciB0byBiZSBub3JtYWxseSBkaXN0cmlidXRlZC4KCiMjIERhdGEgQW5hbHlzaXMKCldlIGNhbiB1c2Ugc3RhdGlzdGljYWwgdGVzdHMgbGlrZSB0aGUgW3N0dWRlbnQgdC10ZXN0XShodHRwczovL3N0YXR0cmVrLmNvbS9zdGF0aXN0aWNzL2RpY3Rpb25hcnkuYXNweD9kZWZpbml0aW9uPXR3by1zYW1wbGUlMjB0LXRlc3QpIHRvIGRldGVybWluZSBpZiBbdHdvIG1lYW5zIGFyZSBzaWduaWZpY2FudGx5IGRpZmZlcmVudF0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2VzdGltYXRpb24vZGlmZmVyZW5jZV9tZWFucy5odG1sKS4KCiMjIyBIeXBvdGhlc2lzIHRlc3RpbmcKV2l0aCB0aGUgdC10ZXN0LCB3ZSBwZXJmb3JtIHdoYXQgaXMgY2FsbGVkIDxiPiB0d28gbWVhbnMgaHlwb3RoZXNpcyB0ZXN0cyA8L2I+LgpXZSBkZWZpbmUgd2hhdCBpcyBjYWxsZWQgdGhlIDxiPiBudWxsIGh5cG90aGVzaXMgPC9iPiwgd2hpY2ggaXMgd2hhdCB3ZSBhc3N1bWUgYnkgZGVmYXVsdCBvciB0aGUgYmFzZWxpbmUsIHRoYXQgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBpbiB0aGUgdHdvIG1lYW5zOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhvOiDOvDEgPSDOvDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgzrwxIGlzIHRoZSB0cnVlIG1lYW4gb2Ygb25lIGdyb3VwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDOvDIgaXMgdGhlIHRydWUgbWVhbiBvZiB0aGUgb3RoZXIgZ3JvdXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApUaHVzIGxpa2UgaW4gbGF3LCB3ZSBmYWlsIHRvIHJlamVjdCB0aGUgbnVsbCB0aGlzIG51bGwgaHlwb3RoZXNpcywgdW5sZXNzIHdlIGhhdmUgZW5vdWdoIGV2aWRlbmNlIHRvIHN1Z2dlc3QgdGhhdCB3ZSBzaG91bGQgcmVqZWN0IGl0IC0gc2ltaWxhcmx5IHRvIHRoZSBpZGVhIHRoYXQgd2UgYnkgZGVmYXVsdCBhc3N1bWUgdGhhdCBpbmRpdmlkdWFscyBhcmUgbm90IGd1aWx0eSB1bnRpbCBwcm92ZW4gb3RoZXJ3aXNlLiBJZiB3ZSByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcywgd2UgdGhlbiBhY2NlcHQgYW4gPGI+IGFsdGVybmF0aXZlIGh5cG90aGVzaXMgPC9iPiwgdGhpcyBjYW4gdmFyeSBmb3IgZGlmZmVyZW50IHN0YXRpc3RpY2FsIHRlc3RzLCBidXQgaW4gdGhlIGNhc2Ugb2YgdGhlIHQtdGVzdCB3ZSBldmFsdWF0ZSBpZiB0aGUgdHdvIG1lYW5zIGFyZSBub3QgZXF1YWw6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhhOiDOvDEg4omgIM68MgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgClJlbWVtYmVyIHRoYXQgd2UgY2FuJ3Qga25vdyB0aGUgdHJ1ZSBtZWFuIGZvciBvdXIgcG9wdWxhdGlvbnMgb2YgaW50ZXJlc3QsIGluc3RlYWQgd2UgYXBwcm94aW1hdGUgb3IgZXN0aW1hdGUgb3VyIG1lYW5zIGJhc2VkIG9uIHRoZSBzYW1wbGUgdGhhdCB3ZSBoYXZlIGluIG91ciBkYXRhLgoKV2hlbiB3ZSB1c2UgYSBzdGF0aXN0aWNhbCB0ZXN0IHRvIGV2YWx1YXRlIGh5cG90aGVzZXMgbGlrZSB0aGVzZSwgd2UgdXNlIHdoYXQgd2UgY2FsbCB0aGUgcC12YWx1ZS4gVGhlIHAtdmFsdWUgaXMgYSBtZWFzdXJlIG9mIHRoZSBzdHJlbmd0aCBvZiB0aGUgZXZpZGVuY2UgZm9yIG91ciBudWxsIGh5cG90aGVzaXMuIEl0IGlzIGNvbW1vbiBwcmFjdGljZSB0byBjb25zaWRlciBhIHAtdmFsdWUgPCAwLjA1IGEgc3Ryb25nIGVub3VnaCBldmlkZW5jZSBhZ2FpbnN0IHRoZSBudWxsIGh5cG90aGVzaXMgdG8gcmVqZWN0IGl0LiBBbHRlcm5hdGl2ZWx5IGlmIHRoZSBwLXZhbHVlID4gMC41IHRoZW4gdGhlcmUgaXMgbm90IGVub3VnaCBldmlkZW5jZSB0byByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcy4gV2Ugd2lsbCB1c2UgdGhlIHAtdmFsdWVzIGZyb20gb3VyIHN0YXRpc3RpY2FsIHRlc3RzIHRvIGRlY2lkZSBob3cgdG8gaW50ZXJwcmV0IHRoZSByZXN1bHRzIG9mIG91ciB0ZXN0cy4KICAgIAoKV2UgYXJlIGludGVyZXN0ZWQgaW4gY29tcGFyaW5nIHRoZSBtZWFucyBvZiBmZW1hbGUgcnVyYWwgYW5kIHVyYmFuIEJNSSBtZWFzdXJlbWVudHMgZm9yIGJvdGggeWVhcnMuIAoKVGhlcmUgYXJlIHR3byBwb3NzaWJsZSBjbGFzc2VzIG9mIHN0YXRpc3RpY2FsIHRlc3RzIHRoYXQgd2UgY291bGQgcnVuIHRvIGNvbXBhcmUgdGhlIG1lYW5zIG9mIHRoZXNlIHR3byBncm91cHM6CgoxKSBQYXJhbWV0cmljCjIpIE5vbnBhcmFtZXRyaWMKClBhcmFtZXRyaWMgdGVzdHMgYXJlIGJhc2VkIG9uIGFzc3VtcHRpb25zIGFib3V0IHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIGRhdGEsIHdoaWxlIE5vbnBhcmFtZXRyaWMgdGVzdHMgZG8gbm90IHJlbHkgb24gdGhpcyBhc3N1bXB0aW9uLiBJdCBpcyBjYWxsZWQgInBhcmFtZXRyaWMiIGJlY2F1c2UgYXNwZWN0cyBhYm91dCB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBkYXRhIGxpa2UgdGhlIG1lYW4gYXJlIGNhbGxlZCA8Yj5wYXJhbWV0ZXJzPC9iPiB3aGVuIHdlIGRlc2NyaWJlIGEgcG9wdWxhdGlvbi4gSW4gcGFyYW1ldHJpYyB0ZXN0cyB3ZSBlc3RpbWF0ZSB0aGUgcGFyYW1ldGVycyBvZiB0aGUgdHJ1ZSBwb3B1bGF0aW9uIG9mIGludGVyZXN0IHVzaW5nIGEgc2FtcGxlIG9mIHRoYXQgcG9wdWxhdGlvbi4gVGhlc2UgZXN0aW1hdGVzIGFyZSBjYWxsZWQgPGI+c3RhdGlzdGljczwvYj4uIFNlZSBbaGVyZV0oaHR0cHM6Ly93d3cubWF5by5lZHUvcmVzZWFyY2gvZG9jdW1lbnRzL3BhcmFtZXRyaWMtYW5kLW5vbnBhcmFtZXRyaWMtZGVteXN0aWZ5aW5nLXRoZS10ZXJtcy9kb2MtMjA0MDg5NjApIGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlc2UgdHdvIGNsYXNzZXMgb2YgdGVzdHMuCgojIyMgUGFyYW1ldHJpYyB0d28gc2FtcGxlIG1lYW4gdGVzdHMKCk9mdGVuIHdoZW4gY29tcGFyaW5nIHR3byBncm91cHMgd2UgbWlnaHQgcGVyZm9ybSBhIHR3byBzYW1wbGUgdC10ZXN0IHRvIGRldGVybWluZSBpZiB0aGUgbWVhbnMgb2YgZWFjaCBncm91cCBpcyBkaWZmZXJlbnQuIFRoZSB0d28gc2FtcGxlIHQtdGVzdCBob3dldmVyLCByZWxpZXMgb24gc2V2ZXJhbCA8dT48Yj5hc3N1bXB0aW9uczwvYj48L3U+OgoKMSkgVGhlIGRhdGEgZm9yIGJvdGggZ3JvdXBzIGlzIFtub3JtYWxseSBkaXN0cmlidXRlZF0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpCjIpIFRoZSBbdmFyaWFuY2VdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dmFyaWFuY2UpIG9mIGJvdGggZ3JvdXBzIGlzIHNpbWlsYXIKMykgVGhlIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgaXMgc2ltaWxhciBmb3IgYm90aCBncm91cHMgLSB0aHVzIHRoZXkgYXJlIFtiYWxhbmNlZF0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vYmFsYW5jZWQtYW5kLXVuYmFsYW5jZWQtZGVzaWducy8pCjQpIFRoZSBvYnNlcnZhdGlvbnMgYXJlIFtpbmRlcGVuZGVudF0oaHR0cHM6Ly93d3cuc3RhdC5jbXUuZWR1L35jc2hhbGl6aS8zNi0yMjAvbGVjdHVyZS01LnBkZikgKG1lYW5pbmcgdGhhdCBvYnNlcnZhdGlvbnMgZG8gbm90IGluZmx1ZW5jZSBlYWNoIG90aGVyKQoKSWYgdGhlc2UgYXNzdW1wdGlvbnMgYXJlIHZpb2xhdGVkLCB0aGlzIGRvZXNuJ3QgbmVjZXNzYXJpbHkgbWVhbiB3ZSBjYW4ndCBwZXJmb3JtIGEgdC10ZXN0LiBJdCBqdXN0IG1lYW5zIHdlIG1heSBuZWVkIHRvIGNvbnNpZGVyIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKCjEpIFtUcmFuc2Zvcm1hdGlvbl0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vdHJhbnNmb3JtYXRpb24tc3RhdGlzdGljcy8pIG9mIHRoZSBkYXRhIHRvIG1ha2UgaXQgbW9yZSBub3JtYWxseSBkaXN0cmlidXRlZAoyKSBbV2VsY2gncyB0LXRlc3RdKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL3dlbGNocy10ZXN0LWZvci11bmVxdWFsLXZhcmlhbmNlcy8pIGFsc28gY2FsbCB0aGUgdW5lcXVhbCB2YXJpYW5jZSB0LXRlc3Qgd2UgbWF5IG5lZWQgdG8gbW9kaWZ5IHRoZSB3YXkgd2UgcGVyZm9ybSB0aGUgW3QtdGVzdF0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj10d28tc2FtcGxlJTIwdC10ZXN0KSB0byBhY2NvdW50IGZvciB0aGUgZGlmZmVyZW5jZSBpbiB0aGUgdmFyaWFuY2UgaW4gdGhlIHR3byBncm91cHMKMykgW1Blcm11dGF0aW9uL3Jlc2FtcGxpbmcgbWV0aG9kc10oaHR0cHM6Ly9qaHUtYWR2ZGF0YXNjaS5naXRodWIuaW8vMjAxOS9sZWN0dXJlcy8yMS1yZXNhbXBsaW5nLXRlY2huaXF1ZXMuaHRtbCkgdG8gZGVhbCB3aXRoIHZpb2xhdGlvbnMgb2Ygbm9ybWFsaXR5IG9yIGltYmFsYW5jZS4KCkFsdGVybmF0aXZlbHksIHdlIGNhbiB1c2UgYSBub25wYXJhbWV0cmljIHRlc3Qgd2hpY2ggaXMgbW9kZWwgZnJlZSBhbmQgZG9lcyBub3QgcmVseSBvbiBhc3N1bXB0aW9ucyBhYm91dCB0aGUgcGFyYW1ldGVycyBvZiB0aGUgZGF0YS4gVGhlc2UgdGVzdHMgYXJlIG9mdGVuIGEgZ29vZCBvcHRpb24gd2hlbiBtdWx0aXBsZSBhc3N1bXB0aW9ucyBhcmUgdmlvbGF0ZWQgYXJlIHdoZW4gc2FtcGxlIHNpemVzIGFyZSBzbWFsbC4gV2Ugd2lsbCBleHBsb3JlIHRoZXNlIG9wdGlvbnMuCgpPdXIgZGF0YSBoYXMgYSBiYWxhbmNlIG9mIG9ic2VydmF0aW9ucyBmb3IgYm90aCBncm91cHMgLSBpbiBmYWN0IHRoZXkgYXJlIGVxdWFsLCB0aHVzIHRoYXQgYXNzdW1wdGlvbiBpcyBub3QgdmlvbGF0ZWQuCklmIGl0IHdlcmUgdmlvbGF0ZWQsIHdlIHdvdWxkIHdhbnQgdG8gY29uc2lkZXIgdXNpbmcgcGVybXV0YXRpb24gbWV0aG9kcyB3aGljaCBhcmUgYWxzbyBhIGdvb2Qgb3B0aW9uIGZvciB2aW9sYXRpb25zIG9mIG5vcm1hbGl0eS4gVG8gbGVhcm4gbW9yZSBhYm91dCB0aGVzZSBtZXRob2RzIHNlZSBbaGVyZV0oaHR0cHM6Ly9qaHUtYWR2ZGF0YXNjaS5naXRodWIuaW8vMjAxOS9sZWN0dXJlcy8yMS1yZXNhbXBsaW5nLXRlY2huaXF1ZXMuaHRtbCkuCgpJZiB3ZSBuZWVkZWQgdG8gY2hlY2sgaWYgb3VyIHNhbXBsZXMgd2VyZSBpbWJhbGFuY2VkLCB3ZSBjb3VsZCB1c2UgdGhlIGB0YWJsZSgpYCBmdW5jdGlvbjoKCmBgYHtyfQp0YWJsZShCTUlfbG9uZyRTZXgsIEJNSV9sb25nJFJlZ2lvbiwgQk1JX2xvbmckWWVhcikKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgZm9yIGVhY2ggcG9zc2libGUgZ3JvdXAgb2YgaW50ZXJlc3QgaXMgdGhlIHNhbWUuCgpUaGUgdC10ZXN0IGlzIGFsc28gZmFpcmx5IHJvYnVzdCB0byBub24tbm9ybWFsaXR5IGlmIHRoZSBkYXRhIGlzIHJlbGF0aXZlbHkgbGFyZ2UsIGR1ZSB0byB3aGF0IGlzIGNhbGxlZCB0aGUgW2NlbnRyYWwgbGltaXQgdGhlb3JlbV0oaHR0cHM6Ly93d3cuYW5hbHl0aWNzdmlkaHlhLmNvbS9ibG9nLzIwMTkvMDUvc3RhdGlzdGljcy0xMDEtaW50cm9kdWN0aW9uLWNlbnRyYWwtbGltaXQtdGhlb3JlbS8pLCB3aGljaCBzdGF0ZXMgdGhhdCBhcyBzYW1wbGVzIGdldCBsYXJnZXIsIHRoZXkgYXBwcm94aW1hdGUgYSBub3JtYWwgZGlzdHJpYnV0aW9uLgoKV2UgaGF2ZSBhbiBuIG9mIDIwMCwgd2hpY2ggc2hvdWxkIGJlIHN1ZmZpY2llbnQgYnV0IGxldCdzIGludmVzdGlnYXRlIHRoZSBub25wYXJhbWV0cmljIHRlc3RzIGZ1cnRoZXIuIAoKCk9mdGVuIHdlIHdvdWxkIGNoZWNrIGlmIHRoZSB2YXJpYW5jZSBvZiB0aGUgcnVyYWwgYW5kIHVyYmFuIGRhdGEgaXMgZXF1YWwgdXNpbmcgdGhlIGB2YXIudGVzdCgpYCBmdW5jdGlvbi4gSG93ZXZlciB0aGlzIGlzIGFuIEYgdGVzdCBhbmQgYXNzdW1lcyB0aGF0IHRoZSBkYXRhIGlzIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLiBJbnN0ZWFkIHdlIHdpbGwgdXNlIHRoZSBgbW9vZC50ZXN0KClgIGZ1bmN0aW9uIHdoaWNoIHBlcmZvcm1zIHRoZSBbTW9vZCdzIHR3by1zYW1wbGUgdGVzdCBmb3IgYSBkaWZmZXJlbmNlIGluIHNjYWxlIHBhcmFtZXRlcnNdKGh0dHBzOi8vZmlsZXMuZXJpYy5lZC5nb3YvZnVsbHRleHQvRUQwNjU1NTkucGRmKSBhbmQgZG9lcyBub3QgYXNzdW1lIHRoYXQgdGhlIGRhdGEgaXMgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuIFdlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGBwdWxsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuCgpgYGB7cn0KCiNwdWxsKCkgd2lsbCBhbGxvdyB1cyB0byB0YWtlIHRoZSBCTUkgY29sdW1uIGFmdGVyIHdlIGZpbHRlciBCTUlfbG9uZwoKbW9vZC50ZXN0KGRwbHlyOjpwdWxsKGZpbHRlcihCTUlfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgICAgZHBseXI6OnB1bGwoZmlsdGVyKEJNSV9sb25nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpKQojIHAgdmFsdWUgPC4wNSwgY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBub3QgZXF1YWwKIyByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIHNwcmVhZCBvZiB0aGUgZGlzdHJpYnV0aW9ucwoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpKQojIHAgdmFsdWUgPC4wNSwgY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBub3QgZXF1YWwKIyByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIHZhcmlhbmNlIG9mIHRoZSBkaXN0cmlidXRpb25zCgptb29kLnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLCAKICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSkpCiMgcCB2YWx1ZSA+LjA1LCBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIGVxdWFsCiMgZmFpbCB0byByZWplY3QgdGhlIG51bGwgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIHZhcmlhbmNlIG9mIHRoZSBkaXN0cmlidXRpb25zCgptb29kLnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLCAKICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSkpCiMgcCB2YWx1ZSA+LjA1LCBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIGVxdWFsCiMgZmFpbCB0byByZWplY3QgdGhlIG51bGwgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIHZhcmlhbmNlIG9mIHRoZSBkaXN0cmlidXRpb25zCgpgYGAKCk91ciBwIHZhbHVlIGlzIGxlc3MgdGhhbiAuMDUgZm9yIGJvdGggdGVzdHMsIHRodXMgd2UgcmVqZWN0IG91ciBudWxsIGh5cG90aGVzaXMgdGhhdCB0aGVyZSBpcyBubyBkaWZmZXJlbmNlIGluIHRoZSB2YXJpYW5jZS4gVGhlcmVmb3JlLCB3ZSBjb25jbHVkZSB0aGF0IHRoZSB2YXJpYW5jZSBpcyBub3QgZXF1YWwgYW5kIHRoYXQgb3VyIGRhdGEgYWxzbyB2aW9sYXRlcyB0aGlzIGFzc3VtcHRpb24uCgpXZSB3aWxsIHBlcmZvcm0gYSBzcGVjaWFsIHQudGVzdCB3aGVyZSB3ZSBhY2NvdW50IGZvciB0aGUgZmFjdCB0aGF0IG91ciB2YXJpYW5jZSBpcyBub3QgZXF1YWwuIAoKQW5vdGhlciBpbXBvcnRhbnQgY29uc2lkZXJhdGlvbiBpcyB0aGF0IHRoZSBkYXRhIGlzIHdoYXQgd2UgY2FsbCBbcGFpcmVkXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM1NTc5NDY1LyksIG1lYW5pbmcgdGhhdCB0aGUgbWVhc3VyZW1lbnRzIGZyb20gdGhlIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcyBhcmUgbm90IGluZGVwZW5kZW50LiBUaGF0IGlzIGJlY2F1c2Ugd2UgaGF2ZSBhIHJ1cmFsIGFuZCB1cmJhbiBtZWFzdXJlbWVudCBtZWFuIGZvciBuZWFybHkgZXZlcnkgY291bnRyeS4gVGh1cyB0aGVzZSB2YWx1ZXMgbWF5IGJlIG1vcmUgc2ltaWxhciB0byBvbmUgYW5vdGhlciBpZiB0aGV5IGNvbWUgZnJvbSB0aGUgc2FtZSBjb3VudHJ5LiBUaGlzIGlzIGFsc28gdHJ1ZSBmb3IgdGhlIG1hbGUgYW5kIGZlbWFsZSBtZWFzdXJlbWVudHMgZnJvbSB0aGUgc2FtZSBjb3VudHJ5IG9yIHRoZSB2YWx1ZXMgaW4gdGhlIHNhbWUgY291bnRyaWVzIGZyb20gMTk4NSBhbmQgbGF0ZXIgaW4gMjAxNy4gSG93ZXZlciwgd2UgYXJlIGFzc3VtaW5nIHRoYXQgbWVhc3VyZW1lbnRzIGJldHdlZW4gZGlmZmVyZW50IGNvdW50cmllcyBhcmUgaW5kZXBlbmRlbnQsIHRodXMgdGhpcyBhc3N1bXB0aW9uIGlzIG5vdCB2aW9sYXRlZCwgbWFraW5nIGl0IHJlYXNvbmFibGUgdG8gcGVyZm9ybSB0aGUgV2VsY2gncyBvciBwYWlyZWQgdC10ZXN0LgoKV2hlbiB3ZSBwZXJmb3JtIGEgcGFpcmVkIHQtdGVzdCBvdXIgaHlwb3RoZXNpcyBpcyBzbGlnaHRseSBkaWZmZXJlbnQgZnJvbSB0aGUgdHlwaWNhbCBzdHVkZW50J3MgdC10ZXN0LiBJbiB0aGlzIGNhc2Ugd2UgYXJlIHRlc3RpbmcgdGhlIGRpZmZlcmVuY2VzIGFtb25nIHRoZSBwYWlycyBvZiBvYnNlcnZhdGlvbnMgYW5kIGhvdyBjbG9zZSB0aGVzZSBkaWZmZXJlbmNlcyBhcmUgdG8gemVyby4gT3VyIG51bGwgaHlwb3RoZXNpcyBpcyB0aGF0IHRoZSBtZWFuIG9mIHRoZSBkaWZmZXJlbmNlcyBpcyBlcXVhbCB0byB6ZXJvOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhvOiDOvGQgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIM68ZCBpcyB0aGUgdHJ1ZSBtZWFuIGRpZmZlcmVuY2VzIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmV0d2VlbiBwYWlyZWQgb2JzZXJ2YXRpb25zIG9mIHRoZSB0d28gZ3JvdXBzCgpUaGUgYWx0ZXJuYXRpdmUgaHlwb3RoZXNpcyBpcyB0aGF0IHRoZSBtZWFuIG9mIHRoZSBkaWZmZXJlbmNlcyBpcyBub3QgZXF1YWwgdG8gemVybwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhhOiDOvGQg4omgIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgzrxkIGlzIHRoZSB0cnVlIG1lYW4gZGlmZmVyZW5jZXMgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXR3ZWVuIHBhaXJlZCBvYnNlcnZhdGlvbnMgb2YgdGhlIHR3byBncm91cHMKCmBgYHtyfQoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwgCiAgICAgICB2YXIuZXF1YWwgPSBGQUxTRSwgcGFpcmVkID0gVFJVRSkKIyBtZWFucyBhcmUgZGlmZmVyZW50IC0gcCB2YWx1ZSA8LjA1IHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMKCnQudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IEZBTFNFLCBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IFRSVUUsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwgCiAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgdmFyLmVxdWFsID0gVFJVRSwgcGFpcmVkID0gVFJVRSkKIyBtZWFucyBhcmUgZGlmZmVyZW50IC0gcCB2YWx1ZSA8LjA1IHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMKIyB0aGUgdCB2YWx1ZSBzaG93cyB1cyB0aGF0IHRoZSBkaXJlY3Rpb25hbGl0eSBvZiB0aGUgZGlmZmVyZW5jZQojIHRoZSB0IHZhbHVlIHdhcyBuZWdhdGl2ZSB0aHVzIEJNSSB3YXMgbG93ZXIgaW4gMTk4NSAoMXN0IGdyb3VwKSAKIyBjb21wYXJlZCB0byAyMDE3ICgybmQgZ3JvdXApCgoKYGBgCgojIyMjIHsucXVlc3Rpb25fYmxvY2t9Cjx1PlF1ZXN0aW9uIG9wcG9ydHVuaXR5OjwvdT4gCkxvb2tpbmcgYXQgdGhlIHQgdmFsdWUsIHdhcyBnbG9iYWwgQk1JIGxvd2VyIGluIFJ1cmFsIG9yIFVyYmFuIGFyZWFzIGluIDE5ODU/CgojIyMjCgpOb3cgd2Ugd2lsbCB0cnkgdHJhbnNmb3JtIG91ciBkYXRhIHRvIG1ha2UgaXQgbW9yZSBub3JtYWxseSBkaXN0cmlidXRlZC4gT25lIHdheSB0byBkbyB0aGlzIGlzIHRvIHRha2UgdGhlIGxvZ2FyaXRobSBvZiB0aGUgZGF0YSB2YWx1ZXMuIFRoZW4gd2Ugd2lsbCBzZWUgaG93IHRoaXMgaW5mbHVlbmNlcyB0aGUgcmVzdWx0cy4gQWdhaW4gd2Ugd2lsbCBmb2N1cyBvbiB0aGUgZGF0YSBmb3Igd29tZW4uCgpgYGB7cn0KCiMgY3JlYXRlIGEgbmV3IGNvbHVtbiB3aXRoIHRoZSBsb2cgdmVyc2lvbiBvZiB0aGUgQk1JIHZhcmlhYmxlIHVzaW5nIG11dGF0ZSgpCgpCTUlfbG9uZ19sb2cgPC0gbXV0YXRlKEJNSV9sb25nLCBsb2dfQk1JPWxvZyhwdWxsKEJNSV9sb25nLEJNSSkpKQoKQk1JX2xvbmdfbG9nICU+JQogIGZpbHRlcihTZXggPT0gIldvbWVuIikgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPWxvZ19CTUkpKSArCiAgc3RhdF9xcSgpICsgIyB0byBhZGQgdGhlIGxpbmUgd2UgbmVlZCB0byBhbHNvIGluY2x1ZGUgc3RhdF9xcV9saW5lKCkKICBzdGF0X3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IFllYXIgKyBSZWdpb24pCgpCTUlfbG9uZ19sb2cgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIikgJT4lIAogIGdyb3VwX2J5KFllYXIsIFJlZ2lvbikgJT4lIAogIHN1bW1hcml6ZShzaGFwaXJvX3Rlc3QgPSBzaGFwaXJvLnRlc3QobG9nX0JNSSkkcC52YWx1ZSkKCiMgcmVjYWxsIHdoYXQgaXQgd2FzIGJlZm9yZQpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iKSAlPiUgCiAgZ3JvdXBfYnkoWWVhciwgUmVnaW9uKSAlPiUgCiAgc3VtbWFyaXplKHNoYXBpcm9fdGVzdCA9IHNoYXBpcm8udGVzdChCTUkpJHAudmFsdWUpCgoKCmBgYAoKVGhlIGRhdGEgYXBwZWFycyB0byBiZSBtb3JlIHNpbWlsYXIgdG8gdGhlIG5vcm1hbCBkaXN0cmlidXRpb24sIGFsdGhvdWdoIG5vdCBxdWl0ZS4gQWdhaW4sIG91ciBzYW1wbGUgc2l6ZSBvZiAyMDAgaXMgcXVpdGUgbGFyZ2UgYW5kIHRoZSB0LXRlc3QgaXMgZ2VuZXJhbGx5IHF1aXRlIHJvYnVzdCB0byB2aW9sYXRpb25zIG9mIG5vcm1hbGl0eSB3aXRoIGxhcmdlIG4sIHRodXMgdGhlIG1vZGlmaWVkIHQtdGVzdCB0byBhY2NvdW50IGZvciB1bmVxdWFsIHZhcmlhbmNlIG1pZ2h0IGJlIGEgZ29vZCBvcHRpb24gdXNpbmcgdGhlIGxvZyBub3JtYWxpemVkIGRhdGEsIGFzIGl0IGlzIGF0IGxlYXN0IG1vcmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuCgpMZXQncyBzZWUgdGhlIHJlc3VsdHMgb2YgdGhlIHQtdGVzdCB3aXRoIHRoZSB0cmFuc2Zvcm1lZCBkYXRhOgoKYGBge3J9Cgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmdfbG9nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIGxvZ19CTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBsb2dfQk1JKSwgCiAgICAgICB2YXIuZXF1YWwgPSBGQUxTRSwgcGFpcmVkID0gVFJVRSkKIyBtZWFucyBhcmUgZGlmZmVyZW50IC0gcCB2YWx1ZSA8LjA1IHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMKCnQudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZ19sb2csIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgbG9nX0JNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmdfbG9nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIGxvZ19CTUkpLAogICAgICAgdmFyLmVxdWFsID0gRkFMU0UsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmdfbG9nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIGxvZ19CTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBsb2dfQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IFRSVUUsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmdfbG9nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIGxvZ19CTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBsb2dfQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IFRSVUUsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgpgYGAKCldlIGNhbiBzZWUgdGhhdCBvdXIgcmVzdWx0cyBhcmUgcXVpdGUgc2ltaWxhciB0byB0aGF0IG9mIHRoZSBvcmlnaW5hbCBkYXRhLCBob3dldmVyIHRoZSB0IHZhbHVlcyBhcmUgc2xpZ2h0bHkgc21hbGxlci4gSW4gb3RoZXIgY2FzZXMgd2UgbWF5IHNlZSBhIG11Y2ggbW9yZSBkcmFtYXRpYyBpbmZsdWVuY2Ugb2YgdHJhbnNmb3JtaW5nIG91ciBkYXRhLgoKCk5vdywgbGV0J3MgdGFrZSBhIGxvb2sgYXQgbm9ucGFyYW1ldHJpYyB0ZXN0cywgd2hpY2ggYXJlIGFsc28gYSBncmVhdCBvcHRpb24gd2hlbiB0aGUgYXNzdW1wdGlvbnMgb2YgdGhlIHQtdGVzdCBhcmUgdmlvbGF0ZWQuIAoKIyMjIE5vbnBhcmFtZXRyaWMgdHdvIHNhbXBsZSB0ZXN0cwoKVGhlcmUgYXJlIG11bHRpcGxlIG5vbnBhcmFtZXRyaWMgb3B0aW9ucyB0byBjb25zaWRlciB3aGVuIHRoZSBhc3N1bXB0aW9ucyBvZiB0aGUgW3QtdGVzdF0gYXJlIHZpb2xhdGVkLiBUaGUgW1dpbGNveG9uIHNpZ25lZCByYW5rIHRlc3RdKGh0dHA6Ly93d3cuYmlvc3RhdGhhbmRib29rLmNvbS93aWxjb3hvbnNpZ25lZHJhbmsuaHRtbCkgKGZvciBwYWlyZWQgZGF0YSAtIHRoZSBhbHRlcm5hdGl2ZSBpcyBbV2lsY294b24gcmFuayBzdW0gdGVzdF0oaHR0cDovL3NwaHdlYi5idW1jLmJ1LmVkdS9vdGx0L21waC1tb2R1bGVzL2JzL2JzNzA0X25vbnBhcmFtZXRyaWMvQlM3MDRfTm9ucGFyYW1ldHJpYzQuaHRtbCkgKGFsc28gY2FsbGVkIHRoZSBNYW5uLVdoaXRuZXkgVSB0ZXN0KSBmb3IgaW5kZXBlbmRlbnQgc2FtcGxlcykgYW5kIHRoZSBbdHdvLXNhbXBsZSBLb2xtb2dvcm92LVNtaXJub3YgdGVzdF0oaHR0cHM6Ly93d3cuaXRsLm5pc3QuZ292L2Rpdjg5OC9zb2Z0d2FyZS9kYXRhcGxvdC9yZWZtYW4xL2F1eGlsbGFyL2tzMnNhbXAuaHRtKSAoS1MpIGJvdGggZG8gbm90IGFzc3VtZSBub3JtYWxpdHkgKGhhcyBib3RoIHBhaXJlZCBhbmQgdW5wYWlyZWQgbWV0aG9kcykuIFRodXMgdGhlc2UgdGVzdHMgc2hvdWxkIGJlIGNvbnNpZGVyZWQgd2hlbiB0aGUgZGF0YSBvZiBlaXRoZXIgZ3JvdXBzIGRvZXMgbm90IGFwcGVhciB0byBiZSBub3JtYWxseSBkaXN0cmlidXRlZCBhbmQgcGFydGljdWxhcmx5IHdoZW4gdGhlIG51bWJlciBvZiBzYW1wbGVzIGlzIGxvdy4KCkltcG9ydGFudGx5IHRoZSBLUyB0ZXN0IGRvZXMgbm90IGFzc3VtZSBub3JtYWxpdHkgb3IgZXF1YWwgdmFyaWFuY2UsIHdoaWxlIHRoZSBXaWxjb3hvbiBzaWduZWQgcmFuayB0ZXN0IGRvZXMgYXNzdW1lIGVxdWFsIHZhcmlhbmNlLiBIZXJlIGlzIGhvdyB5b3Ugd291bGQgcGVyZm9ybSB0aGVzZSB0ZXN0cy4gSG93ZXZlciBpbiBvdXIgY2FzZSwgYmVjYXVzZSB0aGUgdmFyaWFuY2UgaXMgbm90IGVxdWFsIGJldHdlZW4gc29tZSBvZiBvdXIgZ3JvdXBzIG9mIGludGVyZXN0LCB0aGUgS1MgdGVzdCB3b3VsZCBiZSBtb3JlIGFwcHJvcHJpYXRlLiBCb3RoIHRoZSB0LXRlc3QgYW5kIHRoZSBLUyB0ZXN0IGV2YWx1YXRlIGlmIHRoZSBkaXN0cmlidXRpb25zIG9mIHRoZSB0d28gZ3JvdXBzIGFyZSBpZGVudGljYWwsIGhvd2V2ZXIgdGhlIEtTIHRlc3QgZG9lcyBub3QgcGFydGljdWxhcmx5IHRlc3QgYW55IGFzcGVjdCBvZiB0aGUgZGlzdHJpYnV0aW9uIGxpa2UgdGhlIG1lYW4sIHRoZXJlZm9yZSB0aGVyZSBhcmUgbm8gY29uZmlkZW5jZSBpbnRlcnZhbHMgaW4gdGhlIG91dHB1dCB1c2luZyB0aGlzIHRlc3QuIAoKYGBge3J9Cgprcy50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwgCiAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgIHBhaXJlZCA9IFRSVUUpCgprcy50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwgCiAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgIHBhaXJlZCA9IFRSVUUpCmBgYAoKCldoYXQgYWJvdXQgdGhlIGRpZmZlcmVuY2UgaW4gZmVtYWxlIEJNSSBmcm9tIDE5ODUgdG8gMjAxNyBmb3IgYm90aCByZWdpb25zPwpSZWNhbGwgdGhhdCB0aGUgdmFyaWFuY2Ugd2FzIGVxdWFsIGZvciB0aGVzZSBjb21wYXJpc29ucy4KCmBgYHtyfQoKd2lsY294LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksCiAgICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLAogICAgICAgICAgIHBhaXJlZCA9IFRSVUUpCgp3aWxjb3gudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksCiAgICAgICAgICAgcGFpcmVkID0gVFJVRSkKCmBgYApUaGVyZSBpcyBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgYWNyb3NzIHRpbWUgZm9yIGJvdGggcmVnaW9ucywgYXMgd2Ugc2F3IHdpdGggdGhlIHQtdGVzdC4gVGhlcmUgaXMgYWxzbyBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgYnkgcmVnaW9uIGZvciBlYWNoIHllYXIuIEhvd2V2ZXIsIHRoZSBwLXZhbHVlcyBhcmUgYSBiaXQgbGFyZ2VyIGZvciB0aGUgS1MgdGVzdCByZXN1bHRzIHRoYW4gd2Ugc2F3IHdpdGggdGhlIHQtdGVzdC4KCiMjIyBNdWx0aXBsZSBUZXN0aW5nIENvcnJlY3Rpb24KCkxldCdzIHRha2UgYSBsb29rIGJhY2sgYXQgdGhlIHF1ZXN0aW9ucyB3ZSB3YW50ZWQgdG8gYW5zd2VyOgoxKSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gQk1JIGVzdGltYXRlcyBhcm91bmQgdGhlIHdvcmxkPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGlzIGxvb2sgZm9yIGZlbWFsZXM/CjIpIEhvdyBoYXZlIEJNSSBlc3RpbWF0ZXMgY2hhbmdlZCBmcm9tIDE5ODUgdG8gMjAxNz8gQWdhaW4sIEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMykgSG93IGRvIGRpZmZlcmVudCBjb3VudHJpZXMgY29tcGFyZSBmb3IgQk1JIGVzdGltYXRlcz8gSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhlIFVuaXRlZCBTdGF0ZXMgY29tcGFyZSB0byB0aGUgcmVzdCBvZiB0aGUgd29ybGQ/CgpJdCdzIGltcG9ydGFudCB0byBub3RlIHRoYXQgdWx0aW1hdGVseSB3ZSB3YW50ZWQgdG8gdGVzdCA0IGRpZmZlcmVudCB0ZXN0cyB0byBhbnN3ZXIgcXVlc3Rpb24gMSBhbmQgMjoKCjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBpbiBtZWFuIEJNSSBmb3Igd29tZW4gYmV0d2VlbiBSdXJhbCBhbmQgVXJiYW4gYXJlYXMgaW4gMTk4NT8KMikgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGluIG1lYW4gQk1JIGZvciB3b21lbiBiZXR3ZWVuIFJ1cmFsIGFuZCBVcmJhbiBhcmVhcyBpbiAyMDE3PwozKSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gbWVhbiBCTUkgZm9yIHdvbWVuIGJldHdlZW4gMTk4NSBhbmQgMjAxNyBpbiBSdXJhbCBhcmVhcz8KNCkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGluIG1lYW4gQk1JIGZvciB3b21lbiBiZXR3ZWVuIDE5ODUgYW5kIDIwMTcgaW4gVXJiYW4gYXJlYXM/CgpXaGVuIHdlIHRlc3QgbXVsdGlwbGUgcXVlc3Rpb25zIGxpa2UgdGhpcywgd2UgbmVlZCB0byBjb3JyZWN0IGZvciB0aGUgbXVsdGlwbGUgdGVzdHMgdGhhdCB3ZSBhcmUgcGVyZm9ybWluZy4KClRoZSBtb3JlIHdlIHRlc3QgZGF0YSwgdGhlIG1vcmUgbGlrZWx5IHdlIGFyZSB0byBzZWUgYSBzaWduaWZpY2FudCBmaW5kaW5nIGp1c3QgYnkgW3JhbmRvbSBjaGFuY2VdKGh0dHBzOi8vd3d3LnN0YXQuYmVya2VsZXkuZWR1L35tZ29sZG1hbi9TZWN0aW9uMDQwMi5wZGYpIGV2ZW4gd2hlbiB0aGUgZmluZGluZyBpcyBpbiBmYWN0IG5vdCByZWFsLiBJdCBhbGwgY29tZXMgZG93biB0byBwcm9iYWJpbGl0eS4KCiMjIyMgUHJvYmFiaWxpdHkKCllvdSBtYXkgcmVjYWxsIHRoYXQgcHJvYmFiaWxpdHkgaXMgdGhlIGNoYW5jZSB0aGF0IGFuIGV2ZW50IHdpbGwgaGFwcGVuIGFuZCBpdCByYW5nZXMgZnJvbSAwIHRvIDEuIApZb3UgY2FuIGFsc28gdGhpbmsgb2YgaXQgYXMgYSBwZXJjZW50YWdlIG9mIDAlIChwcm9iYWJpbGl0eSA9MCkgdG8gMTAwJSAocHJvYmFiaWxpdHkgPSAxKSBvZiBjaGFuY2UgdGhhdCBhbiBldmVudCB3aWxsIGhhcHBlbi4KCiFbXShodHRwczovL3d3dy5tYXRoc2lzZnVuLmNvbS9kYXRhL2ltYWdlcy9wcm9iYWJpbGl0eS1saW5lLnN2ZykKaHR0cHM6Ly93d3cubWF0aHNpc2Z1bi5jb20vZGF0YS9pbWFnZXMvcHJvYmFiaWxpdHktbGluZS5zdmcKCklmIHdlIGNvbnNpZGVyIGZsaXBwaW5nIGEgY29pbiwgdGhlIHByb2JhYmlsaXR5IG9mIGFuIGV2ZW50IGhhcHBlbmluZyAoaGVhZHMpIGlzIGFsd2F5cyBlcXVhbCB0byAgMSAoIG9yIDEwMCUgY2hhbmNlKSBtaW51cyB0aGUgcHJvYmFiaWxpdHkgb2YgdGhlIGV2ZW50IG5vdCBoYXBwZW5pbmcgKHRhaWxzIGluc3RlYWQgb2YgaGVhZHMpIGJlY2F1c2UgdGhlIHRvdGFsIHByb2JhYmlsaXR5IGNhbiBub3QgZXhjZWVkIDEwMCUuCgogICAgICAgIHByb2JhYmlsaXR5IG9mIDEgKDEwMCUgY2hhbmNlKSA9IHRoZSBwcm9iYWJpbHR5IG9mIGhlYWRzICg1MCUgY2hhbmNlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgdGhlIHByb2JhYmlsaXR5IG9mIHRhaWxzICg1MCUgY2hhbmNlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPSBQKGhlYWRzKSArIFAodGFpbHMpCiAgICAgICAgICAgIHByb2JhYmlsaXR5IG9mIG9uZSBvdXRjb21lID0gMSAtIHRoZSBwcm9iYWJpbGl0eSBvZiB0aGUgb3RoZXIgb3V0Y29tZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQKGhlYWRzKSA9IDEgLSBQKHRhaWxzKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAodGFpbHMpID0gMSAtIFAoaGVhZHMpCgpJZiB3ZSB0aGluayBhYm91dCB0aGUgcHJvYmFiaWxpdHkgb2YgZ2V0dGluZyBzaWduaWZpY2FudCBvciBub25zaWduaWZpY2FudCByZXN1bHRzIHdlIGNhbiB0aGluayBvZiBpdCBsaWtlIHRoaXM6CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA9IFAoc2lnbmlmaWFudCByZXN1bHRzKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBQKG5vIHNpZ25pZmljYW50IHJlc3VsdHMpCiAgICAgICAgICAgICAgICBQKHNpZ25pZmljYW50IHJlc3VsdHMpID0gMSAtIFAobm8gc2lnbmlmaWNhbnQgcmVzdWx0cykKCiMjIyBBbHBoYQoKQWxwaGEgaXMgdGhlIGFtb3VudCBvZiByaXNrIHRoYXQgeW91IGFyZSB3aWxsaW5nIHRvIGFjY2VwdCB0aGF0IGEgc3RhdGlzdGljYWwgdGVzdCByZXN1bHQgaXMgYWN0dWFsbHkgYSBmYWxzZSBwb3NpdGl2ZSwgaW4gb3RoZXIgd29yZHMgd2UgcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMgd2hlbiB0aGUgbnVsbCBoeXBvdGhlc2lzIGlzIHRydWUuIFRoaXMgaXMgYWxzbyBjYWxsZWQgW3R5cGUgMSBlcnJvcl0oaHR0cHM6Ly93ZWIubWEudXRleGFzLmVkdS91c2Vycy9ta3Mvc3RhdG1pc3Rha2VzL2Vycm9ydHlwZXMuaHRtbCkuIEEgc2lnbmlmaWNhbmNlIHRocmVzaG9sZCBvZiAuMDUgaXMgY3VzdG9tYXJ5IGFuZCBpdCBtZWFucyB0aGF0IHdlIGFyZSBhY2NlcHRpbmcgYSA1JSBjaGFuY2UgdGhhdCBvdXIgcmVzdWx0IGlzIGFjdHVhbGx5IGEgZmFsc2UgcG9zaXRpdmUuCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IHByb2JhYmlsaXR5IG9mIGZhbHNlIHNpZ25pZmljYW50IHJlc3VsdHMgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgzrEgPSBQKE1ha2luZyBhIHR5cGUgMSBlcnJvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKUmVtZW1iZXIgdGhhdCBpbiBvdXIgc3RhdGlzdGljYWwgdGVzdHMgaWYgdGhlIHAtdmFsdWUgPCBhbHBoYSBpdCBpcyBjb25zaWRlcmVkIHNpZ25pZmljYW50IGFuZCBpZiBwLXZhbHVlID4gYWxwaGEgaXQgaXMgY29uc2lkZXJlZCBub3Qgc2lnbmlmaWNhbnQKCgpCdXQgd2hhdCByZWFsbHkgaXMgdGhlIFtwLXZhbHVlXShodHRwczovL3Rvd2FyZHNkYXRhc2NpZW5jZS5jb20vcC12YWx1ZXMtZXhwbGFpbmVkLWJ5LWRhdGEtc2NpZW50aXN0LWY0MGE3NDZjZmM4KT8KCiMjIyBwLXZhbHVlcwoKVGhlIHAgaW4gcC12YWx1ZSBzdGFuZHMgZm9yIDxiPnByb2JhYmlsaXR5PC9iPiAtIHRoZSBwcm9iYWJpbGl0eSB0aGF0IHdlIHdvdWxkIG9idGFpbiB0aGUgc3RhdGlzdGljcyAoZm9yIGV4YW1wbGUgdGhlIHQgaW4gb3VyIHN0dWRlbnQgdC10ZXN0cyBiYXNlZCBvbiB0aGUgbWVhbnMgb2Ygb3VyIGdyb3VwcyBvZiBjb21wYXJpc29uKSBqdXN0IGJ5IHJhbmRvbSBjaGFuY2UgYWxvbmUuIFRoZXJlZm9yZSBhIHAtdmFsdWUgb2YgMC4wMiBtZWFucyB0aGF0IHRoZXJlIGlzIGEgMiBwZXJjZW50IGNoYW5jZSB0aGF0IG91dCBkYXRhIG1heSBsb29rIHRoZSB3YXkgaXQgZG9lcyBqdXN0IGJlY2F1c2Ugb2YgcmFuZG9tIGNoYW5jZSBhbmQgbm90IGJlY2F1c2UgdGhlcmUgaXMgcmVhbGx5IGEgZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMgb2YgdGhlIGdyb3VwcyBvZiBpbnRlcmVzdC4KClNvIHRoZW4gaWYgYWxwaGEgaXMgdGhlIHRocmVzaG9sZCBmb3IgdGhlIHAtdmFsdWUgZm9yIG9idGFpbmluZyBmYWxzZSBzaWduaWZpY2FudCByZXN1bHRzIHRoZW4gdGhlIHByb2JhYmlsaXR5IG9mIG5vdCBtYWtpbmcgaW5jb3JyZWN0IGNvbmNsdXNpb25zIGlzIDEgLSBhbHBoYToKCiAgICAgICAgICAgICAgICAgUChOb3QgbWFraW5nIGFuIGVycm9yKSA9IDEgLSDOsQoKYGBge3J9CiNQKE5vdCBtYWtpbmcgYW4gZXJyb3IpID0gMSAtIM6xCjEtLjA1IAoKYGBgCiAgCk9LIHNvIGlmIHdlIHVzZSBhbiBhbHBoYSBvZiAuMDUgd2UgYXJlIGFjY2VwdGluZyB0aGF0IDk1JSBvZiB0aGUgdGltZSB3ZSB3aWxsIG5vdCBtYWtlIGEgVHlwZSAxIGVycm9yIGFuZCA1ICUgb2YgdGhlIHRpbWUgd2Ugd2lsbCBqdXN0IGJ5IHJhbmRvbSBjaGFuY2UuICAgICAgICAgICAgICAKVGFraW5nIHRoaXMgb25lIHN0ZXAgZnVydGhlcjoKCiAgICAgICAgICAgICAgICAgICAgIFAoTWFraW5nIGFuIGVycm9yKSA9IDEgLSBQKE5vdCBtYWtpbmcgYW4gZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgIFAoTWFraW5nIGFuIGVycm9yKSA9IDEgLSAoMSAtIM6xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCkhlcmUgd2UgY2FuIHNlZSB0aGF0IHRoaXMgY2hlY2tzIG91dDogICAgICAgICAgICAgICAgICAgICAgICAgICAgIApgYGB7cn0KI1AoTWFraW5nIGFuIGVycm9yKSA9IDEgLSAoMSAtIM6xKQoxLSgxLS4wNSkKYGBgCgpTbyB3aGF0IGhhcHBlbnMgaWYgd2UgcGVyZm9ybSBtdWx0aXBsZSB0ZXN0cz8KClRoZSBwcm9iYWJpbGl0eSBvZiBub3QgbWFraW5nIGEgdHlwZSAxIGVycm9yIHdvdWxkIHJlbWFpbiB0aGUgc2FtZSBmb3IgZWFjaCB0ZXN0LiBUaGVyZWZvcmUgd2UgbmVlZCB0byBtdWx0aXBseSB0aGUgcHJvYmFiaWxpdGllcyB0b2dldGhlciBlYWNoIHRpbWUgdG8gZGV0ZXJtaW5lIHRoZSBvdmVyIGFsbCBwcm9iYWJpbGl0eSBvZiBtYWtpbmcgYW4gZXJyb3IgYWNyb3NzIG11bHRpcGxlIHRlc3RzLiBTZWUgW2hlcmVdKGh0dHA6Ly9tYXRoZm9ydW0ub3JnL2xpYnJhcnkvZHJtYXRoL3ZpZXcvNzQwNjUuaHRtbCkgYWJvdXQgd2h5IHdlIG11bHRpcGx5IHByb2JhYmlsaXRpZXMgdG9nZXRoZXIuCgogICAgICAgIFAoTm90IG1ha2luZyBhbiBlcnJvciBpbiBtIHRlc3RzKSA9ICgxIC0gzrEpXm0KICAgIFAoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gbSB0ZXN0cykgPSAxIC0gKDEgLSDOsSlebQoKTGV0J3MgY29uc2lkZXIgaWYgd2UgcGVyZm9ybWVkIDEwIGRpZmZlcmVudCBzdGF0aXN0aWNhbCB0ZXN0cyBhbmQgaWYgd2UgYXMgdXN1YWwgY29uc2lkZXJlZCB0aGUgc2lnbmlmaWNhbmNlIHRocmVzaG9sZCBhbHBoYSBvZiAuMDU6CgpTbyB0aGUgcHJvYmFiaWxpdHkgb2YgZ2V0dGluZyAxIHNpZ25pZmljYW50IHJlc3VsdCB3aXRoIDEwIHRlc3RzIGlzOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCmBgYHtSfQojUChNYWtpbmcgYXQgbGVhc3QgMSBlcnJvciBpbiAxMCB0ZXN0cykgPSAxIC0gKCgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKQojdGhpcyBpcyB0aGUgc2FtZSBhczoKI1AoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gMTAgdGVzdHMpID0gMSAtICgxIC0gzrEpXjEwCiAxLSAoMS0uMDUpXjEwCmBgYAoKU28gdGhlcmUgaXMgYSA0MCUgY2hhbmNlIHRoYXQgdGhhdCB0aGVyZSB3aWxsIGJlIGEgc2lnbmlmaWNhbnQgZmluZGluZyBzaW1wbHkgZHVlIHRvIHJhbmRvbSBjaGFuY2UgYWxvbmUuCgpXaGF0IGFib3V0IDEwMCB0ZXN0cz8KCmBgYHtSfQoKI1AoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gMTAwIHRlc3RzKSA9IDEgLSAoMSAtIM6xKV4xMDAKIDEtICgxLS4wNSleMTAwCmBgYAogICAgICAgICAgICAgICAgICAgICAgICAKWWlrZXMhISBUaGF0IGlzIGFsbW9zdCBhIDEwMCUgY2hhbmNlIHRoYXQgdGhlcmUgd2lsbCBiZSBhIHNpZ25pZmljYW50IGZpbmRpbmcgc2ltcGx5IGR1ZSB0byBjaGFuY2UgYWxvbmUhCgpNdWNoIG9mIHRoaXMgZXhwbGFuYXRpb24gaXMgZGVzY3JpYmVkIGluIHRoaXMgW2xlY3R1cmVdKGh0dHBzOi8vd3d3LmdzLndhc2hpbmd0b24uZWR1L2FjYWRlbWljcy9jb3Vyc2VzL2FrZXkvNTYwMDgvbGVjdHVyZS9sZWN0dXJlMTAucGRmKQoKCk9uZSB3YXkgdG8gY29ycmVjdCBmb3IgdGhpcyBpcyBtdWx0aXBsZSB0ZXN0aW5nIGlzc3VlIGlzIHVzaW5nIHRoZSBbQm9uZmVycm9uaSBtZXRob2RdKGh0dHA6Ly9tYXRod29ybGQud29sZnJhbS5jb20vQm9uZmVycm9uaUNvcnJlY3Rpb24uaHRtbCkuIAoKSW4gdGhpcyBtZXRob2Qgd2Ugd291bGQgZGl2aWRlIG91ciBzaWduaWZpY2FuY2UgdGhyZXNob2xkIChnZW5lcmFsbHkgMC4wNSkgYnkgdGhlIG51bWJlciBvZiB0ZXN0cy4KCmBgYHtyfQouMDUvNCAjIDQgdGVzdHMKYGBgCgpPdXIgbmV3IHNpZ25pZmljYW5jZSB0aHJlc2hvbGQgaXMgbm93IDAuMDEyNS4gClRodXMgb3VyIHAtdmFsdWVzIHNob3VsZCBiZSBsZXNzIHRoYW4gdGhpcyB2YWx1ZSBmb3IgdXMgdG8gcmVqZWN0IHRoZSBudWxsIHRoYXQgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBpbiBtZWFucy4KSW4gYWxsIGNhc2VzLCBvdXIgcC12YWx1ZXMgd2VyZSBsZXNzIHRoYW4gMC4wMTI1LgpTbyB3ZSBzZWUgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIHRoZSBtZWFucyBvZiB0aGUgZ3JvdXBzIGFmdGVyIG11bHRpcGxlIHRlc3RpbmcgY29ycmVjdGlvbiBmb3Igb3VyIGRpZmZlcmVudCB0ZXN0cy4KCkFnYWluLCBpdCB3b3VsZCBiZSByZWFzb25hYmxlIHRvIHVzZSB0aGUgdC10ZXN0IGJlY2F1c2UgaXQgaXMgcm9idXN0IHRvIGRldmlhdGlvbnMgaW4gbm9ybWFsaXR5IHdoZW4gc2FtcGxlcyBhcmUgcmVsYXRpdmVseSBsYXJnZS4gCldlIGNhbiBzZWUgdGhhdCB3ZSBvYnRhaW5lZCB0aGUgc2FtZSByZXN1bHRzIHJlZ2FyZGxlc3Mgb2YgdGhlIHRlc3QgdGhhdCB3ZSB1c2VkLgpIb3dldmVyLCBpZiBzYW1wbGUgc2l6ZXMgYXJlIHNtYWxsIChnZW5lcmFsbHkgc3BlYWtpbmcgbjwxNSBmb3IgZWFjaCBncm91cCksIHRoZW4gdGhlc2Ugbm9ucGFyYW1ldHJpYyBvcHRpb25zIGFyZSB1c2VmdWwgdG8ga25vdy4KClRoZSBEIHZhbHVlcyBpbiB0aGUgb3V0cHV0IG9mIG91ciBLUyB0ZXN0cywgc2hvdyB0aGUgbWFnbml0dWRlIG9mIGRpc3RhbmNlIGluIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIGRpc3RyaWJ1dGlvbnMgb2YgdGhlIGdyb3VwcyB0ZXN0ZWQuCllvdSBtYXkgbm90aWNlIHRoYXQgdGhlIEQgdmFsdWUgaXMgbGFyZ2VyIGZvciB0aGUgdGVzdHMgb2YgQk1JIGFjcm9zcyB0aW1lIHJhdGhlciB0aGVuIGFjcm9zcyByZWdpb24uCkluIHRoZXNlIHRlc3RzIHRoZSBwLXZhbHVlIHdhcyBhbHNvIHNtYWxsZXIuCgojIyBEYXRhIFZpc3VhbGl6YXRpb24KCkFnYWluIHdlIHdpbGwgdXRpbGl6ZSBgZ2dwbG90MmAgdG8gY3JlYXRlIHBsb3RzIHRvIGxvb2sgYXQgdGhlIGRpcmVjdGlvbmFsIGFuZCBtYWduaXR1ZGUgb2YgdGhlIGRpZmZlcmVuY2VzIGluIEJNSSB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4gSWYgeW91IG5lZWQgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBwbGVhc2Ugc2VlIFtoZXJlXShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKS4gVGhlIHRvcCB0d28gbGluZXMgb2YgdGhlIGNvZGUgZm9yIHRoZSBmb2xsb3dpbmcgcGxvdHMsIGZpbHRlciB0aGUgZGF0YSB0byBvbmx5IHNwZWNpZmljIHZhbHVlcyBvZiBpbnRlcmVzdC4gVGhlbiB3ZSBsYXllciB3aGF0IGlzIGNhbGxlZCBhIGppdHRlciBvbiB0b3Agb2YgYSBib3ggcGxvdC4gQSBqaXR0ZXIgaXMgZXNzZW50aWFsbHkgYSBkb3QgcGxvdCBidXQgd2l0aCBzb21lIHZhcmlhdGlvbiBvbiB0aGUgbG9jYXRpb24gb2YgdGhlIHBvaW50cyBzbyB0aGF0IHRoZXkgZG8gbm90IGxpbmUgdXAgdmVydGljYWxseSB3aGljaCBjYW4gbWFrZSB0aGUgaW5kaXZpZHVhbCBwb2ludHMgZGlmZmljdWx0IHRvIHNlZS4KCk91ciBmaXJzdCBtYWluIHF1ZXN0aW9uIHdhczogSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8KTGV0J3MgbG9vayBhdCB0aGUgbmF0aW9uYWwgbWVhbiBCTUkgZXN0aW1hdGVzIGZvciBlYWNoIG9mIHRoZSB5ZWFyczoKYGBge3J9CkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBSZWdpb24sIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpIAojIHRoZSB3aWR0aCBkZXRlcm1pbmVzIGhvdyB3aWRlIHRoZSBwb2ludHMgYXJlIHBsb3R0ZWQKCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBSZWdpb24sIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpCgpgYGAKCk91ciAybmQgbWFpbiBxdWVzdGlvbiB3YXM6IEhvdyBoYXZlIEJNSSBlc3RpbWF0ZXMgY2hhbmdlZCBmcm9tIDE5ODUgdG8gMjAxNz8KTGV0J3MgbG9vayBhdCB0aGUgY2hhbmdlIGluIHJ1cmFsIGFuZCB1cmJhbiBtZWFuIEJNSSBlc3RpbWF0ZXMgb3ZlciB0aW1lOgpgYGB7cn0KI3RoaXMgdGltZSB3ZSB3aWxsIGFkZCB0aXRsZXMgZm9yIFJ1cmFsIGFuZCBVcmJhbiB1c2luZyBnZ3RpdGxlKCkKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICAjIGZpbHRlcmluZyB0aGlzIHdheSBhbGxvd3MgdXMgdG8ga2VlcCBkYXRhIGZyb20gYm90aCB5ZWFycwogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBnZ3RpdGxlKCJSdXJhbCIpCgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBnZ3RpdGxlKCJVcmJhbiIpCgpgYGAKCkxldCdzIHB1dCB0aGUgcGxvdHMgdG9nZXRoZXIgdG8gc2VlIGhvdyB0aGUgY2hhbmdlIG92ZXIgdGhlIHllYXJzIGRpZmZlcnMgYmV0d2VlbiB0aGUgcmVnaW9ucy4KV2Ugd2lsbCB1c2UgYWdhaW4gdXNlIGBmYWNldF93cmFwKClgIHRvIGRvIHRoaXM6CgpgYGB7cn0KCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gJWluJSBjKCJSdXJhbCIsICJVcmJhbiIpKSAlPiUKICAjIGZpbHRlcmluZyB0aGlzIHdheSBhbGxvd3MgdXMgdG8ga2VlcCBkYXRhIGZyb20gYm90aCB5ZWFycwogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBmYWNldF93cmFwKH4gUmVnaW9uKQoKIyB3ZSB3b3VsZCBhbHNvIGdldCBuYXRpb25hbCBkYXRhIHdpdGhvdXQgYFJlZ2lvbiAlaW4lIGMoIlJ1cmFsIiwgIlVyYmFuIikpYAoKYGBgCkluZGVlZCB0aGUgY2hhbmdlIGluIEJNSSBvdmVyIHRpbWUgbG9va3MgYmlnZ2VyIGluIHRoZSBydXJhbCBhcmVhcyEKCgpPbmUgdGhpcmQgbWFpbiBxdWVzdGlvbnMgd2FzOiBIb3cgZG8gdGhlIGRpZmZlcmVudCBjb3VudHJpZXMgY29tcGFyZT8gIE9yIGluIG90aGVyIHdvcmRzIHdoYXQgZG8gdGhlIGluZGl2aWR1YWwgZG90cyByZXByZXNlbnQgaW4gb3VyIGJveCBwbG90cz8KV2Ugd2lsbCB0YWtlIGEgbG9vayB1c2luZyBgZ2VvbV9sYWJlbCgpYDoKCmBgYHtyfQoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gQk1JKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBnZW9tX2ppdHRlcih3aWR0aCA9IC4zKSArCiAgZ2VvbV9sYWJlbChhZXMobGFiZWwgPSBDb3VudHJ5KSkKCmBgYAoKSWYgd2UgaW5jbHVkZSBhbGwgY291bnRyeSBuYW1lcyB0aGlzIGlzIGEgYml0IHRvbyBtdWNoLi4uIHNvIHBlcmhhcHMgd2Ugc2hvdWxkIGZvY3VzIG9uIGp1c3QgdGhlIGV4dHJlbWUgQk1JIHZhbHVlcyB1c2luZyBgZmlsdGVyKClgIGZ1bmN0aW9uIG9mIHRoZWBkcGx5cmAgcGFja2FnZS4gV2Ugd2lsbCBhbHNvIHVzZSB0aGUgYGdncmVwZWxgIHBhY2thZ2UgdG8gaGF2ZSBvdXIgbGFiZWxzIG5vdCBvdmVybGFwIGVhY2ggb3RoZXIuCgpQYXJ0IG9mIHRoZSB0aGlyZCBxdWVzdGlvbiB3YXM6IEhvdyBkb2VzIHRoZSBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EgY29tcGFyZT8gU28gbGV0J3MgbGFiZWwgdGhlIGRhdGEgcG9pbnRzIGZvciB0aGUgVW5pdGVkIHN0YXRlcy4KCmBgYHtyfQoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gQk1JKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgZmlsdGVyKEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JKSwKICAgICAgICAgICAgICB3aWR0aCA9IC4wMikgKwogIGdncmVwZWw6Omdlb21fdGV4dF9yZXBlbChkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgZmlsdGVyKEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JLCBsYWJlbCA9IENvdW50cnkpKQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIApgYGAKCkFuZCBsZXQncyBmaWxsIHRoZSBib3ggcGxvdHMgd2l0aCBjb2xvciBhbmQgb3V0bGluZSBpbiBibGFjazoKYGBge3J9CgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siLCBhZXMoZmlsbCA9IFllYXIpKSArCiAgZ2VvbV9qaXR0ZXIoZGF0YT1CTUlfbG9uZyAlPiUgCiAgICAgICAgICAgICAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogICAgICAgICAgICAgIHN1YnNldChCTUk+MzEgfCBCTUk8MTkgfCBDb3VudHJ5ID09ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksCiAgICAgICAgICAgICAgd2lkdGggPSAuMDIpICsKICBnZ3JlcGVsOjpnZW9tX3RleHRfcmVwZWwoZGF0YT1CTUlfbG9uZyAlPiUgCiAgICAgICAgICAgICAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogICAgICAgICAgICAgIHN1YnNldChCTUk+MzEgfCBCTUk8MTkgfCBDb3VudHJ5ID09ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSwgbGFiZWwgPSBDb3VudHJ5KSkKCmBgYAoKCiMjIyBPdmVyYWxsIGRpZmZlcmVuY2VzCgpMZXQncyB0YWtlIGEgbG9vayBhdCBhbGwgdGhlIGRhdGEgdG9nZXRoZXIsIGluY2x1ZGluZyB0aGUgZGF0YSBmb3IgbWVuOgpgYGB7cn0KZ2dwbG90KEJNSV9sb25nLCBhZXMoeCA9IFllYXIsIHkgPSBCTUksIGNvbCA9IFJlZ2lvbikpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIgLCBhZXMoZmlsbCA9IFJlZ2lvbikpICsgCiAgZmFjZXRfZ3JpZCh+IFNleCkgICAKYGBgCgpUaGF0J3MgdXNlZnVsLCBidXQgbGV0J3MgbG9vayBhdCB0aGUgaW5kaXZpZHVhbCBwb2ludHMgYW5kIGluY2x1ZGUgb3VyIGNvdW50cnkgbGFiZWxzLCB0byBkbyBzbyBsZXRzIGNoYW5nZSBvdXIgVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIGxhYmVsIHRvIFVTQToKYGBge3J9CkJNSV9sb25nJENvdW50cnkgPC1CTUlfbG9uZyRDb3VudHJ5ICU+JQogIHN0cl9yZXBsYWNlKCBwYXR0ZXJuID0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIsIHJlcGxhY2VtZW50ID0gIlVTQSIpCgoKZ2dwbG90KEJNSV9sb25nLCBhZXMoeCA9IFllYXIsIHkgPSBCTUksIGNvbCA9IFllYXIpKSArIAogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEsIGNvbG9yID0gImJsYWNrIiAsIGFlcyhmaWxsID0gWWVhcikpICsgCiAgZmFjZXRfZ3JpZCh+IFNleCArIFJlZ2lvbikgKyAKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQ9MzAsIGxpbmV0eXBlPSJkYXNoZWQiLCBjb2xvciA9ICJyZWQiLCBzaXplID0xKSArIAogICMgVGhpcyB3aWxsIGFkZCBhIGhvcml6b250YWwgZGFzaGVkIGxpbmUgdG8gaW5kaWNhdGUgdGhlIG9iZXNpdHkgQk1JIHRocmVzaG9sZAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksIAogICAgICAgICAgICAgIHdpZHRoID0gLjIsIHNpemUgPTIsIHNoYXBlID0yMSwgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCB0aGUgaW5kaXZpZHVhbCBjb3VudHJ5IGRhdGEgcG9pbnRzCiAgIyBUaGUgc2hhcGUgMjEgYWxsb3dzIGZvciBhIGRpZmZlcmVudCBmaWxsIGFuZCBvdXRsaW5lIGNvbG9yCiAgIyBUaGUgd2lkdGggZGV0ZXJtaW5lcyBob3cgd2lkZSB0aGUgaml0dGVyIHBvaW50cyBhcmUgcGxvdHRlZAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nLCBDb3VudHJ5ID09ICJVU0EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksIAogICAgICAgICAgICAgIHdpZHRoID0gLjAyLCBzaXplID0xMiwgc2hhcGUgPTIxLCBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHBvaW50cyB0aGF0IGFyZSBsYXJnZXIgZm9yIHRoZSBVU0EgZGF0YQogIGdlb21fdGV4dChkYXRhPXN1YnNldChCTUlfbG9uZywgIENvdW50cnkgPT0gIlVTQSIpLCAKICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSxsYWJlbD1Db3VudHJ5KSwgCiAgICAgICAgICAgIGNvbG9yID0gImJsYWNrIikgKyAKICAjIFRoaXMgd2lsbCBhZGQgVVNBIGxhYmVscyB0byB0aGUgVVNBIHBvaW50cwogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgCiAgIyBUaGlzIGlzIHVzZWZ1bCBmb3IgcmVtb3ZpbmcgdGhlIGxlZ2VuZAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSxhbmdsZSA9IDMwKSwgCiAgICAgICAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgYW5kIGFuZ2xlIG9mIHRoZSB4IGF4aXMgcG9pbnQgbGFiZWxzIAogICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAyMCksIAogICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIHN0cmlwLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUpKSArCiAgIyBUaGlzIGNoYW5nZXMgdGhlIHNpemUgb2YgeCBheGlzIGxhYmVscyBmb3IgdGhlIGZhY2V0IAogICAgICAgIGdndGl0bGUoICJEaWZmZXJlbmNlcyBpbiBCTUkgT3ZlciBUaW1lIGFuZCBBY3Jvc3MgUmVnaW9uIFR5cGUgYW5kIEdlbmRlciIpIAogICMgQWRkIGEgIHBsb3QgdGl0bGUKICAgCgoKYGBgCgpIZXJlIHdlIGNhbiBzZWUgdGhhdCBvdmVyYWxsIEJNSSBhcHBlYXJzIHRvIGJlIGluY3JlYXNpbmcgZ2xvYmFsbHkgb3ZlciB0aW1lLiBBZGRpdGlvbmFsbHkgd2UgY2FuIHNlZSB0aGF0IHRoaXMgaXMgb2NjdXJyaW5nIG5vdCBqdXN0IGluIHVyYmFuIGFyZWFzLCBidXQgYWxzbyBpbiBydXJhbCBhcmVhcy4gVGhlIFVTIGlzIGNvbnNpc3RlbnRseSBhYm92ZSB0aGUgbWVkaWFuIGluIGFsbCBzdHJhdGEgb2YgdGhlIGRhdGEuIEluIGdlbmVyYWwsIHRoZSBmZW1hbGUgZGF0YSBzaG93cyBoaWdoZXIgQk1JIHZhbHVlcyB0aGFuIHRoZSBtYWxlIGRhdGEuIFRoZSBydXJhbCBVU0EgQk1JIGFwcGVhcnMgdG8gYmUgaGlnaGVyIHRoYW4gdGhlIHVyYmFuIEJNSSBmb3IgYm90aCBtZW4gYW5kIHdvbWVuLiBNYW55IGNvdW50cmllcyBoYXZlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBhYm92ZSB0aGUgb2Jlc2l0eSB0aHJlc2hvbGQgb2YgMzAuIFRodXMgaXQgYXBwZWFycyB0aGF0IGVkdWNhdGlvbiBhbmQgb3V0cmVhY2ggcHJvZ3JhbXMgZm9yIHdlaWdodCBtYW5hZ2VtZW50IHNob3VsZCBmb2N1cyBvbiBib3RoIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcyBhbmQgYm90aCBnZW5kZXJzLiBFZHVjYXRpb24gYW5kIGFzc2lzdGFuY2UgZm9yIHdvbWVuIG1heSBiZSBlc3BlY2lhbGx5IGhlbHBmdWwuIAoKIyMjIERpZmZlcmVuY2VzIGluIHJhdGUgb2YgY2hhbmdlCgpIb3cgZG9lcyB0aGUgcmF0ZSBvZiBjaGFuZ2UgaW4gQk1JIGRpZmZlciBiZXR3ZWVuIGdyb3Vwcz8gV2hpY2ggZ3JvdXAgbWlnaHQgZXNwZWNpYWxseSBuZWVkIGF0dGVudGlvbj8KCkZpcnN0IGxldCdzIGNhbGN1bGF0ZSB0aGUgZGlmZmVyZW5jZXMgaW4gQk1JIGZyb20gMjAxNyBhbmQgMTk4NSBhbmQgYWRkIHRoaXMgdG8gb3VyIEJNSV9sb25nIGRhdGEgb2JqZWN0OgpgYGB7cn0KCkJNSV9udW1lcmljJFJ1cmFsX2RpZmZlcmVuY2UgPC0gCiAgICAgQk1JX251bWVyaWMkUnVyYWxfQk1JXzIwMTcgLSBCTUlfbnVtZXJpYyRSdXJhbF9CTUlfMTk4NQoKQk1JX251bWVyaWMkVXJiYW5fZGlmZmVyZW5jZSA8LSAKICAgICBCTUlfbnVtZXJpYyRVcmJhbl9CTUlfMjAxNyAtIEJNSV9udW1lcmljJFVyYmFuX0JNSV8xOTg1CgpCTUlfbnVtZXJpYyROYXRpb25hbF9kaWZmZXJlbmNlIDwtIAogICAgIEJNSV9udW1lcmljJE5hdGlvbmFsX0JNSV8yMDE3IC0gQk1JX251bWVyaWMkTmF0aW9uYWxfQk1JXzE5ODUKCkJNSV9kaWZmX2xvbmcgPC0gQk1JX251bWVyaWMgJT4lIAogIHNlbGVjdChDb3VudHJ5OiBOYXRpb25hbF9kaWZmZXJlbmNlKSAlPiUgCmdhdGhlcihrZXkgPSBUeXBlLCB2YWx1ZSA9IERpZmZlcmVuY2UgLCBSdXJhbF9kaWZmZXJlbmNlOk5hdGlvbmFsX2RpZmZlcmVuY2UpCgpoZWFkKEJNSV9kaWZmX2xvbmcpCmBgYAoKTGV0J3MgcmVwbGFjZSAiVW5pdGVkIHN0YXRlcyBvZiBBbWVyaWNhIiB3aXRoICJVU0EiIGFuZCBtYWtlIGEgcGxvdCB3aXRoIHRoaXMgZGF0YSB0byBjb21wYXJlIHRoZSBjaGFuZ2UgaW4gQk1JOgoKYGBge3J9CgpCTUlfZGlmZl9sb25nJENvdW50cnkgPC1CTUlfZGlmZl9sb25nJENvdW50cnkgJT4lCiAgc3RyX3JlcGxhY2UoIHBhdHRlcm4gPSAiVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIiwgcmVwbGFjZW1lbnQgPSAiVVNBIikKCgpnZ3Bsb3QoQk1JX2RpZmZfbG9uZywgYWVzKHggPSBUeXBlLCB5ID0gRGlmZmVyZW5jZSwgY29sID0gVHlwZSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBUeXBlKSkgKyAKICBmYWNldF9ncmlkKH4gU2V4KSArCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyksIAogICAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICAgICAgICAgICAgd2lkdGggPSAuMiwgc2l6ZSA9Miwgc2hhcGUgPTIxLCBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHRoZSBpbmRpdmlkdWFsIGNvdW50cnkgZGF0YSBwb2ludHMKICAjIFRoZSBzaGFwZSAyMSBhbGxvd3MgZm9yIGEgZGlmZmVyZW50IGZpbGwgYW5kIG91dGxpbmUgY29sb3IKICAjIFRoZSB3aWR0aCBkZXRlcm1pbmVzIGhvdyB3aWRlIHRoZSBqaXR0ZXIgcG9pbnRzIGFyZSBwbG90dGVkCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZywgQ291bnRyeSA9PSAiVVNBIiksIAogICAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICAgICAgICAgICAgd2lkdGggPSAuMDIsIHNpemUgPTEyLCBzaGFwZSA9MjEsIGNvbG9yID0gImJsYWNrIiwgZmlsbCA9ICJncmF5IikgKyAKICAjIFRoaXMgd2lsbCBhZGQgcG9pbnRzIHRoYXQgYXJlIGxhcmdlciBmb3IgdGhlIFVTQSBkYXRhCiAgZ2VvbV90ZXh0KGRhdGE9c3Vic2V0KEJNSV9kaWZmX2xvbmcsICBDb3VudHJ5ID09ICJVU0EiKSwgCiAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlLGxhYmVsPUNvdW50cnkpLCBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCksIAogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIGFuZCBhbmdsZSBvZiB0aGUgeCBheGlzIHBvaW50IGxhYmVscyAKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChzaXplID0gMjApLCAKICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBzdHJpcC50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1KSkgKwogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIG9mIHggYXhpcyBsYWJlbHMgZm9yIHRoZSBmYWNldAogICAgICAgIGdndGl0bGUoICJDaGFuZ2UgaW4gQk1JIE92ZXIgVGltZSBhbmQgQWNyb3NzIFJlZ2lvbiBUeXBlIGFuZCBHZW5kZXIiKQogICAgICAgICMgQWRkIGEgcGxvdCB0aXRsZSAgCgoKCmBgYAoKV2UgY2FuIG5vdyBzZWUgdGhhdCB0aGUgcmF0ZSBvZiBjaGFuZ2UgZnJvbSAxOTg1IHRvIDIwMTcgYXBwZWFycyB0byBiZSBsYXJnZXIgaW4gdGhlIHdvbWVuIGNvbXBhcmVkIHRvIHRoZSBtZW4gaW4gYWxsIHJlZ2lvbnMuIFRoZSBncm91cCB3aXRoIHRoZSBsYXJnZXN0IGluY3JlYXNlIGluIHRoZSBVU0EgaXMgdGhlIHdvbWVuIGxpdmluZyBpbiBydXJhbCBhcmVhcy4KCkxldCdzIGNoZWNrIHRoZSBkaWZmZXJlbmNlIHdpdGggc29tZSBzdGF0aXN0aWNhbCB0ZXN0czoKCmBgYHtyfQojZmlyc3QgbGV0cyBsb29rIGF0IHRoZSBub3JtYWxpdHkgb2YgdGhlIGRpZmZlcmVuY2UgaW4gQk1JCkJNSV9kaWZmX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyh4PURpZmZlcmVuY2UpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFR5cGUpCiMgaW50ZXJlc3RpbmcuLi50aGUgc3ByZWFkIG9mIGRpZmZlcmVuY2UgaXMgbXVjaCBicm9hZGVyIGZvciB3b21lbiB0aGFuIGZvciBtZW4gCiMgc29tZSB3b21lbiBpbiBzb21lIGNvdW50cmllcyBlc3BlY2lhbGx5IG5lZWQgaGVscCB3aXRoIG9iZXNpdHkKIyB3aGlsZSBvdGhlciBjb3VudHJpZXMgYXJlIGFjdHVhbGx5IHNob3dpbmcgYSBsb3NzIG9mIEJNSQojIHRoZXNlIGNvdW50cmllcyBhcmUgdGhlIHBvaW50cyBvbiBvdXIgcHJldmlvdXMgcGxvdCB3aXRoIGEgZGlmZmVyZW5jZSBiZWxvdyAwCgojTGV0J3Mgc2VlIHdobzoKQk1JX2RpZmZfbG9uZyAlPiUgCiAgYXJyYW5nZShEaWZmZXJlbmNlKQoKIyBJbiBnZW5lcmFsLCBwZW9wbGUgYXBwZWFyIHRvIGhhdmUgbG9zdCB3ZWlnaHQgaW4gR3JlZWNlCgojIExldCdzIGxvb2sgYXQgUS1RIHBsb3RzOgpCTUlfZGlmZl9sb25nICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1EaWZmZXJlbmNlKSkgKwogIHN0YXRfcXEoKSArICMgdG8gYWRkIHRoZSBsaW5lIHdlIG5lZWQgdG8gYWxzbyBpbmNsdWRlIHN0YXRfcXFfbGluZSgpCiAgc3RhdF9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofiBTZXggKyBUeXBlKQoKIyBvayBzbyBzb21lIG9mIHRoZSBkYXRhIGZvciBNZW4gbG9va3MgZmFpcmx5IG5vcm1hbCBidXQgbm90IGFzIG11Y2ggZm9yIFdvbWVuCgojIE5vdyB3ZSB3aWxsIGNoZWNrIHRoZSB2YXJpYW5jZQoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlVyYmFuX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSkpCiNyZWplY3QgdGhlIG51bGwgLSBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIG5vdCBlcXVhbAoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJNZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSkKI2ZhaWwgdG8gcmVqZWN0IHRoZSBudWxsIHRoZSBudWxsIC0gY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBlcXVhbAoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiTWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBUeXBlID09ICJSdXJhbF9kaWZmZXJlbmNlIiksIERpZmZlcmVuY2UpKQojcmVqZWN0IHRoZSBudWxsIC0gY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBub3QgZXF1YWwKCgojIGxldCdzIGNvbXBhcmUgdGhlIGdyb3VwcwojIHRoaXMgaXMgYWdhaW4gc3RpbGwgcGFpcmVkIGRhdGEKIyB0aGlzIGlzIGJlY2F1c2UgZWFjaCB2YWx1ZSBvZiAiUnVyYWxfZGlmZmVyZW5jZSIgYW5kICJVcmJhbl9kaWZmZXJlbmNlIiBjb3JyZXNwb25kIHRvIHRoZSBzYW1lIGNvdW50cnkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsICAKICAgICAgICAgICAgICAgICAgICBUeXBlID09ICJSdXJhbF9kaWZmZXJlbmNlIiksIERpZmZlcmVuY2UpLCAKICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLAogICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAgCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKSAKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlVyYmFuX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksCiAgICAgICAgcGFpcmVkID0gVFJVRSkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksIAogICAgICAgIHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAgCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKQoKYGBgCk5vdyB3ZSBoYXZlIHBlcmZvcm1lZCBzZXZlbiBjb21wYXJpc29ucyAoNCBlYXJsaWVyKSBzbyB3ZSBzaG91bGQgYXBwbHkgb3VyIG11bHRpcGxlIHRlc3RpbmcgY29ycmVjdGlvbgpgYGB7cn0KLjA1LzcKCmBgYAoKV2Ugc2VlIHRoYXQgdGhlcmUgaXMgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIHRoZSBjaGFuZ2UgaW4gQk1JIFJ1cmFsIGNvbW11bml0aWVzIGJldHdlZW4gbWVuIGFuZCB3b21lbi4gVGhpcyBjaGFuZ2UgaXMgbGFyZ2VyIGZvciB3b21lbi4KCkltcG9ydGFudGx5LSB3ZSBub3RpY2VkIHRoYXQgaXQgYXBwZWFycyB0byBiZSBzcGVjaWZpYyBjb3VudHJpZXMgd2hlcmUgQk1JIHNob3dzIGEgcGFydGljdWxhciBpbmNyZWFzZSBlc3BlY2lhbGx5IGZvciB3b21lbi4gV2hpY2ggY291bnRyaWVzIGFyZSB0aG9zZT8gaG93IGRvZXMgdGhhdCBjb21wYXJlIHdpdGggdGhlIFVTPyBDbGVhcmx5IHRoZSBVUyBpcyBhbW9uZyB0aGUgY291bnRyaWVzIHdpdGggdGhlIGhpZ2hlc3QgZGlmZmVyZW5jZXMuIAoKYGBge3J9CkJNSV9kaWZmX2xvbmcgJT4lIAogIGZpbHRlcihDb3VudHJ5ID09ICJVU0EiKQoKYGBgCgpJbiB0aGUgVVMsIGZvY3VzIHNob3VsZCBiZSBwbGFjZWQgb24gPGI+IGJvdGggdXJiYW4gYW5kIHJ1cmFsIDwvYj4gd29tZW4gdG8gaW1wcm92ZSB0aGlzIHB1YmxpYyBoZWFsdGggaXNzdWUuIAoKSGVyZSB3ZSBjYW4gc2VlIHRoZSBjb3VudHJpZXMgaGF2ZSB0aGUgbGFyZ2VzdCBkaWZmZXJlbmNlcyBpbiBCTUkgZnJvbSAxOTg1LTIwMTc6CgpgYGB7cn0KQk1JX2RpZmZfbG9uZyAlPiUKICBmaWx0ZXIoRGlmZmVyZW5jZT40LjkpICU+JQogIGFycmFuZ2UoLURpZmZlcmVuY2UpCiNoZXJlIHdlIHNvcnRlZCBieSB0aGUgaGlnaGVzdCB0byBsb3dlc3QgdmFsdWVzIG9mIEJNSSBEaWZmZXJlbmNlCmBgYAoKCkhvd2V2ZXIgaXQgaXMgaW1wb3J0YW50IHRvIHNlZSB3aGF0IHRoZSBtZWFuIEJNSSB2YWx1ZXMgYXJlIHdlcmUgZm9yIHRoZXNlIGNvdW50cmllcyBpbiAyMDE3LiAKSXQgY291bGQgYmUgdGhhdCB0aGUgYXZlcmFnZSB3YXMgdW5kZXJ3ZWlnaHQgaW4gMTk4NS4uLiBsZXQncyB0YWtlIGEgbG9vay4KCmBgYHtyfQpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKENvdW50cnkgJWluJSBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCBEaWZmZXJlbmNlPjQuOSksIENvdW50cnkpLCAKICAgICAgICAgICAgICAgICAgICBTZXggJWluJSBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCBEaWZmZXJlbmNlPjQuOSksIFNleCksCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSIyMDE3IikgJT4lCiAgYXJyYW5nZSgtQk1JKQoKI0hlcmUgaXMgdGhlIGRhdGEganVzdCBmb3IgdGhlIGNoYW5nZXMgaW4gQk1JIGluIEVneXB0CmZpbHRlcihCTUlfZGlmZl9sb25nLCBDb3VudHJ5ID09ICJFZ3lwdCIpICU+JSAKICBhcnJhbmdlKC1EaWZmZXJlbmNlKQoKYGBgClRodXMgcnVyYWwgd29tZW4gaW4gRWd5cHQgaGFkIHRoZSBncmVhdGVzdCBpbmNyZWFzZSBpbiBCTUkgZnJvbSAxOTg1IHRvIDIwMTcgaW4gdGhpcyBkYXRhICg1LjkpIGFuZCB0aGUgYXZlcmFnZSBCTUkgaXMgbm93IG92ZXIgdGhlIG9iZXNpdHkgdGhyZXNob2xkIG9mIDMwLgoKVGhlIGRhdGEgc3VnZ2VzdHMgdGhhdCBydXJhbCB3b21lbiBpbiBFZ3lwdCBhbmQgb3RoZXIgY291bnRyaWVzIG1heSBlc3BlY2lhbGx5IGJlbmVmaXQgZnJvbSBkaWV0YXJ5IHJlc291cmNlcyBhbmQgb3VyIGludGVydmVudGlvbnMgYW5kIHByb2dyYW1zIHRvIGFzc2lzdCB3aXRoIHdlaWdodCBtYW5hZ2VtZW50LgoKTm93IGxldCdzIG1ha2UgYSBwbG90IHRoYXQgc3VtbWFyaXplcyBvdXIgZmluZGluZ3MuIFRvIGRvIHRoaXMgd2Ugd2lsbCBzaW1wbGlmeSB0aGUgb3RoZXIgcGxvdHMgd2UgbWFkZSBhbmQgdGhlbiBjb21iaW5lIHRoZW0gdG9nZXRoZXIuCgpgYGB7cn0KCiMgc2ltcGxpZmllZCBuYXRpb25hbCBtZWFucyBwbG90Ck1lYW5zX3Bsb3Q8LUJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gPT0gIk5hdGlvbmFsIikgJT4lCmdncGxvdChhZXMoeCA9IFNleCwgeSA9IEJNSSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBTZXgpKSArIAogc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzPWMoImRvZGdlcmJsdWUiLCAib3JjaGlkMiIpKSArCiAgZmFjZXRfZ3JpZCh+IFllYXIpICsgCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0PTMwLCBsaW5ldHlwZT0iZGFzaGVkIiwgY29sb3IgPSAicmVkIiwgc2l6ZSA9MSkgKyAKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9sb25nICU+JQogICAgICAgICAgICAgICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiKSwKICAgICAgICAgICAgICAgIGFlcyh4ID1TZXgsIHkgPUJNSSksIAogICAgICAgICAgICAgICAgd2lkdGggPSAuMiwgc2l6ZSA9Miwgc2hhcGUgPTIxLCAKICAgICAgICAgICAgICAgIGNvbG9yID0gImJsYWNrIiwgZmlsbCA9ICJncmF5IikgKwogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudHJ5ID09ICJVU0EiKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFlcyh4ID1TZXgsIHkgPUJNSSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gLjAyLCBzaXplID0xMiwgc2hhcGUgPTIxLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHBvaW50cyB0aGF0IGFyZSBsYXJnZXIgZm9yIHRoZSBVU0EgZGF0YQogIGdlb21fdGV4dChkYXRhPXN1YnNldChCTUlfbG9uZyU+JQogICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiLCBDb3VudHJ5ID09ICJVU0EiKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgYWVzKHggPVNleCwgeSA9Qk1JLGxhYmVsPUNvdW50cnkpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZV9saW5lZHJhdygpICsKICAjIFRoaXMgd2lsbCBtYWtlIHRoZWJhY2tncm91bmQgb2YgdGhlIHBsb3Qgd2hpdGUgYW5kIHRoZSBmYWNldCBsYWJlbHMgYmxhY2sKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCwgdmp1c3QgPSAwLjUpLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSkpCiAgIAojU2ltcGxpZmllZCBkaWZmZXJlbmNlIHBsb3QgCkJNSV9kaWZmX2xvbmckVHlwZSA8LUJNSV9kaWZmX2xvbmckVHlwZSAlPiUKICBzdHJfcmVwbGFjZSggcGF0dGVybiA9ICJfZGlmZmVyZW5jZSIsIHJlcGxhY2VtZW50ID0gIiIpCgpEaWZmX3Bsb3Q8LUJNSV9kaWZmX2xvbmcgJT4lIAogIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgIFR5cGUgIT0gIk5hdGlvbmFsIikgJT4lCmdncGxvdCggYWVzKHggPSBUeXBlLCB5ID0gRGlmZmVyZW5jZSwgY29sID0gVHlwZSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBTZXgpKSArIAogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcz1jKCJkb2RnZXJibHVlIiwgIm9yY2hpZDIiKSkgKwogIGZhY2V0X2dyaWQofiBTZXgpICsKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9kaWZmX2xvbmcgJT4lIAogICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICBUeXBlICE9ICJOYXRpb25hbCIpLCAKICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICB3aWR0aCA9IC4yLCBzaXplID0yLCBzaGFwZSA9MjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9kaWZmX2xvbmcgJT4lIAogICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICBUeXBlICE9ICJOYXRpb25hbCIsIAogICAgICAgICAgIENvdW50cnkgPT0gIlVTQSIpKSwgCiAgICBhZXMoeCA9VHlwZSwgeSA9RGlmZmVyZW5jZSksIAogICAgd2lkdGggPSAuMDIsIHNpemUgPTEyLCBzaGFwZSA9MjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyAlPiUgCiAgICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksCiAgICAgICAgICAgVHlwZSAhPSAiTmF0aW9uYWwiKSwgCiAgICAgICAgICAgQ291bnRyeSA9PSAiVVNBIiksCiAgICBhZXMoeCA9VHlwZSwgeSA9RGlmZmVyZW5jZSxsYWJlbD1Db3VudHJ5KSwgCiAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZV9saW5lZHJhdygpICsKICAgICMgVGhpcyB3aWxsIG1ha2UgdGhlIGJhY2tncm91bmQgb2YgdGhlIHBsb3Qgd2hpdGUgYW5kIHRoZSBmYWNldCBsYWJlbHMgYmxhY2sKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCwgdmp1c3QgPSAwLjUpLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSkpCiAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgb2YgeCBheGlzIGxhYmVscyBmb3IgdGhlIGZhY2V0CgojYWRkIGxhYmVscwpEaWZmX3Bsb3Q8LURpZmZfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiQ2hhbmdlIGluIEJNSSBieSByZWdpb24iLCAKICAgICAgICAgICAgIHggPSAiIiwgCiAgICAgICAgICAgICB5ID0gIkNoYW5nZSBpbiBCTUkgXG4gKDE5ODUgdG8gMjAxNykiKSArCiAgICAgICAgdGhlbWUodGl0bGUgPSBlbGVtZW50X3RleHQgKHNpemUgPSAxMiwgZmFjZSA9ICJib2xkIikpCgpNZWFuc19wbG90IDwtTWVhbnNfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiTWVhbiBCTUkgb3ZlciB0aW1lIiwgCiAgICAgICAgICAgICB4ID0gIiIsIAogICAgICAgICAgICAgeSA9ICJNZWFuIEJNSSIpICsKICAgICAgICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dCAoc2l6ZSA9IDEyLCBmYWNlID0gImJvbGQiKSkKCgoKb2Jlc2l0eV90ZXh0PC10aWJibGUoWWVhcj1jKDE5ODUpLEJNST1jKDMxKSxTZXg9YygiTWVuIiksbGFiZWw9YygiT2Jlc2l0eSIpKQoKTWVhbnNfcGxvdCA8LU1lYW5zX3Bsb3QgKyAKICAgICAgICAgICAgIGdlb21fdGV4dChkYXRhID0gb2Jlc2l0eV90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXB1bGwob2Jlc2l0eV90ZXh0LGxhYmVsKSwgCiAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgYWVzKCBmb250ZmFjZSA9ImJvbGQuaXRhbGljIiwgc2l6ZSA9IDEzKSkKCmNvd3Bsb3Q6OnBsb3RfZ3JpZChNZWFuc19wbG90LCBEaWZmX3Bsb3QsIGxhYmVscyA9IGMoIkEiLCAiQiIpKQoKCmBgYAoKR3JlYXQsIG5vdyB3ZSBoYXZlIHB1dCB0d28gcGxvdHMgdG9nZXRoZXIgdXNpbmcgdGhlIGBwbG90X2dyaWQoKWAgZnVuY3Rpb24gb2YgdGhlIGBjb3dwbG90YCBwYWNrYWdlLiBUaGlzIHdheSB3ZSBjYW4gY2xlYXJseSBjb21tdW5pY2F0ZSB0d28gbWVzc2FnZXMuIFRoZSBmaXJzdCBiZWluZyB0aGF0IEJNSSBoYXMgaW5jcmVhc2VkIG92ZXIgdGltZSBnbG9iYWxseSBhbmQgdGhhdCBtYW55IGNvdW50cmllcyBpbmNsdWRpbmcgdGhlIFVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSBhcmUgYXBwcm9hY2hpbmcgYSBtZWFuIEJNSSB0aGF0IGlzIGFib3ZlIHRoZSBvYmVzaXR5IHRocmVzaG9sZCBvZiAzMC4gV2UgY2FuIGFsc28gc2VlIHRoYXQgd29tZW4gb24gYXZlcmFnZSBoYXZlIGxhcmdlciBCTUkgdmFsdWVzIHRoYW4gbWFsZXMsIGJ1dCB0aGF0IGJvdGggZ2VuZGVycyBzaG93IGluY3JlYXNlZCBsZXZlbHMgb3ZlciB0aW1lLiBJbiB0aGUgc2Vjb25kIHBsb3Qgd2UgY2FuIHNlZSB0aGF0IHRoZSBpbmNyZWFzZSBpbiBCTUkgaXMgbm90IGp1c3QgaGFwcGVuaW5nIGluICB1cmJhbiBjb21tdW5pdGllcywgYnV0IGluIGJvdGggcnVyYWwgYW5kIHVyYmFuIGNvbW11bml0aWVzIGFuZCBwYXJ0aWN1bGFybHkgaW4gd29tZW4uIAoKT3VyIHBsb3QgdmlzdWFsbHkgZXhwbG9yZXMgYWxsIG9mIG91ciBtYWluIHF1ZXN0aW9uczoKMSkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8gSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwoyKSBIb3cgaGF2ZSBCTUkgZXN0aW1hdGVzIGNoYW5nZWQgZnJvbSAxOTg1IHRvIDIwMTc/IEFnYWluLCBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGlzIGxvb2sgZm9yIGZlbWFsZXM/CjMpIEhvdyBkbyBkaWZmZXJlbnQgY291bnRyaWVzIGNvbXBhcmUgZm9yIEJNSSBlc3RpbWF0ZXM/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoZSBVbml0ZWQgU3RhdGVzIGNvbXBhcmUgdG8gdGhlIHJlc3Qgb2YgdGhlIHdvcmxkPwoKCiMjIFN1bW1hcnkKCldlIGhhdmUgZXZhbHVhdGVkIEJNSSBhdmVyYWdlIGVzdGltYXRlcyBmcm9tIDIwMCBkaWZmZXJlbnQgY291bnRyaWVzIGFyb3VuZCB0aGUgd29ybGQuIFRvIGRvIHNvIHdlIGltcG9ydGVkIGRhdGEgZnJvbSBhIHBkZiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlLiBXZSB1c2VkIGB0aWR5dmVyc2VgIHBhY2thZ2VzIHN1Y2ggYXMgYGRwbHlyYCwgYHN0cmluZ3JgLCBhbmQgYHRpZHlgIHRvIGNsZWFuIHRoZSBkYXRhIGFuZCBnZXQgaXQgaW4gYSB3b3JrYWJsZSBmb3JtYXQuIE91ciBzdGF0aXN0aWNhbCBhbmFseXNpcyBmb2N1c2VkIG9uIGV2YWx1YXRpbmcgZGlmZmVyZW5jZXMgaW4gQk1JIGluIGZlbWFsZXMgYXJvdW5kIHRoZSB3b3JsZCBhY3Jvc3MgdGltZSBhbmQgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gYXJlYXMuIFdlIGZvdW5kIGEgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBib3RoIGJldHdlZW4geWVhcnMgYW5kIGJldHdlZW4gdGhlIHR5cGUgb2YgY29tbXVuaXR5IGFtb25nIHdvbWVuIGdsb2JhbGx5IHVzaW5nIFt0LXRlc3RzXShodHRwczovL3N0YXR0cmVrLmNvbS9zdGF0aXN0aWNzL2RpY3Rpb25hcnkuYXNweD9kZWZpbml0aW9uPXR3by1zYW1wbGUlMjB0LXRlc3QpIGFuZCBbbm9ucGFyYW1ldHJpY10oaHR0cHM6Ly93d3cubWF5by5lZHUvcmVzZWFyY2gvZG9jdW1lbnRzL3BhcmFtZXRyaWMtYW5kLW5vbnBhcmFtZXRyaWMtZGVteXN0aWZ5aW5nLXRoZS10ZXJtcy9kb2MtMjA0MDg5NjApIHRlc3RzLiBUaHVzIEJNSSBoYXMgaW5jcmVhc2VkIGluIHdvbWVuIHNpbmNlIDE5ODUuIEFsdGhvdWdoIEJNSSBlc3RpbWF0ZXMgYXJlIHNpZ25pZmljYW50bHkgaGlnaGVyIGluIFVyYmFuIGFyZWFzIGNvbXBhcmVkIHRvIHJ1cmFsIGFyZWFzLCBCTUkgZXN0aW1hdGVzIGhhdmUgaW5jcmVhc2VkIGluIGJvdGggcmVnaW9ucy4gV2UgbGVhcm5lZCB0aGF0IHRoZXJlIGFyZSBhc3N1bXB0aW9ucyBhbmQgY29uc2lkZXJhdGlvbnMgdG8ga2VlcCBpbiBtaW5kIHdoZW4gcGVyZm9ybWluZyB0ZXN0cyB0aGF0IGNvbXBhcmUgdHdvIGdyb3Vwcy4gCgo8dT4gV2UgbGVhcm5lZCB0aGF0IHRoZSB0LXRlc3QgcmVsaWVzIG9uOjwvdT4KMSkgbm9ybWFsaXR5IG9mIHRoZSBkYXRhIGZvciBib3RoIGdyb3VwcyAodGhpcyBpcyBub3QgYXMgbXVjaCBvZiBhbiBpc3N1ZSBpZiB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBpcyByZWxhdGl2ZWx5IGxhcmdlIHRvdGFsIG4+MzApCjIpIGVxdWFsIHZhcmlhbmNlIGJldHdlZW4gdGhlIHR3byBncm91cHMgKG1ha2Ugc3VyZSB5b3UgZG8gdGhlIGNvcnJlY3QgdGVzdCBpZiB0aGUgZGF0YSBpcyBub3Qgbm9ybWFsKQozKSBiYWxhbmNlZCBzYW1wbGUgc2l6ZXMgb2YgdGhlIHR3byBncm91cHMKNCkgaW5kZXBlbmRlbnQgb2JzZXJ2YXRpb25zIChvciBpbmRlcGVuZGVudCBwYWlyZWQgb2JzZXJ2YXRpb25zKQoKV2UgbGVhcm5lZCB0aGF0IHdlIGNhbiBldmFsdWF0ZSBpZiBvdXIgZGF0YSBpcyBbbm9ybWFsbHkgZGlzdHJpYnV0ZWRdKGh0dHBzOi8vd3d3LnBoeXNpb2xvZ3kub3JnL2RvaS9mdWxsLzEwLjExNTIvYWR2YW4uMDAwNjQuMjAxNykgYnkgcGxvdHRpbmcgdGhlIGRpc3RyaWJ1dGlvbiBhbmQgYnkgY3JlYXRpbmcgUS1RIHBsb3RzLgoKPHU+V2UgbGVhcm5lZCB0aGF0IGlmIG91ciBkYXRhIGlzIG5vdCBub3JtYWxseSBkaXN0cmlidXRlZCwgd2UgY2FuIGNvbnNpZGVyIHRoZXNlIG9wdGlvbnM6PC91PgoxKSBXZSBjYW4gc3RpbGwgcGVyZm9ybSBhIHQtdGVzdCBpZiBvdXIgbiBpcyBsYXJnZQoyKSBXZSBjYW4gdHJhbnNmb3JtIHRoZSBkYXRhIGJlZm9yZSBwZXJmb3JtaW5nIGEgdC10ZXN0CjMpIFdlIGNhbiB1c2UgYSBub25wYXJhbWV0cmljIHRlc3QgKFdpbGNveG9uIHNpZ25lZCByYW5rIHRlc3QsIHRoZSBXaWxjb3hvbiByYW5rIHN1bSB0ZXN0LCBhbmQgdGhlIFR3by1zYW1wbGUgS29sbW9nb3Jvdi1TbWlybm92IChLUykgdGVzdCkKNCkgV2UgY2FuIHBlcmZvcm0gYSB0LXRlc3Qgd2l0aCByZXNhbXBsaW5nIG1ldGhvZHMgKHdoaWNoIHNob3VsZCBiZSBlc3BlY2lhbGx5IGNvbnNpZGVyZWQgd2hlbiB0aGUgZ3JvdXBzIGFyZSBpbWJhbGFuY2VkKQoKV2UgbGVhcm5lZCB0aGF0IGlmIG91ciBncm91cHMgZG8gbm90IGhhdmUgZXF1YWwgdmFyaWFuY2UsIHRoYXQgd2UgbmVlZCB0byB1c2UgYSBtb2RpZmllZCB0LXRlc3QgdG8gYWNjb3VudCBmb3IgdGhpcyBvciB0aGUgY29ycmVjdCBub25wYXJhbWV0cmljIHRlc3QgdGhhdCBkb2VzIG5vdCByZWx5IG9uIHRoaXMgYXNzdW1wdGlvbiAoVHdvLXNhbXBsZSBLb2xtb2dvcm92LVNtaXJub3YgdGVzdCkuCgpXZSBhbHNvIGxlYXJuZWQgdGhhdCBpZiBvdXIgZ3JvdXBzIGFyZSBub3Qgd2VsbCBiYWxhbmNlZCwgdGhhdCB3ZSBjYW4gY29uc2lkZXIgcmVzYW1wbGluZyBtZXRob2RzLgoKRmluYWxseSBpdHMgYWxzbyBpbXBvcnRhbnQgdG8gcmVtZW1iZXIgdGhhdCB3aGVuIHdlIGhhdmUgW3BhaXJlZCBkYXRhXShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS9wYWlyZWQtZGF0YS8pIGFuZCBpbnRlbmQgdG8gY29tcGFyZSBtZWFucywgd2Ugc2hvdWxkIHBlcmZvcm0gYSBwYWlyZWQgdGVzdCAoW3BhaXJlZCB0LXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL2h5cG90aGVzaXMtdGVzdC9wYWlyZWQtbWVhbnMuYXNweCNleGFtcGxlMSksIFdpbGNveG9uIHNpZ25lZCByYW5rIHRlc3QsIG9yIHBhaXJlZCBLUyB0ZXN0KS4gT3VyIGRhdGEgdXNlZCBpbiB0aGlzIGNhc2Ugc3R1ZHkgd2FzIHBhaXJlZCBiZWNhdXNlIG9ic2VydmF0aW9ucyB3ZXJlIHRha2VuIGZvciB0aGUgc2FtZSBjb3VudHJpZXMgZm9yIGRpZmZlcmVudCBjYXRlZ29yaWVzIG9mIHBvcHVsYXRpb25zIC0gdGh1cywgd2Ugd2FudGVkIHRvIGNvbXBhcmUgdGhlc2UgcG9wdWxhdGlvbnMgd2l0aGluIHRoZSBzYW1lIGNvdW50cnkgKG1hbGUgdnMgZmVtYWxlLCBydXJhbCB2cyB1cmJhbiBldGMuKS4gT3RoZXIgZXhhbXBsZXMgd291bGQgYmUgaW4gYSBjYXNlLWNvbnRyb2wgc3R1ZHkgKGlmIHNhbXBsZXMgYXJlIG1hdGNoZWQgZm9yIHZhcmlvdXMgZGVtb2dyYXBoaWNzKSBvciBhIHN0dWR5IHdpdGggcmVwZWF0ZWQgbWVhc3VyZXMgKGZvciBleGFtcGxlLCBzeW1wdG9tIG1lYXN1cmVzIGZyb20gdGhlIHNhbWUgaW5kaXZpZHVhbCBiZWZvcmUgYW5kIGFmdGVyIGEgdHJlYXRtZW50KS4gCgoKVXNpbmcgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlIHdlIHdlcmUgYWJsZSB0byB2aXN1YWxpemUgdHJlbmRzIGluIHRoZSBkYXRhLiBJbXBvcnRhbnRseSwgdGhlIGxhcmdlc3QgaW5jcmVhc2UgYXBwZWFycyB0byBiZSBpbiB0aGUgcnVyYWwgYXJlYXMgcGFydGljdWxhcmx5IGZvciB3b21lbi4gV2Ugd2VyZSBhbHNvIGFibGUgdG8gaWRlbnRpZnkgaG93IHRoZSBVUyBjb21wYXJlZCB0byBvdGhlciBjb3VudHJpZXMgYW5kIHdoaWNoIGNvdW50cmllcyBzaG93ZWQgdGhlIGxhcmdlc3QgaW5jcmVhc2UgaW4gQk1JIG92ZXIgdGltZS4gQW5hbHlzZXMgbGlrZSB0aGlzIGFyZSBpbXBvcnRhbnQgZm9yIGRlZmluaW5nIHdoaWNoIGdyb3VwcyBjb3VsZCBiZW5lZml0IHRoZSBtb3N0IGZyb20gaW50ZXJ2ZW50aW9ucywgZWR1Y2F0aW9uLCBhbmQgcG9saWN5IGNoYW5nZXMgd2hlbiBhdHRlbXB0aW5nIHRvIG1pdGlnYXRlIHB1YmxpYyBoZWFsdGggY2hhbGxlbmdlcy4gWW91IGNhbiBzZWUgaW4gdGhlIFthcnRpY2xlXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL3M0MTU4Ni0wMTktMTE3MS14LnBkZikgdGhhdCB0aGlzIGRhdGEgY2FtZSBmcm9tIHRoYXQgbWFueSBhZGRpdGlvbmFsIGNvbnNpZGVyYXRpb25zIHdvdWxkIGJlIGludm9sdmVkIHRvIHBlcmZvcm0gc3VjaCBhbiBhbmFseXNpcy4KCgojIyMgU3VnZ2VzdGVkIEhvbWV3b3JrCgpTdHVkZW50cyBjYW4gZXZhbHVhdGUgdGhlIGNoYW5nZSBpbiBCTUkgb3ZlciB0aW1lIHVzaW5nIHRoZSBnbG9iYWwgZGF0YSBhdmFpbGFibGUgZm9yIGVhY2ggeWVhciBiZXR3ZWVuIDIwMTUgYW5kIDIwMTcuIFRoZSBkYXRhIGNhbiBiZSBmb3VuZCBbaGVyZV0oaHR0cDovL3d3dy5uY2RyaXNjLm9yZy9kb3dubG9hZHMvYm1pL05DRF9SaXNDX0xhbmNldF8yMDE3X0JNSV9hZ2Vfc3RhbmRhcmRpc2VkX3dvcmxkLmNzdikuCgojIyMgSGVscGZ1bCBMaW5rcwoKW0JNSV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9oZWFsdGh5d2VpZ2h0L2Fzc2Vzc2luZy9ibWkvYWR1bHRfYm1pL2luZGV4Lmh0bWwpICAKW0xvbmcgYW5kIFdpZGUgRGF0YSBGb3JtYXRzXShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKSAgCltEaXN0cmlidXRpb25zXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCkKW05vcm1hbCBEaXN0cmlidXRpb25dKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9pbnRyb2R1Y3Rpb24vZGlzdHJpYnV0aW9ucy5odG1sKQpbU2tld2VkIERpc3RyaWJ1dGlvbnNdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9nbG9zc2FyeS9za2V3Lmh0bWwpICAKW0JpbW9kYWwgRGlzdHJpYnV0aW9uXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCkgIApbZ2dwbG90Ml0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1oZWFsdGhleHBlbmRpdHVyZS9vY3MtaGVhbHRoZXhwZW5kaXR1cmUuaHRtbCkgICAgCltRLVEgUGxvdHNdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9hZHZhbmNlZF9ncmFwaHMvcS1xX3Bsb3RzLmh0bWwpICAKW1NoYXBpcm8tV2lsayBUZXN0XShodHRwOi8vd3d3LnN0YXRpc3RpY3M0dS5pbmZvL2Z1bmRzdGF0X2VuZy9lZV9zaGFwaXJvX3dpbGtfdGVzdC5odG1sKSAgCltTdHVkZW50IHQtdGVzdF0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj10d28tc2FtcGxlJTIwdC10ZXN0KSAgIApbUGFpcmVkIERhdGFdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzU1Nzk0NjUvKSAgCltXZWxjaCdzIHQtdGVzdF0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vd2VsY2hzLXRlc3QtZm9yLXVuZXF1YWwtdmFyaWFuY2VzLykgICAgCltQYXJhbWV0cmljIGFuZCBOb25wYXJhbWV0cmljIE1ldGhvZHNdKGh0dHBzOi8vd3d3Lm1heW8uZWR1L3Jlc2VhcmNoL2RvY3VtZW50cy9wYXJhbWV0cmljLWFuZC1ub25wYXJhbWV0cmljLWRlbXlzdGlmeWluZy10aGUtdGVybXMvZG9jLTIwNDA4OTYwKSAgCltWYXJpYW5jZV0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj12YXJpYW5jZSkgIApbQmFsYW5jZWQgU3R1ZHkgRGVzaWduXShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS9iYWxhbmNlZC1hbmQtdW5iYWxhbmNlZC1kZXNpZ25zLykgIApbSW5kZXBlbmRlbnQgT2JzZXJ2YXRpb25zXShodHRwczovL3d3dy5zdGF0LmNtdS5lZHUvfmNzaGFsaXppLzM2LTIyMC9sZWN0dXJlLTUucGRmKSAgCltUcmFuc2Zvcm1hdGlvbl0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vdHJhbnNmb3JtYXRpb24tc3RhdGlzdGljcy8pICAKW1Blcm11dGF0aW9uL1Jlc2FtcGxpbmcgTWV0aG9kc10oaHR0cHM6Ly9qaHUtYWR2ZGF0YXNjaS5naXRodWIuaW8vMjAxOS9sZWN0dXJlcy8yMS1yZXNhbXBsaW5nLXRlY2huaXF1ZXMuaHRtbCkgICAKW0NlbnRyYWwgTGltaXQgVGhlb3JlbV0oaHR0cHM6Ly93d3cuYW5hbHl0aWNzdmlkaHlhLmNvbS9ibG9nLzIwMTkvMDUvc3RhdGlzdGljcy0xMDEtaW50cm9kdWN0aW9uLWNlbnRyYWwtbGltaXQtdGhlb3JlbS8pICAKW01vb2QncyBUd28tU2FtcGxlIFNjYWxlIFRlc3RdKGh0dHBzOi8vZmlsZXMuZXJpYy5lZC5nb3YvZnVsbHRleHQvRUQwNjU1NTkucGRmKSAgCltXaWxjb3hvbiBTaWduZWQgUmFuayBUZXN0XShodHRwOi8vd3d3LmJpb3N0YXRoYW5kYm9vay5jb20vd2lsY294b25zaWduZWRyYW5rLmh0bWwpICAgCltXaWxjb3hvbiBSYW5rIFN1bSBUZXN0XShodHRwOi8vc3Bod2ViLmJ1bWMuYnUuZWR1L290bHQvbXBoLW1vZHVsZXMvYnMvYnM3MDRfbm9ucGFyYW1ldHJpYy9CUzcwNF9Ob25wYXJhbWV0cmljNC5odG1sKSAgCltUd28tc2FtcGxlIEtvbG1vZ29yb3YtU21pcm5vdiBUZXN0XShodHRwczovL3d3dy5pdGwubmlzdC5nb3YvZGl2ODk4L3NvZnR3YXJlL2RhdGFwbG90L3JlZm1hbjEvYXV4aWxsYXIva3Myc2FtcC5odG0pICAKW1R5cGUgMSBFcnJvcl0oaHR0cHM6Ly93ZWIubWEudXRleGFzLmVkdS91c2Vycy9ta3Mvc3RhdG1pc3Rha2VzL2Vycm9ydHlwZXMuaHRtbCkgIApbcC12YWx1ZV0oaHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL3AtdmFsdWVzLWV4cGxhaW5lZC1ieS1kYXRhLXNjaWVudGlzdC1mNDBhNzQ2Y2ZjOCkgIApbTXVsdGlwbGUgVGVzdGluZ10oaHR0cHM6Ly93d3cuZ3Mud2FzaGluZ3Rvbi5lZHUvYWNhZGVtaWNzL2NvdXJzZXMvYWtleS81NjAwOC9sZWN0dXJlL2xlY3R1cmUxMC5wZGYpICAgIApbQm9uZmVycm9uaSBNZXRob2Qgb2YgTXVsdGlwbGUgVGVzdGluZyBDb3JyZWN0aW9uXShodHRwOi8vbWF0aHdvcmxkLndvbGZyYW0uY29tL0JvbmZlcnJvbmlDb3JyZWN0aW9uLmh0bWwpCgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
