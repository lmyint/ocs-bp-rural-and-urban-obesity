<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Open Case Studies: Exploring global patterns of obesity across rural and urban regions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies: Exploring global patterns of obesity across rural and urban regions</h1>

</div>


<style>
#TOC {
  background: url("https://opencasestudies.github.io/img/logo.jpg");
  background-size: contain;
  padding-top: 240px !important;
  background-repeat: no-repeat;
}
</style>
<div id="section" class="section level4 outline">
<h4></h4>
<p><img src="img/main_plot.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level2 disclaimer_block">
<h2></h2>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io" target="_blank">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most appropriate way to analyze a given dataset, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Body mass index (<a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html" target="_blank">BMI</a>) is often used as a proxy for <strong>adiposity</strong> (the condition of having excess body fat) and is measured as an individual’s weight in kilograms (kg) or pounds (lbs) divided by the individual’s height in meters (<span class="math inline">\(m^2\)</span>) squared.</p>
<p>There are different categories of weight defined using different BMI thresholds as defined by the <a href="http://www.euro.who.int/en/health-topics/disease-prevention/nutrition/a-healthy-lifestyle/body-mass-index-bmi" target="_blank">World Health Organization</a> (WHO), the <a href="https://www.cdc.gov/obesity/adult/defining.html" target="_blank">Centers for Disease Control and Prevention</a>, and the <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf" target="_blank">National Institutes of Health</a>. For example, these are the categories defined by the WHO:</p>
<p><img src="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg" width="90%" style="display: block; margin: auto;" /></p>
<div id="source" class="section level6">
<h6>[<a href="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg" target="_blank">source</a>]</h6>
<p>The following chart can help you identify your estimate of BMI: <img src="http://content.everydayhealth.com/mayodiet/images/BMI-chart.jpg" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-1" class="section level6">
<h6>[<a href="http://diet.mayoclinic.org/diet/eat/what-is-your-bmi?xid=nl_MayoClinicDiet_20160426" target="_blank">source</a>]</h6>
<p>Previous work has shown higher BMI (&gt;30) is associated with <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf" target="_blank">higher rates of all-causes of mortality</a>, as well as increased rates of type 2 diabetes, cancer, heart disease, and stroke.</p>
<p>Recently, an <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf" target="_blank">article</a> published in <a href="https://www.nature.com" target="_blank"><em>Nature</em></a> evaluated and compared the Body-Mass Index (BMI) of populations in rural and urban communities around the world:</p>
<p><img src="img/paper.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-2" class="section level4 reference_block">
<h4></h4>
<p>NCD Risk Factor Collaboration (NCD-RisC). Rising rural body-mass index is the main driver of the global obesity epidemic in adults. <em>Nature</em> <strong>569</strong>, 260–264 (2019).</p>
</div>
<div id="section-3" class="section level4">
<h4></h4>
<p>The article challenged the widely-held view that increased urbanization was one of the major reasons for increased global obesity rates. This view came about because many countries around the world have shown increased urbanization levels in parallel with increased obesity rates. In this article, however, the NCD-RisC argued that this might not be the case and that in fact for most regions around the world, BMI measurements are increasing in rural populations just as much, if not more so, than urban populations. Furthermore, this study suggested that obesity has particularly increased in female populations in rural regions:</p>
<blockquote>
<p>“We noted a persistently higher rural BMI, especially for women.”</p>
</blockquote>
<p>In this case study, we will evaluate the data reported in this article to explore regional and gender specific differences in the obesity rates around the world in 1985 and 2017. Most importantly we will test if there is a difference in obesity rates between rural and urban communities and if there has been a change in obesity over time for these regions, particularly for women. To do this we will test if there is a difference between the average BMI for each group.</p>
<p>While <a href="https://www.genderspectrum.org/quick-links/understanding-gender/" target="_blank">gender</a> and <a href="https://www.who.int/genomics/gender/en/index1.html" target="_blank">sex</a> are not actually binary, the data presented that is used in this analysis only contain data for groups of individuals described as men or women.</p>
</div>
<div id="main-questions" class="section level3">
<h3>Main Questions</h3>
<div id="section-4" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions are: </u></b></p>
<ol style="list-style-type: decimal">
<li>Is there a difference between rural and urban BMI estimates around the world? In particular, what does this difference look like for women?</li>
<li>How have BMI estimates changed from 1985 to 2017? In particular, what does this change over time look like for women?</li>
<li>How do different countries vary in terms of estimates of BMI? In particular, how does the United States compare to the rest of the world?</li>
</ol>
</div>
<div id="section-5" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level3">
<h3>Learning Objectives</h3>
<p>In this case study, we will walk you through importing data from a pdf, cleaning, wrangling and visualizing the data, and <b> comparing two groups </b>.</p>
<p>We will use well-established and commonly used packages, including <code>stringr</code>, <code>tidyr</code>, <code>dplyr</code>, <code>purrr</code>, and <code>ggplot2</code> from the <a href="https://www.tidyverse.org/" target="_blank"><code>tidyverse</code></a>. Specifically, the tidyverse is</p>
<blockquote>
<p>“an opinionated collection of R packages designed for data science. All packages share an underlying philosophy and common APIs”.</p>
</blockquote>
<p>Another way of putting it is that it’s a set of packages that are useful specifically for data manipulation, exploration and visualization with a common philosophy. While some students may be familiar with previous packages from the R programming language, these packages make data science in R especially efficient.</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>We will begin by loading the packages that we will need with a brief explanation:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(pdftools)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">library</span>(patchwork)</a></code></pre></div>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data with relative paths</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/pdftools/pdftools.pdf" target="_blank">pdftools</a></td>
<td>to read a text from pdf into R</td>
</tr>
<tr class="odd">
<td><a href="https://stringr.tidyverse.org/articles/stringr.html" target="_blank">stringr</a></td>
<td>to manipulate the text data</td>
</tr>
<tr class="even">
<td><a href="https://readr.tidyverse.org/" target="_blank">readr</a></td>
<td>to manipulate the text data within the pdf into individual lines</td>
</tr>
<tr class="odd">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to arrange/filter/select subsets of the data</td>
</tr>
<tr class="even">
<td><a href="https://tibble.tidyverse.org/" target="_blank">tibble</a></td>
<td>to create data objects that we can manipulate with <code>dplyr</code>/<code>stringr</code>/<code>tidyr</code>/<code>purrr</code></td>
</tr>
<tr class="odd">
<td><a href="https://magrittr.tidyverse.org/articles/magrittr.html" target="_blank">magrittr</a></td>
<td>to use the <code>%&lt;&gt;%</code> piping operator</td>
</tr>
<tr class="even">
<td><a href="https://www.tidyverse.org/blog/2017/10/glue-1.2.0/" target="_blank">glue</a></td>
<td>to paste or combine character strings and data together</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/" target="_blank">purrr</a></td>
<td>to perform functions on all columns of a tibble</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to convert data from ‘wide’ to ‘long’ format</td>
</tr>
<tr class="odd">
<td><a href="https://ggplot2.tidyverse.org/">ggplot2</a></td>
<td>to make visualizations with multiple layers</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html" target="_blank">ggrepel</a></td>
<td>to allow labels in figures not to overlap</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a> and <a href="https://github.com/thomasp85/patchwork" target="_blank">patchwork</a></td>
<td>to allow plots to be combined</td>
</tr>
</tbody>
</table>
<hr />
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using (e.g. <code>stringr::str_detect()</code>). Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level3">
<h3>Context</h3>
<p>The measurement of BMI has some <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/pdf/nt-50-117.pdf" target="_blank">limitations</a> that are well recognized, as it does not account for the composition of body mass, the location of body fat, or the contribution of body frame size. However, <a href="https://journals.lww.com/acsm-healthfitness/Fulltext/2016/07000/THE_BENEFITS_OF_BODY_MASS_INDEX_AND_WAIST.8.aspx#pdf-link" target="_blank">BMI has been a useful health indicator</a> for risk for many diseases and conditions particularly when combined with other risk factor information.</p>
</div>
</div>
<div id="what-are-the-data" class="section level2">
<h2>What are the data?</h2>
<p>We will be using data located within a table of the <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf" target="_blank">supplementary material</a> for the NCD-RisC paper referenced above.</p>
<p>This is a pdf that can be found freely available online. Here is a screenshot of the first few rows of this table:</p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>You can see that the data contain average BMI estimates for both men and women in countries at the national level, as well as the average BMI estimates for the rural and urban areas of these countries in both 1985 and 2017.</p>
<p>The data within the parentheses are the 95% <a href="https://en.wikipedia.org/wiki/Credible_interval" target="_blank">credible intervals</a> (CIs) for the average BMI estimates. The authors provide these CIs as a guide to understand how likely the estimate is for the true population mean BMI. A wider range suggests that the estimate is less accurate, as there are more possible values for the true mean with credible evidence. Notice that the mean BMI values are “age-standardised,” this means that the mean values were adjusted for the different age distributions of the various countries so that the countries can be more fairly compared. For example, if one country has a population that is considerably younger, the mean BMI might be quite low (as younger individuals tend to have lower BMI values due to faster metabolic rates). One might falsely conclude that people in that country generally have lower BMI values than people in most other countries, however the lower overall BMI mean might simply be due to the fact that the country has a younger population than those other countries.</p>
</div>
<div id="data-import" class="section level2">
<h2>Data Import</h2>
<p>First let’s download the data from the PDF file. We use <code>file.exists()</code> from base R to check if the file we want to download already exists. If not, then we download it using the function <code>utils::download.file()</code>. We also use the <code>here()</code> function of the <code>here</code> package to look specifically in the <code>docs</code> directory` of the directory where our open RStudio project file is located. This helps us, as we do not need to write the full path to the document. This makes our code more reproducible for someone else, who may have a different overall file structure on their computer but downloads our case study files from GitHub and therefore has the same file structure specifically for the files included in our GitHub repository. Thus our commands about file locations still work on their local machine.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))){</a>
<a class="sourceLine" id="cb2-2" title="2">  url &lt;-<span class="st"> &quot;https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf&quot;</span></a>
<a class="sourceLine" id="cb2-3" title="3">  utils<span class="op">::</span><span class="kw">download.file</span>(url, <span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a>
<a class="sourceLine" id="cb2-4" title="4">}</a></code></pre></div>
<p>Now that we have downloaded the PDF file, we will read it in to R using the <code>pdftools</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">pdf_obesity &lt;-<span class="st"> </span>pdftools<span class="op">::</span><span class="kw">pdf_text</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a></code></pre></div>
<p>Let’s take a look at the data – the <code>summary()</code> function from base R helps us to look at the structure of R objects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">summary</span>(pdf_obesity)</a></code></pre></div>
<pre><code>   Length     Class      Mode 
       63 character character </code></pre>
<p>We can see that we have 63 elements that are character strings. You may also notice that the original PDF has 63 pages. Let’s take a look at some of these elements and compare them to the pages in the original document.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">pdf_obesity[<span class="dv">1</span>] <span class="co"># this looks like the first page</span></a></code></pre></div>
<pre><code>[1] &quot;Letter                                                                                https://doi.org/10.1038/s41586-019-1171-x\nRising rural body-mass index is the main driver of\nthe global obesity epidemic in adults\nNCD Risk Factor Collaboration (NCD-RisC)*\n*A list of authors and their affiliations appears in the online version of the paper.\n2 6 0 | N A T U RE | V O L 5 6 9 | 9 M A Y 2 0 1 9\n&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">pdf_obesity[<span class="dv">2</span>] <span class="co"># this looks like the second page</span></a></code></pre></div>
<pre><code>[1] &quot;Supplementary Information. Statistical model for estimating BMI trends by rural and urban\nplace of residence.\n                                          1\n&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">str</span>(pdf_obesity[<span class="dv">52</span>], <span class="dt">nchar.max =</span> <span class="dv">1600</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                          2                                                           2\n                                  Age-standardised mean BMI in 1985 (kg/m )                   Age-standardised mean BMI in 2017 (kg/m )\n             Country     Sex\n                             National               Rural                Urban           National               Rural                Urban\n                     Men     20.2 (17.8-22.7)      19.7 (17.2-22.2)     22.4 (20.0-25.0) 22.8 (20.3-25.3)      22.5 (20.0-25.0)     23.6 (21.0-26.1)\nAfghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)\n                     Men     25.2 (23.9-26.5)      25.0 (23.7-26.4)     25.4 (24.0-26.7) 27.0 (26.0-27.9)      26.9 (25.9-27.9)     27.0 (26.0-28.0)\nAlbania              Women   26.0 (24.1-27.9)      26.1 (24.1-28.1)     25.9 (23.9-27.8) 26.0 (24.8-27.2)      26.2 (24.8-27.5)     25.9 (24.6-27.2)\n                     Men     22.1 (20.8-23.3)      21.8 (20.5-23.1)     22.3 (21.0-23.6) 25.1 (24.5-25.7)      24.8 (24.1-25.4)     25.2 (24.6-25.9)\nAlgeria              Women   24.0 (22.2-25.7)      23.3 (21.4-25.1)     24.8 (22.9-26.6) 27.4 (26.7-28.0)      27.0 (26.3-27.8)     27.5 (26.7-28.2)\n                     Men     33.7 (32.7-34.7)      32.6 (31.7-33.5)     34.0 (32.9-35.1) 34.3 (33.0-35.6)      34.6 (33.1-35.9)     34.2 (32.9-35.6)\nAmerican Samoa       Women   34.3 (33.1-35.6)      34.1 (33.0-35.2)     34.4 (33.0-35.8) &quot;| __truncated__</code></pre>
<p>Yes, this looks like data in a the table we want. We are using the <code>str()</code> function to print just a portion of the data. The <code>str()</code> function compactly displays the structure of arbitrary R objects. The <code>nchar.max</code> argument let’s us define the maximal number of characters to show. Note <code>print(pdf_obesity[52])</code> would show the entire contents of the this page of the table.</p>
<p>Here is the PDF version again: <img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that the output looks pretty similar to the pages of the pdf, but the spacing is a bit awkward. Note that the way the data is displayed is partially influenced by the width setting of the RStudio window.</p>
<p>Now, we are interested in a supplementary Table 3, which has multiple pages and includes the same header on each page. We can use that to determine what elements of our <code>pdf_obesity</code> character strings include our table. We will use the <code>str_detect()</code> function from the <code>stringr</code> package to search for the elements that contain text that is consistently in the header. The output of of this function will show which elements of the object (in this case pages of the pdf) include this pattern indicated as a <code>TRUE</code> or <code>FALSE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">stringr<span class="op">::</span><span class="kw">str_detect</span>(<span class="dt">pattern =</span> <span class="st">&quot;Age-standardised mean BMI&quot;</span>, </a>
<a class="sourceLine" id="cb12-2" title="2">                    <span class="dt">string =</span> pdf_obesity)</a></code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[37] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[49] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[61]  TRUE FALSE FALSE</code></pre>
<p>We note, the “Age-standardised mean BMI” is part of the header in the table on every page. The code above shows the pages that contain our table of interest (as <code>TRUE</code> values).</p>
<p>Now we will extract just the data for the table now and call it <code>rural_urban</code>. To do this we will use the <code>str_subset()</code> function of the <code>stringr</code> package.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">rural_urban &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_subset</span>(<span class="dt">pattern =</span> <span class="st">&quot;Age-standardised mean BMI&quot;</span>, </a>
<a class="sourceLine" id="cb14-2" title="2">                                   <span class="dt">string =</span> pdf_obesity)</a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw">summary</span>(rural_urban) </a></code></pre></div>
<pre><code>   Length     Class      Mode 
       10 character character </code></pre>
<p>Here, we see there are 10 pages worth of elements in our <code>rural_urban</code> object.</p>
<p>Let’s check the first and last page:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">str</span>(rural_urban[<span class="dv">1</span>], <span class="dt">nchar.max =</span> <span class="dv">1600</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                          2                                                           2\n                                  Age-standardised mean BMI in 1985 (kg/m )                   Age-standardised mean BMI in 2017 (kg/m )\n             Country     Sex\n                             National               Rural                Urban           National               Rural                Urban\n                     Men     20.2 (17.8-22.7)      19.7 (17.2-22.2)     22.4 (20.0-25.0) 22.8 (20.3-25.3)      22.5 (20.0-25.0)     23.6 (21.0-26.1)\nAfghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)\n                     Men     25.2 (23.9-26.5)      25.0 (23.7-26.4)     25.4 (24.0-26.7) 27.0 (26.0-27.9)      26.9 (25.9-27.9)     27.0 (26.0-28.0)\nAlbania              Women   26.0 (24.1-27.9)      26.1 (24.1-28.1)     25.9 (23.9-27.8) 26.0 (24.8-27.2)      26.2 (24.8-27.5)     25.9 (24.6-27.2)\n                     Men     22.1 (20.8-23.3)      21.8 (20.5-23.1)     22.3 (21.0-23.6) 25.1 (24.5-25.7)      24.8 (24.1-25.4)     25.2 (24.6-25.9)\nAlgeria              Women   24.0 (22.2-25.7)      23.3 (21.4-25.1)     24.8 (22.9-26.6) 27.4 (26.7-28.0)      27.0 (26.3-27.8)     27.5 (26.7-28.2)\n                     Men     33.7 (32.7-34.7)      32.6 (31.7-33.5)     34.0 (32.9-35.1) 34.3 (33.0-35.6)      34.6 (33.1-35.9)     34.2 (32.9-35.6)\nAmerican Samoa       Women   34.3 (33.1-35.6)      34.1 (33.0-35.2)     34.4 (33.0-35.8) &quot;| __truncated__</code></pre>
<p>Using <code>[1]</code> shows just the first page of the 10 pages that contain the table. Also, notice the new line <code>&quot;\n&quot;</code> values that indicate new lines.</p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This looks the same as the beginning… how about the end?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">str</span>(rural_urban[<span class="dv">10</span>], <span class="dt">nchar.max =</span> <span class="dv">1800</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                                                            2                                                                  2\n                                                                   Age-standardised mean BMI in 1985 (kg/m )                           Age-standardised mean BMI in 2017 (kg/m )\n              Country                         Sex\n                                                              National               Rural                 Urban                  National               Rural                Urban\n                                        Men                   20.0 (18.6-21.4)      19.6 (18.1-21.1)      20.7 (19.2-22.0)        22.2 (21.6-22.9)      21.7 (21.0-22.4)     23.0 (22.3-23.7)\nZambia                                  Women                 21.4 (20.3-22.6)      20.7 (19.5-21.9)      22.5 (21.3-23.7)        23.9 (23.3-24.5)      22.7 (22.1-23.3)     25.5 (24.9-26.2)\n                                        Men                   21.2 (20.2-22.3)      20.9 (19.8-22.1)      22.1 (21.1-23.1)        22.3 (21.7-22.9)      21.9 (21.2-22.5)     23.3 (22.6-23.9)\nZimbabwe                                Women                 24.6 (23.5-25.9)      24.0 (22.8-25.4)      26.5 (25.3-27.8)        25.3 (24.6-26.1)      24.5 (23.7-25.3)     27.1 (26.2-27.9)\n*The entire population live in areas classified as urban (Bermuda, Hong Kong (from 1992 onwards), Nauru and Singapore) or rural (Tokelau).\nNumbers in parentheses show 95% credible intervals.\n                                                                                                 60\n&quot;</code></pre>
<p><img src="img/last_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great! Our <code>rural_urban</code> object looks like it contains the entire Supplementary 3 table, as both the beginning and the end include the data we expected.</p>
</div>
<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>At this point we have large strings now for each page of the table, but this is not very convenient to work with. Now, we will wrangle the data into a more usable form. Ideally, we would like our data to be in some sort of tabular form.</p>
<div id="separate-the-data-into-lines" class="section level3">
<h3>Separate the data into lines</h3>
<p>First, it would be useful to separate the data that is currently in 10 giant string chunks into individual lines or rows of the table. To do this we can use the <code>read_lines()</code> function of the <code>readr</code> package which will separate the lines based on the <code>&quot;\n&quot;</code> new line characters.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">summary</span>(rural_urban)</a></code></pre></div>
<pre><code>   Length     Class      Mode 
       10 character character </code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">rural_urban &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_lines</span>(rural_urban)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">summary</span>(rural_urban) </a></code></pre></div>
<pre><code>   Length     Class      Mode 
      461 character character </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># now we have 461 lines</span></a></code></pre></div>
<p>We can see that each string in the <code>rural_urban</code> object is now a single line from the table.</p>
<p>For example, line 6 shows the data for women in Afghanistan.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">rural_urban[<span class="dv">6</span>] </a></code></pre></div>
<pre><code>[1] &quot;Afghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)&quot;</code></pre>
</div>
<div id="removing-excess-white-space" class="section level3">
<h3>Removing excess white-space</h3>
<p>We also have a lot of white-space. Let’s get rid of the excess white spaces using <code>str_squish()</code> also from the <code>stringr</code> package.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">rural_urban &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_squish</span>(rural_urban) </a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;2 2&quot;                                                                                                                    
[2] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                    
[3] &quot;Country Sex&quot;                                                                                                            
[4] &quot;National Rural Urban National Rural Urban&quot;                                                                              
[5] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[6] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;</code></pre>
<p>Now it is much easier to see the data.</p>
<p>If we look at the part of our data that contains the end of the first page of the table and the start of the second we can see that the header information is repeated, as well as a line with the page number and an empty line, and a line that says “2 2”.</p>
<div id="section-6" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">rural_urban[<span class="dv">44</span><span class="op">:</span><span class="dv">56</span>] <span class="co"># scroll through!</span></a></code></pre></div>
<pre><code> [1] &quot;Benin Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;  
 [2] &quot;Men 24.3 (21.8-26.8) na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* 26.7 (24.3-29.2)&quot;                                    
 [3] &quot;Bermuda Women 25.4 (22.2-28.6) na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* 28.5 (25.3-31.6)&quot;                          
 [4] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;          
 [5] &quot;Bhutan Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot; 
 [6] &quot;51&quot;                                                                                                                 
 [7] &quot;&quot;                                                                                                                   
 [8] &quot;2 2&quot;                                                                                                                
 [9] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                
[10] &quot;Country Sex&quot;                                                                                                        
[11] &quot;National Rural Urban National Rural Urban&quot;                                                                          
[12] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;          
[13] &quot;Bolivia Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;</code></pre>
</div>
<div id="section-7" class="section level4">
<h4></h4>
<p>Although the header was necessary on all of the pages of the pdf version of the table, we only need that information once in our data.</p>
</div>
</div>
<div id="removing-unnecessary-repeated-header-information" class="section level3">
<h3>Removing unnecessary repeated header information</h3>
<p>So, let’s remove all the header information and the page number lines from the <code>rural_urban</code> object, then we will make a single line header for the beginning. One way to do this is to find all lines that include either “Women” or “Men” and only keep this data.</p>
<p>First, let’s see how many lines include “Women” or “Men”. We can do this by first identifying the lines that contain these patterns and then check the length of the resulting vector for the line numbers that contain these patterns. Note, the <code>&quot;|&quot;</code> indicates that we are looking for either “Women” or “Men”.</p>
<div id="section-8" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">#scroll through the output!</span></a>
<a class="sourceLine" id="cb31-2" title="2">stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb31-3" title="3">                   <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<pre><code>  [1]   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22
 [19]  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40
 [37]  41  42  43  44  45  46  47  48  55  56  57  58  59  60  61  62  63  64
 [55]  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82
 [73]  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98 105 106
 [91] 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124
[109] 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142
[127] 143 144 145 146 147 148 155 156 157 158 159 160 161 162 163 164 165 166
[145] 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184
[163] 185 186 187 188 189 190 191 192 193 194 195 196 197 198 205 206 207 208
[181] 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226
[199] 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244
[217] 245 246 247 248 255 256 257 258 259 260 261 262 263 264 265 266 267 268
[235] 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286
[253] 287 288 289 290 291 292 293 294 295 296 297 298 305 306 307 308 309 310
[271] 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328
[289] 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346
[307] 347 348 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370
[325] 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388
[343] 389 390 391 392 393 394 395 396 397 398 405 406 407 408 409 410 411 412
[361] 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430
[379] 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448
[397] 455 456 457 458</code></pre>
</div>
<div id="section-9" class="section level4">
<h4></h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">length</span>(stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb33-2" title="2">                          <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>))</a></code></pre></div>
<pre><code>[1] 400</code></pre>
<p>Note that <code>str_which()</code> is case sensitive, so it would not work to use “women” as the pattern, and using “men” would return the lines that contain “Wo<strong>men</strong>” or “Ye<strong>men</strong>” etc. Try this out with <code>pattern = &quot;women&quot;</code> and <code>pattern = &quot;men&quot;</code> to see the result!</p>
<p>OK, so this looks correct. This includes most lines but there are gaps where the header is located. It looks like out of the original 461 lines, there are 400 lines in our table that aren’t headers.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">rural_urban &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb35-2" title="2">                          <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<p>We can check our data now using either <code>head()</code> from base R or <code>glimpse()</code> from the <code>tibble</code> and <code>dplyr</code> package. (Yup, the same function is available from both packages!) The <code>head()</code> function shows us the first rows or lines of the data, while the <code>glimpse()</code> function provides us information about the total size of the object and shows us the first line or row.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">dplyr<span class="op">::</span><span class="kw">glimpse</span>(rural_urban)</a></code></pre></div>
<pre><code> chr [1:400] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot; ...</code></pre>
<p>Now our <code>rural_urban</code> object 400 lines instead of 461, like it did before when it contained the redundant header information.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[2] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;              
[4] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;    
[5] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;              
[6] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;    </code></pre>
<p>Great! So now our data looks much better but we need to add back our header and we would like this to only be a single line to make it easy to transform our data into a table or table-like object.</p>
<p>As a reminder, here is what our header used to look like:</p>
<p><img src="img/last_page.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We will add a new header after first dealing with some additional spacing and missing data issues.</p>
</div>
</div>
<div id="dealing-with-spacing" class="section level3">
<h3>Dealing with spacing</h3>
<p>First let’s try splitting our header-less data into columns based on spaces using the <code>str_split()</code> function, where we specify that we are splitting the data based on the pattern of a space (the space is included in quotes):</p>
<p>Here, we will take a look at just the first 10 lines using the <code>[1:10,]</code> syntax:</p>
<div id="section-10" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co">#scroll through the output!</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">str_split</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb40-3" title="3">          <span class="dt">pattern =</span> <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb40-4" title="4">          <span class="dt">simplify =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,] </a></code></pre></div>
<pre><code>      [,1]          [,2]    [,3]          [,4]          [,5]         
 [1,] &quot;Men&quot;         &quot;20.2&quot;  &quot;(17.8-22.7)&quot; &quot;19.7&quot;        &quot;(17.2-22.2)&quot;
 [2,] &quot;Afghanistan&quot; &quot;Women&quot; &quot;20.6&quot;        &quot;(18.4-22.8)&quot; &quot;20.1&quot;       
 [3,] &quot;Men&quot;         &quot;25.2&quot;  &quot;(23.9-26.5)&quot; &quot;25.0&quot;        &quot;(23.7-26.4)&quot;
 [4,] &quot;Albania&quot;     &quot;Women&quot; &quot;26.0&quot;        &quot;(24.1-27.9)&quot; &quot;26.1&quot;       
 [5,] &quot;Men&quot;         &quot;22.1&quot;  &quot;(20.8-23.3)&quot; &quot;21.8&quot;        &quot;(20.5-23.1)&quot;
 [6,] &quot;Algeria&quot;     &quot;Women&quot; &quot;24.0&quot;        &quot;(22.2-25.7)&quot; &quot;23.3&quot;       
 [7,] &quot;Men&quot;         &quot;33.7&quot;  &quot;(32.7-34.7)&quot; &quot;32.6&quot;        &quot;(31.7-33.5)&quot;
 [8,] &quot;American&quot;    &quot;Samoa&quot; &quot;Women&quot;       &quot;34.3&quot;        &quot;(33.1-35.6)&quot;
 [9,] &quot;Men&quot;         &quot;25.0&quot;  &quot;(22.5-27.4)&quot; &quot;25.3&quot;        &quot;(22.8-27.7)&quot;
[10,] &quot;Andorra&quot;     &quot;Women&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.4&quot;       
      [,6]          [,7]          [,8]          [,9]          [,10]        
 [1,] &quot;22.4&quot;        &quot;(20.0-25.0)&quot; &quot;22.8&quot;        &quot;(20.3-25.3)&quot; &quot;22.5&quot;       
 [2,] &quot;(17.8-22.4)&quot; &quot;23.2&quot;        &quot;(20.9-25.4)&quot; &quot;24.4&quot;        &quot;(23.3-25.4)&quot;
 [3,] &quot;25.4&quot;        &quot;(24.0-26.7)&quot; &quot;27.0&quot;        &quot;(26.0-27.9)&quot; &quot;26.9&quot;       
 [4,] &quot;(24.1-28.1)&quot; &quot;25.9&quot;        &quot;(23.9-27.8)&quot; &quot;26.0&quot;        &quot;(24.8-27.2)&quot;
 [5,] &quot;22.3&quot;        &quot;(21.0-23.6)&quot; &quot;25.1&quot;        &quot;(24.5-25.7)&quot; &quot;24.8&quot;       
 [6,] &quot;(21.4-25.1)&quot; &quot;24.8&quot;        &quot;(22.9-26.6)&quot; &quot;27.4&quot;        &quot;(26.7-28.0)&quot;
 [7,] &quot;34.0&quot;        &quot;(32.9-35.1)&quot; &quot;34.3&quot;        &quot;(33.0-35.6)&quot; &quot;34.6&quot;       
 [8,] &quot;34.1&quot;        &quot;(33.0-35.2)&quot; &quot;34.4&quot;        &quot;(33.0-35.8)&quot; &quot;35.3&quot;       
 [9,] &quot;25.0&quot;        &quot;(22.5-27.4)&quot; &quot;26.8&quot;        &quot;(24.4-29.2)&quot; &quot;26.8&quot;       
[10,] &quot;(22.2-28.7)&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.3&quot;        &quot;(22.1-28.6)&quot;
      [,11]         [,12]         [,13]         [,14]         [,15]        
 [1,] &quot;(20.0-25.0)&quot; &quot;23.6&quot;        &quot;(21.0-26.1)&quot; &quot;&quot;            &quot;&quot;           
 [2,] &quot;23.6&quot;        &quot;(22.5-24.8)&quot; &quot;26.3&quot;        &quot;(25.1-27.4)&quot; &quot;&quot;           
 [3,] &quot;(25.9-27.9)&quot; &quot;27.0&quot;        &quot;(26.0-28.0)&quot; &quot;&quot;            &quot;&quot;           
 [4,] &quot;26.2&quot;        &quot;(24.8-27.5)&quot; &quot;25.9&quot;        &quot;(24.6-27.2)&quot; &quot;&quot;           
 [5,] &quot;(24.1-25.4)&quot; &quot;25.2&quot;        &quot;(24.6-25.9)&quot; &quot;&quot;            &quot;&quot;           
 [6,] &quot;27.0&quot;        &quot;(26.3-27.8)&quot; &quot;27.5&quot;        &quot;(26.7-28.2)&quot; &quot;&quot;           
 [7,] &quot;(33.1-35.9)&quot; &quot;34.2&quot;        &quot;(32.9-35.6)&quot; &quot;&quot;            &quot;&quot;           
 [8,] &quot;(33.7-36.9)&quot; &quot;35.0&quot;        &quot;(33.1-36.9)&quot; &quot;35.4&quot;        &quot;(33.7-37.1)&quot;
 [9,] &quot;(24.3-29.2)&quot; &quot;26.8&quot;        &quot;(24.3-29.3)&quot; &quot;&quot;            &quot;&quot;           
[10,] &quot;25.2&quot;        &quot;(21.9-28.5)&quot; &quot;25.3&quot;        &quot;(22.1-28.6)&quot; &quot;&quot;           
      [,16] [,17] [,18]
 [1,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [2,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [3,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [4,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [5,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [6,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [7,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [8,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [9,] &quot;&quot;    &quot;&quot;    &quot;&quot;   
[10,] &quot;&quot;    &quot;&quot;    &quot;&quot;   </code></pre>
</div>
<div id="section-11" class="section level4">
<h4></h4>
<p>This almost worked, but unfortunately country names that have spaces will be a problem. For example, we can see that “American Samoa” has been divided into two columns and all subsequent columns are shifted.</p>
<p>Let’s try this another way.</p>
<p>As we can see by looking at our <code>rural_ubran</code> data, the country information is only present when the sex is Women. Let’s try to extract the country information from the rows that contain data about Women.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[2] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;              
[4] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;    
[5] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;              
[6] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;    </code></pre>
<p>To do this, we start by noticing that the sex always starts with either a capital “W” if the sex is female. Note, we need to use a space before the “W” otherwise we will split some of the country names if the names starts with “W”.</p>
<p>Here, we will also introduce the concept of piping, which uses the <code>%&gt;%</code> from the <code>magrittr</code> package, which allows us to pipe the output from one function to the input for another function. This is really useful when we have multiple steps, which we will show soon.</p>
<p>First, we will select just the data for Women and Men separately:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">Women &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb44-2" title="2">                    <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) </a>
<a class="sourceLine" id="cb44-3" title="3">Men &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb44-4" title="4">                    <span class="dt">pattern =</span> <span class="st">&quot;Men&quot;</span>)</a>
<a class="sourceLine" id="cb44-5" title="5"></a>
<a class="sourceLine" id="cb44-6" title="6"></a>
<a class="sourceLine" id="cb44-7" title="7"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;   
[2] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;       
[3] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;       
[4] &quot;American Samoa Women 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (33.1-36.9) 35.4 (33.7-37.1)&quot;
[5] &quot;Andorra Women 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (21.9-28.5) 25.3 (22.1-28.6)&quot;       
[6] &quot;Angola Women 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (20.0-26.7) 25.7 (22.4-29.1)&quot;        </code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<p>And then split the <code>Women</code> data based on the pattern <code>pattern = &quot; Women&quot;</code> (Note that the space before the word “Women” is included - so that it is not within the country data). Here we take our <code>Women</code> dataset and pipe it into the first argument of the <code>str_split()</code> function, where then we can split on the pattern <code>&quot; Women&quot;</code>. We then pipe through the <code>unlist()</code> function so that the results is a vector instead of a list. We assign this new result to the <code>country_split</code> object.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">country_split &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="st">  </span>Women <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern =</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="st">  </span><span class="kw">unlist</span>() </a>
<a class="sourceLine" id="cb48-5" title="5"></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="kw">head</span>(country_split)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan&quot;                                                                                           
[2] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Albania&quot;                                                                                               
[4] &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;
[5] &quot;Algeria&quot;                                                                                               
[6] &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;</code></pre>
<p>However, we can also do the same thing in a single step, where we replace the <code>Women</code> dataset with the code we used to create that dataset. So first, we select the “Women” and then we split the data by &quot; Women&quot; to create a new dataset all within the same chunk of code.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">country_split &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="st">  </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban,</a>
<a class="sourceLine" id="cb50-3" title="3">             <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern=</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb50-6" title="6"></a>
<a class="sourceLine" id="cb50-7" title="7"><span class="kw">head</span>(country_split)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan&quot;                                                                                           
[2] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Albania&quot;                                                                                               
[4] &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;
[5] &quot;Algeria&quot;                                                                                               
[6] &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;</code></pre>
<p>Now, we can see that <code>Country</code> is always the odd rows and the BMI data for Women is the even rows. We can select the odd rows using the <b> Modulus (Remainder from division) operator</b>. This operator looks like this <code>%%</code>. All odd values such as 3, 7, or 15 when divided by 2 would leave a remainder of 1. We will select just these rows using the <code>filter()</code> function of <code>dplyr</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">country &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </a></code></pre></div>
<p>We can take a look to make sure that all the country names look as expected. You can scroll through the country names if you hover over the data.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">country</a></code></pre></div>
</div>
<div id="section-12" class="section level4 scrollable">
<h4></h4>
<pre><code>                       country_split
1                        Afghanistan
2                            Albania
3                            Algeria
4                     American Samoa
5                            Andorra
6                             Angola
7                Antigua and Barbuda
8                          Argentina
9                            Armenia
10                         Australia
11                           Austria
12                        Azerbaijan
13                           Bahamas
14                           Bahrain
15                        Bangladesh
16                          Barbados
17                           Belarus
18                           Belgium
19                            Belize
20                             Benin
21                           Bermuda
22                            Bhutan
23                           Bolivia
24            Bosnia and Herzegovina
25                          Botswana
26                            Brazil
27                 Brunei Darussalam
28                          Bulgaria
29                      Burkina Faso
30                           Burundi
31                        Cabo Verde
32                          Cambodia
33                          Cameroon
34                            Canada
35          Central African Republic
36                              Chad
37                             Chile
38                             China
39             China (Hong Kong SAR)
40                          Colombia
41                           Comoros
42                             Congo
43                      Cook Islands
44                        Costa Rica
45                     Cote d&#39;Ivoire
46                           Croatia
47                              Cuba
48                            Cyprus
49                    Czech Republic
50                           Denmark
51                          Djibouti
52                          Dominica
53                Dominican Republic
54                          DR Congo
55                           Ecuador
56                             Egypt
57                       El Salvador
58                 Equatorial Guinea
59                           Eritrea
60                           Estonia
61                          Ethiopia
62                              Fiji
63                           Finland
64                            France
65                  French Polynesia
66                             Gabon
67                            Gambia
68                           Georgia
69                           Germany
70                             Ghana
71                            Greece
72                         Greenland
73                           Grenada
74                         Guatemala
75                            Guinea
76                     Guinea Bissau
77                            Guyana
78                             Haiti
79                          Honduras
80                           Hungary
81                           Iceland
82                             India
83                         Indonesia
84                              Iran
85                              Iraq
86                           Ireland
87                            Israel
88                             Italy
89                           Jamaica
90                             Japan
91                            Jordan
92                        Kazakhstan
93                             Kenya
94                          Kiribati
95                            Kuwait
96                        Kyrgyzstan
97                           Lao PDR
98                            Latvia
99                           Lebanon
100                          Lesotho
101                          Liberia
102                            Libya
103                        Lithuania
104                       Luxembourg
105                 Macedonia (TFYR)
106                       Madagascar
107                           Malawi
108                         Malaysia
109                         Maldives
110                             Mali
111                            Malta
112                 Marshall Islands
113                       Mauritania
114                        Mauritius
115                           Mexico
116 Micronesia (Federated States of)
117                          Moldova
118                         Mongolia
119                       Montenegro
120                          Morocco
121                       Mozambique
122                          Myanmar
123                          Namibia
124                            Nauru
125                            Nepal
126                      Netherlands
127                      New Zealand
128                        Nicaragua
129                            Niger
130                          Nigeria
131                             Niue
132                      North Korea
133                           Norway
134   Occupied Palestinian Territory
135                             Oman
136                         Pakistan
137                            Palau
138                           Panama
139                 Papua New Guinea
140                         Paraguay
141                             Peru
142                      Philippines
143                           Poland
144                         Portugal
145                      Puerto Rico
146                            Qatar
147                          Romania
148               Russian Federation
149                           Rwanda
150            Saint Kitts and Nevis
151                      Saint Lucia
152 Saint Vincent and the Grenadines
153                            Samoa
154            Sao Tome and Principe
155                     Saudi Arabia
156                          Senegal
157                           Serbia
158                       Seychelles
159                     Sierra Leone
160                        Singapore
161                         Slovakia
162                         Slovenia
163                  Solomon Islands
164                          Somalia
165                     South Africa
166                      South Korea
167                            Spain
168                        Sri Lanka
169                   Sudan (former)
170                         Suriname
171                        Swaziland
172                           Sweden
173                      Switzerland
174             Syrian Arab Republic
175                           Taiwan
176                       Tajikistan
177                         Tanzania
178                         Thailand
179                      Timor-Leste
180                             Togo
181                          Tokelau
182                            Tonga
183              Trinidad and Tobago
184                          Tunisia
185                           Turkey
186                     Turkmenistan
187                           Tuvalu
188                           Uganda
189                          Ukraine
190             United Arab Emirates
191                   United Kingdom
192         United States of America
193                          Uruguay
194                       Uzbekistan
195                          Vanuatu
196                        Venezuela
197                         Viet Nam
198                            Yemen
199                           Zambia
200                         Zimbabwe</code></pre>
</div>
<div id="section-13" class="section level4">
<h4></h4>
<p>Looks good! We have 200 countries represented in our dataset.</p>
<p>Great! Now we have a list of the countries that can be used for both the male and female data.</p>
<p>Remember the even rows are the rows with the BMI data for women. These row values have a remainder of 0 when divided by 2. Let’s select that data too.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">Women_BMI &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-4" title="4"></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="kw">head</span>(Women_BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  country_split                                                                 
  &lt;chr&gt;                                                                         
1 &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (2…
2 &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (2…
3 &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (2…
4 &quot; 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (3…
5 &quot; 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (2…
6 &quot; 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (2…</code></pre>
<p>This looks similar to our <code>Men</code> data (although slightly different):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<p>Notice how the data in each row is in quotes. This is because these are character strings. We can check this by using the base <code>class()</code> function.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">class</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>Whereas the <code>Women_BMI</code> data is a tibble.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">class</span>(Women_BMI)</a></code></pre></div>
<pre><code>[1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Let’s make the <code>Men</code> data into a tibble as well:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">Men &lt;-<span class="st"> </span><span class="kw">tibble</span>(Men)</a></code></pre></div>
<p>It’s always a good idea to check that your data objects are the size you expect when wrangling. We can do so with the <code>dim()</code> function, which shows us the dimensions of data objects.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">dim</span>(Women_BMI)</a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">dim</span>(Men)</a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">head</span>(Women_BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  country_split                                                                 
  &lt;chr&gt;                                                                         
1 &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (2…
2 &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (2…
3 &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (2…
4 &quot; 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (3…
5 &quot; 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (2…
6 &quot; 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (2…</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  Men                                                                           
  &lt;chr&gt;                                                                         
1 Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 …
2 Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 …
3 Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 …
4 Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 …
5 Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 …
6 Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 …</code></pre>
<p>Great! There are 200 rows of character strings with the BMI data like we expected to match the 200 countries in our data.</p>
<p>We do however need to add the word <code>&quot; Women&quot;</code> back to the <code>Women_BMI</code> data. To do this we will use the <code>glue()</code> function of the <code>glue</code> package.</p>
<p>Here is a simple example of how this function glues two things together.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">where &lt;-<span class="st">&quot;the moon&quot;</span></a>
<a class="sourceLine" id="cb72-2" title="2"></a>
<a class="sourceLine" id="cb72-3" title="3">glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;the cow jumped over {where}&quot;</span>)</a></code></pre></div>
<pre><code>the cow jumped over the moon</code></pre>
<p>Now let’s add the word “Women” to each row of the <code>Women_BMI</code> data using <code>glue</code>.</p>
<p>First let’s pull the <code>country_split</code> data out as a vector to make this simpler when we <code>glue</code>. To do this we will use the <code>pull()</code> function of the <code>dplyr</code> package. This function will allow us to extract or pull out the single variable called <code>country_split</code> which contains the BMI values for women from within the tibble called <code>Women_BMI</code> which we just created by grabbing only the even rows of our original <code>country_split</code> tibble.</p>
<p>Then, let’s use the <code>first()</code> function of the <code>dplyr</code> package to get a reminder of what just the first row of the <code>country_split</code> column of the <code>Women_BMI</code> data looks like.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">women_data &lt;-<span class="st"> </span>Women_BMI <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="st">  </span><span class="kw">pull</span>(country_split)</a>
<a class="sourceLine" id="cb74-3" title="3"></a>
<a class="sourceLine" id="cb74-4" title="4">dplyr<span class="op">::</span><span class="kw">first</span>(women_data)</a></code></pre></div>
<pre><code>[1] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;</code></pre>
<p>Now we will paste the word <code>&quot;Women&quot;</code> in the beginning of each value in the vector using the <code>glue()</code> function.</p>
<p>Note that there will be a space in between. This is because the space is already in front of the first BMI value.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">Women &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;Women{women_data}&quot;</span>)</a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code>Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)
Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)
Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)
Women 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (33.1-36.9) 35.4 (33.7-37.1)
Women 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (21.9-28.5) 25.3 (22.1-28.6)
Women 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (20.0-26.7) 25.7 (22.4-29.1)</code></pre>
<p>You could also do all of this in one step but its less obvious what is happening.</p>
<p>Here we can pull the <code>country_split</code> data out of the <code>Women_BMI</code> object and then paste <code>&quot;Women&quot;</code> in front of each string in one command.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">Women &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;Women{pull(Women_BMI,country_split)}&quot;</span>)</a></code></pre></div>
<p>If we try splitting our data by space again, will it have the expected number of columns? What about the rows that contain <code>na*</code> values?</p>
<p>Let’s just take the <code>Men</code> data that contains <code>na*</code> values. This column is called <code>rural_urban</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">unknown &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="st">  </span>Men<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(<span class="dt">pattern =</span><span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb79-4" title="4">                    <span class="dt">string =</span> Men)) </a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="kw">head</span>(unknown)</a></code></pre></div>
<pre><code># A tibble: 5 x 1
  Men                                                                           
  &lt;chr&gt;                                                                         
1 Men 24.3 (21.8-26.8) na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* 26.7 (24.3-29.…
2 Men 22.4 (21.4-23.3) 21.5 (20.2-22.8) 22.4 (21.5-23.4) 24.8 (23.6-26.1) na* 2…
3 Men 32.6 (32.0-33.2) na* 32.6 (32.0-33.2) 32.9 (31.7-34.1) na* 32.9 (31.7-34.…
4 Men 22.8 (22.2-23.3) na* 22.8 (22.2-23.3) 24.4 (23.6-25.1) na* 24.4 (23.6-25.…
5 Men 29.6 (28.1-31.1) 29.6 (28.1-31.1) na* 32.3 (31.4-33.2) 32.3 (31.4-33.2) n…</code></pre>
<p>Now we can try splitting by a space</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(<span class="kw">pull</span>(unknown, Men), <span class="st">&quot; &quot;</span>,</a>
<a class="sourceLine" id="cb81-2" title="2">                            <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code># A tibble: 5 x 12
  V1    V2    V3     V4    V5     V6     V7     V8     V9     V10   V11   V12   
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 
1 Men   24.3  (21.8… na*   24.3   (21.8… 26.7   (24.3… na*    26.7  (24.… &quot;&quot;    
2 Men   22.4  (21.4… 21.5  (20.2… 22.4   (21.5… 24.8   (23.6… na*   24.8  &quot;(23.…
3 Men   32.6  (32.0… na*   32.6   (32.0… 32.9   (31.7… na*    32.9  (31.… &quot;&quot;    
4 Men   22.8  (22.2… na*   22.8   (22.2… 24.4   (23.6… na*    24.4  (23.… &quot;&quot;    
5 Men   29.6  (28.1… 29.6  (28.1… na*    32.3   (31.4… 32.3   (31.… na*   &quot;&quot;    </code></pre>
<p>So close! Notice that the <code>&quot;na*&quot;</code> values have shifted the subsequent values within the columns because typically there is a space between the BMI and the credible intervals. Here we can see this data in our original pdf:</p>
<p><img src="img/missing_pdf.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="dealing-with-na-values" class="section level3">
<h3>Dealing with NA values</h3>
<p>We need to replace our <code>na*</code> values with something that includes a space so that when we separate our data by space we will have two values instead of one when we have an <code>na*</code>. Therefore, <code>na* na*</code> should work.</p>
<p>So, in order to use the functions within the <code>stringr</code> package, our <code>Men</code> data needs to be of <code>character</code> class, so let’s check that now.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">class</span>(<span class="kw">pull</span>(Men, Men))</a></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>The <code>as.character()</code> function allows us to change factor data within to the character class. We could use this if we needed it, but it looks like our data is already <code>character</code>.</p>
<p>We are also changing the structure so that the data is not within a column called <code>Men</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  Men                                                                           
  &lt;chr&gt;                                                                         
1 Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 …
2 Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 …
3 Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 …
4 Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 …
5 Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 …
6 Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 …</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">Men &lt;-<span class="st"> </span><span class="kw">pull</span>(Men, Men)</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">Men &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Men, </a>
<a class="sourceLine" id="cb89-3" title="3">                           <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb89-4" title="4">                           <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb89-5" title="5"></a>
<a class="sourceLine" id="cb89-6" title="6"><span class="co"># The \\ are necessary because the * is a special character </span></a>
<a class="sourceLine" id="cb89-7" title="7"><span class="co"># The * would typically indicate any possible value, </span></a>
<a class="sourceLine" id="cb89-8" title="8"><span class="co"># but here we actually want a &quot;*&quot; instead</span></a>
<a class="sourceLine" id="cb89-9" title="9"><span class="co"># Thus the double backslash does that for us</span></a>
<a class="sourceLine" id="cb89-10" title="10"><span class="co"># Here we are replacing all occurences of the na* values </span></a>
<a class="sourceLine" id="cb89-11" title="11"><span class="co">#(thus str_replace_all instead of str_replace) with na* na*. </span></a></code></pre></div>
<p>Let’s check that it worked…</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">Men[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Men 20.7 (19.4-22.1) 20.3 (18.9-21.7) 21.7 (20.3-23.1) 22.7 (22.0-23.3) 22.1 (21.3-22.8) 23.4 (22.7-24.1)&quot;
 [2] &quot;Men 24.3 (21.8-26.8) na* na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* na* 26.7 (24.3-29.2)&quot;                  
 [3] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;
 [4] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;
 [5] &quot;Men 24.9 (23.5-26.2) 24.8 (23.4-26.2) 25.0 (23.6-26.4) 26.8 (25.7-27.8) 26.7 (25.7-27.8) 26.8 (25.7-27.9)&quot;
 [6] &quot;Men 20.6 (19.2-22.0) 20.3 (18.8-21.7) 21.4 (20.0-22.9) 22.6 (21.9-23.4) 21.9 (20.9-22.8) 23.2 (22.3-24.0)&quot;
 [7] &quot;Men 23.3 (22.5-24.0) 22.2 (21.4-23.0) 23.7 (22.9-24.5) 26.2 (25.7-26.7) 25.0 (24.3-25.6) 26.4 (25.9-26.9)&quot;
 [8] &quot;Men 24.0 (22.5-25.4) 23.7 (22.1-25.1) 24.2 (22.7-25.7) 27.1 (26.4-27.7) 26.6 (26.0-27.3) 27.2 (26.5-27.9)&quot;
 [9] &quot;Men 25.0 (23.8-26.4) 24.9 (23.5-26.4) 25.1 (23.8-26.5) 27.0 (25.8-28.1) 27.0 (25.7-28.3) 27.0 (25.7-28.2)&quot;
[10] &quot;Men 20.2 (18.8-21.5) 20.0 (18.6-21.4) 21.4 (19.9-22.9) 22.2 (21.4-23.0) 21.8 (21.0-22.6) 23.1 (22.1-24.1)&quot;
[11] &quot;Men 20.2 (17.7-22.6) 20.1 (17.6-22.5) 21.2 (18.7-23.6) 22.1 (19.8-24.5) 22.0 (19.6-24.3) 23.2 (20.8-25.6)&quot;</code></pre>
<p>Great!</p>
<p>Now for the Women data object</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">class</span>(Women)</a></code></pre></div>
<pre><code>[1] &quot;glue&quot;      &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="co"># the female data is already character type</span></a>
<a class="sourceLine" id="cb94-2" title="2">Women &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Women, </a>
<a class="sourceLine" id="cb94-4" title="4">                           <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb94-5" title="5">                           <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb94-6" title="6">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;
 [2] &quot;Women 25.4 (22.2-28.6) na* na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* na* 28.5 (25.3-31.6)&quot;                  
 [3] &quot;Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot;
 [4] &quot;Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;
 [5] &quot;Women 25.5 (23.5-27.4) 25.7 (23.7-27.7) 25.1 (23.1-27.0) 25.7 (24.4-27.1) 26.0 (24.6-27.5) 25.3 (23.9-26.8)&quot;
 [6] &quot;Women 24.2 (22.2-26.2) 23.7 (21.5-25.8) 25.6 (23.5-27.7) 26.2 (25.3-27.1) 25.0 (23.8-26.2) 27.0 (26.0-28.2)&quot;
 [7] &quot;Women 24.0 (23.2-25.0) 23.1 (22.1-24.1) 24.4 (23.5-25.4) 26.9 (26.2-27.5) 26.4 (25.7-27.2) 26.9 (26.3-27.6)&quot;
 [8] &quot;Women 23.6 (21.4-25.6) 22.9 (20.7-25.0) 24.0 (21.8-26.1) 27.4 (26.6-28.1) 27.0 (26.1-27.8) 27.5 (26.7-28.2)&quot;
 [9] &quot;Women 25.2 (23.4-27.1) 25.5 (23.4-27.6) 25.0 (23.1-26.9) 25.6 (24.1-27.1) 26.0 (24.2-27.8) 25.5 (23.9-27.1)&quot;
[10] &quot;Women 19.9 (18.7-21.2) 19.6 (18.4-20.9) 22.0 (20.7-23.3) 22.2 (21.4-23.1) 21.1 (20.2-22.0) 24.7 (23.7-25.7)&quot;
[11] &quot;Women 19.6 (17.5-21.7) 19.5 (17.4-21.6) 21.7 (19.5-23.8) 21.1 (20.3-22.0) 20.7 (19.8-21.6) 24.0 (23.0-24.9)&quot;</code></pre>
<p>Great, now we can split our data by spaces.</p>
</div>
<div id="splitting-the-data" class="section level3">
<h3>Splitting the data</h3>
<p>We will split our data finally by spaces using the <code>str_split()</code> function of the <code>stringr</code> package. We can check the rows with NA values by looking at rows 20-30.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">Men &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Men, <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb96-2" title="2">                                   <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb96-3" title="3">Men[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>,]</a></code></pre></div>
<pre><code># A tibble: 11 x 13
   V1    V2    V3    V4    V5    V6    V7    V8    V9    V10   V11   V12   V13  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Men   20.7  (19.… 20.3  (18.… 21.7  (20.… 22.7  (22.… 22.1  (21.… 23.4  (22.…
 2 Men   24.3  (21.… na*   na*   24.3  (21.… 26.7  (24.… na*   na*   26.7  (24.…
 3 Men   20.6  (19.… 20.3  (18.… 23.1  (21.… 23.5  (22.… 23.1  (22.… 24.2  (23.…
 4 Men   23.3  (21.… 22.9  (20.… 23.6  (21.… 26.1  (23.… 25.3  (23.… 26.5  (24.…
 5 Men   24.9  (23.… 24.8  (23.… 25.0  (23.… 26.8  (25.… 26.7  (25.… 26.8  (25.…
 6 Men   20.6  (19.… 20.3  (18.… 21.4  (20.… 22.6  (21.… 21.9  (20.… 23.2  (22.…
 7 Men   23.3  (22.… 22.2  (21.… 23.7  (22.… 26.2  (25.… 25.0  (24.… 26.4  (25.…
 8 Men   24.0  (22.… 23.7  (22.… 24.2  (22.… 27.1  (26.… 26.6  (26.… 27.2  (26.…
 9 Men   25.0  (23.… 24.9  (23.… 25.1  (23.… 27.0  (25.… 27.0  (25.… 27.0  (25.…
10 Men   20.2  (18.… 20.0  (18.… 21.4  (19.… 22.2  (21.… 21.8  (21.… 23.1  (22.…
11 Men   20.2  (17.… 20.1  (17.… 21.2  (18.… 22.1  (19.… 22.0  (19.… 23.2  (20.…</code></pre>
<p>Great! It looks good!</p>
<p>Now for the <code>Women</code> data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">Women &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Women, <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb98-2" title="2">                             <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  V1    V2    V3     V4    V5    V6    V7    V8    V9    V10   V11   V12   V13  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Women 20.6  (18.4… 20.1  (17.… 23.2  (20.… 24.4  (23.… 23.6  (22.… 26.3  (25.…
2 Women 26.0  (24.1… 26.1  (24.… 25.9  (23.… 26.0  (24.… 26.2  (24.… 25.9  (24.…
3 Women 24.0  (22.2… 23.3  (21.… 24.8  (22.… 27.4  (26.… 27.0  (26.… 27.5  (26.…
4 Women 34.3  (33.1… 34.1  (33.… 34.4  (33.… 35.3  (33.… 35.0  (33.… 35.4  (33.…
5 Women 25.2  (22.0… 25.4  (22.… 25.2  (22.… 25.3  (22.… 25.2  (21.… 25.3  (22.…
6 Women 21.3  (18.0… 20.9  (17.… 22.7  (19.… 24.4  (21.… 23.3  (20.… 25.7  (22.…</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>,] </a></code></pre></div>
<pre><code># A tibble: 11 x 13
   V1    V2    V3    V4    V5    V6    V7    V8    V9    V10   V11   V12   V13  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Women 20.6  (19.… 20.1  (18.… 21.8  (20.… 24.3  (23.… 23.2  (22.… 25.5  (24.…
 2 Women 25.4  (22.… na*   na*   25.4  (22.… 28.5  (25.… na*   na*   28.5  (25.…
 3 Women 20.7  (18.… 20.3  (18.… 23.0  (20.… 24.6  (23.… 23.8  (22.… 25.9  (24.…
 4 Women 23.8  (22.… 23.0  (21.… 24.6  (23.… 27.9  (26.… 27.0  (25.… 28.3  (26.…
 5 Women 25.5  (23.… 25.7  (23.… 25.1  (23.… 25.7  (24.… 26.0  (24.… 25.3  (23.…
 6 Women 24.2  (22.… 23.7  (21.… 25.6  (23.… 26.2  (25.… 25.0  (23.… 27.0  (26.…
 7 Women 24.0  (23.… 23.1  (22.… 24.4  (23.… 26.9  (26.… 26.4  (25.… 26.9  (26.…
 8 Women 23.6  (21.… 22.9  (20.… 24.0  (21.… 27.4  (26.… 27.0  (26.… 27.5  (26.…
 9 Women 25.2  (23.… 25.5  (23.… 25.0  (23.… 25.6  (24.… 26.0  (24.… 25.5  (23.…
10 Women 19.9  (18.… 19.6  (18.… 22.0  (20.… 22.2  (21.… 21.1  (20.… 24.7  (23.…
11 Women 19.6  (17.… 19.5  (17.… 21.7  (19.… 21.1  (20.… 20.7  (19.… 24.0  (23.…</code></pre>
<p>We can see that our <code>na</code> values look correct.</p>
<p>Looks good!</p>
</div>
<div id="adding-new-header" class="section level3">
<h3>Adding new header</h3>
<p>We can see from our pdf and our object called <code>header</code> what the header was like in the original pdf document. We need to add column names to our data based on the original data.</p>
<p>We’ll wait to add <code>Country</code> to the header until we add the country information to our data.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">new_header &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>,<span class="st">&quot;National_BMI_1985&quot;</span>, </a>
<a class="sourceLine" id="cb102-2" title="2">                <span class="st">&quot;National_BMI_1985_CI&quot;</span>, <span class="st">&quot;Rural_BMI_1985&quot;</span>, </a>
<a class="sourceLine" id="cb102-3" title="3">                <span class="st">&quot;Rural_BMI_1985_CI&quot;</span>, <span class="st">&quot;Urban_BMI_1985&quot;</span>,</a>
<a class="sourceLine" id="cb102-4" title="4">                <span class="st">&quot;Urban_BMI_1985_CI&quot;</span>, <span class="st">&quot;National_BMI_2017&quot;</span>,</a>
<a class="sourceLine" id="cb102-5" title="5">                <span class="st">&quot;National_BMI_2017_CI&quot;</span>,<span class="st">&quot;Rural_BMI_2017&quot;</span>,</a>
<a class="sourceLine" id="cb102-6" title="6">                <span class="st">&quot;Rural_BMI_2017_CI&quot;</span>, <span class="st">&quot;Urban_BMI_2017&quot;</span>, </a>
<a class="sourceLine" id="cb102-7" title="7">                <span class="st">&quot;Urban_BMI_2017_CI&quot;</span>)</a></code></pre></div>
<p>Let’s change the names of our columns of our tibbles to this new header for our <code>Men</code> and <code>Women</code> data</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">names</span>(Women) &lt;-<span class="st"> </span>new_header</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="kw">names</span>(Men) &lt;-<span class="st"> </span>new_header</a>
<a class="sourceLine" id="cb103-3" title="3"></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985 Rural_BMI_1985_…
  &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;           
1 Women 20.6             (18.4-22.8)      20.1           (17.8-22.4)     
2 Women 26.0             (24.1-27.9)      26.1           (24.1-28.1)     
3 Women 24.0             (22.2-25.7)      23.3           (21.4-25.1)     
4 Women 34.3             (33.1-35.6)      34.1           (33.0-35.2)     
5 Women 25.2             (22.0-28.4)      25.4           (22.2-28.7)     
6 Women 21.3             (18.0-24.6)      20.9           (17.6-24.3)     
# … with 8 more variables: Urban_BMI_1985 &lt;chr&gt;, Urban_BMI_1985_CI &lt;chr&gt;,
#   National_BMI_2017 &lt;chr&gt;, National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985 Rural_BMI_1985_…
  &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;           
1 Men   20.2             (17.8-22.7)      19.7           (17.2-22.2)     
2 Men   25.2             (23.9-26.5)      25.0           (23.7-26.4)     
3 Men   22.1             (20.8-23.3)      21.8           (20.5-23.1)     
4 Men   33.7             (32.7-34.7)      32.6           (31.7-33.5)     
5 Men   25.0             (22.5-27.4)      25.3           (22.8-27.7)     
6 Men   20.5             (17.9-23.1)      20.2           (17.6-22.9)     
# … with 8 more variables: Urban_BMI_1985 &lt;chr&gt;, Urban_BMI_1985_CI &lt;chr&gt;,
#   National_BMI_2017 &lt;chr&gt;, National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Now we will add our country data to both our <code>Men</code> and <code>Women</code> tibbles using the <code>bind_cols()</code> function. This will add the <code>country</code> as a new column to the <code>Women</code> data object on the left.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">Women &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Women)</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  country_split Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghanistan   Women 20.6             (18.4-22.8)      20.1          
2 Albania       Women 26.0             (24.1-27.9)      26.1          
3 Algeria       Women 24.0             (22.2-25.7)      23.3          
4 American Sam… Women 34.3             (33.1-35.6)      34.1          
5 Andorra       Women 25.2             (22.0-28.4)      25.4          
6 Angola        Women 21.3             (18.0-24.6)      20.9          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Similarly, for the data about Men, this will add the <code>country</code> as a new column to the <code>Men</code> data object on the left.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">Men &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Men) </a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  country_split Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghanistan   Men   20.2             (17.8-22.7)      19.7          
2 Albania       Men   25.2             (23.9-26.5)      25.0          
3 Algeria       Men   22.1             (20.8-23.3)      21.8          
4 American Sam… Men   33.7             (32.7-34.7)      32.6          
5 Andorra       Men   25.0             (22.5-27.4)      25.3          
6 Angola        Men   20.5             (17.9-23.1)      20.2          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="changing-variable-names" class="section level3">
<h3>Changing variable names</h3>
<p>Here, we will change the variable name in the <code>country</code> dataset to <code>country</code> (currently it is called <code>country_split</code>). We will also introduce the concept of the assignment pipe. In this case our pipe operator looks like this <code>%&lt;&gt;%</code>. Using this additional pipe requires another package, called <code>magrittr</code>. The other simpler pipe options from this package are loaded with <code>tidyverse</code> (if you used <code>library(tidyverse)</code> which loads most tidyverse packages), but not this version.</p>
<p>The <code>&gt;</code> portion of the pipe still behaves like a normal pipe, while the <code>&lt;</code> portion of the pipe makes an assignment to whatever the <code>&lt;</code>is pointing to, just like when we use the typical assignment operator <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="co"># library(magrittr) </span></a>
<a class="sourceLine" id="cb111-2" title="2"><span class="co"># We can&#39;t use the `%&lt;&gt;%` unless we load the magrittr package</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="co"># We have already done this but we include this for illustrative purposes.</span></a>
<a class="sourceLine" id="cb111-4" title="4"><span class="co"># Here we will just use the traditional assignment strategy</span></a>
<a class="sourceLine" id="cb111-5" title="5"></a>
<a class="sourceLine" id="cb111-6" title="6">Women &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(Women, <span class="dt">Country =</span> country_split) </a></code></pre></div>
<p>Here, we have renamed the <code>country_split</code> variable to be called <code>Country</code>.</p>
<p>Here, we reassign <code>Men</code> using the pipe strategy.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">Men <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">Country =</span> country_split) </a></code></pre></div>
<p>We have renamed the <code>country_split</code> variable to to be called <code>Country</code>. We have also reassigned <code>Men</code> to the same data object. which has the <code>Country</code> variable renamed.</p>
<p>Let’s take a look at our data for <code>Men</code> and <code>Women</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Women 20.6             (18.4-22.8)      20.1          
2 Albania Women 26.0             (24.1-27.9)      26.1          
3 Algeria Women 24.0             (22.2-25.7)      23.3          
4 Americ… Women 34.3             (33.1-35.6)      34.1          
5 Andorra Women 25.2             (22.0-28.4)      25.4          
6 Angola  Women 21.3             (18.0-24.6)      20.9          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Men   20.2             (17.8-22.7)      19.7          
2 Albania Men   25.2             (23.9-26.5)      25.0          
3 Algeria Men   22.1             (20.8-23.3)      21.8          
4 Americ… Men   33.7             (32.7-34.7)      32.6          
5 Andorra Men   25.0             (22.5-27.4)      25.3          
6 Angola  Men   20.5             (17.9-23.1)      20.2          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="joining-the-data" class="section level3">
<h3>Joining the data</h3>
<p>Now that both of these tibbles have the same structure, we can combine our <code>Men</code> and <code>Women</code> data using the <code>bind_rows()</code> function of <code>dplyr</code>. This will combine all of the rows based on their similar column structure. All of the male data will be first and all the female data will be second.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">BMI &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(Men, Women)</a></code></pre></div>
<p>Let’s check the size of our BMI data… it should have 400 rows (obs). We can see the end of the <code>BMI</code> data using the <code>tail()</code> function:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>tibble [400 × 14] (S3: tbl_df/tbl/data.frame)
 $ Country             : chr [1:400] &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American Samoa&quot; ...
 $ Sex                 : chr [1:400] &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; ...
 $ National_BMI_1985   : chr [1:400] &quot;20.2&quot; &quot;25.2&quot; &quot;22.1&quot; &quot;33.7&quot; ...
 $ National_BMI_1985_CI: chr [1:400] &quot;(17.8-22.7)&quot; &quot;(23.9-26.5)&quot; &quot;(20.8-23.3)&quot; &quot;(32.7-34.7)&quot; ...
 $ Rural_BMI_1985      : chr [1:400] &quot;19.7&quot; &quot;25.0&quot; &quot;21.8&quot; &quot;32.6&quot; ...
 $ Rural_BMI_1985_CI   : chr [1:400] &quot;(17.2-22.2)&quot; &quot;(23.7-26.4)&quot; &quot;(20.5-23.1)&quot; &quot;(31.7-33.5)&quot; ...
 $ Urban_BMI_1985      : chr [1:400] &quot;22.4&quot; &quot;25.4&quot; &quot;22.3&quot; &quot;34.0&quot; ...
 $ Urban_BMI_1985_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(24.0-26.7)&quot; &quot;(21.0-23.6)&quot; &quot;(32.9-35.1)&quot; ...
 $ National_BMI_2017   : chr [1:400] &quot;22.8&quot; &quot;27.0&quot; &quot;25.1&quot; &quot;34.3&quot; ...
 $ National_BMI_2017_CI: chr [1:400] &quot;(20.3-25.3)&quot; &quot;(26.0-27.9)&quot; &quot;(24.5-25.7)&quot; &quot;(33.0-35.6)&quot; ...
 $ Rural_BMI_2017      : chr [1:400] &quot;22.5&quot; &quot;26.9&quot; &quot;24.8&quot; &quot;34.6&quot; ...
 $ Rural_BMI_2017_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(25.9-27.9)&quot; &quot;(24.1-25.4)&quot; &quot;(33.1-35.9)&quot; ...
 $ Urban_BMI_2017      : chr [1:400] &quot;23.6&quot; &quot;27.0&quot; &quot;25.2&quot; &quot;34.2&quot; ...
 $ Urban_BMI_2017_CI   : chr [1:400] &quot;(21.0-26.1)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-25.9)&quot; &quot;(32.9-35.6)&quot; ...</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">tail</span>(BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Vanuatu Women 24.4             (22.7-26.1)      24.2          
2 Venezu… Women 24.0             (22.2-25.9)      22.6          
3 Viet N… Women 18.5             (17.7-19.4)      18.2          
4 Yemen   Women 20.5             (18.9-22.0)      20.0          
5 Zambia  Women 21.4             (20.3-22.6)      20.7          
6 Zimbab… Women 24.6             (23.5-25.9)      24.0          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="sorting-the-data" class="section level3">
<h3>Sorting the data</h3>
<p>Now, let’s sort the data alphabetically by <code>Country</code> using the <code>arrange()</code> function from the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">BMI &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(BMI, Country)</a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">head</span>(BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Men   20.2             (17.8-22.7)      19.7          
2 Afghan… Women 20.6             (18.4-22.8)      20.1          
3 Albania Men   25.2             (23.9-26.5)      25.0          
4 Albania Women 26.0             (24.1-27.9)      26.1          
5 Algeria Men   22.1             (20.8-23.3)      21.8          
6 Algeria Women 24.0             (22.2-25.7)      23.3          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;,
#   Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Our data is looking great!</p>
<p>Now, we might want to make sure that our observations for each variable look the way we want. In other words, if we want to make plots about National BMI in 1985 then we would need our values to be numeric. Looking at our BMI data using <code>str()</code>, we can see the type of data for each of our variables listed just after variable name and the <code>&quot;:&quot;</code> colon.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>tibble [400 × 14] (S3: tbl_df/tbl/data.frame)
 $ Country             : chr [1:400] &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr [1:400] &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : chr [1:400] &quot;20.2&quot; &quot;20.6&quot; &quot;25.2&quot; &quot;26.0&quot; ...
 $ National_BMI_1985_CI: chr [1:400] &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : chr [1:400] &quot;19.7&quot; &quot;20.1&quot; &quot;25.0&quot; &quot;26.1&quot; ...
 $ Rural_BMI_1985_CI   : chr [1:400] &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : chr [1:400] &quot;22.4&quot; &quot;23.2&quot; &quot;25.4&quot; &quot;25.9&quot; ...
 $ Urban_BMI_1985_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : chr [1:400] &quot;22.8&quot; &quot;24.4&quot; &quot;27.0&quot; &quot;26.0&quot; ...
 $ National_BMI_2017_CI: chr [1:400] &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : chr [1:400] &quot;22.5&quot; &quot;23.6&quot; &quot;26.9&quot; &quot;26.2&quot; ...
 $ Rural_BMI_2017_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : chr [1:400] &quot;23.6&quot; &quot;26.3&quot; &quot;27.0&quot; &quot;25.9&quot; ...
 $ Urban_BMI_2017_CI   : chr [1:400] &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>Looks like none of our BMI data is actually <code>numeric</code> (or <code>num</code>), but of the class <code>character</code> (or <code>chr</code>). Let’s change that now.</p>
<p>To start, we could change these values to be numeric with 6 lines of code like this, where the double brackets<code>[[]]</code> and quotes are used to select the specific variable within the <code>BMI</code> tibble. In this case we need to use the brackets instead of <code>pull()</code> because we can’t start a command with <code>pull()</code> to reassign values in a variable.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co">#pull(BMI, National_BMI_1985)%&lt;&gt;% as.numeric #This will not work</span></a>
<a class="sourceLine" id="cb126-2" title="2">BMI[[<span class="st">&quot;National_BMI_1985&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-3" title="3">BMI[[<span class="st">&quot;Rural_BMI_1985&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-4" title="4">BMI[[<span class="st">&quot;Urban_BMI_1985&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-5" title="5"></a>
<a class="sourceLine" id="cb126-6" title="6">BMI[[<span class="st">&quot;National_BMI_2017&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-7" title="7">BMI[[<span class="st">&quot;Rural_BMI_2017&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-8" title="8">BMI[[<span class="st">&quot;Urban_BMI_2017&quot;</span>]] <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a></code></pre></div>
<p>And if we did this we would see these variables show as <code>&quot;num&quot;</code> which stands for a numeric type of variable.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>tibble [400 × 14] (S3: tbl_df/tbl/data.frame)
 $ Country             : chr [1:400] &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr [1:400] &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : num [1:400] 20.2 20.6 25.2 26 22.1 24 33.7 34.3 25 25.2 ...
 $ National_BMI_1985_CI: chr [1:400] &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : num [1:400] 19.7 20.1 25 26.1 21.8 23.3 32.6 34.1 25.3 25.4 ...
 $ Rural_BMI_1985_CI   : chr [1:400] &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : num [1:400] 22.4 23.2 25.4 25.9 22.3 24.8 34 34.4 25 25.2 ...
 $ Urban_BMI_1985_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : num [1:400] 22.8 24.4 27 26 25.1 27.4 34.3 35.3 26.8 25.3 ...
 $ National_BMI_2017_CI: chr [1:400] &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : num [1:400] 22.5 23.6 26.9 26.2 24.8 27 34.6 35 26.8 25.2 ...
 $ Rural_BMI_2017_CI   : chr [1:400] &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : num [1:400] 23.6 26.3 27 25.9 25.2 27.5 34.2 35.4 26.8 25.3 ...
 $ Urban_BMI_2017_CI   : chr [1:400] &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>Or we can use a more automated way with the <code>map()</code> function of the <code>purrr</code> package:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">BMI_numeric &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>((BMI <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-3" title="3"><span class="st">                </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">matches</span>(<span class="st">&quot;CI|Sex|Country&quot;</span>))),</a>
<a class="sourceLine" id="cb129-4" title="4">             as.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-5" title="5"><span class="st">  </span><span class="kw">as_tibble</span>()</a></code></pre></div>
<p>The <code>map()</code> function of the <code>purrr</code> package allows us to apply the <code>as.numeric()</code> function to all the selected columns of <code>BMI</code> dataset. Above, we have selected those that don’t contain <code>CI</code>, <code>Sex</code>, or <code>Country</code> in the column name. If you are familiar with <code>apply()</code>, this function is very similar.</p>
<p>Now we need to add the <code>Country</code> and <code>Sex</code> variables back to our new numeric dataset.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">BMI_numeric <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Country =</span> <span class="kw">pull</span>(BMI, Country), </a>
<a class="sourceLine" id="cb130-3" title="3">         <span class="dt">Sex =</span> <span class="kw">pull</span>(BMI, Sex))</a>
<a class="sourceLine" id="cb130-4" title="4"><span class="kw">head</span>(BMI_numeric)</a></code></pre></div>
<pre><code># A tibble: 6 x 8
  National_BMI_19… Rural_BMI_1985 Urban_BMI_1985 National_BMI_20… Rural_BMI_2017
             &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
1             20.2           19.7           22.4             22.8           22.5
2             20.6           20.1           23.2             24.4           23.6
3             25.2           25             25.4             27             26.9
4             26             26.1           25.9             26             26.2
5             22.1           21.8           22.3             25.1           24.8
6             24             23.3           24.8             27.4           27  
# … with 3 more variables: Urban_BMI_2017 &lt;dbl&gt;, Country &lt;chr&gt;, Sex &lt;chr&gt;</code></pre>
<p>In this case our numeric data is of a class <code>dbl</code>. This means double-precision floating point numbers (with decimals). The alternative numeric option is the integer class.</p>
</div>
<div id="transforming-to-tidy-data" class="section level3">
<h3>Transforming to tidy data</h3>
<p>It is generally useful to get the data in what is called <b>long</b> format for other analyses, and particularly for plotting.</p>
<p>For a more detailed description about this, please see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">case study</a>.</p>
<p>Basically, the long format has more rows and fewer columns. Thus, we can combine some columns together. In our case, we can put all the different BMI data together in one long column. We will create a new column that tells us what each row of the new BMI column represents. In other words, it will tell us what the original column was.</p>
<p>To do this we will use the <code>pivot_longer()</code> function of the <code>tidyr</code> package. The <code>data</code> argument specifies what data we want to work with, the <code>cols</code> argument specifies the names of the columns or variables that we want to combine and change to one long format variable, and the <code>names_to</code> argument specifies the name for the new variable that we are creating. The <code>:</code> is used to indicate that we want to combine the columns or variables between <code>National_BMI_1985</code> and <code>Urban_BMI_2017</code>.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">BMI_long &lt;-</a>
<a class="sourceLine" id="cb132-2" title="2"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">data =</span> BMI_numeric, </a>
<a class="sourceLine" id="cb132-3" title="3">                      <span class="dt">cols =</span> National_BMI_<span class="dv">1985</span><span class="op">:</span>Urban_BMI_<span class="dv">2017</span>, </a>
<a class="sourceLine" id="cb132-4" title="4">                      <span class="dt">names_to =</span> <span class="st">&quot;class_BMI&quot;</span>)</a>
<a class="sourceLine" id="cb132-5" title="5"></a>
<a class="sourceLine" id="cb132-6" title="6"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   class_BMI         value
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;
1 Afghanistan Men   National_BMI_1985  20.2
2 Afghanistan Men   Rural_BMI_1985     19.7
3 Afghanistan Men   Urban_BMI_1985     22.4
4 Afghanistan Men   National_BMI_2017  22.8
5 Afghanistan Men   Rural_BMI_2017     22.5
6 Afghanistan Men   Urban_BMI_2017     23.6</code></pre>
<p>We really want to promote the idea of working with <a href="https://r4ds.had.co.nz/tidy-data.html" target="_blank">tidy data</a>. Tidy data is data that is structured in a way that makes it especially usable. One of the rules of tidy data, is that each column or variable should have only one type of data. Currently we have two types of data in the <code>BMI_class</code> variable: the type of BMI measurement ( Rural, Urban, or National), and the year (1985 and 2017). We can separate these two data types of the <code>class_BMI</code> column using the <code>separate()</code> function of the <code>tidyr</code> package to replace the <code>class_BMI</code> column with two new columns.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">BMI_long <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">separate</span>(class_BMI, </a>
<a class="sourceLine" id="cb134-3" title="3">                  <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;Year&quot;</span>)) </a></code></pre></div>
<p>Here, we separate the <code>class_BMI</code> column of the <code>BMI_long</code> tibble. This is based on the underscores and create two new columns. The first column will be called <code>Region</code>. It will contain the 1st part of the <code>class_BMI</code> data before the 1st underscore. The 2nd column will be called <code>Year</code>. It will contain the 3rd part of the data based on underscores. The middle part of the column will not be used to create any new columns.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 5
  Country     Sex   Region   Year  value
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan Men   National 1985   20.2
2 Afghanistan Men   Rural    1985   19.7
3 Afghanistan Men   Urban    1985   22.4
4 Afghanistan Men   National 2017   22.8
5 Afghanistan Men   Rural    2017   22.5
6 Afghanistan Men   Urban    2017   23.6</code></pre>
<p>Let’s see how the dimensions of the <code>BMI</code> data have changed in long format:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">dim</span>(BMI_numeric)</a></code></pre></div>
<pre><code>[1] 400   8</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="kw">dim</span>(BMI_long)</a></code></pre></div>
<pre><code>[1] 2400    5</code></pre>
<p>Let’s rename the <code>value</code> column to something more informative. We can use the <code>rename()</code> function of the <code>dplyr</code> package to do this. Notice that the value we want to replace is listed second after the <code>=</code> sign.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">BMI_long <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">BMI =</span> value)</a>
<a class="sourceLine" id="cb141-3" title="3"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan Men   National 1985   20.2
2 Afghanistan Men   Rural    1985   19.7
3 Afghanistan Men   Urban    1985   22.4
4 Afghanistan Men   National 2017   22.8
5 Afghanistan Men   Rural    2017   22.5
6 Afghanistan Men   Urban    2017   23.6</code></pre>
<div id="section-14" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Why exactly are there 2,400 rows now?</p>
</div>
<div id="section-15" class="section level4">
<h4></h4>
<p>Great! Our data is very usable now in this format!</p>
</div>
</div>
</div>
<div id="data-exploration" class="section level2">
<h2>Data Exploration</h2>
<p>Now that our data is clean and in a format that we can work with, we can start to take a look at the data and how different groups might compare.</p>
<p>Going back to one of our original questions,</p>
<blockquote>
<p>Is there a difference between rural and urban BMI estimates around the world?</p>
</blockquote>
<p>We want to use a statistical test to identify if there are differences in the average BMI estimates between e.g. rural and urban groups. First, let’s explore our data a bit.</p>
<div id="general-summary" class="section level3">
<h3>General summary</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">summary</span>(BMI_numeric)</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985 Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.7   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.50     1st Qu.:20.9   1st Qu.:22.43   1st Qu.:24.07    
 Median :24.00     Median :23.4   Median :24.30   Median :26.15    
 Mean   :23.68     Mean   :23.3   Mean   :24.24   Mean   :26.00    
 3rd Qu.:25.23     3rd Qu.:25.1   3rd Qu.:25.40   3rd Qu.:27.43    
 Max.   :34.30     Max.   :34.1   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :6      NA&#39;s   :2                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :19.80   Min.   :21.50   Length:400         Length:400        
 1st Qu.:23.30   1st Qu.:24.80   Class :character   Class :character  
 Median :26.00   Median :26.30   Mode  :character   Mode  :character  
 Mean   :25.61   Mean   :26.37                                        
 3rd Qu.:27.30   3rd Qu.:27.60                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :8       NA&#39;s   :2                                            </code></pre>
<p>We can see that the mean BMI estimates are larger in 2017. However, is this a meaningful increase? This is difficult to determine without a statistical test.</p>
<p>Lets look at the data stratified by <code>Sex</code>:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.70   Min.   :19.70   Min.   :21.00    
 1st Qu.:22.00     1st Qu.:21.20   1st Qu.:22.85   1st Qu.:24.40    
 Median :24.25     Median :23.90   Median :24.60   Median :26.10    
 Mean   :24.00     Mean   :23.59   Mean   :24.63   Mean   :26.38    
 3rd Qu.:25.50     3rd Qu.:25.40   3rd Qu.:25.60   3rd Qu.:28.00    
 Max.   :34.30     Max.   :34.10   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :20.40   Min.   :21.60   Length:200         Length:200        
 1st Qu.:23.70   1st Qu.:25.30   Class :character   Class :character  
 Median :26.20   Median :26.40   Mode  :character   Mode  :character  
 Mean   :25.98   Mean   :26.84                                        
 3rd Qu.:27.60   3rd Qu.:28.25                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :4       NA&#39;s   :1                                            </code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.50     Min.   :18.40   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.10     1st Qu.:20.80   1st Qu.:22.10   1st Qu.:23.30    
 Median :23.60     Median :23.20   Median :24.10   Median :26.20    
 Mean   :23.36     Mean   :23.01   Mean   :23.84   Mean   :25.61    
 3rd Qu.:25.00     3rd Qu.:24.90   3rd Qu.:25.10   3rd Qu.:27.10    
 Max.   :33.70     Max.   :32.60   Max.   :34.00   Max.   :34.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017   Country              Sex           
 Min.   :19.80   Min.   :21.5   Length:200         Length:200        
 1st Qu.:22.60   1st Qu.:23.8   Class :character   Class :character  
 Median :25.75   Median :26.3   Mode  :character   Mode  :character  
 Mean   :25.24   Mean   :25.9                                        
 3rd Qu.:27.00   3rd Qu.:27.2                                        
 Max.   :34.60   Max.   :34.2                                        
 NA&#39;s   :4       NA&#39;s   :1                                           </code></pre>
<p>It looks like mean BMIs have increased in all regions for both men and women, but let’s look deeper with some statistical tests.</p>
</div>
<div id="distributions" class="section level3">
<h3>Distributions</h3>
<p>In order to apply a statistical test to compare the means, one of the first things to do is to explore the frequency of the different observed values. One way to summarize the frequency of different observed values is the <b>frequency distribution</b>, which can be shown in a table or a plot. See <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">here</a> for more information about distributions.</p>
<p>There are other types of distributions too, such as <b>probability distributions</b>, which describe the probability the occurrence of different possible outcomes. Probability distributions can be defined for discrete data (e.g. flipping a coin as heads or tails) and continuous data (e.g. BMI estimates). If we are talking about discrete data, the relative frequency of the different categories (heads or tails) can be used to define a <b>discrete probability distribution</b>. We can simply assign a probability to each category, e.g. <span class="math inline">\(P(heads) = 0.5\)</span> and <span class="math inline">\(P(tails) = 0.5\)</span>.</p>
<p><b>Continuous probability distributions</b> work in a similar way, except instead of assigning a probability to each category or type of observation (e.g. heads or tails), we assign a probability to an interval of continuous values (e.g. BMI between 22 and 26). This is because it’s not useful to construct a distribution that assigns a probability to each possible outcome (e.g. a BMI of 22.11, 22.12, etc) with such high precision. In this case, we would have to assign a very small probability to every possible BMI outcome.</p>
<p>The <b>normal (or Gaussian) distribution</b> is a type of <b>theoretical continuous probability distribution</b> that is frequently used to approximate the distribution of many naturally occurring measurements, such as that of BMI. We say that a random quantity <span class="math inline">\(X\)</span> (e.g. BMI) is normally distributed with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span> if the proportion of values in a given interval <span class="math inline">\((a,b)\)</span> (e.g. BMI between 22 and 26) can be computed using this mathematical formula:</p>
<p><span class="math display">\[P(a &lt; x &lt; b) = \int_a^b \frac{1}{\sqrt{2\pi} s} e^{-\frac{1}{2}\big(\frac{x-m}{s}\big)^2}  \]</span></p>
<p>Translating this to our case study, if our BMI data follow a normal distribution with mean of <span class="math inline">\(m = 24\)</span> and standard deviation of <span class="math inline">\(s = 1\)</span>, then the distribution of different BMI outcomes should be centered around that mean value of 24 and would look something like this:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">norm_BMI_ex_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb149-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">norm_data =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb149-3" title="3"><span class="kw">hist</span>(<span class="kw">pull</span>(norm_BMI_ex_data, norm_data))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we are simulating 200 observations from a normal distribution with a mean of <span class="math inline">\(m = 24\)</span> and standard deviation of <span class="math inline">\(s = 1\)</span> using the <code>rnorm()</code> function.</p>
<p>Alternatively to using base R, we can plot the frequency of simulated observations using the <code>geom_hist()</code> function of the <code>ggplot2</code> R package. The <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a> package creates plots by using layers. Notice in the following code how there is a plus sign between the <code>ggplot()</code> function and the <code>geom_histogram()</code> function. With <code>ggplot2</code> we select what data we would like to plot using the first function (<code>ggplot()</code>) and then we add on additional layers of complexity (these layers can even involve different data).</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">  ggplot2<span class="op">::</span><span class="kw">ggplot</span>(norm_BMI_ex_data, <span class="kw">aes</span>(<span class="dt">x =</span> norm_data)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-2" title="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here, we are using the column called <code>norm_data</code> within <code>norm_BMI_ex_data</code>. As we noted, with <code>ggplot2</code> we must first specify the data to plot with the <code>ggplot()</code> function. Then, the <code>geom_*</code> function specifies what type of plot to create (e.g. <code>geom_histogram()</code> create a histogram).</p>
<p>We could also make this same plot by piping the <code>norm_BMI_ex_data</code> data into the <code>ggplot()</code> function:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">norm_BMI_ex_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb151-2" title="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> norm_data)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb151-3" title="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We will see later how we can add many layers to plots with <code>ggplot2</code>. For additional information on using <code>ggplot2</code>, see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">case study</a>.</p>
<p>Now instead of using simulated data from a normal distribution, let’s make a histogram of our BMI data:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Interesting! The data looks like it has one mode, but it does not look completely symmetric. In fact it looks like it might be what is called right skewed. See <a href="http://onlinestatbook.com/2/glossary/skew.html" target="_blank">here</a> for more information about skewed distributions.</p>
<p>To check we can calculate the mean and median of the BMI data using the base <code>summarize()</code> function of the <code>dplyr</code> package. If the mean and median are very similar, then we will know that the data isn’t skewed. Note that it is necessary to filter out the NA values first.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(BMI))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(BMI), <span class="dt">median =</span> <span class="kw">median</span>(BMI))</a></code></pre></div>
<pre><code># A tibble: 1 x 2
   mean median
  &lt;dbl&gt;  &lt;dbl&gt;
1  24.9   24.9</code></pre>
<p>OK, so they are essentially the same, mean= 24.87 and median = 24.9, so this does not fit the hallmark of right-skewed data where the the mean is greater than the median.</p>
<p>However so far we have made a histogram of the BMI data in the long format which combines BMI estimates for different subgroups of people, so rural women, rural men, urban women, urban men, etc. are all combined. If we want to make group comparisons, we need to look at the distributions for the specific groups that we are evaluating. So, we need to pick a particular population of individuals and graph their BMI, for example just the national estimates for women and for men in 1985.</p>
<p>The easiest way to do this is to use some other functions of the <code>ggplot2</code> package, particularly the <code>facet_wrap()</code> function, which will allow us to look at differences in the distribution of the BMI estimates stratified by <code>Year</code>, <code>Sex</code>, and <code>Region</code>. We can sequentially divide our plots by deeper levels using multiple variables and the <code>+</code> plus sign within <code>facet_wrap()</code>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb155-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb155-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb155-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Some of these plots look pretty similar to a normal distribution, like the <code>Women 2017 Urban</code> plot (although it might be right-skewed, again we could check the mean and median to determine that). However some of the other plots, like the <code>Men 2017 Urban</code> plot, look very different. These plots show what is called a <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">bimodal distribution</a>, meaning that there appear to be two peaks (or modes), or in other words two different values (and values near each of these) that are the most frequent.</p>
</div>
<div id="quantile-quantile-plots" class="section level3">
<h3>Quantile-Quantile Plots</h3>
<p>Another useful plot to create when exploring distributions is something called a “quantile-quantile” plot (or <b>Q-Q plot</b> for short). When we talk about a <b>quantile</b>, we are talking about dividing up the distribution of the data into roughly equal portions where roughly the same number of observations fall into each portion. For example, if you divide your data into 100 quantiles, you can think about this as percentiles, but you could also divide your data into 10 quantiles and these would be called deciles.</p>
<p><b>Why Q-Q plots?</b> This plot allows us to compare the quantiles of two distributions together: (1) quantiles of a known theoretical distribution (like the normal distribution) compared to (2) quantiles of the distribution of our data. If the quantiles from these two distributions line up in the plot, then that is a visual piece of evidence that our data follow that theoretical distribution (like the normal distribution).</p>
<p><b>How does this work?</b> To do this we will plot the quantiles of our data on the y-axis and the quantiles of the theoretical normal distribution on the x-axis. If the quantiles line up then we can say that our data is fairly normal. See <a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html" target="_blank">here</a> for more information about Q-Q plots.</p>
<p>Using the <code>stat_qq()</code> function of the <code>ggplot2</code> package, we can easily create a Q-Q plot for our data randomly sampled from a normal distribution (“sample”) and compare it to the quantiles from a normal distribution (“theoretical”). The default comparison distribution for these functions is the normal distribution, so we don’t need to specify it in our code.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">norm_BMI_ex_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> norm_data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb156-3" title="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb156-4" title="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The <code>stat_qq_line()</code> function is used to add a line (computes the slope an intercept) on the plot. If the points lie on this straight line, this is evidence that the data have a normal distribution, not that the data have a particular normal distribution. Not surprisingly, we see that the points mostly fall on the line, indicating that the quantiles are fairly similar between the observed and theoretical data.</p>
<p>There are some points that are a bit further from the line as we get to the extreme quantiles.</p>
<p>Note that this plot is comparing our <code>norm_BMI_ex_data</code> which was randomly sampled from a normal distribution with mean 24 and standard deviation 1 to a <em>standard normal distribution</em> with mean 0 and standard deviation 1, which is why the values on the x-axis are -3 to 3 instead of 21 to 27.</p>
<p>As expected we see that about half the points are below our mean of 24 on the y-axis.</p>
<p>We can specify a specific mean and standard deviation for our theoretical distribution in our Q-Q plot; here we specify a normal distribution with mean 24 and standard deviation 1 (so that the theoretical distribution looks more like our data):</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">norm_BMI_ex_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb157-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> norm_data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="st">  </span><span class="kw">stat_qq</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">dparams =</span> <span class="kw">c</span>(<span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-4" title="4"><span class="st">  </span><span class="kw">stat_qq_line</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">dparams =</span> <span class="kw">c</span>(<span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-90-1.png" width="90%" style="display: block; margin: auto;" /> Notice that the plot looks the same except for the values on the x-axis have changed, meaning our interpretation will be the same – it looks like the values are consistent with a normal distribution.</p>
<p>Now, let’s take a look at our actual BMI data:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb158-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb158-4" title="4"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb158-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This is a little hard to see, some plots suggest those subsets of the data are similar to a normal distribution, but others seem to be skewed. Let’s take a closer look.</p>
<p>For the sake of simplicity, we are going to focus on the subset of data for the women. This is because women were identified in the paper to have fastest increases in BMI over time. If we want to compare two subsets of women (e.g. 1985 versus 2017 or rural versus urban), then we need to look at the distribution of each of these subsets.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb159-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb159-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-4" title="4"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb159-5" title="5"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb159-6" title="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-92-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that at the extremes of our quantiles, for most of our data, our tails are not very similar to the theoretical distribution. We can can also see that our data is right- or positive-skewed, because the extreme values are above the line.</p>
<p>The rural data looks more normal than the urban data. You might be asking, why do we care if the data look more normal or not? It turns out if you want to ask questions like “Is there a difference in the average BMI estimates from women in 1985 compared to women in 2017?”, we will need to use some of type of statistical test. The most commonly used statistical tests that can answer that question rely on an assumption about the data you have, namely that your data have a similar shape as a theoretical normal distribution. So, if we want to use those powerful statistical tests that rely on this assumption of “normality”, then we need to check that assumption before using those tests.</p>
<p>We can conclude from these plots that the assumption of normality appears to be violated in our data.</p>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<p>In the previous section, we hinted at the existence of statistical tests to be able to assess if there is a difference in the average BMI estimates between two groups (e.g. national BMI estimates in rural areas and national BMI estimates in urban areas). One such test is the <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test" target="_blank">Student’s <span class="math inline">\(t\)</span>-test</a>, which can be used to determine if <a href="http://onlinestatbook.com/2/estimation/difference_means.html" target="_blank">two group means are different</a>. However, as mentioned before, this test depends on certain assumption of our data.</p>
<p>In this section, we are going to talk about this test and other tests that do not require the same assumptions about our data.</p>
<div id="hypothesis-testing" class="section level3">
<h3>Hypothesis testing</h3>
<p>Let’s remind ourselves of one of our original questions,</p>
<blockquote>
<p>Is there a difference between rural and urban BMI estimates around the world?</p>
</blockquote>
<p>In hypothesis testing, we are interested in comparing two different hypotheses: a “null” hypothesis (can be thought of like a baseline e.g. the means between two groups are the same) compared to an “alternative” hypothesis (e.g. the means between two groups are different). We are going to ask if there is enough evidence in our data to reject the null hypothesis.</p>
<p>Let’s try to formalize this a bit.</p>
<p>Suppose we want to test whether there is a difference between rural and urban BMI estimates using the data from 1985. In our case, then, we want to test whether the mean BMI estimate among the rural areas is the same as the mean BMI estimate in the urban areas. If we call the true unknown means of the two groups <span class="math inline">\(\mu_U\)</span> and <span class="math inline">\(\mu_R\)</span>, for the urban and rural areas, respectively, then we can define the <b>null hypothesis</b> that there is no difference in the two means:</p>
<p><span class="math display">\[ H_0: \mu_U = \mu_R \]</span></p>
<p>In contrast, we also define an <b>alternative hypothesis</b> that there is a difference between the mean BMI esimates:</p>
<p><span class="math display">\[ H_a: \mu_U \neq \mu_R \]</span></p>
<p>The idea behind a hypothesis test is that we assume the null hypothesis is true and we use our data to help us identify if there is enough evidence to <em>reject the null hypothesis</em>.</p>
<p>This is similar to the idea of assuming that individuals are not guilty until proven otherwise. If there is not enough evidence in the data, then we say we “fail to reject the null hypothesis”.</p>
<p>You might be asking, “But we do not know what the true group means are?” That is correct. Instead, we must estimate these means based on the data that we have. For example, in our data, we can estimate the average BMI estimates for women in rural and urban regions in 1985. Here we will use the <code>summarize()</code> function from the <code>dplyr</code> package again, this time using the argument <code>na.rm = TRUE</code> to remove NA values.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb160-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">avg_bmi =</span> <span class="kw">mean</span>(BMI, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </a></code></pre></div>
<pre><code># A tibble: 2 x 2
  Region avg_bmi
  &lt;chr&gt;    &lt;dbl&gt;
1 Rural     23.6
2 Urban     24.6</code></pre>
<p>Here we see that that in 1985, the average BMI estimate for women across urban areas is 24.6 compared to 23.6 across rural areas. It looks like BMI estimates are, on average, higher in urban areas compared to rural areas. However, now we want to use a statistical test to assess if this difference is statistically meaningful or a difference of this size could be found due to random chance.</p>
</div>
<div id="two-sample-t-test" class="section level3">
<h3>Two-sample t-test</h3>
<p>The two-sample <span class="math inline">\(t\)</span>-test is a common way to determine if the means of two groups are different. It does this by calculating a observed test-statistic, <span class="math inline">\(t\)</span>, that looks at the difference in the sample means of the two groups divided by an estimate of the variability in the difference in sample means. Here <span class="math inline">\(s_{pooled}\)</span> is standard deviation of the data when pooling the samples together. <span class="math display">\[
t = \frac{\bar{X}_U-\bar{X}_R}{s_{pooled}\sqrt{\frac{1}{n_U} + \frac{1}{n_R}}}
\]</span> If the null hypothesis is true, and the means for urban and rural areas are the same, then the sample means in the numerator will be similar and this test statistic will be close to 0. However, if the test statistic is not close to 0, this provides evidence the means for the urban and rural areas are difference, and so we may choose to reject the null hypothesis.</p>
<p>To formally decide whether to reject the null hypothesis, we compare the observed test statistic to the distribution of possible test statistics that could occur if the null hypothesis were true using what we call a <strong>p-value</strong>. The p-value tells us the probability of observing a test statistic as or more extreme than the one we observed if the null hypothesis is true. If the p-value is small, say less than 0.05, then our observed test statistic is pretty rare if the null hypothesis is true. This would lead us to reject the null hypothesis and conclude that the means of the two groups are different. We will talk more about p-values, and in particular our choice of 0.05 as a comparison for the p-value, a little later.</p>
<p>Here we perform a two-sample <span class="math inline">\(t\)</span>-test comparing estimate for rural women in 1985 to estimates for urban women in 1985. We use the <code>var.equal = TRUE</code> option here to use the pooled standard deviation <span class="math inline">\(s_{pooled}\)</span> from the formula above.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb162-2" title="2">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb162-3" title="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb162-4" title="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb162-5" title="5">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb162-6" title="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb162-7" title="7">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two Sample t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -3.8952, df = 394, p-value = 0.0001152
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.5744694 -0.5182378
sample estimates:
mean of x mean of y 
 23.58782  24.63417 </code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a></code></pre></div>
<p>In this case the p-value for the test is 0.00012, which is quite small. Here would would reject the null hypthesis that the means in the two groups are equal and conclude there are differences in mean BMI estimates for women in urban and rural areas.</p>
<p>But wait! We need to check the assumptions of the statistical test we used to be sure it is valid. The two-sample <span class="math inline">\(t\)</span>-test relies on several <u><b>assumptions</b></u>:</p>
<ol style="list-style-type: decimal">
<li>The data for each group is <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">normally distributed</a>.</li>
<li>The <a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance" target="_blank">variance</a> of both groups is similar.</li>
<li>The observations from the two groups are <a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">independent</a> (meaning that observations do not influence each other).</li>
<li>The observations within each group are <a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">independent</a> (meaning that observations do not influence each other).</li>
</ol>
<p>If these assumptions are violated, this doesn’t necessarily mean we can’t perform a statistical test. It just means we may need to consider the following options:</p>
<ol style="list-style-type: decimal">
<li>If the data isn’t normally distributed, we may need to consider either a <a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/" target="_blank">transformation</a> of the data to make it more normally distributed or a <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960" target="_blank">nonparametric</a> test which doesn’t rely on the normality assumption.</li>
<li>If the variances of the two groups aren’t similar, we can to a <a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/" target="_blank">Welch’s <span class="math inline">\(t\)</span>-test</a> (also called the unequal variance <span class="math inline">\(t\)</span>-test) to account for difference variances. This modifies the denominator of the test statistic to no longer use the standard deviation from pooling the samples. We can do this in <code>R</code> by using the <code>var.equal = TRUE</code> option in the <code>t.test()</code> function.</li>
<li>If the data in the two samples are not independent and are instead what we call paired, we should use the <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/" target="_blank">Paired <span class="math inline">\(t\)</span>-test</a>.</li>
<li>If the data within a group is not independent, we would need to consider methods beyond the scope of this case study.</li>
</ol>
<p>Are these assumptions met in our case? We’ve already seen, using Q-Q plots, that these BMI estimates may not be normally distributed. We haven’t checked the assumption of equal variance yet. But it seems clear that the last assumption (of independent samples) is violated in our case! The BMI data for rural areas comes from the same countries and the BMI data for urban areas, meaning the samples are not independent and are instead what we call <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/" target="_blank">paired</a>. We need to account for this because paired values may be more similar to one another because they come from the same country. Note that this would also be true for the male and female measurements from the same country or the values in the same countries from 1985 and later in 2017.</p>
</div>
<div id="paired-t-test" class="section level3">
<h3>Paired t-test</h3>
<p>When we perform a paired <span class="math inline">\(t\)</span>-test, instead of looking at the means of the two samples separately, we combine observations in a pair (from the same country in our case) to calculate a difference in values between the two samples. For example, we are really testing the <code>bmi_diff</code> column in the data below:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb165-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">bmi_rural =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>],</a>
<a class="sourceLine" id="cb165-5" title="5">            <span class="dt">bmi_urban =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>],</a>
<a class="sourceLine" id="cb165-6" title="6">            <span class="dt">bmi_diff =</span> bmi_rural <span class="op">-</span><span class="st"> </span>bmi_urban) </a></code></pre></div>
<pre><code># A tibble: 200 x 4
   Country             bmi_rural bmi_urban bmi_diff
   &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 Afghanistan              20.1      23.2   -3.10 
 2 Albania                  26.1      25.9    0.2  
 3 Algeria                  23.3      24.8   -1.5  
 4 American Samoa           34.1      34.4   -0.300
 5 Andorra                  25.4      25.2    0.200
 6 Angola                   20.9      22.7   -1.8  
 7 Antigua and Barbuda      24        25.4   -1.40 
 8 Argentina                23.3      24.5   -1.20 
 9 Armenia                  25.2      25.5   -0.3  
10 Australia                24.7      24.4    0.3  
# … with 190 more rows</code></pre>
<p>This means our hypotheses are slightly different from the two-sample <span class="math inline">\(t\)</span>-test. In this case we are testing the differences among the pairs of observations and how close these differences are to zero. (A mean difference of zero would mean the BMI estimates are the same in the rural and urban areas.) If we let <span class="math inline">\(\mu_d\)</span> represent the true mean difference between the paired observations of the two groups, then our null hypothesis is that the mean of the differences is equal to zero: <span class="math display">\[
                                        H_0 : \mu_d = 0
\]</span></p>
<p>And the alternative hypothesis is that the mean of the differences is not equal to zero: <span class="math display">\[
                                        H_a : \mu_d \neq 0
\]</span></p>
<p>We can perform a paired <span class="math inline">\(t\)</span>-test by adding the option <code>paired = TRUE</code> to the <code>t.test()</code> command. Note that we don’t need to specify anything about equality of variances now, because there is only one variance, the variance of the paired differences!</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb167-2" title="2">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb167-3" title="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb167-4" title="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb167-5" title="5">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb167-6" title="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb167-7" title="7">       <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -14.095, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.1870263 -0.8956268
sample estimates:
mean of the differences 
              -1.041327 </code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a></code></pre></div>
<div id="section-16" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Looking at the t value, was global BMI lower in Rural or Urban areas in 1985?</p>
</div>
<div id="section-17" class="section level4">
<h4></h4>
<p>Let’s come back to the other <span class="math inline">\(t\)</span>-test assumptions now. With a paired <span class="math inline">\(t\)</span>-test, we no longer need to assess the assumption about equal variance, since we are really testing the mean of one sample (of paired differences) rather than comparing two samples. However, we still have to check normality and independence of observations. We can rephrase these now to be about the paired differences rather than the two separate samples:</p>
<ol style="list-style-type: decimal">
<li>The paired differences are <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">normally distributed</a>.</li>
<li>The paired differences are <a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">independent</a> (meaning that observations do not influence each other).</li>
</ol>
<p>If we assume that measurements between different countries are independent, this second assumption is not violated. Therefore, we only now need to check normality of these paired differences.</p>
<p>We can start by making a Q-Q plot of the paired differences.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">bmi_rural =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>],</a>
<a class="sourceLine" id="cb170-5" title="5">            <span class="dt">bmi_urban =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>],</a>
<a class="sourceLine" id="cb170-6" title="6">            <span class="dt">bmi_diff =</span> bmi_rural <span class="op">-</span><span class="st"> </span>bmi_urban)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb170-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> bmi_diff)) <span class="op">+</span></a>
<a class="sourceLine" id="cb170-8" title="8"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb170-9" title="9"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We see that these paired differences do not appear to be normally distributed because the points do not lie on the straight line. We can also see this by making a histogram of these paired differences:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb171-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">bmi_rural =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>],</a>
<a class="sourceLine" id="cb171-5" title="5">            <span class="dt">bmi_urban =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>],</a>
<a class="sourceLine" id="cb171-6" title="6">            <span class="dt">bmi_diff =</span> bmi_rural <span class="op">-</span><span class="st"> </span>bmi_urban)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> bmi_diff)) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-8" title="8"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-98-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This histogram appears to show show a bimodal distribution, meaning two groups of countries – most countries have a rural BMI estimates lower than urban BMI estimates (<code>bmi_diff</code> &lt; 0), while a smaller group of countries have urban BMI esimates higher than urban BMI estimates (<code>bmi_diff</code> &gt;0).</p>
<p>First we will try transform our data to make it more normally distributed. One way to do this is to take the logarithm of the data values. Logarithms make extreme values less extreme, so can be helpful when data has a right skew.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="co"># create a new dataset with the paired differences</span></a>
<a class="sourceLine" id="cb172-2" title="2"><span class="co"># create a log version of the difference variable using mutate()</span></a>
<a class="sourceLine" id="cb172-3" title="3">BMI_diff_log &lt;-<span class="st"> </span>BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb172-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb172-6" title="6"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">bmi_rural =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>],</a>
<a class="sourceLine" id="cb172-7" title="7">            <span class="dt">bmi_urban =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>],</a>
<a class="sourceLine" id="cb172-8" title="8">            <span class="dt">bmi_diff =</span> bmi_rural <span class="op">-</span><span class="st"> </span>bmi_urban) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb172-9" title="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_diff=</span><span class="kw">log</span>(bmi_diff))</a></code></pre></div>
<p>Notice the warning message that <code>In log(bmi_diff) :  NaNs produced</code>. This is because some of our differences were less than zero, and the logarithm of a negative number is not defined. We can fix this issue by adding the same positive number, say 5, to each difference before taking the logarithm:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">BMI_diff_log &lt;-<span class="st"> </span>BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">1985</span>, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(Country) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb173-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">bmi_rural =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>],</a>
<a class="sourceLine" id="cb173-5" title="5">            <span class="dt">bmi_urban =</span> BMI[Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>],</a>
<a class="sourceLine" id="cb173-6" title="6">            <span class="dt">bmi_diff =</span> bmi_rural <span class="op">-</span><span class="st"> </span>bmi_urban) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb173-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_diff=</span><span class="kw">log</span>(bmi_diff <span class="op">+</span><span class="st"> </span><span class="dv">5</span>))</a></code></pre></div>
<p>Let’s look at a Q-Q plot and histogram of this transformed data:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1">BMI_diff_log <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> log_diff)) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb174-4" title="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-101-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">BMI_diff_log <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_diff)) <span class="op">+</span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-101-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The transformed data still does not appear to be normally distributed and the bimodal nature of the distribution is still apparent in the histogram. What should we do? The <span class="math inline">\(t\)</span>-test is fairly <strong>robust</strong> to violations of the normality assumption if the sample size is relatively large, due to what is called the <a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/" target="_blank">central limit theorem</a>, which states that as samples get larger, the sample mean has an approximate normal distribution.</p>
<p>With our sample size of 200, we could consider using the paired <span class="math inline">\(t\)</span>-test even with our non-normal data. However, if we had a smaller sample, we might still need to consider another alternative since the log-transformed data still doesn’t look normal. We might want to consider a non-parametric test in that case.</p>
</div>
</div>
<div id="nonparametric-tests" class="section level3">
<h3>Nonparametric tests</h3>
<p>When the normality assumption of a paired <span class="math inline">\(t\)</span>-test is violated, we can consider a nonparametric alternative instead. What’s a non-parametric test? <b>Parametric tests</b> are based on assumptions about the distribution of the underlying data, while <b>nonparametric tests</b> do not rely on these distributional assumptions.</p>
<p>See <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960" target="_blank">here</a> for more information about the difference between these two classes of tests.</p>
<p>The nonparametric alternative to the paired <span class="math inline">\(t\)</span>-test is called the <a href="http://www.biostathandbook.com/wilcoxonsignedrank.html" target="_blank">Wilcoxon signed-rank test</a>. This test doesn’t require the same normality assumption as the <span class="math inline">\(t\)</span>-test, so can be considered with the data does not appear to be normally distributed and particularly when the number of samples is low. The null hypothesis for this test is that the <strong>median</strong> of the paired differences is 0.</p>
<p>To do a Wilcoxon test, we use the <code>wilcox.test()</code> function:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb176-2" title="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb176-3" title="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb176-4" title="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb176-5" title="5">                       Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb176-6" title="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb176-7" title="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 1562, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>With this nonparametric test, we still see a small p-value, indicating that BMI estimates between urban and rural areas are different. We would conclude that there’s a difference in the median BMI estimates between these types of regions.</p>
</div>
<div id="multiple-testing-correction" class="section level3">
<h3>Multiple Testing Correction</h3>
<p>Let’s take a look back at the questions we wanted to answer: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
<p>It’s important to note that ultimately we wanted to test 4 different tests to answer question 1 and 2:</p>
<ol style="list-style-type: decimal">
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 1985?</li>
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 2017?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Rural areas?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Urban areas?</li>
</ol>
<p>So far we have only looked at the first test. Let’s perform all 4 of these tests using the non-parametric Wilcoxon signed-rank test:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb178-2" title="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb178-3" title="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb178-4" title="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb178-5" title="5">                       Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb178-6" title="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb178-7" title="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 1562, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb180-2" title="2">                        Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb180-3" title="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb180-4" title="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb180-5" title="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb180-6" title="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb180-7" title="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 2750.5, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb182-2" title="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb182-3" title="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb182-4" title="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb182-5" title="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb182-6" title="6">                       Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb182-7" title="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
V = 273, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb184-2" title="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb184-3" title="3">                        Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb184-4" title="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb184-5" title="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb184-6" title="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb184-7" title="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 189, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>In each of these tests, the very small p-value that would lead us to conclude that there is a difference between the two groups we are comparing. However, when we test multiple questions like this, we need to correct for the multiple tests that we are performing.</p>
<p>The more we test data, the more likely we are to see a significant finding just by <a href="https://www.stat.berkeley.edu/~mgoldman/Section0402.pdf" target="_blank">random chance</a> even when the finding is in fact not real. It all comes down to probability.</p>
<div id="probability" class="section level4">
<h4>Probability</h4>
<p>You may recall that probability is the chance that an event will happen and it ranges from 0 to 1. You can also think of it as a percentage of 0% (probability =0) to 100% (probability = 1) of chance that an event will happen.</p>
<p><img src="https://www.mathsisfun.com/data/images/probability-line.svg" /> [<a href="https://www.mathsisfun.com/data/images/probability-line.svg" target="_blank">source</a>]</p>
<p>If we consider flipping a coin, the probability of an event happening (heads) is always equal to 1 ( or 100% chance) minus the probability of the event not happening (tails instead of heads) because the total probability can not exceed 100%.</p>
<pre><code>    probability of 1 (100% chance) = the probabilty of heads (50% chance)
                                     + the probability of tails (50% chance)
                                   
                                 1 = P(heads) + P(tails)
        probability of one outcome = 1 - the probability of the other outcome
                          P(heads) = 1 - P(tails) 
                                    or
                          P(tails) = 1 - P(heads)</code></pre>
<p>If we think about the probability of getting significant or nonsignificant results we can think of it like this:</p>
<pre><code>                                 1 = P(signifiant results) 
                                      + P(no significant results)
            P(significant results) = 1 - P(no significant results)</code></pre>
</div>
</div>
<div id="alpha" class="section level3">
<h3>Alpha</h3>
<p>Alpha is the amount of risk that you are willing to accept that a statistical test result is actually a false positive, in other words we reject the null hypothesis when the null hypothesis is true. This is also called <a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html" target="_blank">type 1 error</a>. A significance threshold of .05 is customary and it means that we are accepting a 5% chance that our result is actually a false positive.</p>
<pre><code>                             alpha = probability of false significant results 
                                       or
                                 α = P(Making a type 1 error)
                                        </code></pre>
<p>Remember that in our statistical tests if the p-value &lt; alpha it is considered significant and if p-value &gt; alpha it is considered not significant</p>
<p>But what really is the <a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8" target="_blank">p-value</a>?</p>
</div>
<div id="p-values" class="section level3">
<h3>p-values</h3>
<p>The p in p-value stands for <b>probability</b> - the probability that we would obtain the statistics (for example the t in our student <span class="math inline">\(t\)</span>-tests based on the means of our groups of comparison) just by random chance alone. Therefore a p-value of 0.02 means that there is a 2 percent chance that out data may look the way it does just because of random chance and not because there is really a difference in the means of the groups of interest.</p>
<p>So then if alpha is the threshold for the p-value for obtaining false significant results then the probability of not making incorrect conclusions is 1 - alpha:</p>
<pre><code>             P(Not making an error) = 1 - α</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"><span class="co">#P(Not making an error) = 1 - α</span></a>
<a class="sourceLine" id="cb190-2" title="2"><span class="dv">1</span><span class="fl">-.05</span> </a></code></pre></div>
<pre><code>[1] 0.95</code></pre>
<p>OK so if we use an alpha of .05 we are accepting that 95% of the time we will not make a Type 1 error and 5 % of the time we will just by random chance.<br />
Taking this one step further:</p>
<pre><code>                 P(Making an error) = 1 - P(Not making an error)
                 P(Making an error) = 1 - (1 - α)
                              </code></pre>
<p>Here we can see that this checks out:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="co">#P(Making an error) = 1 - (1 - α)</span></a>
<a class="sourceLine" id="cb193-2" title="2"><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="fl">-.05</span>)</a></code></pre></div>
<pre><code>[1] 0.05</code></pre>
<p>So what happens if we perform multiple tests?</p>
<p>The probability of not making a type 1 error would remain the same for each test. Therefore we need to multiply the probabilities together each time to determine the over all probability of making an error across multiple tests. See <a href="http://mathforum.org/library/drmath/view/74065.html" target="_blank">here</a> about why we multiply probabilities together.</p>
<pre><code>    P(Not making an error in m tests) = (1 - α)^m
P(Making at least 1 error in m tests) = 1 - (1 - α)^m</code></pre>
<p>Let’s consider if we performed 10 different statistical tests and if we as usual considered the significance threshold alpha of .05:</p>
<p>So the probability of getting 1 significant result with 10 tests is:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - ((1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α))</span></a>
<a class="sourceLine" id="cb196-2" title="2"><span class="co">#this is the same as:</span></a>
<a class="sourceLine" id="cb196-3" title="3"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - (1 - α)^10</span></a>
<a class="sourceLine" id="cb196-4" title="4"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">10</span></a></code></pre></div>
<pre><code>[1] 0.4012631</code></pre>
<p>So there is a 40% chance that that there will be a significant finding simply due to random chance alone.</p>
<p>What about 100 tests?</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1"><span class="co">#P(Making at least 1 error in 100 tests) = 1 - (1 - α)^100</span></a>
<a class="sourceLine" id="cb198-2" title="2"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">100</span></a></code></pre></div>
<pre><code>[1] 0.9940795</code></pre>
<p>Yikes!! That is almost a 100% chance that there will be a significant finding simply due to chance alone!</p>
<p>Much of this explanation is described in this <a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf" target="_blank">lecture</a>.</p>
<p>One way to correct for this is multiple testing issue is using the <a href="http://mathworld.wolfram.com/BonferroniCorrection.html" target="_blank">Bonferroni method</a>.</p>
<p>In this method we would divide our significance threshold (generally 0.05) by the number of tests.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">4</span> <span class="co"># 4 tests</span></a></code></pre></div>
<pre><code>[1] 0.0125</code></pre>
<p>Our new significance threshold is now 0.0125. Thus our p-values should be less than this value for us to reject the null that there is no difference in means. In our 4 Wilcoxon tests, our p-values were less than 0.0125. So we see a significant difference in the means of the groups after multiple testing correction for our four different tests.</p>
</div>
</div>
<div id="data-visualization" class="section level2">
<h2>Data Visualization</h2>
<p>Again we will utilize <code>ggplot2</code> to create plots to look at the directional and magnitude of the differences in BMI we are interested in. If you need additional information please see <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">here</a>. The top two lines of the code for the following plots, filter the data to only specific values of interest. Then we layer what is called a jitter on top of a box plot. A jitter is essentially a dot plot but with some variation on the location of the points so that they do not line up vertically which can make the individual points difficult to see.</p>
<p>Our first main question was: Is there a difference between rural and urban BMI estimates around the world? Let’s look at the national mean BMI estimates for each of the years:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb202-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb202-3" title="3">         Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb202-4" title="4">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb202-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb202-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb202-7" title="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-109-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="co"># the width determines how wide the points are plotted</span></a>
<a class="sourceLine" id="cb203-2" title="2"></a>
<a class="sourceLine" id="cb203-3" title="3">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb203-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb203-5" title="5">         Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb203-6" title="6">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb203-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb203-8" title="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb203-9" title="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-109-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Our 2nd main question was: How have BMI estimates changed from 1985 to 2017? Let’s look at the change in rural and urban mean BMI estimates over time:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1"><span class="co">#this time we will add titles for Rural and Urban using ggtitle()</span></a>
<a class="sourceLine" id="cb204-2" title="2">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb204-4" title="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb204-5" title="5">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb204-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb204-9" title="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb204-10" title="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Rural&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb205-3" title="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb205-4" title="4">         Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb205-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb205-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb205-7" title="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb205-8" title="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Urban&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s put the plots together to see how the change over the years differs between the regions. We will use again use <code>facet_wrap()</code> to do this:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb206-3" title="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb206-4" title="4">         Region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Urban&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb206-5" title="5"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb206-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-7" title="7"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-111-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="co"># we would also get national data without `Region %in% c(&quot;Rural&quot;, &quot;Urban&quot;))`</span></a></code></pre></div>
<p>Indeed the change in BMI over time looks bigger in the rural areas!</p>
<p>One third main questions was: How do the different countries compare? Or in other words what do the individual dots represent in our box plots? We will take a look using <code>geom_label()</code>:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb208-3" title="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb208-4" title="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb208-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb208-7" title="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-8" title="8"><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-112-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we include all country names this is a bit too much… so perhaps we should focus on just the extreme BMI values using <code>filter()</code> function of the<code>dplyr</code> package. We will also use the <code>ggrepel</code> package to have our labels not overlap each other.</p>
<p>Part of the third question was: How does the United States of America compare? So let’s label the data points for the United states.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb209-3" title="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb209-4" title="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb209-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb209-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb209-7" title="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-8" title="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb209-9" title="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb209-10" title="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb209-11" title="11"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb209-12" title="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb209-13" title="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb209-14" title="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-15" title="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb209-16" title="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb209-17" title="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb209-18" title="18"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb209-19" title="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And let’s fill the box plots with color and outline in black:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb210-3" title="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb210-4" title="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb210-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> Year)) <span class="op">+</span></a>
<a class="sourceLine" id="cb210-7" title="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-8" title="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb210-9" title="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb210-10" title="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-11" title="11"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb210-12" title="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb210-13" title="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb210-14" title="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-15" title="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb210-16" title="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb210-17" title="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-18" title="18"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb210-19" title="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-114-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="overall-differences" class="section level3">
<h3>Overall differences</h3>
<p>Let’s take a look at all the data together, including the data for men:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Region)) <span class="op">+</span></a>
<a class="sourceLine" id="cb211-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Region)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb211-3" title="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex)   </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-115-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>That’s useful, but let’s look at the individual points and include our country labels, to do so lets change our United States of America label to USA:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1">BMI_long[[<span class="st">&quot;Country&quot;</span>]] &lt;-BMI_long[[<span class="st">&quot;Country&quot;</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb212-3" title="3"></a>
<a class="sourceLine" id="cb212-4" title="4"></a>
<a class="sourceLine" id="cb212-5" title="5"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Year)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-7" title="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Region) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-8" title="8"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-9" title="9"><span class="st">  </span><span class="co"># This will add a horizontal dashed line to indicate the obesity BMI threshold</span></a>
<a class="sourceLine" id="cb212-10" title="10"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long), </a>
<a class="sourceLine" id="cb212-11" title="11">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb212-12" title="12">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-13" title="13"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb212-14" title="14"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb212-15" title="15"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb212-16" title="16"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb212-17" title="17">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb212-18" title="18">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-19" title="19"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb212-20" title="20"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb212-21" title="21">            <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb212-22" title="22">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-23" title="23"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb212-24" title="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb212-25" title="25">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb212-26" title="26">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb212-27" title="27">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb212-28" title="28">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb212-29" title="29">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb212-30" title="30">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb212-31" title="31">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb212-32" title="32"><span class="st">  </span><span class="co"># This changes the size of x axis labels for the facet </span></a>
<a class="sourceLine" id="cb212-33" title="33"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Differences in BMI Over Time and Across Region Type and Gender&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb212-34" title="34"><span class="st">  </span><span class="co"># Add a  plot title</span></a>
<a class="sourceLine" id="cb212-35" title="35"><span class="st">        </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-116-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we can see that overall BMI appears to be increasing globally over time. Additionally we can see that this is occurring not just in urban areas, but also in rural areas. The US is consistently above the median in all strata of the data. In general, the female data shows higher BMI values than the male data. The rural USA BMI appears to be higher than the urban BMI for both men and women. Many countries have average BMI estimates above the obesity threshold of 30. Thus it appears that education and outreach programs for weight management should focus on both rural and urban areas and both genders. Education and assistance for women may be especially helpful.</p>
</div>
<div id="differences-in-rate-of-change" class="section level3">
<h3>Differences in rate of change</h3>
<p>How does the rate of change in BMI differ between groups? Which group might especially need attention?</p>
<p>First let’s calculate the differences in BMI from 2017 and 1985 and add this to our BMI_long data object. This will create new variables called <code>Rural_difference,</code> <code>Urban_difference</code>, and <code>National_difference</code>.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">BMI_numeric[[<span class="st">&quot;Rural_difference&quot;</span>]] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb213-2" title="2"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;Rural_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;Rural_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb213-3" title="3"></a>
<a class="sourceLine" id="cb213-4" title="4">BMI_numeric[[<span class="st">&quot;Urban_difference&quot;</span>]] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb213-5" title="5"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;Urban_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;Urban_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb213-6" title="6"></a>
<a class="sourceLine" id="cb213-7" title="7">BMI_numeric[[<span class="st">&quot;National_difference&quot;</span>]] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb213-8" title="8"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;National_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;National_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb213-9" title="9"></a>
<a class="sourceLine" id="cb213-10" title="10">BMI_diff_long &lt;-<span class="st"> </span>BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-11" title="11"><span class="st">  </span><span class="kw">select</span>(Country<span class="op">:</span>National_difference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-12" title="12"><span class="kw">gather</span>(<span class="dt">key =</span> Type, <span class="dt">value =</span> Difference , Rural_difference<span class="op">:</span>National_difference)</a>
<a class="sourceLine" id="cb213-13" title="13"></a>
<a class="sourceLine" id="cb213-14" title="14"></a>
<a class="sourceLine" id="cb213-15" title="15">BMI_diff_long &lt;-<span class="st"> </span>BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-16" title="16"><span class="st">  </span><span class="kw">select</span>(Country<span class="op">:</span><span class="st"> </span>National_difference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-17" title="17"><span class="kw">pivot_longer</span>( <span class="dt">names_to =</span> <span class="st">&quot;Difference&quot;</span> , <span class="dt">cols =</span> Rural_difference<span class="op">:</span>National_difference)</a>
<a class="sourceLine" id="cb213-18" title="18"></a>
<a class="sourceLine" id="cb213-19" title="19"></a>
<a class="sourceLine" id="cb213-20" title="20"></a>
<a class="sourceLine" id="cb213-21" title="21"><span class="kw">head</span>(BMI_diff_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Difference          value
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;
1 Afghanistan Men   Rural_difference     2.8 
2 Afghanistan Men   Urban_difference     1.2 
3 Afghanistan Men   National_difference  2.6 
4 Afghanistan Women Rural_difference     3.5 
5 Afghanistan Women Urban_difference     3.1 
6 Afghanistan Women National_difference  3.80</code></pre>
<p>Let’s replace “United states of America” with “USA” and make a plot with this data to compare the change in BMI:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1">BMI_diff_long[[<span class="st">&quot;Country&quot;</span>]] &lt;-BMI_diff_long[[<span class="st">&quot;Country&quot;</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb215-2" title="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb215-3" title="3"></a>
<a class="sourceLine" id="cb215-4" title="4"></a>
<a class="sourceLine" id="cb215-5" title="5"><span class="kw">ggplot</span>(BMI_diff_long, <span class="kw">aes</span>(<span class="dt">x =</span> Difference, <span class="dt">y =</span> value, <span class="dt">col =</span> Difference)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Difference)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-7" title="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb215-8" title="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long), </a>
<a class="sourceLine" id="cb215-9" title="9">              <span class="kw">aes</span>(<span class="dt">x =</span>Difference, <span class="dt">y =</span>value), </a>
<a class="sourceLine" id="cb215-10" title="10">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-11" title="11"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb215-12" title="12"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb215-13" title="13"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb215-14" title="14"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb215-15" title="15">              <span class="kw">aes</span>(<span class="dt">x =</span> Difference, <span class="dt">y =</span> value), </a>
<a class="sourceLine" id="cb215-16" title="16">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-17" title="17"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb215-18" title="18"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb215-19" title="19">            <span class="kw">aes</span>(<span class="dt">x =</span>Difference, <span class="dt">y =</span> value, <span class="dt">label =</span> Country), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-20" title="20"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb215-21" title="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb215-22" title="22">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb215-23" title="23">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb215-24" title="24">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb215-25" title="25">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb215-26" title="26">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>), </a>
<a class="sourceLine" id="cb215-27" title="27">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>), </a>
<a class="sourceLine" id="cb215-28" title="28">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb215-29" title="29"><span class="st">        </span><span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb215-30" title="30"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Change in BMI Over Time and Across Region Type and Gender&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-118-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" title="1">        <span class="co"># Add a plot title  </span></a></code></pre></div>
<p>We can now see that the rate of change from 1985 to 2017 appears to be larger in the women compared to the men in all regions. The group with the largest increase in the USA is the women living in rural areas.</p>
<p>Let’s check the difference with some statistical tests:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1"><span class="co">#first lets look at the normality of the difference in BMI</span></a>
<a class="sourceLine" id="cb217-2" title="2">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb217-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb217-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb217-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Difference)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-119-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" title="1"><span class="co"># interesting...the spread of difference is much broader for women than for men </span></a>
<a class="sourceLine" id="cb218-2" title="2"><span class="co"># some women in some countries especially need help with obesity</span></a>
<a class="sourceLine" id="cb218-3" title="3"><span class="co"># while other countries are actually showing a loss of BMI</span></a>
<a class="sourceLine" id="cb218-4" title="4"><span class="co"># these countries are the points on our previous plot with a difference below 0</span></a>
<a class="sourceLine" id="cb218-5" title="5"></a>
<a class="sourceLine" id="cb218-6" title="6"><span class="co">#Let&#39;s see who:</span></a>
<a class="sourceLine" id="cb218-7" title="7">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-8" title="8"><span class="st">  </span><span class="kw">arrange</span>(value)</a></code></pre></div>
<pre><code># A tibble: 1,200 x 4
   Country        Sex   Difference           value
   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;
 1 Greece         Women Rural_difference    -1.5  
 2 Greece         Women National_difference -1.3  
 3 Greece         Women Urban_difference    -1.20 
 4 Italy          Women Rural_difference    -1.10 
 5 Czech Republic Women Rural_difference    -0.8  
 6 Spain          Women Rural_difference    -0.800
 7 Lithuania      Women Urban_difference    -0.700
 8 Lithuania      Women National_difference -0.700
 9 Spain          Women Urban_difference    -0.700
10 Spain          Women National_difference -0.700
# … with 1,190 more rows</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="co"># In general, people appear to have lost weight in Greece</span></a>
<a class="sourceLine" id="cb220-2" title="2"></a>
<a class="sourceLine" id="cb220-3" title="3"><span class="co"># Let&#39;s look at Q-Q plots:</span></a>
<a class="sourceLine" id="cb220-4" title="4">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb220-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb220-6" title="6"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb220-7" title="7"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb220-8" title="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Difference)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-119-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1"><span class="co"># ok so some of the data for Men looks fairly normal but not as much for Women</span></a>
<a class="sourceLine" id="cb221-2" title="2"></a>
<a class="sourceLine" id="cb221-3" title="3"><span class="co"># Now we will check the variance</span></a>
<a class="sourceLine" id="cb221-4" title="4"></a>
<a class="sourceLine" id="cb221-5" title="5"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb221-6" title="6">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb221-7" title="7">                      Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb221-8" title="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb221-9" title="9">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb221-10" title="10">                      Difference <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), value))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Urban_difference&quot;),     value) and     value)
Z = 3.5379, p-value = 0.0004033
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb223-2" title="2"></a>
<a class="sourceLine" id="cb223-3" title="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb223-4" title="4">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb223-5" title="5">                      Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb223-6" title="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb223-7" title="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb223-8" title="8">                      Difference <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), value))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Urban_difference&quot;),     value) and     value)
Z = 0.59121, p-value = 0.5544
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="co">#fail to reject the null the null - conclude that variance is equal</span></a>
<a class="sourceLine" id="cb225-2" title="2"></a>
<a class="sourceLine" id="cb225-3" title="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb225-4" title="4">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb225-5" title="5">                      Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb225-6" title="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb225-7" title="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb225-8" title="8">                      Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Rural_difference&quot;),     value) and     value)
Z = 10.843, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb227-2" title="2"></a>
<a class="sourceLine" id="cb227-3" title="3"></a>
<a class="sourceLine" id="cb227-4" title="4"><span class="co"># let&#39;s compare the groups</span></a>
<a class="sourceLine" id="cb227-5" title="5"><span class="co"># this is again still paired data</span></a>
<a class="sourceLine" id="cb227-6" title="6"><span class="co"># this is because each value of &quot;Rural_difference&quot; and &quot;Urban_difference&quot; correspond to the same country</span></a>
<a class="sourceLine" id="cb227-7" title="7"></a>
<a class="sourceLine" id="cb227-8" title="8"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb227-9" title="9">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb227-10" title="10">                    Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb227-11" title="11">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb227-12" title="12">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb227-13" title="13">                    Difference <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), value),</a>
<a class="sourceLine" id="cb227-14" title="14">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Urban_difference&quot;),     value) and     value)
D = 0.16534, p-value = 0.009043
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb229-2" title="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>,</a>
<a class="sourceLine" id="cb229-3" title="3">                    Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb229-4" title="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb229-5" title="5">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb229-6" title="6">                    Difference <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), value),</a>
<a class="sourceLine" id="cb229-7" title="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Urban_difference&quot;),     value) and     value)
D = 0.14586, p-value = 0.02995
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb231-2" title="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb231-3" title="3">                    Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value), </a>
<a class="sourceLine" id="cb231-4" title="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb231-5" title="5">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb231-6" title="6">                    Difference <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), value),</a>
<a class="sourceLine" id="cb231-7" title="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Difference == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Difference == &quot;Rural_difference&quot;),     value) and     value)
D = 0.35204, p-value = 5.645e-11
alternative hypothesis: two-sided</code></pre>
<p>Now we have performed seven comparisons (4 earlier) so we should apply our multiple testing correction</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">7</span></a></code></pre></div>
<pre><code>[1] 0.007142857</code></pre>
<p>We see that there is a significant difference in the change in BMI Rural communities between men and women. This change is larger for women.</p>
<p>Importantly- we noticed that it appears to be specific countries where BMI shows a particular increase especially for women. Which countries are those? how does that compare with the US? Clearly the US is among the countries with the highest differences.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Difference          value
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;
1 USA     Men   Rural_difference     3.10
2 USA     Men   Urban_difference     3.1 
3 USA     Men   National_difference  3.10
4 USA     Women Rural_difference     3.5 
5 USA     Women Urban_difference     3.40
6 USA     Women National_difference  3.4 </code></pre>
<p>In the US, focus should be placed on <b> both urban and rural </b> women to improve this public health issue.</p>
<p>Here we can see the countries have the largest differences in BMI from 1985-2017:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb237-2" title="2"><span class="st">  </span><span class="kw">filter</span>(value<span class="op">&gt;</span><span class="fl">4.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb237-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>value)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Difference          value
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;
1 Egypt       Women Rural_difference     5.9 
2 Honduras    Women National_difference  5.60
3 Honduras    Women Rural_difference     5.5 
4 Egypt       Women National_difference  5.10
5 Saint Lucia Women Rural_difference     5   
6 Honduras    Women Urban_difference     4.9 </code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1"><span class="co">#here we sorted by the highest to lowest values of BMI Difference</span></a></code></pre></div>
<p>However it is important to see what the mean BMI values were for these countries in 2017. It could be that the average was underweight in 1985… let’s take a look.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, value<span class="op">&gt;</span><span class="fl">4.9</span>), Country), </a>
<a class="sourceLine" id="cb240-3" title="3">                    Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, value<span class="op">&gt;</span><span class="fl">4.9</span>), Sex),</a>
<a class="sourceLine" id="cb240-4" title="4">                    Year <span class="op">==</span><span class="st">&quot;2017&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb240-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>BMI)</a></code></pre></div>
<pre><code># A tibble: 9 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Egypt       Women Urban    2017   32.3
2 Egypt       Women National 2017   31.7
3 Egypt       Women Rural    2017   31.3
4 Saint Lucia Women National 2017   30.5
5 Saint Lucia Women Rural    2017   30.5
6 Saint Lucia Women Urban    2017   30.5
7 Honduras    Women Urban    2017   28.3
8 Honduras    Women National 2017   27.7
9 Honduras    Women Rural    2017   26.9</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="co">#Here is the data just for the changes in BMI in Egypt</span></a>
<a class="sourceLine" id="cb242-2" title="2"><span class="kw">filter</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;Egypt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>value)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Difference          value
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt;
1 Egypt   Women Rural_difference     5.9 
2 Egypt   Women National_difference  5.10
3 Egypt   Women Urban_difference     4.20
4 Egypt   Men   Urban_difference     2.60
5 Egypt   Men   Rural_difference     2.5 
6 Egypt   Men   National_difference  2.5 </code></pre>
<p>Thus rural women in Egypt had the greatest increase in BMI from 1985 to 2017 in this data (5.9) and the average BMI is now over the obesity threshold of 30.</p>
<p>The data suggests that rural women in Egypt and other countries may especially benefit from dietary resources and our interventions and programs to assist with weight management.</p>
<p>Now let’s make a plot that summarizes our findings. To do this we will simplify the other plots we made and then combine them together.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="co"># simplified national means plot</span></a>
<a class="sourceLine" id="cb244-2" title="2">Means_plot&lt;-BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-4" title="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb244-5" title="5">         Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-6" title="6"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-7" title="7"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-8" title="8"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-9" title="9"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Year) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-10" title="10"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-11" title="11"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-12" title="12"><span class="st">                </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-13" title="13">                       Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb244-14" title="14">                       Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>),</a>
<a class="sourceLine" id="cb244-15" title="15">                <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb244-16" title="16">                <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb244-17" title="17">                <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-18" title="18"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-19" title="19"><span class="st">                            </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-20" title="20">                                   Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb244-21" title="21">                                   Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb244-22" title="22">                                   Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb244-23" title="23">                             <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb244-24" title="24">                             <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb244-25" title="25">                             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-26" title="26"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb244-27" title="27"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-28" title="28"><span class="st">                          </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-29" title="29">                                 Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb244-30" title="30">                                 Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)),</a>
<a class="sourceLine" id="cb244-31" title="31">                          <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb244-32" title="32">                          <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-33" title="33"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb244-34" title="34"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb244-35" title="35"><span class="st">  </span><span class="co"># This will make thebackground of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb244-36" title="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb244-37" title="37">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb244-38" title="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb244-39" title="39">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb244-40" title="40">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb244-41" title="41">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb244-42" title="42">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb244-43" title="43">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb244-44" title="44">   </a>
<a class="sourceLine" id="cb244-45" title="45"><span class="co">#Simplified difference plot </span></a>
<a class="sourceLine" id="cb244-46" title="46">BMI_diff_long[[<span class="st">&quot;Difference&quot;</span>]] &lt;-BMI_diff_long[[<span class="st">&quot;Difference&quot;</span>]]<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-47" title="47"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;_difference&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb244-48" title="48"></a>
<a class="sourceLine" id="cb244-49" title="49">Diff_plot&lt;-BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-50" title="50"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-51" title="51">         Difference <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-52" title="52"><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Difference, <span class="dt">y =</span> value, <span class="dt">col =</span> Difference)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-53" title="53"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-54" title="54"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-55" title="55"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-56" title="56"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-57" title="57"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-58" title="58">           Difference <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb244-59" title="59">    <span class="kw">aes</span>(<span class="dt">x =</span>Difference, <span class="dt">y =</span> value), </a>
<a class="sourceLine" id="cb244-60" title="60">    <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb244-61" title="61">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-62" title="62"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-63" title="63"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb244-64" title="64">           Difference <span class="op">!=</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb244-65" title="65">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb244-66" title="66">    <span class="kw">aes</span>(<span class="dt">x =</span> Difference, <span class="dt">y =</span> value), </a>
<a class="sourceLine" id="cb244-67" title="67">    <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb244-68" title="68">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-69" title="69"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb244-70" title="70"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-71" title="71"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>),</a>
<a class="sourceLine" id="cb244-72" title="72">           Difference <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb244-73" title="73">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>),</a>
<a class="sourceLine" id="cb244-74" title="74">    <span class="kw">aes</span>(<span class="dt">x =</span> Difference, <span class="dt">y =</span> value,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb244-75" title="75">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-76" title="76"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb244-77" title="77"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb244-78" title="78"><span class="st">    </span><span class="co"># This will make the background of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb244-79" title="79"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb244-80" title="80">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb244-81" title="81">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb244-82" title="82">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb244-83" title="83">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb244-84" title="84">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb244-85" title="85">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb244-86" title="86">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb244-87" title="87">  <span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb244-88" title="88"></a>
<a class="sourceLine" id="cb244-89" title="89"><span class="co">#add labels</span></a>
<a class="sourceLine" id="cb244-90" title="90">Diff_plot&lt;-Diff_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-91" title="91"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Change in BMI by region&quot;</span>, </a>
<a class="sourceLine" id="cb244-92" title="92">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb244-93" title="93">             <span class="dt">y =</span> <span class="st">&quot;Change in BMI </span><span class="ch">\n</span><span class="st"> (1985 to 2017)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-94" title="94"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb244-95" title="95"></a>
<a class="sourceLine" id="cb244-96" title="96">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-97" title="97"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mean National BMI over time&quot;</span>, </a>
<a class="sourceLine" id="cb244-98" title="98">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb244-99" title="99">             <span class="dt">y =</span> <span class="st">&quot;Mean BMI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-100" title="100"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb244-101" title="101"></a>
<a class="sourceLine" id="cb244-102" title="102"></a>
<a class="sourceLine" id="cb244-103" title="103"></a>
<a class="sourceLine" id="cb244-104" title="104">obesity_text&lt;-<span class="kw">tibble</span>(<span class="dt">Year=</span><span class="kw">c</span>(<span class="dv">1985</span>),<span class="dt">BMI=</span><span class="kw">c</span>(<span class="dv">31</span>),<span class="dt">Sex=</span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>),<span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;Obesity&quot;</span>))</a>
<a class="sourceLine" id="cb244-105" title="105"></a>
<a class="sourceLine" id="cb244-106" title="106">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb244-107" title="107"><span class="st">             </span><span class="kw">geom_text</span>(<span class="dt">data =</span> obesity_text,</a>
<a class="sourceLine" id="cb244-108" title="108">                       <span class="dt">label=</span><span class="kw">pull</span>(obesity_text,label), </a>
<a class="sourceLine" id="cb244-109" title="109">                       <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb244-110" title="110">                       <span class="kw">aes</span>( <span class="dt">fontface =</span><span class="st">&quot;bold.italic&quot;</span>, <span class="dt">size =</span> <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb244-111" title="111"></a>
<a class="sourceLine" id="cb244-112" title="112">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(Means_plot, Diff_plot, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-124-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We could make a similar plot with the <code>patchwork</code> package:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1">Means_plot <span class="op">+</span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;A&#39;</span>) <span class="op">+</span><span class="st"> </span>Diff_plot<span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;B&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb245-2" title="2"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&#39;collect&#39;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-125-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great, now we have put two plots together using the <code>plot_grid()</code> function of the <code>cowplot</code> package. This way we can clearly communicate two messages. The first being that BMI has increased over time globally and that many countries including the United States of America are approaching a mean BMI that is above the obesity threshold of 30. We can also see that women on average have larger BMI values than males, but that both genders show increased levels over time. In the second plot we can see that the increase in BMI is not just happening in urban communities, but in both rural and urban communities and particularly in women.</p>
<p>Our plot visually explores all of our main questions: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
<p>Now let’s save our plot as a png file using the <code>png()</code> function:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1"><span class="kw">png</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;main_plot.png&quot;</span>), <span class="dt">height =</span> <span class="dv">1500</span>, <span class="dt">width =</span> <span class="dv">2000</span>, <span class="dt">res =</span> <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb246-2" title="2">Means_plot <span class="op">+</span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;A&#39;</span>) <span class="op">+</span><span class="st"> </span>Diff_plot<span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;B&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb246-3" title="3"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&#39;collect&#39;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb246-4" title="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>quartz_off_screen 
                2 </code></pre>
<p>You might think that these two plots look a bit odd together, that if you look at the change in the boxplots in part A, that the data for Men shows a bigger change, however, we can’t tell from this plot how the individual countries are changing. Part B of the figure looks at the specific change for each country.</p>
<p>We could check our plot using the following code:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb248-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Sex, Difference) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb248-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(value))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb248-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb248-5" title="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value), <span class="dt">median =</span> <span class="kw">median</span>(value))</a></code></pre></div>
<pre><code># A tibble: 6 x 4
# Groups:   Sex [2]
  Sex   Difference  mean median
  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1 Men   National    3.10   3.10
2 Men   Rural       3.10   3.10
3 Men   Urban       3.1    3.1 
4 Women National    3.4    3.4 
5 Women Rural       3.5    3.5 
6 Women Urban       3.40   3.40</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb250-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Sex, Difference) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb250-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(value))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb250-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value), <span class="dt">median =</span> <span class="kw">median</span>(value))</a></code></pre></div>
<pre><code># A tibble: 6 x 4
# Groups:   Sex [2]
  Sex   Difference  mean median
  &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1 Men   National    2.26   2.2 
2 Men   Rural       2.23   2.30
3 Men   Urban       2.05   2.10
4 Women National    2.37   2.70
5 Women Rural       2.38   2.5 
6 Women Urban       2.21   2.60</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb252-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Sex, Year, Region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb252-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(BMI))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb252-4" title="4"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb252-5" title="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(BMI), <span class="dt">median =</span> <span class="kw">median</span>(BMI))</a></code></pre></div>
<pre><code># A tibble: 12 x 5
# Groups:   Sex, Year [4]
   Sex   Year  Region    mean median
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 Men   1985  National  25.8   25.8
 2 Men   1985  Rural     26.1   26.1
 3 Men   1985  Urban     25.7   25.7
 4 Men   2017  National  28.9   28.9
 5 Men   2017  Rural     29.2   29.2
 6 Men   2017  Urban     28.8   28.8
 7 Women 1985  National  25.7   25.7
 8 Women 1985  Rural     26     26  
 9 Women 1985  Urban     25.6   25.6
10 Women 2017  National  29.1   29.1
11 Women 2017  Rural     29.5   29.5
12 Women 2017  Urban     29     29  </code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb254-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Sex, Year, Region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb254-3" title="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(BMI))<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb254-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(BMI), <span class="dt">median =</span> <span class="kw">median</span>(BMI))</a></code></pre></div>
<pre><code># A tibble: 12 x 5
# Groups:   Sex, Year [4]
   Sex   Year  Region    mean median
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 Men   1985  National  23.4   23.6
 2 Men   1985  Rural     23.0   23.2
 3 Men   1985  Urban     23.8   24.1
 4 Men   2017  National  25.6   26.2
 5 Men   2017  Rural     25.2   25.8
 6 Men   2017  Urban     25.9   26.3
 7 Women 1985  National  24.0   24.2
 8 Women 1985  Rural     23.6   23.9
 9 Women 1985  Urban     24.6   24.6
10 Women 2017  National  26.4   26.1
11 Women 2017  Rural     26.0   26.2
12 Women 2017  Urban     26.8   26.4</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1">BMI_numeric <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb256-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(Sex)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb256-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Nat_mean1985 =</span> <span class="kw">mean</span>(National_BMI_<span class="dv">1985</span>), <span class="dt">Nat_mean2017 =</span> <span class="kw">mean</span>(National_BMI_<span class="dv">2017</span>))</a></code></pre></div>
<pre><code># A tibble: 2 x 3
  Sex   Nat_mean1985 Nat_mean2017
  &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 Men           23.4         25.6
2 Women         24.0         26.4</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1">BMI_numeric <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb258-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(Sex)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb258-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Nat_med1985 =</span> <span class="kw">median</span>(National_BMI_<span class="dv">1985</span>), <span class="dt">Nat_med2017 =</span> <span class="kw">median</span>(National_BMI_<span class="dv">2017</span>))</a></code></pre></div>
<pre><code># A tibble: 2 x 3
  Sex   Nat_med1985 Nat_med2017
  &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;
1 Men          23.6        26.2
2 Women        24.2        26.1</code></pre>
<p>We can see that the largest changes occur for Women.</p>
<p>Scroll through the output!</p>
<div id="section-18" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb260-2" title="2"><span class="st">  </span><span class="kw">filter</span>(value<span class="op">&gt;</span><span class="fl">3.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb260-3" title="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb260-4" title="4"><span class="st">  </span><span class="co"># this allows us to show the full output</span></a>
<a class="sourceLine" id="cb260-5" title="5"><span class="st">  </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="fl">1e3</span>)</a></code></pre></div>
<pre><code># A tibble: 117 x 4
    Country                          Sex   Difference value
    &lt;chr&gt;                            &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
  1 Egypt                            Women Rural       5.9 
  2 Honduras                         Women National    5.60
  3 Honduras                         Women Rural       5.5 
  4 Egypt                            Women National    5.10
  5 Saint Lucia                      Women Rural       5   
  6 Honduras                         Women Urban       4.9 
  7 El Salvador                      Women Rural       4.8 
  8 Mexico                           Women Rural       4.8 
  9 Uzbekistan                       Women Rural       4.8 
 10 Dominican Republic               Women Rural       4.80
 11 Comoros                          Women Urban       4.70
 12 Nicaragua                        Women Rural       4.70
 13 Saint Lucia                      Women National    4.70
 14 El Salvador                      Women National    4.6 
 15 Haiti                            Women National    4.6 
 16 Kyrgyzstan                       Women Rural       4.60
 17 Costa Rica                       Women Rural       4.5 
 18 Guatemala                        Women Rural       4.5 
 19 Jamaica                          Women Rural       4.5 
 20 Qatar                            Women Rural       4.4 
 21 Bahrain                          Women Rural       4.40
 22 Dominican Republic               Women National    4.40
 23 Guatemala                        Women National    4.40
 24 Malaysia                         Women Rural       4.40
 25 Nicaragua                        Women National    4.40
 26 Uzbekistan                       Women National    4.40
 27 Bangladesh                       Women National    4.3 
 28 Gabon                            Women National    4.3 
 29 Iraq                             Women Rural       4.3 
 30 Mexico                           Women National    4.3 
 31 Saint Kitts and Nevis            Women Rural       4.3 
 32 Belize                           Women Rural       4.20
 33 Comoros                          Women National    4.20
 34 Costa Rica                       Women National    4.20
 35 Kyrgyzstan                       Women National    4.20
 36 Panama                           Women Rural       4.20
 37 Tajikistan                       Women Rural       4.20
 38 Tanzania                         Women Urban       4.20
 39 Egypt                            Women Urban       4.20
 40 Brunei Darussalam                Women Rural       4.1 
 41 Gambia                           Women National    4.1 
 42 Ghana                            Women National    4.1 
 43 Haiti                            Women Rural       4.1 
 44 Nepal                            Women National    4.1 
 45 Bolivia                          Women National    4.10
 46 Chile                            Women Rural       4.10
 47 Grenada                          Women Rural       4.10
 48 Saint Lucia                      Men   Rural       4.10
 49 Samoa                            Women Rural       4.  
 50 Antigua and Barbuda              Women Rural       4   
 51 Bahamas                          Women Rural       4   
 52 Bangladesh                       Women Rural       4   
 53 Bolivia                          Women Rural       4   
 54 Comoros                          Women Rural       4   
 55 Dominica                         Women Rural       4   
 56 Jamaica                          Women National    4   
 57 Malaysia                         Women National    4   
 58 Mexico                           Women Urban       4   
 59 Nicaragua                        Women Urban       4   
 60 Panama                           Women National    4   
 61 Puerto Rico                      Women Rural       4   
 62 Saint Kitts and Nevis            Women National    4   
 63 Saint Lucia                      Men   National    4   
 64 Saint Lucia                      Women Urban       4   
 65 Suriname                         Women Rural       4   
 66 Turkmenistan                     Women Rural       4   
 67 Bhutan                           Women National    3.9 
 68 Gabon                            Women Urban       3.9 
 69 Ghana                            Women Urban       3.9 
 70 Mali                             Women Urban       3.9 
 71 Samoa                            Women Urban       3.9 
 72 El Salvador                      Women Urban       3.90
 73 Georgia                          Women Rural       3.90
 74 Guyana                           Women Rural       3.90
 75 Libya                            Women Rural       3.90
 76 Saint Vincent and the Grenadines Women Rural       3.90
 77 Samoa                            Women National    3.90
 78 Grenada                          Women National    3.8 
 79 Nepal                            Women Rural       3.8 
 80 Pakistan                         Women National    3.8 
 81 Yemen                            Women National    3.8 
 82 Afghanistan                      Women National    3.80
 83 Brunei Darussalam                Women National    3.80
 84 Guatemala                        Women Urban       3.80
 85 Paraguay                         Women Rural       3.80
 86 Tajikistan                       Women National    3.80
 87 Dominica                         Women National    3.7 
 88 Guyana                           Women National    3.7 
 89 Algeria                          Women Rural       3.70
 90 Argentina                        Women Rural       3.70
 91 Belize                           Women National    3.70
 92 Benin                            Women Urban       3.70
 93 Benin                            Women National    3.70
 94 Bolivia                          Women Urban       3.70
 95 Dominican Republic               Women Urban       3.70
 96 Gambia                           Women Urban       3.70
 97 Iraq                             Women National    3.70
 98 Mongolia                         Women Rural       3.70
 99 Occupied Palestinian Territory   Women Rural       3.70
100 Pakistan                         Women Rural       3.70
101 Saint Lucia                      Men   Urban       3.70
102 Saint Vincent and the Grenadines Women National    3.70
103 Syrian Arab Republic             Women Rural       3.70
104 Uzbekistan                       Women Urban       3.70
105 Yemen                            Women Rural       3.70
106 Antigua and Barbuda              Women National    3.6 
107 Costa Rica                       Women Urban       3.6 
108 Liberia                          Women Urban       3.6 
109 Malaysia                         Women Urban       3.6 
110 Mali                             Women National    3.6 
111 Papua New Guinea                 Women Rural       3.6 
112 Togo                             Women Urban       3.6 
113 Turkmenistan                     Women National    3.6 
114 Uruguay                          Women Rural       3.6 
115 Ecuador                          Women Rural       3.60
116 Malawi                           Women Urban       3.60
117 Qatar                            Women National    3.60</code></pre>
</div>
<div id="section-19" class="section level4">
<h4></h4>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have evaluated BMI average estimates from 200 different countries around the world. To do so we imported data from a pdf using the <code>pdftools</code> package. We used <code>tidyverse</code> packages such as <code>dplyr</code>, <code>stringr</code>, and <code>tidy</code> to clean the data and get it in a workable format. Our statistical analysis focused on evaluating differences in BMI in females around the world across time and between rural and urban areas. We found a significant difference both between years and between the type of community among women globally using <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test" target="_blank"><span class="math inline">\(t\)</span>-tests</a> and <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960" target="_blank">nonparametric</a> tests. Thus BMI has increased in women since 1985. Although BMI estimates are significantly higher in Urban areas compared to rural areas, BMI estimates have increased in both regions. We learned that there are assumptions and considerations to keep in mind when performing tests that compare two groups.</p>
<p><u> We learned that the <span class="math inline">\(t\)</span>-test relies on:</u></p>
<ol style="list-style-type: decimal">
<li>normality of the data for both groups (this is not as much of an issue if the number of observations is relatively large total n&gt;30)</li>
<li>equal variance between the two groups (make sure you do the correct test if the data is not normal)</li>
<li>independent observations (or independent paired observations)</li>
</ol>
<p>We learned that we can evaluate if our data is <a href="https://www.physiology.org/doi/full/10.1152/advan.00064.2017" target="_blank">normally distributed</a> by plotting the distribution and by creating Q-Q plots.</p>
<p><u>We learned that if our data is not normally distributed, we can consider these options:</u></p>
<ol style="list-style-type: decimal">
<li>We can still perform a <span class="math inline">\(t\)</span>-test if our n is large</li>
<li>We can transform the data before performing a <span class="math inline">\(t\)</span>-test</li>
<li>We can use a nonparametric test (Wilcoxon signed rank test, the Wilcoxon rank sum test, and the Two-sample Kolmogorov-Smirnov (KS) test)</li>
<li>We can perform a <span class="math inline">\(t\)</span>-test with resampling methods for violations of normality (which should be especially considered when the groups are imbalanced)</li>
</ol>
<p>We learned that if our groups do not have equal variance, that we need to use a modified <span class="math inline">\(t\)</span>-test to account for this or the correct nonparametric test that does not rely on this assumption (Two-sample Kolmogorov-Smirnov test).</p>
<p>Finally its also important to remember that when we have <a href="https://www.statisticshowto.datasciencecentral.com/paired-data/" target="_blank">paired data</a> and intend to compare means, we should perform a paired test (<a href="https://stattrek.com/hypothesis-test/paired-means.aspx#example1" target="_blank">paired <span class="math inline">\(t\)</span>-test</a>, Wilcoxon signed rank test, or paired KS test). Our data used in this case study was paired because observations were taken for the same countries for different categories of populations - thus, we wanted to compare these populations within the same country (male vs female, rural vs urban etc.). Other examples would be in a case-control study (if samples are matched for various demographics) or a study with repeated measures (for example, symptom measures from the same individual before and after a treatment).</p>
<p>Using the <code>ggplot2</code> package we were able to visualize trends in the data. Importantly, the largest increase appears to be in the rural areas particularly for women. We were also able to identify how the US compared to other countries and which countries showed the largest increase in BMI over time. Analyses like this are important for defining which groups could benefit the most from interventions, education, and policy changes when attempting to mitigate public health challenges. You can see in the <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf" target="_blank">article</a> that this data came from that many additional considerations would be involved to perform such an analysis.</p>
<div id="suggested-homework" class="section level3">
<h3>Suggested Homework</h3>
<p>Students can evaluate the change in BMI over time using the global data available for each year between 2015 and 2017. The data can be found <a href="http://www.ncdrisc.org/downloads/bmi/NCD_RisC_Lancet_2017_BMI_age_standardised_world.csv" target="_blank">here</a>.</p>
</div>
<div id="helpful-links" class="section level3">
<h3>Helpful Links</h3>
<p><a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html" target="_blank">BMI</a><br />
<a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">Long and Wide Data Formats</a><br />
<a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Distributions</a> <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Normal Distribution</a> <a href="http://onlinestatbook.com/2/glossary/skew.html" target="_blank">Skewed Distributions</a> <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Bimodal Distribution</a> <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">ggplot2</a><br />
<a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html" target="_blank">Q-Q Plots</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">Student <span class="math inline">\(t\)</span>-test</a><br />
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/" target="_blank">Paired Data</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/" target="_blank">Welch’s <span class="math inline">\(t\)</span>-test</a><br />
<a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960">Parametric and Nonparametric Methods</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance" target="_blank">Variance</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/balanced-and-unbalanced-designs/" target="_blank">Balanced Study Design</a><br />
<a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">Independent Observations</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/" target="_blank">Transformation</a><br />
<a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html" target="_blank">Permutation/Resampling Methods</a><br />
<a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/" target="_blank">Central Limit Theorem</a><br />
<a href="https://files.eric.ed.gov/fulltext/ED065559.pdf" target="_blank">Mood’s Two-Sample Scale Test</a><br />
<a href="http://www.biostathandbook.com/wilcoxonsignedrank.html">Wilcoxon Signed Rank Test</a><br />
<a href="http://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/BS704_Nonparametric4.html" target="_blank">Wilcoxon Rank Sum Test</a><br />
<a href="https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/ks2samp.htm" target="_blank">Two-sample Kolmogorov-Smirnov Test</a><br />
<a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html" target="_blank">Type 1 Error</a><br />
<a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8" target="_blank">p-value</a><br />
<a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf" target="_blank">Multiple Testing</a><br />
<a href="http://mathworld.wolfram.com/BonferroniCorrection.html" target="_blank">Bonferroni Method of Multiple Testing Correction</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXM6IEV4cGxvcmluZyBnbG9iYWwgcGF0dGVybnMgb2Ygb2Jlc2l0eSBhY3Jvc3MgcnVyYWwgYW5kIHVyYmFuIHJlZ2lvbnMiCmNzczogc3R5bGUuY3NzCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgc2VsZl9jb250YWluZWQ6IHllcwogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBoaWdobGlnaHQ6IHRhbmdvCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogIHBkZl9kb2N1bWVudDoKICAgIHRvYzogeWVzCiAgd29yZF9kb2N1bWVudDoKICAgIHRvYzogeWVzCi0tLQoKPHN0eWxlPgojVE9DIHsKICBiYWNrZ3JvdW5kOiB1cmwoImh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9pbWcvbG9nby5qcGciKTsKICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47CiAgcGFkZGluZy10b3A6IDI0MHB4ICFpbXBvcnRhbnQ7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKfQo8L3N0eWxlPgoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldChpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFLCBjYWNoZSA9IEZBTFNFLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmFsaWduID0gImNlbnRlciIsIG91dC53aWR0aCA9ICc5MCUnKQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkoa25pdHIpCmBgYAoKIAojIyMjIHsub3V0bGluZSB9CmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJtYWluX3Bsb3QucG5nIikpCmBgYAoKIyMgey5kaXNjbGFpbWVyX2Jsb2NrfQoKKipEaXNjbGFpbWVyKio6IFRoZSBwdXJwb3NlIG9mIHRoZSBbT3BlbiBDYXNlIFN0dWRpZXNdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pbyl7dGFyZ2V0PSJfYmxhbmsifSBwcm9qZWN0IGlzICoqdG8gZGVtb25zdHJhdGUgdGhlIHVzZSBvZiB2YXJpb3VzIGRhdGEgc2NpZW5jZSBtZXRob2RzLCB0b29scywgYW5kIHNvZnR3YXJlIGluIHRoZSBjb250ZXh0IG9mIG1lc3N5LCByZWFsLXdvcmxkIGRhdGEqKi4gQSBnaXZlbiBjYXNlIHN0dWR5IGRvZXMgbm90IGNvdmVyIGFsbCBhc3BlY3RzIG9mIHRoZSByZXNlYXJjaCBwcm9jZXNzLCBpcyBub3QgY2xhaW1pbmcgdG8gYmUgdGhlIG1vc3QgYXBwcm9wcmlhdGUgd2F5IHRvIGFuYWx5emUgYSBnaXZlbiBkYXRhc2V0LCBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGluIHRoZSBjb250ZXh0IG9mIG1ha2luZyBwb2xpY3kgZGVjaXNpb25zIHdpdGhvdXQgZXh0ZXJuYWwgY29uc3VsdGF0aW9uIGZyb20gc2NpZW50aWZpYyBleHBlcnRzLiAKCiMjIE1vdGl2YXRpb24KCkJvZHkgbWFzcyBpbmRleCAoW0JNSV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9oZWFsdGh5d2VpZ2h0L2Fzc2Vzc2luZy9ibWkvYWR1bHRfYm1pL2luZGV4Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0pIGlzIG9mdGVuIHVzZWQgYXMgYSBwcm94eSBmb3IgKiphZGlwb3NpdHkqKiAodGhlIGNvbmRpdGlvbiBvZiBoYXZpbmcgZXhjZXNzIGJvZHkgZmF0KSBhbmQgaXMgbWVhc3VyZWQgYXMgYW4gaW5kaXZpZHVhbCdzIHdlaWdodCBpbiBraWxvZ3JhbXMgKGtnKSBvciBwb3VuZHMgKGxicykgZGl2aWRlZCBieSB0aGUgaW5kaXZpZHVhbCdzIGhlaWdodCBpbiBtZXRlcnMgKCRtXjIkKSBzcXVhcmVkLgoKVGhlcmUgYXJlIGRpZmZlcmVudCBjYXRlZ29yaWVzIG9mIHdlaWdodCBkZWZpbmVkIHVzaW5nIGRpZmZlcmVudCBCTUkgdGhyZXNob2xkcyBhcyBkZWZpbmVkIGJ5IHRoZSBbV29ybGQgSGVhbHRoIE9yZ2FuaXphdGlvbl0oaHR0cDovL3d3dy5ldXJvLndoby5pbnQvZW4vaGVhbHRoLXRvcGljcy9kaXNlYXNlLXByZXZlbnRpb24vbnV0cml0aW9uL2EtaGVhbHRoeS1saWZlc3R5bGUvYm9keS1tYXNzLWluZGV4LWJtaSl7dGFyZ2V0PSJfYmxhbmsifSAoV0hPKSwgdGhlIFtDZW50ZXJzIGZvciBEaXNlYXNlIENvbnRyb2wgYW5kIFByZXZlbnRpb25dKGh0dHBzOi8vd3d3LmNkYy5nb3Yvb2Jlc2l0eS9hZHVsdC9kZWZpbmluZy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LCBhbmQgdGhlIFtOYXRpb25hbCBJbnN0aXR1dGVzIG9mIEhlYWx0aF0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9LiAKRm9yIGV4YW1wbGUsIHRoZXNlIGFyZSB0aGUgY2F0ZWdvcmllcyBkZWZpbmVkIGJ5IHRoZSBXSE86IAoKYGBge3IsIGVjaG89RkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L2Jvb2tzL05CSzUzNTQ1Ni9iaW4vYm1pX1dITy5qcGciKQpgYGAKCiMjIyMjIyBbW3NvdXJjZV0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQks1MzU0NTYvYmluL2JtaV9XSE8uanBnKXt0YXJnZXQ9Il9ibGFuayJ9XQoKVGhlIGZvbGxvd2luZyBjaGFydCBjYW4gaGVscCB5b3UgaWRlbnRpZnkgeW91ciBlc3RpbWF0ZSBvZiBCTUk6CmBgYHtyLCBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygiaHR0cDovL2NvbnRlbnQuZXZlcnlkYXloZWFsdGguY29tL21heW9kaWV0L2ltYWdlcy9CTUktY2hhcnQuanBnIikKYGBgCgojIyMjIyMgW1tzb3VyY2VdKGh0dHA6Ly9kaWV0Lm1heW9jbGluaWMub3JnL2RpZXQvZWF0L3doYXQtaXMteW91ci1ibWk/eGlkPW5sX01heW9DbGluaWNEaWV0XzIwMTYwNDI2KXt0YXJnZXQ9Il9ibGFuayJ9XQoKUHJldmlvdXMgd29yayBoYXMgc2hvd24gaGlnaGVyIEJNSSAoPjMwKSBpcyBhc3NvY2lhdGVkIHdpdGggW2hpZ2hlciByYXRlcyBvZiBhbGwtY2F1c2VzIG9mIG1vcnRhbGl0eV0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9LCBhcyB3ZWxsIGFzIGluY3JlYXNlZCByYXRlcyBvZiB0eXBlIDIgZGlhYmV0ZXMsIGNhbmNlciwgaGVhcnQgZGlzZWFzZSwgYW5kIHN0cm9rZS4gCgpSZWNlbnRseSwgYW4gW2FydGljbGVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg2LTAxOS0xMTcxLXgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHB1Ymxpc2hlZCBpbiBbKk5hdHVyZSpdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20pe3RhcmdldD0iX2JsYW5rIn0gZXZhbHVhdGVkIGFuZCBjb21wYXJlZCB0aGUgQm9keS1NYXNzIEluZGV4IChCTUkpIG9mIHBvcHVsYXRpb25zIGluIHJ1cmFsIGFuZCB1cmJhbiBjb21tdW5pdGllcyBhcm91bmQgdGhlIHdvcmxkOiAKCmBgYHtyLCAgZWNobz1GQUxTRSwgb3V0LndpZHRoPScxMDAlJ30Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInBhcGVyLnBuZyIpKQpgYGAKCiMjIyMgey5yZWZlcmVuY2VfYmxvY2t9Ck5DRCBSaXNrIEZhY3RvciBDb2xsYWJvcmF0aW9uIChOQ0QtUmlzQykuIFJpc2luZyBydXJhbCBib2R5LW1hc3MgaW5kZXggaXMgdGhlIG1haW4gZHJpdmVyIG9mIHRoZSBnbG9iYWwgb2Jlc2l0eSBlcGlkZW1pYyBpbiBhZHVsdHMuICpOYXR1cmUqICoqNTY5KiosIDI2MOKAkzI2NCAoMjAxOSkuIAoKIyMjIwoKVGhlIGFydGljbGUgY2hhbGxlbmdlZCB0aGUgd2lkZWx5LWhlbGQgdmlldyB0aGF0IGluY3JlYXNlZCB1cmJhbml6YXRpb24gd2FzIG9uZSBvZiB0aGUgbWFqb3IgcmVhc29ucyBmb3IgaW5jcmVhc2VkIGdsb2JhbCBvYmVzaXR5IHJhdGVzLiAKVGhpcyB2aWV3IGNhbWUgYWJvdXQgYmVjYXVzZSBtYW55IGNvdW50cmllcyBhcm91bmQgdGhlIHdvcmxkIGhhdmUgc2hvd24gaW5jcmVhc2VkIHVyYmFuaXphdGlvbiBsZXZlbHMgaW4gcGFyYWxsZWwgd2l0aCBpbmNyZWFzZWQgb2Jlc2l0eSByYXRlcy4gCkluIHRoaXMgYXJ0aWNsZSwgaG93ZXZlciwgdGhlIE5DRC1SaXNDIGFyZ3VlZCB0aGF0IHRoaXMgbWlnaHQgbm90IGJlIHRoZSBjYXNlIGFuZCB0aGF0IGluIGZhY3QgZm9yIG1vc3QgcmVnaW9ucyBhcm91bmQgdGhlIHdvcmxkLCBCTUkgbWVhc3VyZW1lbnRzIGFyZSBpbmNyZWFzaW5nIGluIHJ1cmFsIHBvcHVsYXRpb25zIGp1c3QgYXMgbXVjaCwgaWYgbm90IG1vcmUgc28sIHRoYW4gdXJiYW4gcG9wdWxhdGlvbnMuIApGdXJ0aGVybW9yZSwgdGhpcyBzdHVkeSBzdWdnZXN0ZWQgdGhhdCBvYmVzaXR5IGhhcyBwYXJ0aWN1bGFybHkgaW5jcmVhc2VkIGluIGZlbWFsZSBwb3B1bGF0aW9ucyBpbiBydXJhbCByZWdpb25zOiAKCj4gIldlIG5vdGVkIGEgcGVyc2lzdGVudGx5IGhpZ2hlciBydXJhbCBCTUksIGVzcGVjaWFsbHkgZm9yIHdvbWVuLiIKCkluIHRoaXMgY2FzZSBzdHVkeSwgd2Ugd2lsbCBldmFsdWF0ZSB0aGUgZGF0YSByZXBvcnRlZCBpbiB0aGlzIGFydGljbGUgdG8gZXhwbG9yZSByZWdpb25hbCBhbmQgZ2VuZGVyIHNwZWNpZmljIGRpZmZlcmVuY2VzIGluIHRoZSBvYmVzaXR5IHJhdGVzIGFyb3VuZCB0aGUgd29ybGQgaW4gMTk4NSBhbmQgMjAxNy4gCk1vc3QgaW1wb3J0YW50bHkgd2Ugd2lsbCB0ZXN0IGlmIHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBpbiBvYmVzaXR5IHJhdGVzIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIGNvbW11bml0aWVzIGFuZCBpZiB0aGVyZSBoYXMgYmVlbiBhIGNoYW5nZSBpbiBvYmVzaXR5IG92ZXIgdGltZSBmb3IgdGhlc2UgcmVnaW9ucywgcGFydGljdWxhcmx5IGZvciB3b21lbi4gClRvIGRvIHRoaXMgd2Ugd2lsbCB0ZXN0IGlmIHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBhdmVyYWdlIEJNSSBmb3IgZWFjaCBncm91cC4KCldoaWxlIFtnZW5kZXJdKGh0dHBzOi8vd3d3LmdlbmRlcnNwZWN0cnVtLm9yZy9xdWljay1saW5rcy91bmRlcnN0YW5kaW5nLWdlbmRlci8pe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtzZXhdKGh0dHBzOi8vd3d3Lndoby5pbnQvZ2Vub21pY3MvZ2VuZGVyL2VuL2luZGV4MS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGFyZSBub3QgYWN0dWFsbHkgYmluYXJ5LCB0aGUgZGF0YSBwcmVzZW50ZWQgdGhhdCBpcyB1c2VkIGluIHRoaXMgYW5hbHlzaXMgb25seSBjb250YWluIGRhdGEgZm9yIGdyb3VwcyBvZiBpbmRpdmlkdWFscyBkZXNjcmliZWQgYXMgbWVuIG9yIHdvbWVuLiAKCiMjIyBNYWluIFF1ZXN0aW9ucwojIyMjIHsubWFpbl9xdWVzdGlvbl9ibG9ja30KCjxiPjx1PiBPdXIgbWFpbiBxdWVzdGlvbnMgYXJlOiA8L3U+PC9iPgoKMSkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8gSW4gcGFydGljdWxhciwgd2hhdCBkb2VzIHRoaXMgZGlmZmVyZW5jZSBsb29rIGxpa2UgZm9yIHdvbWVuPwoyKSBIb3cgaGF2ZSBCTUkgZXN0aW1hdGVzIGNoYW5nZWQgZnJvbSAxOTg1IHRvIDIwMTc/IEluIHBhcnRpY3VsYXIsIHdoYXQgZG9lcyB0aGlzIGNoYW5nZSBvdmVyIHRpbWUgbG9vayBsaWtlIGZvciB3b21lbj8KMykgSG93IGRvIGRpZmZlcmVudCBjb3VudHJpZXMgdmFyeSBpbiB0ZXJtcyBvZiBlc3RpbWF0ZXMgb2YgQk1JPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCiMjIyMKCiMjIyBMZWFybmluZyBPYmplY3RpdmVzIAoKSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIHdhbGsgeW91IHRocm91Z2ggaW1wb3J0aW5nIGRhdGEgZnJvbSBhIHBkZiwgY2xlYW5pbmcsIHdyYW5nbGluZyBhbmQgdmlzdWFsaXppbmcgdGhlIGRhdGEsIGFuZCA8Yj4gY29tcGFyaW5nIHR3byBncm91cHMgPC9iPi4gIAoKV2Ugd2lsbCB1c2Ugd2VsbC1lc3RhYmxpc2hlZCBhbmQgY29tbW9ubHkgdXNlZCBwYWNrYWdlcywgaW5jbHVkaW5nIGBzdHJpbmdyYCwgYHRpZHlyYCwgYGRwbHlyYCwgYHB1cnJyYCwgYW5kIGBnZ3Bsb3QyYCBmcm9tIHRoZSBbYHRpZHl2ZXJzZWBdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9LiAKU3BlY2lmaWNhbGx5LCB0aGUgdGlkeXZlcnNlIGlzCgo+ICJhbiBvcGluaW9uYXRlZCBjb2xsZWN0aW9uIG9mIFIgcGFja2FnZXMgZGVzaWduZWQgZm9yIGRhdGEgc2NpZW5jZS4gQWxsIHBhY2thZ2VzIHNoYXJlIGFuIHVuZGVybHlpbmcgcGhpbG9zb3BoeSBhbmQgY29tbW9uIEFQSXMiLgoKQW5vdGhlciB3YXkgb2YgcHV0dGluZyBpdCBpcyB0aGF0IGl0J3MgYSBzZXQgb2YgcGFja2FnZXMgdGhhdCBhcmUgdXNlZnVsIHNwZWNpZmljYWxseSBmb3IgZGF0YSBtYW5pcHVsYXRpb24sIGV4cGxvcmF0aW9uIGFuZCB2aXN1YWxpemF0aW9uIHdpdGggYSBjb21tb24gcGhpbG9zb3BoeS4KV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBwYWNrYWdlcyBmcm9tIHRoZSBSIHByb2dyYW1taW5nIGxhbmd1YWdlLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgZWZmaWNpZW50LgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjIwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3RpZHl2ZXJzZS50aWR5dmVyc2Uub3JnL2xvZ28ucG5nIikKYGBgCgpXZSB3aWxsIGJlZ2luIGJ5IGxvYWRpbmcgdGhlIHBhY2thZ2VzIHRoYXQgd2Ugd2lsbCBuZWVkIHdpdGggYSBicmllZiBleHBsYW5hdGlvbjoKCmBgYHtyfQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkocGRmdG9vbHMpCmxpYnJhcnkoc3RyaW5ncikKbGlicmFyeShyZWFkcikKbGlicmFyeShkcGx5cikKbGlicmFyeSh0aWJibGUpCmxpYnJhcnkobWFncml0dHIpCmxpYnJhcnkoZ2x1ZSkKbGlicmFyeShwdXJycikKbGlicmFyeSh0aWR5cikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KGdncmVwZWwpCmxpYnJhcnkoY293cGxvdCkKbGlicmFyeShwYXRjaHdvcmspCmBgYAoKCiBQYWNrYWdlICAgfCBVc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi0tLS0tLS0tLS0gfC0tLS0tLS0tLS0tLS0KW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSl7dGFyZ2V0PSJfYmxhbmsifSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEgd2l0aCByZWxhdGl2ZSBwYXRocwpbcGRmdG9vbHNdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9wZGZ0b29scy9wZGZ0b29scy5wZGYpe3RhcmdldD0iX2JsYW5rIn0gICB8IHRvIHJlYWQgYSB0ZXh0IGZyb20gcGRmIGludG8gUiAgIApbc3RyaW5ncl0oaHR0cHM6Ly9zdHJpbmdyLnRpZHl2ZXJzZS5vcmcvYXJ0aWNsZXMvc3RyaW5nci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgdGV4dCBkYXRhCltyZWFkcl0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgdGV4dCBkYXRhIHdpdGhpbiB0aGUgcGRmIGludG8gaW5kaXZpZHVhbCBsaW5lcyAgCltkcGx5cl0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gYXJyYW5nZS9maWx0ZXIvc2VsZWN0IHN1YnNldHMgb2YgdGhlIGRhdGEgClt0aWJibGVdKGh0dHBzOi8vdGliYmxlLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICB8IHRvIGNyZWF0ZSBkYXRhIG9iamVjdHMgdGhhdCB3ZSBjYW4gbWFuaXB1bGF0ZSB3aXRoIGBkcGx5cmAvYHN0cmluZ3JgL2B0aWR5cmAvYHB1cnJyYApbbWFncml0dHJdKGh0dHBzOi8vbWFncml0dHIudGlkeXZlcnNlLm9yZy9hcnRpY2xlcy9tYWdyaXR0ci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgfCB0byB1c2UgdGhlIGAlPD4lYCBwaXBpbmcgb3BlcmF0b3IKW2dsdWVdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvYmxvZy8yMDE3LzEwL2dsdWUtMS4yLjAvKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IHRvIHBhc3RlIG9yIGNvbWJpbmUgY2hhcmFjdGVyIHN0cmluZ3MgYW5kIGRhdGEgdG9nZXRoZXIKW3B1cnJyXShodHRwczovL3B1cnJyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBwZXJmb3JtIGZ1bmN0aW9ucyBvbiBhbGwgY29sdW1ucyBvZiBhIHRpYmJsZQpbdGlkeXJdKGh0dHBzOi8vdGlkeXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIGNvbnZlcnQgZGF0YSBmcm9tICd3aWRlJyB0byAnbG9uZycgZm9ybWF0CltnZ3Bsb3QyXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pICAgIHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucyB3aXRoIG11bHRpcGxlIGxheWVycwpbZ2dyZXBlbF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgICB8IHRvIGFsbG93IGxhYmVscyBpbiBmaWd1cmVzIG5vdCB0byBvdmVybGFwCltjb3dwbG90XShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvY293cGxvdC92aWduZXR0ZXMvaW50cm9kdWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtwYXRjaHdvcmtdKGh0dHBzOi8vZ2l0aHViLmNvbS90aG9tYXNwODUvcGF0Y2h3b3JrKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gYWxsb3cgcGxvdHMgdG8gYmUgY29tYmluZWQgCgoKX19fCgpUaGUgZmlyc3QgdGltZSB3ZSB1c2UgYSBmdW5jdGlvbiwgd2Ugd2lsbCB1c2UgdGhlIGA6OmAgdG8gaW5kaWNhdGUgd2hpY2ggcGFja2FnZSB3ZSBhcmUgdXNpbmcgKGUuZy4gYHN0cmluZ3I6OnN0cl9kZXRlY3QoKWApLiAKVW5sZXNzIHdlIGhhdmUgb3ZlcmxhcHBpbmcgZnVuY3Rpb24gbmFtZXMsIHRoaXMgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IHdlIHdpbGwgaW5jbHVkZSBpdCBoZXJlIHRvIGJlIGluZm9ybWF0aXZlIGFib3V0IHdoZXJlIHRoZSBmdW5jdGlvbnMgd2Ugd2lsbCB1c2UgY29tZSBmcm9tLgoKIyMjIENvbnRleHQKClRoZSBtZWFzdXJlbWVudCBvZiBCTUkgaGFzIHNvbWUgW2xpbWl0YXRpb25zXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM0ODkwODQxL3BkZi9udC01MC0xMTcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHRoYXQgYXJlIHdlbGwgcmVjb2duaXplZCwgYXMgaXQgZG9lcyBub3QgYWNjb3VudCBmb3IgdGhlIGNvbXBvc2l0aW9uIG9mIGJvZHkgbWFzcywgdGhlIGxvY2F0aW9uIG9mIGJvZHkgZmF0LCBvciB0aGUgY29udHJpYnV0aW9uIG9mIGJvZHkgZnJhbWUgc2l6ZS4gCkhvd2V2ZXIsIFtCTUkgaGFzIGJlZW4gYSB1c2VmdWwgaGVhbHRoIGluZGljYXRvcl0oaHR0cHM6Ly9qb3VybmFscy5sd3cuY29tL2Fjc20taGVhbHRoZml0bmVzcy9GdWxsdGV4dC8yMDE2LzA3MDAwL1RIRV9CRU5FRklUU19PRl9CT0RZX01BU1NfSU5ERVhfQU5EX1dBSVNULjguYXNweCNwZGYtbGluayl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgcmlzayBmb3IgbWFueSBkaXNlYXNlcyBhbmQgY29uZGl0aW9ucyBwYXJ0aWN1bGFybHkgd2hlbiBjb21iaW5lZCB3aXRoIG90aGVyIHJpc2sgZmFjdG9yIGluZm9ybWF0aW9uLgoKIyMgV2hhdCBhcmUgdGhlIGRhdGE/CgpXZSB3aWxsIGJlIHVzaW5nIGRhdGEgbG9jYXRlZCB3aXRoaW4gYSB0YWJsZSBvZiB0aGUgW3N1cHBsZW1lbnRhcnkgbWF0ZXJpYWxdKGh0dHBzOi8vc3RhdGljLWNvbnRlbnQuc3ByaW5nZXIuY29tL2VzbS9hcnQlM0ExMC4xMDM4JTJGczQxNTg2LTAxOS0xMTcxLXgvTWVkaWFPYmplY3RzLzQxNTg2XzIwMTlfMTE3MV9NT0VTTTFfRVNNLnBkZil7dGFyZ2V0PSJfYmxhbmsifSBmb3IgdGhlIE5DRC1SaXNDIHBhcGVyIHJlZmVyZW5jZWQgYWJvdmUuIAoKVGhpcyBpcyBhIHBkZiB0aGF0IGNhbiBiZSBmb3VuZCBmcmVlbHkgYXZhaWxhYmxlIG9ubGluZS4gSGVyZSBpcyBhIHNjcmVlbnNob3Qgb2YgdGhlIGZpcnN0IGZldyByb3dzIG9mIHRoaXMgdGFibGU6IAoKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImZpcnN0X3BhZ2UucG5nIikpCmBgYAoKWW91IGNhbiBzZWUgdGhhdCB0aGUgZGF0YSBjb250YWluIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmb3IgYm90aCBtZW4gYW5kIHdvbWVuIGluIGNvdW50cmllcyBhdCB0aGUgbmF0aW9uYWwgbGV2ZWwsIGFzIHdlbGwgYXMgdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmb3IgdGhlIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcyBvZiB0aGVzZSBjb3VudHJpZXMgaW4gYm90aCAxOTg1IGFuZCAyMDE3LgoKVGhlIGRhdGEgd2l0aGluIHRoZSBwYXJlbnRoZXNlcyBhcmUgdGhlIDk1JSBbY3JlZGlibGUgaW50ZXJ2YWxzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DcmVkaWJsZV9pbnRlcnZhbCl7dGFyZ2V0PSJfYmxhbmsifSAoQ0lzKSBmb3IgdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcy4gVGhlIGF1dGhvcnMgcHJvdmlkZSB0aGVzZSBDSXMgYXMgYSBndWlkZSB0byB1bmRlcnN0YW5kIGhvdyBsaWtlbHkgdGhlIGVzdGltYXRlIGlzIGZvciB0aGUgdHJ1ZSBwb3B1bGF0aW9uIG1lYW4gQk1JLiBBIHdpZGVyIHJhbmdlIHN1Z2dlc3RzIHRoYXQgdGhlIGVzdGltYXRlIGlzIGxlc3MgYWNjdXJhdGUsIGFzIHRoZXJlIGFyZSBtb3JlIHBvc3NpYmxlIHZhbHVlcyBmb3IgdGhlIHRydWUgbWVhbiB3aXRoIGNyZWRpYmxlIGV2aWRlbmNlLiBOb3RpY2UgdGhhdCB0aGUgbWVhbiBCTUkgdmFsdWVzIGFyZSAiYWdlLXN0YW5kYXJkaXNlZCwiIHRoaXMgbWVhbnMgdGhhdCB0aGUgbWVhbiB2YWx1ZXMgd2VyZSBhZGp1c3RlZCBmb3IgdGhlIGRpZmZlcmVudCBhZ2UgZGlzdHJpYnV0aW9ucyBvZiB0aGUgdmFyaW91cyBjb3VudHJpZXMgc28gdGhhdCB0aGUgY291bnRyaWVzIGNhbiBiZSBtb3JlIGZhaXJseSBjb21wYXJlZC4gRm9yIGV4YW1wbGUsIGlmIG9uZSBjb3VudHJ5IGhhcyBhIHBvcHVsYXRpb24gdGhhdCBpcyBjb25zaWRlcmFibHkgeW91bmdlciwgdGhlIG1lYW4gQk1JIG1pZ2h0IGJlIHF1aXRlIGxvdyAoYXMgeW91bmdlciBpbmRpdmlkdWFscyB0ZW5kIHRvIGhhdmUgbG93ZXIgQk1JIHZhbHVlcyBkdWUgdG8gZmFzdGVyIG1ldGFib2xpYyByYXRlcykuIE9uZSBtaWdodCBmYWxzZWx5IGNvbmNsdWRlIHRoYXQgcGVvcGxlIGluIHRoYXQgY291bnRyeSBnZW5lcmFsbHkgaGF2ZSBsb3dlciBCTUkgdmFsdWVzIHRoYW4gcGVvcGxlIGluIG1vc3Qgb3RoZXIgY291bnRyaWVzLCBob3dldmVyIHRoZSBsb3dlciBvdmVyYWxsIEJNSSBtZWFuIG1pZ2h0IHNpbXBseSBiZSBkdWUgdG8gdGhlIGZhY3QgdGhhdCB0aGUgY291bnRyeSBoYXMgYSB5b3VuZ2VyIHBvcHVsYXRpb24gdGhhbiB0aG9zZSBvdGhlciBjb3VudHJpZXMuCgoKIyMgRGF0YSBJbXBvcnQKCkZpcnN0IGxldCdzIGRvd25sb2FkIHRoZSBkYXRhIGZyb20gdGhlIFBERiBmaWxlLiAKV2UgdXNlIGBmaWxlLmV4aXN0cygpYCBmcm9tIGJhc2UgUiB0byBjaGVjayBpZiB0aGUgZmlsZSB3ZSB3YW50IHRvIGRvd25sb2FkIGFscmVhZHkgZXhpc3RzLiAKSWYgbm90LCB0aGVuIHdlIGRvd25sb2FkIGl0IHVzaW5nIHRoZSBmdW5jdGlvbiBgdXRpbHM6OmRvd25sb2FkLmZpbGUoKWAuIFdlIGFsc28gdXNlIHRoZSBgaGVyZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGhlcmVgIHBhY2thZ2UgdG8gbG9vayBzcGVjaWZpY2FsbHkgaW4gdGhlIGBkb2NzYCBkaXJlY3RvcnlgIG9mIHRoZSBkaXJlY3Rvcnkgd2hlcmUgb3VyIG9wZW4gUlN0dWRpbyBwcm9qZWN0IGZpbGUgaXMgbG9jYXRlZC4gVGhpcyBoZWxwcyB1cywgYXMgd2UgZG8gbm90IG5lZWQgdG8gd3JpdGUgdGhlIGZ1bGwgcGF0aCB0byB0aGUgZG9jdW1lbnQuIFRoaXMgbWFrZXMgb3VyIGNvZGUgbW9yZSByZXByb2R1Y2libGUgZm9yIHNvbWVvbmUgZWxzZSwgd2hvIG1heSBoYXZlIGEgZGlmZmVyZW50IG92ZXJhbGwgZmlsZSBzdHJ1Y3R1cmUgb24gdGhlaXIgY29tcHV0ZXIgYnV0IGRvd25sb2FkcyBvdXIgY2FzZSBzdHVkeSBmaWxlcyBmcm9tIEdpdEh1YiBhbmQgdGhlcmVmb3JlIGhhcyB0aGUgc2FtZSBmaWxlIHN0cnVjdHVyZSBzcGVjaWZpY2FsbHkgZm9yIHRoZSBmaWxlcyBpbmNsdWRlZCBpbiBvdXIgR2l0SHViIHJlcG9zaXRvcnkuIFRodXMgb3VyIGNvbW1hbmRzIGFib3V0IGZpbGUgbG9jYXRpb25zIHN0aWxsIHdvcmsgb24gdGhlaXIgbG9jYWwgbWFjaGluZS4KCmBgYHtyfQppZighZmlsZS5leGlzdHMoaGVyZSgiZG9jcyIsICJwYXBlcl9zdXBwbGVtZW50LnBkZiIpKSl7CiAgdXJsIDwtICJodHRwczovL3N0YXRpYy1jb250ZW50LnNwcmluZ2VyLmNvbS9lc20vYXJ0JTNBMTAuMTAzOCUyRnM0MTU4Ni0wMTktMTE3MS14L01lZGlhT2JqZWN0cy80MTU4Nl8yMDE5XzExNzFfTU9FU00xX0VTTS5wZGYiCiAgdXRpbHM6OmRvd25sb2FkLmZpbGUodXJsLCBoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCn0KYGBgCgpOb3cgdGhhdCB3ZSBoYXZlIGRvd25sb2FkZWQgdGhlIFBERiBmaWxlLCB3ZSB3aWxsIHJlYWQgaXQgaW4gdG8gUiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlOgoKYGBge3J9CnBkZl9vYmVzaXR5IDwtIHBkZnRvb2xzOjpwZGZfdGV4dChoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCmBgYAoKCkxldCdzIHRha2UgYSBsb29rIGF0IHRoZSBkYXRhIC0tIHRoZSBgc3VtbWFyeSgpYCBmdW5jdGlvbiBmcm9tIGJhc2UgUiBoZWxwcyB1cyB0byBsb29rIGF0IHRoZSBzdHJ1Y3R1cmUgb2YgUiBvYmplY3RzLgoKYGBge3J9CnN1bW1hcnkocGRmX29iZXNpdHkpCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHdlIGhhdmUgNjMgZWxlbWVudHMgdGhhdCBhcmUgY2hhcmFjdGVyIHN0cmluZ3MuIApZb3UgbWF5IGFsc28gbm90aWNlIHRoYXQgdGhlIG9yaWdpbmFsIFBERiBoYXMgNjMgcGFnZXMuIExldCdzIHRha2UgYSBsb29rIGF0IHNvbWUgb2YgdGhlc2UgZWxlbWVudHMgYW5kIGNvbXBhcmUgdGhlbSB0byB0aGUgcGFnZXMgaW4gdGhlIG9yaWdpbmFsIGRvY3VtZW50LgoKYGBge3J9CnBkZl9vYmVzaXR5WzFdICMgdGhpcyBsb29rcyBsaWtlIHRoZSBmaXJzdCBwYWdlCnBkZl9vYmVzaXR5WzJdICMgdGhpcyBsb29rcyBsaWtlIHRoZSBzZWNvbmQgcGFnZQpgYGAKCmBgYHtyLCBldmFsID0gVFJVRX0Kc3RyKHBkZl9vYmVzaXR5WzUyXSwgbmNoYXIubWF4ID0gMTYwMCkKYGBgClllcywgdGhpcyBsb29rcyBsaWtlIGRhdGEgaW4gYSB0aGUgdGFibGUgd2Ugd2FudC4gCldlIGFyZSB1c2luZyB0aGUgYHN0cigpYCBmdW5jdGlvbiB0byBwcmludCBqdXN0IGEgcG9ydGlvbiBvZiB0aGUgZGF0YS4gVGhlIGBzdHIoKWAgZnVuY3Rpb24gY29tcGFjdGx5IGRpc3BsYXlzIHRoZSBzdHJ1Y3R1cmUgb2YgYXJiaXRyYXJ5IFIgb2JqZWN0cy4gClRoZSBgbmNoYXIubWF4YCBhcmd1bWVudCBsZXQncyB1cyBkZWZpbmUgdGhlIG1heGltYWwgbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gc2hvdy4gCk5vdGUgYHByaW50KHBkZl9vYmVzaXR5WzUyXSlgIHdvdWxkIHNob3cgdGhlIGVudGlyZSBjb250ZW50cyBvZiB0aGUgdGhpcyBwYWdlIG9mIHRoZSB0YWJsZS4gCgpIZXJlIGlzIHRoZSBQREYgdmVyc2lvbiBhZ2FpbjoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwiZmlyc3RfcGFnZS5wbmciKSkKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlIG91dHB1dCBsb29rcyBwcmV0dHkgc2ltaWxhciB0byB0aGUgcGFnZXMgb2YgdGhlIHBkZiwgYnV0IHRoZSBzcGFjaW5nIGlzIGEgYml0IGF3a3dhcmQuIApOb3RlIHRoYXQgdGhlIHdheSB0aGUgZGF0YSBpcyBkaXNwbGF5ZWQgaXMgcGFydGlhbGx5IGluZmx1ZW5jZWQgYnkgdGhlIHdpZHRoIHNldHRpbmcgb2YgdGhlIFJTdHVkaW8gd2luZG93LiAgCgpOb3csIHdlIGFyZSBpbnRlcmVzdGVkIGluIGEgc3VwcGxlbWVudGFyeSBUYWJsZSAzLCB3aGljaCBoYXMgbXVsdGlwbGUgcGFnZXMgYW5kIGluY2x1ZGVzIHRoZSBzYW1lIGhlYWRlciBvbiBlYWNoIHBhZ2UuIApXZSBjYW4gdXNlIHRoYXQgdG8gZGV0ZXJtaW5lIHdoYXQgZWxlbWVudHMgb2Ygb3VyIGBwZGZfb2Jlc2l0eWAgY2hhcmFjdGVyIHN0cmluZ3MgaW5jbHVkZSBvdXIgdGFibGUuIApXZSB3aWxsIHVzZSB0aGUgYHN0cl9kZXRlY3QoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYHN0cmluZ3JgIHBhY2thZ2UgdG8gc2VhcmNoIGZvciB0aGUgZWxlbWVudHMgdGhhdCBjb250YWluIHRleHQgdGhhdCBpcyBjb25zaXN0ZW50bHkgaW4gdGhlIGhlYWRlci4gClRoZSBvdXRwdXQgb2Ygb2YgdGhpcyBmdW5jdGlvbiB3aWxsIHNob3cgd2hpY2ggZWxlbWVudHMgb2YgdGhlIG9iamVjdCAoaW4gdGhpcyBjYXNlIHBhZ2VzIG9mIHRoZSBwZGYpIGluY2x1ZGUgdGhpcyBwYXR0ZXJuIGluZGljYXRlZCBhcyBhIGBUUlVFYCBvciBgRkFMU0VgLgoKYGBge3J9CnN0cmluZ3I6OnN0cl9kZXRlY3QocGF0dGVybiA9ICJBZ2Utc3RhbmRhcmRpc2VkIG1lYW4gQk1JIiwgCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gcGRmX29iZXNpdHkpCmBgYApXZSBub3RlLCB0aGUgIkFnZS1zdGFuZGFyZGlzZWQgbWVhbiBCTUkiIGlzIHBhcnQgb2YgdGhlIGhlYWRlciBpbiB0aGUgdGFibGUgb24gZXZlcnkgcGFnZS4KVGhlIGNvZGUgYWJvdmUgc2hvd3MgdGhlIHBhZ2VzIHRoYXQgY29udGFpbiBvdXIgdGFibGUgb2YgaW50ZXJlc3QgKGFzIGBUUlVFYCB2YWx1ZXMpLgoKTm93IHdlIHdpbGwgZXh0cmFjdCBqdXN0IHRoZSBkYXRhIGZvciB0aGUgdGFibGUgbm93IGFuZCBjYWxsIGl0IGBydXJhbF91cmJhbmAuIApUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBgc3RyX3N1YnNldCgpYCBmdW5jdGlvbiBvZiB0aGUgYHN0cmluZ3JgIHBhY2thZ2UuCgpgYGB7cn0KcnVyYWxfdXJiYW4gPC0gc3RyaW5ncjo6c3RyX3N1YnNldChwYXR0ZXJuID0gIkFnZS1zdGFuZGFyZGlzZWQgbWVhbiBCTUkiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSBwZGZfb2Jlc2l0eSkKCnN1bW1hcnkocnVyYWxfdXJiYW4pIApgYGAKCkhlcmUsIHdlIHNlZSB0aGVyZSBhcmUgMTAgcGFnZXMgd29ydGggb2YgZWxlbWVudHMgaW4gb3VyIGBydXJhbF91cmJhbmAgb2JqZWN0LiAKCkxldCdzIGNoZWNrIHRoZSBmaXJzdCBhbmQgbGFzdCBwYWdlOgoKYGBge3IsIGV2YWw9VFJVRX0Kc3RyKHJ1cmFsX3VyYmFuWzFdLCBuY2hhci5tYXggPSAxNjAwKQpgYGAKVXNpbmcgYFsxXWAgc2hvd3MganVzdCB0aGUgZmlyc3QgcGFnZSBvZiB0aGUgMTAgcGFnZXMgdGhhdCBjb250YWluIHRoZSB0YWJsZS4gCkFsc28sIG5vdGljZSB0aGUgbmV3IGxpbmUgYCJcbiJgIHZhbHVlcyB0aGF0IGluZGljYXRlIG5ldyBsaW5lcy4gCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBldmFsID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImZpcnN0X3BhZ2VfaW5fUi5wbmciKSkKYGBgCgoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwiZmlyc3RfcGFnZS5wbmciKSkKYGBgCgpUaGlzIGxvb2tzIHRoZSBzYW1lIGFzIHRoZSBiZWdpbm5pbmcuLi4gaG93IGFib3V0IHRoZSBlbmQ/CgpgYGB7cn0Kc3RyKHJ1cmFsX3VyYmFuWzEwXSwgbmNoYXIubWF4ID0gMTgwMCkKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFIH0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwibGFzdF9wYWdlLnBuZyIpKQpgYGAKCgpHcmVhdCEgT3VyIGBydXJhbF91cmJhbmAgb2JqZWN0IGxvb2tzIGxpa2UgaXQgY29udGFpbnMgdGhlIGVudGlyZSBTdXBwbGVtZW50YXJ5IDMgdGFibGUsIGFzIGJvdGggdGhlIGJlZ2lubmluZyBhbmQgdGhlIGVuZCBpbmNsdWRlIHRoZSBkYXRhIHdlIGV4cGVjdGVkLgoKIyMgRGF0YSBXcmFuZ2xpbmcKCkF0IHRoaXMgcG9pbnQgd2UgaGF2ZSBsYXJnZSBzdHJpbmdzIG5vdyBmb3IgZWFjaCBwYWdlIG9mIHRoZSB0YWJsZSwgYnV0IHRoaXMgaXMgbm90IHZlcnkgY29udmVuaWVudCB0byB3b3JrIHdpdGguIApOb3csIHdlIHdpbGwgd3JhbmdsZSB0aGUgZGF0YSBpbnRvIGEgbW9yZSB1c2FibGUgZm9ybS4gCklkZWFsbHksIHdlIHdvdWxkIGxpa2Ugb3VyIGRhdGEgdG8gYmUgaW4gc29tZSBzb3J0IG9mIHRhYnVsYXIgZm9ybS4KCiMjIyBTZXBhcmF0ZSB0aGUgZGF0YSBpbnRvIGxpbmVzCgpGaXJzdCwgaXQgd291bGQgYmUgdXNlZnVsIHRvIHNlcGFyYXRlIHRoZSBkYXRhIHRoYXQgaXMgY3VycmVudGx5IGluIDEwIGdpYW50IHN0cmluZyBjaHVua3MgaW50byBpbmRpdmlkdWFsIGxpbmVzIG9yIHJvd3Mgb2YgdGhlIHRhYmxlLiBUbyBkbyB0aGlzIHdlIGNhbiB1c2UgdGhlIGByZWFkX2xpbmVzKClgIGZ1bmN0aW9uIG9mIHRoZSBgcmVhZHJgIHBhY2thZ2Ugd2hpY2ggd2lsbCBzZXBhcmF0ZSB0aGUgbGluZXMgYmFzZWQgb24gdGhlIGAiXG4iYCBuZXcgbGluZSBjaGFyYWN0ZXJzLgpgYGB7cn0Kc3VtbWFyeShydXJhbF91cmJhbikKcnVyYWxfdXJiYW4gPC0gcmVhZHI6OnJlYWRfbGluZXMocnVyYWxfdXJiYW4pCnN1bW1hcnkocnVyYWxfdXJiYW4pIAojIG5vdyB3ZSBoYXZlIDQ2MSBsaW5lcwpgYGAKV2UgY2FuIHNlZSB0aGF0IGVhY2ggc3RyaW5nIGluIHRoZSBgcnVyYWxfdXJiYW5gIG9iamVjdCBpcyBub3cgYSBzaW5nbGUgbGluZSBmcm9tIHRoZSB0YWJsZS4KCkZvciBleGFtcGxlLCBsaW5lIDYgc2hvd3MgdGhlIGRhdGEgZm9yIHdvbWVuIGluIEFmZ2hhbmlzdGFuLgpgYGB7cn0KcnVyYWxfdXJiYW5bNl0gCmBgYAoKCiMjIyBSZW1vdmluZyBleGNlc3Mgd2hpdGUtc3BhY2UKCldlIGFsc28gaGF2ZSBhIGxvdCBvZiB3aGl0ZS1zcGFjZS4gTGV0J3MgZ2V0IHJpZCBvZiB0aGUgZXhjZXNzIHdoaXRlIHNwYWNlcyB1c2luZyBgc3RyX3NxdWlzaCgpYCBhbHNvIGZyb20gdGhlIGBzdHJpbmdyYCBwYWNrYWdlLgoKYGBge3J9CnJ1cmFsX3VyYmFuIDwtIHN0cmluZ3I6OnN0cl9zcXVpc2gocnVyYWxfdXJiYW4pIApoZWFkKHJ1cmFsX3VyYmFuKQpgYGAKCk5vdyBpdCBpcyBtdWNoIGVhc2llciB0byBzZWUgdGhlIGRhdGEuCgpJZiB3ZSBsb29rIGF0IHRoZSBwYXJ0IG9mIG91ciBkYXRhIHRoYXQgY29udGFpbnMgdGhlIGVuZCBvZiB0aGUgZmlyc3QgcGFnZSBvZiB0aGUgdGFibGUgYW5kIHRoZSBzdGFydCBvZiB0aGUgc2Vjb25kIHdlIGNhbiBzZWUgdGhhdCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uIGlzIHJlcGVhdGVkLCBhcyB3ZWxsIGFzIGEgbGluZSB3aXRoIHRoZSBwYWdlIG51bWJlciBhbmQgYW4gZW1wdHkgbGluZSwgYW5kIGEgbGluZSB0aGF0IHNheXMgIjIgMiIuCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyfQpydXJhbF91cmJhbls0NDo1Nl0gIyBzY3JvbGwgdGhyb3VnaCEKYGBgCiMjIyMKCkFsdGhvdWdoIHRoZSBoZWFkZXIgd2FzIG5lY2Vzc2FyeSBvbiBhbGwgb2YgdGhlIHBhZ2VzIG9mIHRoZSBwZGYgdmVyc2lvbiBvZiB0aGUgdGFibGUsIHdlIG9ubHkgbmVlZCB0aGF0IGluZm9ybWF0aW9uIG9uY2UgaW4gb3VyIGRhdGEuCgojIyMgUmVtb3ZpbmcgdW5uZWNlc3NhcnkgcmVwZWF0ZWQgaGVhZGVyIGluZm9ybWF0aW9uCgpTbywgbGV0J3MgcmVtb3ZlIGFsbCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uIGFuZCB0aGUgcGFnZSBudW1iZXIgbGluZXMgZnJvbSB0aGUgYHJ1cmFsX3VyYmFuYCBvYmplY3QsIHRoZW4gd2Ugd2lsbCBtYWtlIGEgc2luZ2xlIGxpbmUgaGVhZGVyIGZvciB0aGUgYmVnaW5uaW5nLgpPbmUgd2F5IHRvIGRvIHRoaXMgaXMgdG8gZmluZCBhbGwgbGluZXMgdGhhdCBpbmNsdWRlIGVpdGhlciAiV29tZW4iIG9yICJNZW4iIGFuZCBvbmx5IGtlZXAgdGhpcyBkYXRhLgoKRmlyc3QsIGxldCdzIHNlZSBob3cgbWFueSBsaW5lcyBpbmNsdWRlICJXb21lbiIgb3IgIk1lbiIuIApXZSBjYW4gZG8gdGhpcyBieSBmaXJzdCBpZGVudGlmeWluZyB0aGUgbGluZXMgdGhhdCBjb250YWluIHRoZXNlIHBhdHRlcm5zIGFuZCB0aGVuIGNoZWNrIHRoZSBsZW5ndGggb2YgdGhlIHJlc3VsdGluZyB2ZWN0b3IgZm9yIHRoZSBsaW5lIG51bWJlcnMgdGhhdCBjb250YWluIHRoZXNlIHBhdHRlcm5zLiAKTm90ZSwgdGhlIGAifCJgIGluZGljYXRlcyB0aGF0IHdlIGFyZSBsb29raW5nIGZvciBlaXRoZXIgIldvbWVuIiBvciAiTWVuIi4KCiMjIyMgey5zY3JvbGxhYmxlIH0KYGBge3J9CiNzY3JvbGwgdGhyb3VnaCB0aGUgb3V0cHV0IQpzdHJpbmdyOjpzdHJfd2hpY2goc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJXb21lbnxNZW4iKQpgYGAKIyMjIwoKYGBge3J9Cmxlbmd0aChzdHJpbmdyOjpzdHJfd2hpY2goc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW58TWVuIikpCgpgYGAKCk5vdGUgdGhhdCBgc3RyX3doaWNoKClgIGlzIGNhc2Ugc2Vuc2l0aXZlLCBzbyBpdCB3b3VsZCBub3Qgd29yayB0byB1c2UgIndvbWVuIiBhcyB0aGUgcGF0dGVybiwgYW5kIHVzaW5nICJtZW4iIHdvdWxkIHJldHVybiB0aGUgbGluZXMgdGhhdCBjb250YWluICJXbyoqbWVuKioiIG9yICJZZSoqbWVuKioiIGV0Yy4gIFRyeSB0aGlzIG91dCB3aXRoIGBwYXR0ZXJuID0gIndvbWVuImAgYW5kIGBwYXR0ZXJuID0gIm1lbiJgIHRvIHNlZSB0aGUgcmVzdWx0IQoKT0ssIHNvIHRoaXMgbG9va3MgY29ycmVjdC4gClRoaXMgaW5jbHVkZXMgbW9zdCBsaW5lcyBidXQgdGhlcmUgYXJlIGdhcHMgd2hlcmUgdGhlIGhlYWRlciBpcyBsb2NhdGVkLiBJdCBsb29rcyBsaWtlIG91dCBvZiB0aGUgb3JpZ2luYWwgNDYxIGxpbmVzLCB0aGVyZSBhcmUgNDAwIGxpbmVzIGluIG91ciB0YWJsZSB0aGF0IGFyZW4ndCBoZWFkZXJzLgoKYGBge3J9CnJ1cmFsX3VyYmFuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW58TWVuIikKYGBgCgpXZSBjYW4gY2hlY2sgb3VyIGRhdGEgbm93IHVzaW5nIGVpdGhlciBgaGVhZCgpYCBmcm9tIGJhc2UgUiBvciBgZ2xpbXBzZSgpYCBmcm9tIHRoZSBgdGliYmxlYCAgYW5kIGBkcGx5cmAgcGFja2FnZS4gKFl1cCwgdGhlIHNhbWUgZnVuY3Rpb24gaXMgYXZhaWxhYmxlIGZyb20gYm90aCBwYWNrYWdlcyEpICBUaGUgYGhlYWQoKWAgZnVuY3Rpb24gc2hvd3MgdXMgdGhlIGZpcnN0IHJvd3Mgb3IgbGluZXMgb2YgdGhlIGRhdGEsIHdoaWxlIHRoZSBgZ2xpbXBzZSgpYCBmdW5jdGlvbiBwcm92aWRlcyB1cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdG90YWwgc2l6ZSBvZiB0aGUgb2JqZWN0IGFuZCBzaG93cyB1cyB0aGUgZmlyc3QgbGluZSBvciByb3cuCgpgYGB7cn0KZHBseXI6OmdsaW1wc2UocnVyYWxfdXJiYW4pCmBgYAoKTm93IG91ciBgcnVyYWxfdXJiYW5gIG9iamVjdCA0MDAgbGluZXMgaW5zdGVhZCBvZiA0NjEsIGxpa2UgaXQgZGlkIGJlZm9yZSB3aGVuIGl0IGNvbnRhaW5lZCB0aGUgcmVkdW5kYW50IGhlYWRlciBpbmZvcm1hdGlvbi4KCmBgYHtyfQpoZWFkKHJ1cmFsX3VyYmFuKQpgYGAKCkdyZWF0ISBTbyBub3cgb3VyIGRhdGEgbG9va3MgbXVjaCBiZXR0ZXIgYnV0IHdlIG5lZWQgdG8gYWRkIGJhY2sgb3VyIGhlYWRlciBhbmQgd2Ugd291bGQgbGlrZSB0aGlzIHRvIG9ubHkgYmUgYSBzaW5nbGUgbGluZSB0byBtYWtlIGl0IGVhc3kgdG8gdHJhbnNmb3JtIG91ciBkYXRhIGludG8gYSB0YWJsZSBvciB0YWJsZS1saWtlIG9iamVjdC4KCkFzIGEgcmVtaW5kZXIsIGhlcmUgaXMgd2hhdCBvdXIgaGVhZGVyIHVzZWQgdG8gbG9vayBsaWtlOgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgIG91dC53aWR0aCA9ICcxMDAlJ30Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwibGFzdF9wYWdlLnBuZyIpKQpgYGAKCldlIHdpbGwgYWRkIGEgbmV3IGhlYWRlciBhZnRlciBmaXJzdCBkZWFsaW5nIHdpdGggc29tZSBhZGRpdGlvbmFsIHNwYWNpbmcgYW5kIG1pc3NpbmcgZGF0YSBpc3N1ZXMuCgojIyMgRGVhbGluZyB3aXRoIHNwYWNpbmcKCkZpcnN0IGxldCdzIHRyeSBzcGxpdHRpbmcgb3VyIGhlYWRlci1sZXNzIGRhdGEgaW50byBjb2x1bW5zIGJhc2VkIG9uIHNwYWNlcyB1c2luZyB0aGUgYHN0cl9zcGxpdCgpYCBmdW5jdGlvbiwgd2hlcmUgd2Ugc3BlY2lmeSB0aGF0IHdlIGFyZSBzcGxpdHRpbmcgdGhlIGRhdGEgYmFzZWQgb24gdGhlIHBhdHRlcm4gb2YgYSBzcGFjZSAodGhlIHNwYWNlIGlzIGluY2x1ZGVkIGluIHF1b3Rlcyk6CgpIZXJlLCB3ZSB3aWxsIHRha2UgYSBsb29rIGF0IGp1c3QgdGhlIGZpcnN0IDEwIGxpbmVzIHVzaW5nIHRoZSBgWzE6MTAsXWAgc3ludGF4OiAKCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyfQojc2Nyb2xsIHRocm91Z2ggdGhlIG91dHB1dCEKc3RyX3NwbGl0KHN0cmluZyA9IHJ1cmFsX3VyYmFuLCAKICAgICAgICAgIHBhdHRlcm4gPSAiICIsIAogICAgICAgICAgc2ltcGxpZnkgPSBUUlVFKVsxOjEwLF0gCmBgYAojIyMjCgpUaGlzIGFsbW9zdCB3b3JrZWQsIGJ1dCB1bmZvcnR1bmF0ZWx5IGNvdW50cnkgbmFtZXMgdGhhdCBoYXZlIHNwYWNlcyB3aWxsIGJlIGEgcHJvYmxlbS4gCkZvciBleGFtcGxlLCB3ZSBjYW4gc2VlIHRoYXQgIkFtZXJpY2FuIFNhbW9hIiBoYXMgYmVlbiBkaXZpZGVkIGludG8gdHdvIGNvbHVtbnMgYW5kIGFsbCBzdWJzZXF1ZW50IGNvbHVtbnMgYXJlIHNoaWZ0ZWQuCgpMZXQncyB0cnkgdGhpcyBhbm90aGVyIHdheS4gIAoKQXMgd2UgY2FuIHNlZSBieSBsb29raW5nIGF0IG91ciBgcnVyYWxfdWJyYW5gIGRhdGEsIHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIGlzIG9ubHkgcHJlc2VudCB3aGVuIHRoZSBzZXggaXMgV29tZW4uIExldCdzIHRyeSB0byBleHRyYWN0IHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIGZyb20gdGhlIHJvd3MgdGhhdCBjb250YWluIGRhdGEgYWJvdXQgV29tZW4uCgpgYGB7cn0KaGVhZChydXJhbF91cmJhbikKYGBgClRvIGRvIHRoaXMsIHdlIHN0YXJ0IGJ5IG5vdGljaW5nIHRoYXQgdGhlIHNleCBhbHdheXMgc3RhcnRzIHdpdGggZWl0aGVyIGEgY2FwaXRhbCAiVyIgaWYgdGhlIHNleCBpcyBmZW1hbGUuIE5vdGUsIHdlIG5lZWQgdG8gdXNlIGEgc3BhY2UgYmVmb3JlIHRoZSAiVyIgb3RoZXJ3aXNlIHdlIHdpbGwgc3BsaXQgc29tZSBvZiB0aGUgY291bnRyeSBuYW1lcyBpZiB0aGUgbmFtZXMgc3RhcnRzIHdpdGggIlciLiAKCkhlcmUsIHdlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGNvbmNlcHQgb2YgcGlwaW5nLCB3aGljaCB1c2VzIHRoZSBgJT4lYCBmcm9tIHRoZSBgbWFncml0dHJgIHBhY2thZ2UsIHdoaWNoIGFsbG93cyB1cyB0byBwaXBlIHRoZSBvdXRwdXQgZnJvbSBvbmUgZnVuY3Rpb24gdG8gdGhlIGlucHV0IGZvciBhbm90aGVyIGZ1bmN0aW9uLgpUaGlzIGlzIHJlYWxseSB1c2VmdWwgd2hlbiB3ZSBoYXZlIG11bHRpcGxlIHN0ZXBzLCB3aGljaCB3ZSB3aWxsIHNob3cgc29vbi4KCkZpcnN0LCB3ZSB3aWxsIHNlbGVjdCBqdXN0IHRoZSBkYXRhIGZvciBXb21lbiBhbmQgTWVuIHNlcGFyYXRlbHk6CgpgYGB7cn0KCldvbWVuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW4iKSAKTWVuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiTWVuIikKCgpoZWFkKFdvbWVuKQpoZWFkKE1lbikKYGBgCgoKQW5kIHRoZW4gc3BsaXQgdGhlIGBXb21lbmAgZGF0YSBiYXNlZCBvbiB0aGUgcGF0dGVybiBgcGF0dGVybiA9ICIgV29tZW4iYCAoTm90ZSB0aGF0IHRoZSBzcGFjZSBiZWZvcmUgdGhlIHdvcmQgIldvbWVuIiBpcyBpbmNsdWRlZCAtIHNvIHRoYXQgaXQgaXMgbm90IHdpdGhpbiB0aGUgY291bnRyeSBkYXRhKS4KSGVyZSB3ZSB0YWtlIG91ciBgV29tZW5gIGRhdGFzZXQgYW5kIHBpcGUgaXQgaW50byB0aGUgZmlyc3QgYXJndW1lbnQgb2YgdGhlIGBzdHJfc3BsaXQoKWAgZnVuY3Rpb24sIHdoZXJlIHRoZW4gd2UgY2FuIHNwbGl0IG9uIHRoZSBwYXR0ZXJuIGAiIFdvbWVuImAuICBXZSB0aGVuIHBpcGUgdGhyb3VnaCB0aGUgYHVubGlzdCgpYCBmdW5jdGlvbiBzbyB0aGF0IHRoZSByZXN1bHRzIGlzIGEgdmVjdG9yIGluc3RlYWQgb2YgYSBsaXN0LiAgV2UgYXNzaWduIHRoaXMgbmV3IHJlc3VsdCB0byB0aGUgYGNvdW50cnlfc3BsaXRgIG9iamVjdC4KCmBgYHtyfQpjb3VudHJ5X3NwbGl0IDwtIAogIFdvbWVuICU+JQogIHN0cmluZ3I6OnN0cl9zcGxpdChwYXR0ZXJuID0gIiBXb21lbiIpICU+JQogIHVubGlzdCgpIAoKaGVhZChjb3VudHJ5X3NwbGl0KQpgYGAKCkhvd2V2ZXIsIHdlIGNhbiBhbHNvIGRvIHRoZSBzYW1lIHRoaW5nIGluIGEgc2luZ2xlIHN0ZXAsIHdoZXJlIHdlIHJlcGxhY2UgdGhlIGBXb21lbmAgZGF0YXNldCB3aXRoIHRoZSBjb2RlIHdlIHVzZWQgdG8gY3JlYXRlIHRoYXQgZGF0YXNldC4gIFNvIGZpcnN0LCB3ZSBzZWxlY3QgdGhlICJXb21lbiIgYW5kIHRoZW4gd2Ugc3BsaXQgdGhlIGRhdGEgYnkgIiBXb21lbiIgdG8gY3JlYXRlIGEgbmV3IGRhdGFzZXQgYWxsIHdpdGhpbiB0aGUgc2FtZSBjaHVuayBvZiBjb2RlLgpgYGB7cn0KY291bnRyeV9zcGxpdCA8LSAKICBzdHJfc3Vic2V0KHN0cmluZyA9IHJ1cmFsX3VyYmFuLAogICAgICAgICAgICAgcGF0dGVybiA9ICJXb21lbiIpICU+JQogIHN0cmluZ3I6OnN0cl9zcGxpdChwYXR0ZXJuPSAiIFdvbWVuIikgJT4lCiAgdW5saXN0KCkKCmhlYWQoY291bnRyeV9zcGxpdCkKYGBgCgpOb3csIHdlIGNhbiBzZWUgdGhhdCBgQ291bnRyeWAgaXMgYWx3YXlzIHRoZSBvZGQgcm93cyBhbmQgdGhlICBCTUkgZGF0YSBmb3IgV29tZW4gaXMgdGhlIGV2ZW4gcm93cy4gCldlIGNhbiBzZWxlY3QgdGhlIG9kZCByb3dzIHVzaW5nIHRoZSA8Yj4gTW9kdWx1cyAoUmVtYWluZGVyIGZyb20gZGl2aXNpb24pIG9wZXJhdG9yPC9iPi4gClRoaXMgb3BlcmF0b3IgbG9va3MgbGlrZSB0aGlzIGAlJWAuIApBbGwgb2RkIHZhbHVlcyBzdWNoIGFzIDMsIDcsIG9yIDE1IHdoZW4gZGl2aWRlZCBieSAyIHdvdWxkIGxlYXZlIGEgcmVtYWluZGVyIG9mIDEuIApXZSB3aWxsIHNlbGVjdCBqdXN0IHRoZXNlIHJvd3MgdXNpbmcgdGhlIGBmaWx0ZXIoKWAgZnVuY3Rpb24gb2YgYGRwbHlyYC4KCmBgYHtyfQpjb3VudHJ5IDwtIAogIHRpYmJsZShjb3VudHJ5X3NwbGl0KSAlPiUgCiAgZHBseXI6OmZpbHRlcihyb3dfbnVtYmVyKCkgJSUgMiA9PSAxKSAKYGBgCgpXZSBjYW4gdGFrZSBhIGxvb2sgdG8gbWFrZSBzdXJlIHRoYXQgYWxsIHRoZSBjb3VudHJ5IG5hbWVzIGxvb2sgYXMgZXhwZWN0ZWQuIFlvdSBjYW4gc2Nyb2xsIHRocm91Z2ggdGhlIGNvdW50cnkgbmFtZXMgaWYgeW91IGhvdmVyIG92ZXIgdGhlIGRhdGEuCgpgYGB7ciwgZXZhbD0gRkFMU0V9CmNvdW50cnkKYGBgCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyLCBlY2hvID0gRkFMU0V9CmFzLmRhdGEuZnJhbWUoY291bnRyeSkKYGBgCiMjIyMKCkxvb2tzIGdvb2QhICBXZSBoYXZlIDIwMCBjb3VudHJpZXMgcmVwcmVzZW50ZWQgaW4gb3VyIGRhdGFzZXQuCgpHcmVhdCEgTm93IHdlIGhhdmUgYSBsaXN0IG9mIHRoZSBjb3VudHJpZXMgdGhhdCBjYW4gYmUgdXNlZCBmb3IgYm90aCB0aGUgbWFsZSBhbmQgZmVtYWxlIGRhdGEuIAoKClJlbWVtYmVyIHRoZSBldmVuIHJvd3MgYXJlIHRoZSByb3dzIHdpdGggdGhlIEJNSSBkYXRhIGZvciB3b21lbi4KVGhlc2Ugcm93IHZhbHVlcyBoYXZlIGEgcmVtYWluZGVyIG9mIDAgd2hlbiBkaXZpZGVkIGJ5IDIuCkxldCdzIHNlbGVjdCB0aGF0IGRhdGEgdG9vLgoKYGBge3J9CldvbWVuX0JNSSA8LSAKICB0aWJibGUoY291bnRyeV9zcGxpdCkgJT4lIAogIGRwbHlyOjpmaWx0ZXIocm93X251bWJlcigpICUlIDIgPT0gMCkKCmhlYWQoV29tZW5fQk1JKQpgYGAKVGhpcyBsb29rcyBzaW1pbGFyIHRvIG91ciBgTWVuYCBkYXRhIChhbHRob3VnaCBzbGlnaHRseSBkaWZmZXJlbnQpOgoKYGBge3J9CmhlYWQoTWVuKQpgYGAKCk5vdGljZSBob3cgdGhlIGRhdGEgaW4gZWFjaCByb3cgaXMgaW4gcXVvdGVzLiBUaGlzIGlzIGJlY2F1c2UgdGhlc2UgYXJlIGNoYXJhY3RlciBzdHJpbmdzLiBXZSBjYW4gY2hlY2sgdGhpcyBieSB1c2luZyB0aGUgYmFzZSBgY2xhc3MoKWAgZnVuY3Rpb24uCgpgYGB7cn0KY2xhc3MoTWVuKQpgYGAKCldoZXJlYXMgdGhlIGBXb21lbl9CTUlgIGRhdGEgaXMgYSB0aWJibGUuCmBgYHtyfQpjbGFzcyhXb21lbl9CTUkpCmBgYAoKTGV0J3MgbWFrZSB0aGUgYE1lbmAgZGF0YSBpbnRvIGEgdGliYmxlIGFzIHdlbGw6CmBgYHtyfQpNZW4gPC0gdGliYmxlKE1lbikKYGBgCgpJdCdzIGFsd2F5cyBhIGdvb2QgaWRlYSB0byBjaGVjayB0aGF0IHlvdXIgZGF0YSBvYmplY3RzIGFyZSB0aGUgc2l6ZSB5b3UgZXhwZWN0IHdoZW4gd3JhbmdsaW5nLiAKV2UgY2FuIGRvIHNvIHdpdGggdGhlIGBkaW0oKWAgZnVuY3Rpb24sIHdoaWNoIHNob3dzIHVzIHRoZSBkaW1lbnNpb25zIG9mIGRhdGEgb2JqZWN0cy4KCmBgYHtyfQpkaW0oV29tZW5fQk1JKQpkaW0oTWVuKQpoZWFkKFdvbWVuX0JNSSkKaGVhZChNZW4pCmBgYApHcmVhdCEgVGhlcmUgYXJlIDIwMCByb3dzIG9mIGNoYXJhY3RlciBzdHJpbmdzIHdpdGggdGhlIEJNSSBkYXRhIGxpa2Ugd2UgZXhwZWN0ZWQgdG8gbWF0Y2ggdGhlIDIwMCBjb3VudHJpZXMgaW4gb3VyIGRhdGEuCgpXZSBkbyBob3dldmVyIG5lZWQgdG8gYWRkIHRoZSB3b3JkIGAiIFdvbWVuImAgYmFjayB0byB0aGUgYFdvbWVuX0JNSWAgZGF0YS4KVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYGdsdWUoKWAgZnVuY3Rpb24gb2YgdGhlIGBnbHVlYCBwYWNrYWdlLiAKCkhlcmUgaXMgYSBzaW1wbGUgZXhhbXBsZSBvZiBob3cgdGhpcyBmdW5jdGlvbiBnbHVlcyB0d28gdGhpbmdzIHRvZ2V0aGVyLgoKYGBge3J9CndoZXJlIDwtInRoZSBtb29uIgoKZ2x1ZTo6Z2x1ZSgidGhlIGNvdyBqdW1wZWQgb3ZlciB7d2hlcmV9IikKCmBgYAoKTm93IGxldCdzIGFkZCAgdGhlIHdvcmQgIldvbWVuIiB0byBlYWNoIHJvdyBvZiB0aGUgYFdvbWVuX0JNSWAgZGF0YSB1c2luZyBgZ2x1ZWAuCgpGaXJzdCBsZXQncyBwdWxsIHRoZSBgY291bnRyeV9zcGxpdGAgZGF0YSBvdXQgYXMgYSB2ZWN0b3IgdG8gbWFrZSB0aGlzIHNpbXBsZXIgd2hlbiB3ZSBgZ2x1ZWAuIFRvIGRvIHRoaXMgd2Ugd2lsbCB1c2UgdGhlIGBwdWxsKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIFRoaXMgZnVuY3Rpb24gd2lsbCBhbGxvdyB1cyB0byBleHRyYWN0IG9yIHB1bGwgb3V0IHRoZSBzaW5nbGUgdmFyaWFibGUgY2FsbGVkIGBjb3VudHJ5X3NwbGl0YCB3aGljaCBjb250YWlucyB0aGUgQk1JIHZhbHVlcyBmb3Igd29tZW4gZnJvbSB3aXRoaW4gdGhlIHRpYmJsZSBjYWxsZWQgYFdvbWVuX0JNSWAgd2hpY2ggd2UganVzdCBjcmVhdGVkIGJ5IGdyYWJiaW5nIG9ubHkgdGhlIGV2ZW4gcm93cyBvZiBvdXIgb3JpZ2luYWwgYGNvdW50cnlfc3BsaXRgIHRpYmJsZS4KClRoZW4sIGxldCdzIHVzZSB0aGUgYGZpcnN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UgdG8gZ2V0IGEgcmVtaW5kZXIgb2Ygd2hhdCBqdXN0IHRoZSBmaXJzdCByb3cgb2YgdGhlIGBjb3VudHJ5X3NwbGl0YCBjb2x1bW4gb2YgdGhlIGBXb21lbl9CTUlgIGRhdGEgbG9va3MgbGlrZS4KCgpgYGB7cn0Kd29tZW5fZGF0YSA8LSBXb21lbl9CTUkgJT4lCiAgcHVsbChjb3VudHJ5X3NwbGl0KQoKZHBseXI6OmZpcnN0KHdvbWVuX2RhdGEpCmBgYAoKTm93IHdlIHdpbGwgcGFzdGUgdGhlIHdvcmQgYCJXb21lbiJgIGluIHRoZSBiZWdpbm5pbmcgb2YgZWFjaCB2YWx1ZSBpbiB0aGUgdmVjdG9yIHVzaW5nIHRoZSBgZ2x1ZSgpYCBmdW5jdGlvbi4KCk5vdGUgdGhhdCB0aGVyZSB3aWxsIGJlIGEgc3BhY2UgaW4gYmV0d2Vlbi4KVGhpcyBpcyBiZWNhdXNlIHRoZSBzcGFjZSBpcyBhbHJlYWR5IGluIGZyb250IG9mIHRoZSBmaXJzdCBCTUkgdmFsdWUuCgpgYGB7cn0KV29tZW4gPC0gZ2x1ZSgiV29tZW57d29tZW5fZGF0YX0iKQpoZWFkKFdvbWVuKQpgYGAKCllvdSBjb3VsZCBhbHNvIGRvIGFsbCBvZiB0aGlzIGluIG9uZSBzdGVwIGJ1dCBpdHMgbGVzcyBvYnZpb3VzIHdoYXQgaXMgaGFwcGVuaW5nLgoKSGVyZSB3ZSBjYW4gcHVsbCB0aGUgYGNvdW50cnlfc3BsaXRgIGRhdGEgb3V0IG9mIHRoZSBgV29tZW5fQk1JYCBvYmplY3QgYW5kIHRoZW4gcGFzdGUgYCJXb21lbiJgIGluIGZyb250IG9mIGVhY2ggc3RyaW5nIGluIG9uZSBjb21tYW5kLgpgYGB7ciwgZXZhbCA9IEZBTFNFfQpXb21lbiA8LSBnbHVlKCJXb21lbntwdWxsKFdvbWVuX0JNSSxjb3VudHJ5X3NwbGl0KX0iKQpgYGAKCgoKSWYgd2UgdHJ5IHNwbGl0dGluZyBvdXIgZGF0YSBieSBzcGFjZSBhZ2Fpbiwgd2lsbCBpdCBoYXZlIHRoZSBleHBlY3RlZCBudW1iZXIgb2YgY29sdW1ucz8gV2hhdCBhYm91dCB0aGUgcm93cyB0aGF0IGNvbnRhaW4gYG5hKmAgdmFsdWVzPwoKTGV0J3MganVzdCB0YWtlIHRoZSBgTWVuYCBkYXRhIHRoYXQgY29udGFpbnMgYG5hKmAgdmFsdWVzLiAKVGhpcyBjb2x1bW4gaXMgY2FsbGVkIGBydXJhbF91cmJhbmAuIAoKYGBge3J9CnVua25vd24gPC0gCiAgTWVuJT4lIAogIGZpbHRlcihzdHJfZGV0ZWN0KHBhdHRlcm4gPSJuYVxcKiIsIAogICAgICAgICAgICAgICAgICAgIHN0cmluZyA9IE1lbikpIAoKaGVhZCh1bmtub3duKQpgYGAKCk5vdyB3ZSBjYW4gdHJ5IHNwbGl0dGluZyBieSBhIHNwYWNlCmBgYHtyfQp0aWJibGU6OmFzX3RpYmJsZShzdHJfc3BsaXQocHVsbCh1bmtub3duLCBNZW4pLCAiICIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGlmeSA9IFRSVUUpKQoKYGBgCgpTbyBjbG9zZSEgTm90aWNlIHRoYXQgdGhlIGAibmEqImAgdmFsdWVzIGhhdmUgc2hpZnRlZCB0aGUgc3Vic2VxdWVudCB2YWx1ZXMgd2l0aGluIHRoZSBjb2x1bW5zIGJlY2F1c2UgdHlwaWNhbGx5IHRoZXJlIGlzIGEgc3BhY2UgYmV0d2VlbiB0aGUgQk1JIGFuZCB0aGUgY3JlZGlibGUgaW50ZXJ2YWxzLgpIZXJlIHdlIGNhbiBzZWUgdGhpcyBkYXRhIGluIG91ciBvcmlnaW5hbCBwZGY6CgpgYGB7ciwgZWNobyA9IEZBTFNFLCBvdXQud2lkdGg9IjEwMCUifQprbml0cjo6aW5jbHVkZV9ncmFwaGljcyhoZXJlOjpoZXJlKCJpbWciLCJtaXNzaW5nX3BkZi5wbmciKSkKYGBgCgoKIyMjIERlYWxpbmcgd2l0aCBOQSB2YWx1ZXMKCldlIG5lZWQgdG8gcmVwbGFjZSBvdXIgYG5hKmAgdmFsdWVzIHdpdGggc29tZXRoaW5nIHRoYXQgaW5jbHVkZXMgYSBzcGFjZSBzbyB0aGF0IHdoZW4gd2Ugc2VwYXJhdGUgb3VyIGRhdGEgYnkgc3BhY2Ugd2Ugd2lsbCBoYXZlIHR3byB2YWx1ZXMgaW5zdGVhZCBvZiBvbmUgd2hlbiB3ZSBoYXZlIGFuIGBuYSpgLiAKVGhlcmVmb3JlLCBgbmEqIG5hKmAgc2hvdWxkIHdvcmsuCgpTbywgaW4gb3JkZXIgdG8gdXNlIHRoZSBmdW5jdGlvbnMgd2l0aGluIHRoZSBgc3RyaW5ncmAgcGFja2FnZSwgb3VyIGBNZW5gIGRhdGEgbmVlZHMgdG8gYmUgb2YgYGNoYXJhY3RlcmAgY2xhc3MsIHNvIGxldCdzIGNoZWNrIHRoYXQgbm93LgoKYGBge3J9CmNsYXNzKHB1bGwoTWVuLCBNZW4pKQpgYGAKVGhlIGAgYXMuY2hhcmFjdGVyKClgIGZ1bmN0aW9uIGFsbG93cyB1cyB0byBjaGFuZ2UgZmFjdG9yIGRhdGEgd2l0aGluIHRvIHRoZSBjaGFyYWN0ZXIgY2xhc3MuICBXZSBjb3VsZCB1c2UgdGhpcyBpZiB3ZSBuZWVkZWQgaXQsIGJ1dCBpdCBsb29rcyBsaWtlIG91ciBkYXRhIGlzIGFscmVhZHkgYGNoYXJhY3RlcmAuCgpXZSBhcmUgYWxzbyBjaGFuZ2luZyB0aGUgc3RydWN0dXJlIHNvIHRoYXQgdGhlIGRhdGEgaXMgbm90IHdpdGhpbiBhIGNvbHVtbiBjYWxsZWQgYE1lbmAuIApgYGB7cn0KaGVhZChNZW4pCk1lbiA8LSBwdWxsKE1lbiwgTWVuKQpoZWFkKE1lbikKYGBgCgpgYGB7cn0KTWVuIDwtIAogIHN0cmluZ3I6OnN0cl9yZXBsYWNlX2FsbChzdHJpbmcgPSBNZW4sIAogICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gIm5hXFwqIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VtZW50ID0gIm5hXFwqIG5hXFwqIikgCgojIFRoZSBcXCBhcmUgbmVjZXNzYXJ5IGJlY2F1c2UgdGhlICogaXMgYSBzcGVjaWFsIGNoYXJhY3RlciAKIyBUaGUgKiB3b3VsZCB0eXBpY2FsbHkgaW5kaWNhdGUgYW55IHBvc3NpYmxlIHZhbHVlLCAKIyBidXQgaGVyZSB3ZSBhY3R1YWxseSB3YW50IGEgIioiIGluc3RlYWQKIyBUaHVzIHRoZSBkb3VibGUgYmFja3NsYXNoIGRvZXMgdGhhdCBmb3IgdXMKIyBIZXJlIHdlIGFyZSByZXBsYWNpbmcgYWxsIG9jY3VyZW5jZXMgb2YgdGhlIG5hKiB2YWx1ZXMgCiModGh1cyBzdHJfcmVwbGFjZV9hbGwgaW5zdGVhZCBvZiBzdHJfcmVwbGFjZSkgd2l0aCBuYSogbmEqLiAKYGBgCgpMZXQncyBjaGVjayB0aGF0IGl0IHdvcmtlZC4uLgpgYGB7cn0KTWVuWzIwOjMwXQpgYGAKCkdyZWF0IQoKTm93IGZvciB0aGUgV29tZW4gZGF0YSBvYmplY3QKYGBge3J9CmNsYXNzKFdvbWVuKQojIHRoZSBmZW1hbGUgZGF0YSBpcyBhbHJlYWR5IGNoYXJhY3RlciB0eXBlCldvbWVuIDwtIAogIHN0cmluZ3I6OnN0cl9yZXBsYWNlX2FsbChzdHJpbmcgPSBXb21lbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAibmFcXCoiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSAibmFcXCogbmFcXCoiKSAKV29tZW5bMjA6MzBdCmBgYAoKR3JlYXQsIG5vdyB3ZSBjYW4gc3BsaXQgb3VyIGRhdGEgYnkgc3BhY2VzLgoKIyMjIFNwbGl0dGluZyB0aGUgZGF0YQoKV2Ugd2lsbCBzcGxpdCBvdXIgZGF0YSBmaW5hbGx5IGJ5IHNwYWNlcyB1c2luZyB0aGUgYHN0cl9zcGxpdCgpYCBmdW5jdGlvbiBvZiB0aGUgYHN0cmluZ3JgIHBhY2thZ2UuIFdlIGNhbiBjaGVjayB0aGUgcm93cyB3aXRoIE5BIHZhbHVlcyBieSBsb29raW5nIGF0IHJvd3MgMjAtMzAuCmBgYHtyfQpNZW4gPC0gdGliYmxlOjphc190aWJibGUoc3RyX3NwbGl0KE1lbiwgIiAiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGlmeSA9IFRSVUUpKQpNZW5bMjA6MzAsXQpgYGAKR3JlYXQhIEl0IGxvb2tzIGdvb2QhCgpOb3cgZm9yIHRoZSBgV29tZW5gIGRhdGEuCgpgYGB7cn0KV29tZW4gPC0gYXNfdGliYmxlKHN0cl9zcGxpdChXb21lbiwgIiAiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaW1wbGlmeSA9IFRSVUUpKQpoZWFkKFdvbWVuKQpXb21lblsyMDozMCxdIApgYGAKCldlIGNhbiBzZWUgdGhhdCBvdXIgYG5hYCB2YWx1ZXMgbG9vayBjb3JyZWN0LiAKCkxvb2tzIGdvb2QhCiAKIAojIyMgQWRkaW5nIG5ldyBoZWFkZXIKCldlIGNhbiBzZWUgZnJvbSBvdXIgcGRmIGFuZCBvdXIgb2JqZWN0IGNhbGxlZCBgaGVhZGVyYCB3aGF0IHRoZSBoZWFkZXIgd2FzIGxpa2UgaW4gdGhlIG9yaWdpbmFsIHBkZiBkb2N1bWVudC4gV2UgbmVlZCB0byBhZGQgY29sdW1uIG5hbWVzIHRvIG91ciBkYXRhIGJhc2VkIG9uIHRoZSBvcmlnaW5hbCBkYXRhLgoKV2UnbGwgd2FpdCB0byBhZGQgYENvdW50cnlgIHRvIHRoZSBoZWFkZXIgdW50aWwgd2UgYWRkIHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIHRvIG91ciBkYXRhLgoKYGBge3J9Cm5ld19oZWFkZXIgPC0gYygiU2V4IiwiTmF0aW9uYWxfQk1JXzE5ODUiLCAKICAgICAgICAgICAgICAgICJOYXRpb25hbF9CTUlfMTk4NV9DSSIsICJSdXJhbF9CTUlfMTk4NSIsIAogICAgICAgICAgICAgICAgIlJ1cmFsX0JNSV8xOTg1X0NJIiwgIlVyYmFuX0JNSV8xOTg1IiwKICAgICAgICAgICAgICAgICJVcmJhbl9CTUlfMTk4NV9DSSIsICJOYXRpb25hbF9CTUlfMjAxNyIsCiAgICAgICAgICAgICAgICAiTmF0aW9uYWxfQk1JXzIwMTdfQ0kiLCJSdXJhbF9CTUlfMjAxNyIsCiAgICAgICAgICAgICAgICAiUnVyYWxfQk1JXzIwMTdfQ0kiLCAiVXJiYW5fQk1JXzIwMTciLCAKICAgICAgICAgICAgICAgICJVcmJhbl9CTUlfMjAxN19DSSIpCmBgYAoKTGV0J3MgY2hhbmdlIHRoZSBuYW1lcyBvZiBvdXIgY29sdW1ucyBvZiBvdXIgdGliYmxlcyB0byB0aGlzIG5ldyBoZWFkZXIgZm9yIG91ciBgTWVuYCBhbmQgYFdvbWVuYCBkYXRhCgpgYGB7cn0KbmFtZXMoV29tZW4pIDwtIG5ld19oZWFkZXIKbmFtZXMoTWVuKSA8LSBuZXdfaGVhZGVyCgpoZWFkKFdvbWVuKQpoZWFkKE1lbikKYGBgCgpOb3cgd2Ugd2lsbCBhZGQgb3VyIGNvdW50cnkgZGF0YSB0byBib3RoIG91ciBgTWVuYCBhbmQgYFdvbWVuYCB0aWJibGVzIHVzaW5nIHRoZSBgYmluZF9jb2xzKClgIGZ1bmN0aW9uLiBUaGlzIHdpbGwgYWRkIHRoZSBgY291bnRyeWAgYXMgYSBuZXcgY29sdW1uIHRvIHRoZSBgV29tZW5gIGRhdGEgb2JqZWN0IG9uIHRoZSBsZWZ0LiAKCmBgYHtyfQpXb21lbiA8LSBkcGx5cjo6YmluZF9jb2xzKGNvdW50cnksIFdvbWVuKQpoZWFkKFdvbWVuKQpgYGAKCgpTaW1pbGFybHksIGZvciB0aGUgZGF0YSBhYm91dCBNZW4sIHRoaXMgd2lsbCBhZGQgdGhlIGBjb3VudHJ5YCBhcyBhIG5ldyBjb2x1bW4gdG8gdGhlIGBNZW5gIGRhdGEgb2JqZWN0IG9uIHRoZSBsZWZ0LiAKYGBge3J9Ck1lbiA8LSBkcGx5cjo6YmluZF9jb2xzKGNvdW50cnksIE1lbikgCmhlYWQoTWVuKQpgYGAKCgojIyMgQ2hhbmdpbmcgdmFyaWFibGUgbmFtZXMKCkhlcmUsIHdlIHdpbGwgY2hhbmdlIHRoZSB2YXJpYWJsZSBuYW1lIGluIHRoZSBgY291bnRyeWAgZGF0YXNldCB0byBgY291bnRyeWAgKGN1cnJlbnRseSBpdCBpcyBjYWxsZWQgYGNvdW50cnlfc3BsaXRgKS4gCldlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGNvbmNlcHQgb2YgdGhlIGFzc2lnbm1lbnQgcGlwZS4gCkluIHRoaXMgY2FzZSBvdXIgcGlwZSBvcGVyYXRvciBsb29rcyBsaWtlIHRoaXMgYCU8PiVgLiAKVXNpbmcgdGhpcyBhZGRpdGlvbmFsIHBpcGUgcmVxdWlyZXMgYW5vdGhlciBwYWNrYWdlLCBjYWxsZWQgYG1hZ3JpdHRyYC4gClRoZSBvdGhlciBzaW1wbGVyIHBpcGUgb3B0aW9ucyBmcm9tIHRoaXMgcGFja2FnZSBhcmUgbG9hZGVkIHdpdGggYHRpZHl2ZXJzZWAgKGlmIHlvdSB1c2VkIGBsaWJyYXJ5KHRpZHl2ZXJzZSlgIHdoaWNoIGxvYWRzIG1vc3QgdGlkeXZlcnNlIHBhY2thZ2VzKSwgYnV0IG5vdCB0aGlzIHZlcnNpb24uIAoKVGhlIGA+YCBwb3J0aW9uIG9mIHRoZSBwaXBlIHN0aWxsIGJlaGF2ZXMgbGlrZSBhIG5vcm1hbCBwaXBlLCB3aGlsZSB0aGUgYDxgIHBvcnRpb24gb2YgdGhlIHBpcGUgbWFrZXMgYW4gYXNzaWdubWVudCB0byB3aGF0ZXZlciB0aGUgYDxgaXMgcG9pbnRpbmcgdG8sIGp1c3QgbGlrZSB3aGVuIHdlIHVzZSB0aGUgdHlwaWNhbCBhc3NpZ25tZW50IG9wZXJhdG9yIGA8LWAuIAoKYGBge3J9CiMgbGlicmFyeShtYWdyaXR0cikgCiMgV2UgY2FuJ3QgdXNlIHRoZSBgJTw+JWAgdW5sZXNzIHdlIGxvYWQgdGhlIG1hZ3JpdHRyIHBhY2thZ2UKIyBXZSBoYXZlIGFscmVhZHkgZG9uZSB0aGlzIGJ1dCB3ZSBpbmNsdWRlIHRoaXMgZm9yIGlsbHVzdHJhdGl2ZSBwdXJwb3Nlcy4KIyBIZXJlIHdlIHdpbGwganVzdCB1c2UgdGhlIHRyYWRpdGlvbmFsIGFzc2lnbm1lbnQgc3RyYXRlZ3kKCldvbWVuIDwtIGRwbHlyOjpyZW5hbWUoV29tZW4sIENvdW50cnkgPSBjb3VudHJ5X3NwbGl0KSAKYGBgCkhlcmUsIHdlIGhhdmUgcmVuYW1lZCB0aGUgYGNvdW50cnlfc3BsaXRgIHZhcmlhYmxlIHRvIGJlIGNhbGxlZCBgQ291bnRyeWAuIAoKSGVyZSwgd2UgcmVhc3NpZ24gYE1lbmAgdXNpbmcgdGhlIHBpcGUgc3RyYXRlZ3kuIApgYGB7cn0KTWVuICU8PiUgcmVuYW1lKENvdW50cnkgPSBjb3VudHJ5X3NwbGl0KSAKYGBgCldlIGhhdmUgcmVuYW1lZCB0aGUgYGNvdW50cnlfc3BsaXRgIHZhcmlhYmxlIHRvIHRvIGJlIGNhbGxlZCBgQ291bnRyeWAuIApXZSBoYXZlIGFsc28gcmVhc3NpZ25lZCBgTWVuYCB0byB0aGUgc2FtZSBkYXRhIG9iamVjdC4gd2hpY2ggaGFzIHRoZSBgQ291bnRyeWAgdmFyaWFibGUgcmVuYW1lZC4gCgpMZXQncyB0YWtlIGEgbG9vayBhdCBvdXIgZGF0YSBmb3IgYE1lbmAgYW5kIGBXb21lbmA6CgpgYGB7cn0KaGVhZChXb21lbikKaGVhZChNZW4pCmBgYAojIyMgSm9pbmluZyB0aGUgZGF0YQoKTm93IHRoYXQgYm90aCBvZiB0aGVzZSB0aWJibGVzIGhhdmUgdGhlIHNhbWUgc3RydWN0dXJlLCB3ZSBjYW4gY29tYmluZSBvdXIgYE1lbmAgYW5kIGBXb21lbmAgZGF0YSB1c2luZyB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiBvZiBgZHBseXJgLiBUaGlzIHdpbGwgY29tYmluZSBhbGwgb2YgdGhlIHJvd3MgYmFzZWQgb24gdGhlaXIgc2ltaWxhciBjb2x1bW4gc3RydWN0dXJlLgpBbGwgb2YgdGhlIG1hbGUgZGF0YSAgd2lsbCBiZSBmaXJzdCBhbmQgYWxsIHRoZSBmZW1hbGUgZGF0YSB3aWxsIGJlIHNlY29uZC4KCmBgYHtyfQpCTUkgPC0gZHBseXI6OmJpbmRfcm93cyhNZW4sIFdvbWVuKQpgYGAKCkxldCdzIGNoZWNrIHRoZSBzaXplIG9mIG91ciBCTUkgZGF0YS4uLiBpdCBzaG91bGQgaGF2ZSA0MDAgcm93cyAob2JzKS4gV2UgY2FuIHNlZSB0aGUgZW5kIG9mIHRoZSBgQk1JYCBkYXRhIHVzaW5nIHRoZSAgYHRhaWwoKWAgZnVuY3Rpb246CmBgYHtyfQpzdHIoQk1JKQp0YWlsKEJNSSkKYGBgCgojIyMgU29ydGluZyB0aGUgZGF0YQoKTm93LCBsZXQncyBzb3J0IHRoZSBkYXRhIGFscGhhYmV0aWNhbGx5IGJ5IGBDb3VudHJ5YCB1c2luZyB0aGUgYGFycmFuZ2UoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYGRwbHlyYCBwYWNrYWdlOgoKYGBge3J9CkJNSSA8LSBkcGx5cjo6YXJyYW5nZShCTUksIENvdW50cnkpCmhlYWQoQk1JKQpgYGAKCk91ciBkYXRhIGlzIGxvb2tpbmcgZ3JlYXQhIAoKTm93LCB3ZSBtaWdodCB3YW50IHRvIG1ha2Ugc3VyZSB0aGF0IG91ciBvYnNlcnZhdGlvbnMgZm9yIGVhY2ggdmFyaWFibGUgbG9vayB0aGUgd2F5IHdlIHdhbnQuIApJbiBvdGhlciB3b3JkcywgaWYgd2Ugd2FudCB0byBtYWtlIHBsb3RzIGFib3V0IE5hdGlvbmFsIEJNSSBpbiAxOTg1IHRoZW4gd2Ugd291bGQgbmVlZCBvdXIgdmFsdWVzIHRvIGJlIG51bWVyaWMuIApMb29raW5nIGF0IG91ciBCTUkgZGF0YSB1c2luZyBgc3RyKClgLCB3ZSBjYW4gc2VlIHRoZSB0eXBlIG9mIGRhdGEgZm9yIGVhY2ggb2Ygb3VyIHZhcmlhYmxlcyBsaXN0ZWQganVzdCBhZnRlciB2YXJpYWJsZSBuYW1lIGFuZCB0aGUgYCI6ImAgY29sb24uIAoKYGBge3IsIHdhcm5pbmc9RkFMU0UsIGV2YWx9CnN0cihCTUkpCmBgYAoKTG9va3MgbGlrZSBub25lIG9mIG91ciBCTUkgZGF0YSBpcyBhY3R1YWxseSBgbnVtZXJpY2AgKG9yIGBudW1gKSwgYnV0IG9mIHRoZSBjbGFzcyBgY2hhcmFjdGVyYCAob3IgYGNocmApLiAKTGV0J3MgY2hhbmdlIHRoYXQgbm93LgoKVG8gc3RhcnQsIHdlIGNvdWxkIGNoYW5nZSB0aGVzZSB2YWx1ZXMgdG8gYmUgbnVtZXJpYyB3aXRoIDYgbGluZXMgb2YgY29kZSBsaWtlIHRoaXMsIHdoZXJlIHRoZSBkb3VibGUgYnJhY2tldHNgW1tdXWAgYW5kIHF1b3RlcyBhcmUgdXNlZCB0byBzZWxlY3QgdGhlIHNwZWNpZmljIHZhcmlhYmxlIHdpdGhpbiB0aGUgYEJNSWAgdGliYmxlLiBJbiB0aGlzIGNhc2Ugd2UgbmVlZCB0byB1c2UgdGhlIGJyYWNrZXRzIGluc3RlYWQgb2YgYHB1bGwoKWAgYmVjYXVzZSB3ZSBjYW4ndCBzdGFydCBhIGNvbW1hbmQgd2l0aCBgcHVsbCgpYCB0byByZWFzc2lnbiB2YWx1ZXMgaW4gYSB2YXJpYWJsZS4KCmBgYHtyLCBldmFsID0gVFJVRX0KI3B1bGwoQk1JLCBOYXRpb25hbF9CTUlfMTk4NSklPD4lIGFzLm51bWVyaWMgI1RoaXMgd2lsbCBub3Qgd29yawpCTUlbWyJOYXRpb25hbF9CTUlfMTk4NSJdXSAlPD4lIGFzLm51bWVyaWMKQk1JW1siUnVyYWxfQk1JXzE5ODUiXV0gJTw+JSBhcy5udW1lcmljCkJNSVtbIlVyYmFuX0JNSV8xOTg1Il1dICU8PiUgYXMubnVtZXJpYwoKQk1JW1siTmF0aW9uYWxfQk1JXzIwMTciXV0gJTw+JSBhcy5udW1lcmljCkJNSVtbIlJ1cmFsX0JNSV8yMDE3Il1dICU8PiUgYXMubnVtZXJpYwpCTUlbWyJVcmJhbl9CTUlfMjAxNyJdXSAlPD4lIGFzLm51bWVyaWMKYGBgCgpBbmQgaWYgd2UgZGlkIHRoaXMgd2Ugd291bGQgc2VlIHRoZXNlIHZhcmlhYmxlcyBzaG93IGFzIGAibnVtImAgd2hpY2ggc3RhbmRzIGZvciBhIG51bWVyaWMgdHlwZSBvZiB2YXJpYWJsZS4KYGBge3J9CnN0cihCTUkpCmBgYAoKT3Igd2UgY2FuIHVzZSBhIG1vcmUgYXV0b21hdGVkIHdheSB3aXRoIHRoZSBgbWFwKClgIGZ1bmN0aW9uIG9mIHRoZSBgcHVycnJgIHBhY2thZ2U6CmBgYHtyfQpCTUlfbnVtZXJpYyA8LSAKICBwdXJycjo6bWFwKChCTUkgJT4lIAogICAgICAgICAgICAgICAgc2VsZWN0KC1tYXRjaGVzKCJDSXxTZXh8Q291bnRyeSIpKSksCiAgICAgICAgICAgICBhcy5udW1lcmljKSAlPiUgCiAgYXNfdGliYmxlKCkKYGBgCgpUaGUgYG1hcCgpYCBmdW5jdGlvbiBvZiB0aGUgYHB1cnJyYCBwYWNrYWdlIGFsbG93cyB1cyB0byBhcHBseSB0aGUgYGFzLm51bWVyaWMoKWAgZnVuY3Rpb24gdG8gYWxsIHRoZSBzZWxlY3RlZCBjb2x1bW5zIG9mIGBCTUlgIGRhdGFzZXQuCkFib3ZlLCB3ZSBoYXZlIHNlbGVjdGVkIHRob3NlIHRoYXQgZG9uJ3QgY29udGFpbiBgQ0lgLCBgU2V4YCwgb3IgYENvdW50cnlgIGluIHRoZSBjb2x1bW4gbmFtZS4gCklmIHlvdSBhcmUgZmFtaWxpYXIgd2l0aCBgYXBwbHkoKWAsIHRoaXMgZnVuY3Rpb24gaXMgdmVyeSBzaW1pbGFyLgoKTm93IHdlIG5lZWQgdG8gYWRkIHRoZSBgQ291bnRyeWAgYW5kIGBTZXhgIHZhcmlhYmxlcyBiYWNrIHRvIG91ciBuZXcgbnVtZXJpYyBkYXRhc2V0LgoKYGBge3J9CkJNSV9udW1lcmljICU8PiUgCiAgbXV0YXRlKENvdW50cnkgPSBwdWxsKEJNSSwgQ291bnRyeSksIAogICAgICAgICBTZXggPSBwdWxsKEJNSSwgU2V4KSkKaGVhZChCTUlfbnVtZXJpYykKYGBgCgpJbiB0aGlzIGNhc2Ugb3VyIG51bWVyaWMgZGF0YSBpcyBvZiBhIGNsYXNzIGBkYmxgLiAKVGhpcyBtZWFucyBkb3VibGUtcHJlY2lzaW9uIGZsb2F0aW5nIHBvaW50IG51bWJlcnMgKHdpdGggZGVjaW1hbHMpLgpUaGUgYWx0ZXJuYXRpdmUgbnVtZXJpYyBvcHRpb24gaXMgdGhlIGludGVnZXIgY2xhc3MuIAoKIyMjIFRyYW5zZm9ybWluZyB0byB0aWR5IGRhdGEKCkl0IGlzIGdlbmVyYWxseSB1c2VmdWwgdG8gZ2V0IHRoZSBkYXRhIGluIHdoYXQgaXMgY2FsbGVkIDxiPmxvbmc8L2I+IGZvcm1hdCBmb3Igb3RoZXIgYW5hbHlzZXMsIGFuZCBwYXJ0aWN1bGFybHkgZm9yIHBsb3R0aW5nLiAKCkZvciBhIG1vcmUgZGV0YWlsZWQgZGVzY3JpcHRpb24gYWJvdXQgdGhpcywgcGxlYXNlIHNlZSB0aGlzIFtjYXNlIHN0dWR5XShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LgoKQmFzaWNhbGx5LCB0aGUgbG9uZyBmb3JtYXQgaGFzIG1vcmUgcm93cyBhbmQgZmV3ZXIgY29sdW1ucy4KVGh1cywgd2UgY2FuIGNvbWJpbmUgc29tZSBjb2x1bW5zIHRvZ2V0aGVyLgpJbiBvdXIgY2FzZSwgd2UgY2FuIHB1dCBhbGwgdGhlIGRpZmZlcmVudCBCTUkgZGF0YSB0b2dldGhlciBpbiBvbmUgbG9uZyBjb2x1bW4uCldlIHdpbGwgY3JlYXRlIGEgbmV3IGNvbHVtbiB0aGF0IHRlbGxzIHVzIHdoYXQgZWFjaCByb3cgb2YgdGhlIG5ldyBCTUkgY29sdW1uIHJlcHJlc2VudHMuCkluIG90aGVyIHdvcmRzLCBpdCB3aWxsIHRlbGwgdXMgd2hhdCB0aGUgb3JpZ2luYWwgY29sdW1uIHdhcy4KClRvIGRvIHRoaXMgd2Ugd2lsbCB1c2UgdGhlIGBwaXZvdF9sb25nZXIoKWAgZnVuY3Rpb24gb2YgdGhlIGB0aWR5cmAgcGFja2FnZS4gVGhlIGBkYXRhYCBhcmd1bWVudCBzcGVjaWZpZXMgd2hhdCBkYXRhIHdlIHdhbnQgdG8gd29yayB3aXRoLCB0aGUgYGNvbHNgIGFyZ3VtZW50IHNwZWNpZmllcyB0aGUgbmFtZXMgb2YgdGhlIGNvbHVtbnMgb3IgdmFyaWFibGVzIHRoYXQgd2Ugd2FudCB0byBjb21iaW5lIGFuZCBjaGFuZ2UgdG8gb25lIGxvbmcgZm9ybWF0IHZhcmlhYmxlLCBhbmQgdGhlIGBuYW1lc190b2AgYXJndW1lbnQgc3BlY2lmaWVzIHRoZSBuYW1lIGZvciB0aGUgbmV3IHZhcmlhYmxlIHRoYXQgd2UgYXJlIGNyZWF0aW5nLiBUaGUgYDpgIGlzIHVzZWQgdG8gaW5kaWNhdGUgdGhhdCB3ZSB3YW50IHRvIGNvbWJpbmUgdGhlIGNvbHVtbnMgb3IgdmFyaWFibGVzIGJldHdlZW4gYE5hdGlvbmFsX0JNSV8xOTg1YCBhbmQgYFVyYmFuX0JNSV8yMDE3YC4KCmBgYHtyfQpCTUlfbG9uZyA8LQogIHRpZHlyOjpwaXZvdF9sb25nZXIoZGF0YSA9IEJNSV9udW1lcmljLCAKICAgICAgICAgICAgICAgICAgICAgIGNvbHMgPSBOYXRpb25hbF9CTUlfMTk4NTpVcmJhbl9CTUlfMjAxNywgCiAgICAgICAgICAgICAgICAgICAgICBuYW1lc190byA9ICJjbGFzc19CTUkiKQoKaGVhZChCTUlfbG9uZykKYGBgCgpXZSByZWFsbHkgd2FudCB0byBwcm9tb3RlIHRoZSBpZGVhIG9mIHdvcmtpbmcgd2l0aCBbdGlkeSBkYXRhXShodHRwczovL3I0ZHMuaGFkLmNvLm56L3RpZHktZGF0YS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LiBUaWR5IGRhdGEgaXMgZGF0YSB0aGF0IGlzIHN0cnVjdHVyZWQgaW4gYSB3YXkgdGhhdCBtYWtlcyBpdCBlc3BlY2lhbGx5IHVzYWJsZS4gT25lIG9mIHRoZSBydWxlcyBvZiB0aWR5IGRhdGEsIGlzIHRoYXQgZWFjaCBjb2x1bW4gb3IgdmFyaWFibGUgc2hvdWxkIGhhdmUgb25seSBvbmUgdHlwZSBvZiBkYXRhLiBDdXJyZW50bHkgd2UgaGF2ZSB0d28gdHlwZXMgb2YgZGF0YSBpbiB0aGUgYEJNSV9jbGFzc2AgdmFyaWFibGU6IHRoZSB0eXBlIG9mIEJNSSBtZWFzdXJlbWVudCAoIFJ1cmFsLCBVcmJhbiwgb3IgTmF0aW9uYWwpLCBhbmQgdGhlIHllYXIgKDE5ODUgYW5kIDIwMTcpLiAgV2UgY2FuIHNlcGFyYXRlIHRoZXNlIHR3byBkYXRhIHR5cGVzIG9mIHRoZSBgY2xhc3NfQk1JYCBjb2x1bW4gdXNpbmcgdGhlIGBzZXBhcmF0ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYHRpZHlyYCBwYWNrYWdlIHRvIHJlcGxhY2UgdGhlIGBjbGFzc19CTUlgIGNvbHVtbiB3aXRoIHR3byBuZXcgY29sdW1ucy4KCmBgYHtyfQpCTUlfbG9uZyAlPD4lIAogIHRpZHlyOjpzZXBhcmF0ZShjbGFzc19CTUksIAogICAgICAgICAgICAgICAgICBjKCJSZWdpb24iLCBOQSwgIlllYXIiKSkgCmBgYAoKSGVyZSwgd2Ugc2VwYXJhdGUgdGhlIGBjbGFzc19CTUlgIGNvbHVtbiBvZiB0aGUgYEJNSV9sb25nYCB0aWJibGUuIApUaGlzIGlzIGJhc2VkIG9uIHRoZSB1bmRlcnNjb3JlcyBhbmQgY3JlYXRlIHR3byBuZXcgY29sdW1ucy4gClRoZSBmaXJzdCBjb2x1bW4gd2lsbCBiZSBjYWxsZWQgYFJlZ2lvbmAuIApJdCB3aWxsIGNvbnRhaW4gdGhlIDFzdCBwYXJ0IG9mIHRoZSBgY2xhc3NfQk1JYCBkYXRhIGJlZm9yZSB0aGUgMXN0IHVuZGVyc2NvcmUuIApUaGUgMm5kIGNvbHVtbiB3aWxsIGJlIGNhbGxlZCBgWWVhcmAuCkl0IHdpbGwgY29udGFpbiB0aGUgM3JkIHBhcnQgb2YgdGhlIGRhdGEgYmFzZWQgb24gdW5kZXJzY29yZXMuClRoZSBtaWRkbGUgcGFydCBvZiB0aGUgY29sdW1uIHdpbGwgbm90IGJlIHVzZWQgdG8gY3JlYXRlIGFueSBuZXcgY29sdW1ucy4gCgpgYGB7cn0KaGVhZChCTUlfbG9uZykKYGBgCgpMZXQncyBzZWUgaG93IHRoZSBkaW1lbnNpb25zIG9mIHRoZSBgQk1JYCBkYXRhIGhhdmUgY2hhbmdlZCBpbiBsb25nIGZvcm1hdDoKYGBge3J9CmRpbShCTUlfbnVtZXJpYykKZGltKEJNSV9sb25nKQpgYGAKTGV0J3MgcmVuYW1lIHRoZSBgdmFsdWVgIGNvbHVtbiB0byBzb21ldGhpbmcgbW9yZSBpbmZvcm1hdGl2ZS4gV2UgY2FuIHVzZSB0aGUgYHJlbmFtZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGRwbHlyYCBwYWNrYWdlIHRvIGRvIHRoaXMuIE5vdGljZSB0aGF0IHRoZSB2YWx1ZSB3ZSB3YW50IHRvIHJlcGxhY2UgaXMgbGlzdGVkIHNlY29uZCBhZnRlciB0aGUgYD1gIHNpZ24uCgpgYGB7cn0KCkJNSV9sb25nICU8PiUgCiAgcmVuYW1lKEJNSSA9IHZhbHVlKQpoZWFkKEJNSV9sb25nKQoKYGBgCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPHU+UXVlc3Rpb24gb3Bwb3J0dW5pdHk6PC91PiBXaHkgZXhhY3RseSBhcmUgdGhlcmUgMiw0MDAgcm93cyBub3c/CgojIyMjCgpHcmVhdCEgT3VyIGRhdGEgaXMgdmVyeSB1c2FibGUgbm93IGluIHRoaXMgZm9ybWF0IQoKYGBge3IsIGVjaG8gPSBGQUxTRX0Kc2F2ZShCTUlfbnVtZXJpYywgCiAgICAgQk1JX2xvbmcsIAogICAgIGZpbGUgPSBoZXJlKCJkYXRhIiwgIldyYW5nbGVkX2RhdGEucmRhIikpCgpgYGAKCiMjIERhdGEgRXhwbG9yYXRpb24KCk5vdyB0aGF0IG91ciBkYXRhIGlzIGNsZWFuIGFuZCBpbiBhIGZvcm1hdCB0aGF0IHdlIGNhbiB3b3JrIHdpdGgsIHdlIGNhbiBzdGFydCB0byB0YWtlIGEgbG9vayBhdCB0aGUgZGF0YSBhbmQgaG93IGRpZmZlcmVudCBncm91cHMgbWlnaHQgY29tcGFyZS4KCkdvaW5nIGJhY2sgdG8gb25lIG9mIG91ciBvcmlnaW5hbCBxdWVzdGlvbnMsIAoKPiBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gQk1JIGVzdGltYXRlcyBhcm91bmQgdGhlIHdvcmxkPwoKV2Ugd2FudCB0byB1c2UgYSBzdGF0aXN0aWNhbCB0ZXN0IHRvIGlkZW50aWZ5IGlmIHRoZXJlIGFyZSBkaWZmZXJlbmNlcyBpbiB0aGUgYXZlcmFnZSBCTUkgZXN0aW1hdGVzIGJldHdlZW4gZS5nLiBydXJhbCBhbmQgdXJiYW4gZ3JvdXBzLiAKRmlyc3QsIGxldCdzIGV4cGxvcmUgb3VyIGRhdGEgYSBiaXQuIAoKIyMjIEdlbmVyYWwgc3VtbWFyeQoKYGBge3IsIGVjaG8gPSBGQUxTRX0KIyBTdGFydCBoZXJlIGlmIG5vdCB3b3JraW5nIHRocm91Z2ggZGF0YSBpbXBvcnQgYW5kIHdyYW5nbGluZwpsb2FkKGhlcmUoImRhdGEiLCAiV3JhbmdsZWRfZGF0YS5yZGEiKSkKYGBgCgpgYGB7cn0Kc3VtbWFyeShCTUlfbnVtZXJpYykKYGBgCldlIGNhbiBzZWUgdGhhdCB0aGUgbWVhbiBCTUkgZXN0aW1hdGVzIGFyZSBsYXJnZXIgaW4gMjAxNy4KSG93ZXZlciwgaXMgdGhpcyBhIG1lYW5pbmdmdWwgaW5jcmVhc2U/ClRoaXMgaXMgZGlmZmljdWx0IHRvIGRldGVybWluZSB3aXRob3V0IGEgc3RhdGlzdGljYWwgdGVzdC4KCkxldHMgbG9vayBhdCB0aGUgZGF0YSBzdHJhdGlmaWVkIGJ5IGBTZXhgOgoKYGBge3J9CkJNSV9udW1lcmljICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JSAKICBzdW1tYXJ5KCkKYGBgCgpgYGB7cn0KQk1JX251bWVyaWMgJT4lIAogIGZpbHRlcihTZXggPT0gIk1lbiIpICU+JSAKICBzdW1tYXJ5KCkKYGBgCgpJdCBsb29rcyBsaWtlIG1lYW4gQk1JcyBoYXZlIGluY3JlYXNlZCBpbiBhbGwgcmVnaW9ucyBmb3IgYm90aCBtZW4gYW5kIHdvbWVuLCBidXQgbGV0J3MgbG9vayBkZWVwZXIgd2l0aCBzb21lIHN0YXRpc3RpY2FsIHRlc3RzLgoKIyMjIERpc3RyaWJ1dGlvbnMKCkluIG9yZGVyIHRvIGFwcGx5IGEgc3RhdGlzdGljYWwgdGVzdCB0byBjb21wYXJlIHRoZSBtZWFucywgb25lIG9mIHRoZSBmaXJzdCB0aGluZ3MgdG8gZG8gaXMgdG8gZXhwbG9yZSB0aGUgZnJlcXVlbmN5IG9mIHRoZSBkaWZmZXJlbnQgb2JzZXJ2ZWQgdmFsdWVzLiAKT25lIHdheSB0byBzdW1tYXJpemUgdGhlIGZyZXF1ZW5jeSBvZiBkaWZmZXJlbnQgb2JzZXJ2ZWQgdmFsdWVzIGlzIHRoZSA8Yj5mcmVxdWVuY3kgZGlzdHJpYnV0aW9uPC9iPiwgd2hpY2ggY2FuIGJlIHNob3duIGluIGEgdGFibGUgb3IgYSBwbG90LiAKU2VlIFtoZXJlXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCBkaXN0cmlidXRpb25zLiAKClRoZXJlIGFyZSBvdGhlciB0eXBlcyBvZiBkaXN0cmlidXRpb25zIHRvbywgc3VjaCBhcyA8Yj5wcm9iYWJpbGl0eSBkaXN0cmlidXRpb25zPC9iPiwgd2hpY2ggZGVzY3JpYmUgdGhlIHByb2JhYmlsaXR5IHRoZSBvY2N1cnJlbmNlIG9mIGRpZmZlcmVudCBwb3NzaWJsZSBvdXRjb21lcy4gClByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbnMgY2FuIGJlIGRlZmluZWQgZm9yIGRpc2NyZXRlIGRhdGEgKGUuZy4gZmxpcHBpbmcgYSBjb2luIGFzIGhlYWRzIG9yIHRhaWxzKSBhbmQgY29udGludW91cyBkYXRhIChlLmcuIEJNSSBlc3RpbWF0ZXMpLiAKSWYgd2UgYXJlIHRhbGtpbmcgYWJvdXQgZGlzY3JldGUgZGF0YSwgdGhlIHJlbGF0aXZlIGZyZXF1ZW5jeSBvZiB0aGUgZGlmZmVyZW50IGNhdGVnb3JpZXMgKGhlYWRzIG9yIHRhaWxzKSBjYW4gYmUgdXNlZCB0byBkZWZpbmUgYSA8Yj5kaXNjcmV0ZSBwcm9iYWJpbGl0eSBkaXN0cmlidXRpb248L2I+LiAKV2UgY2FuIHNpbXBseSBhc3NpZ24gYSBwcm9iYWJpbGl0eSB0byBlYWNoIGNhdGVnb3J5LCBlLmcuICRQKGhlYWRzKSA9IDAuNSQgYW5kICRQKHRhaWxzKSA9IDAuNSQuIAoKPGI+Q29udGludW91cyBwcm9iYWJpbGl0eSBkaXN0cmlidXRpb25zPC9iPiB3b3JrIGluIGEgc2ltaWxhciB3YXksIGV4Y2VwdCBpbnN0ZWFkIG9mIGFzc2lnbmluZyBhIHByb2JhYmlsaXR5IHRvIGVhY2ggY2F0ZWdvcnkgb3IgdHlwZSBvZiBvYnNlcnZhdGlvbiAoZS5nLiBoZWFkcyBvciB0YWlscyksIHdlIGFzc2lnbiBhIHByb2JhYmlsaXR5IHRvIGFuIGludGVydmFsIG9mIGNvbnRpbnVvdXMgdmFsdWVzIChlLmcuIEJNSSBiZXR3ZWVuIDIyIGFuZCAyNikuIApUaGlzIGlzIGJlY2F1c2UgaXQncyBub3QgdXNlZnVsIHRvIGNvbnN0cnVjdCBhIGRpc3RyaWJ1dGlvbiB0aGF0IGFzc2lnbnMgYSBwcm9iYWJpbGl0eSB0byBlYWNoIHBvc3NpYmxlIG91dGNvbWUgKGUuZy4gYSBCTUkgb2YgMjIuMTEsIDIyLjEyLCBldGMpIHdpdGggc3VjaCBoaWdoIHByZWNpc2lvbi4gSW4gdGhpcyBjYXNlLCB3ZSB3b3VsZCBoYXZlIHRvIGFzc2lnbiBhIHZlcnkgc21hbGwgcHJvYmFiaWxpdHkgdG8gZXZlcnkgcG9zc2libGUgQk1JIG91dGNvbWUuIAoKVGhlIDxiPm5vcm1hbCAob3IgR2F1c3NpYW4pIGRpc3RyaWJ1dGlvbjwvYj4gaXMgYSB0eXBlIG9mIDxiPnRoZW9yZXRpY2FsIGNvbnRpbnVvdXMgcHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9uPC9iPiB0aGF0IGlzIGZyZXF1ZW50bHkgdXNlZCB0byBhcHByb3hpbWF0ZSB0aGUgZGlzdHJpYnV0aW9uIG9mIG1hbnkgbmF0dXJhbGx5IG9jY3VycmluZyBtZWFzdXJlbWVudHMsIHN1Y2ggYXMgdGhhdCBvZiBCTUkuIApXZSBzYXkgdGhhdCBhIHJhbmRvbSBxdWFudGl0eSAkWCQgKGUuZy4gQk1JKSBpcyBub3JtYWxseSBkaXN0cmlidXRlZCB3aXRoIG1lYW4gJG0kIGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gJHMkIGlmIHRoZSBwcm9wb3J0aW9uIG9mIHZhbHVlcyBpbiBhIGdpdmVuIGludGVydmFsICQoYSxiKSQgKGUuZy4gQk1JIGJldHdlZW4gMjIgYW5kIDI2KSBjYW4gYmUgY29tcHV0ZWQgdXNpbmcgdGhpcyBtYXRoZW1hdGljYWwgZm9ybXVsYTogCgokJFAoYSA8IHggPCBiKSA9IFxpbnRfYV5iIFxmcmFjezF9e1xzcXJ0ezJccGl9IHN9IGVeey1cZnJhY3sxfXsyfVxiaWcoXGZyYWN7eC1tfXtzfVxiaWcpXjJ9ICAkJAoKVHJhbnNsYXRpbmcgdGhpcyB0byBvdXIgY2FzZSBzdHVkeSwgaWYgb3VyIEJNSSBkYXRhIGZvbGxvdyBhIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBtZWFuIG9mICRtID0gMjQkIGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gb2YgJHMgPSAxJCwgdGhlbiB0aGUgZGlzdHJpYnV0aW9uIG9mIGRpZmZlcmVudCBCTUkgb3V0Y29tZXMgc2hvdWxkIGJlIGNlbnRlcmVkIGFyb3VuZCB0aGF0IG1lYW4gdmFsdWUgb2YgMjQgYW5kIHdvdWxkIGxvb2sgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYHtyfQpub3JtX0JNSV9leF9kYXRhIDwtIAogIHRpYmJsZShub3JtX2RhdGEgPSBybm9ybShuID0gMjAwLCBtZWFuID0gMjQsIHNkID0gMSkpCmhpc3QocHVsbChub3JtX0JNSV9leF9kYXRhLCBub3JtX2RhdGEpKQpgYGAKCkhlcmUgd2UgYXJlIHNpbXVsYXRpbmcgMjAwIG9ic2VydmF0aW9ucyBmcm9tIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiB3aXRoIGEgbWVhbiBvZiAkbSA9IDI0JCBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIG9mICRzID0gMSQgdXNpbmcgdGhlIGBybm9ybSgpYCBmdW5jdGlvbi4gCgpBbHRlcm5hdGl2ZWx5IHRvIHVzaW5nIGJhc2UgUiwgd2UgY2FuIHBsb3QgdGhlIGZyZXF1ZW5jeSBvZiBzaW11bGF0ZWQgb2JzZXJ2YXRpb25zIHVzaW5nIHRoZSBgZ2VvbV9oaXN0KClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgUiBwYWNrYWdlLiAKVGhlIFtnZ3Bsb3QyXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gcGFja2FnZSBjcmVhdGVzIHBsb3RzIGJ5IHVzaW5nIGxheWVycy4KTm90aWNlIGluIHRoZSBmb2xsb3dpbmcgY29kZSBob3cgdGhlcmUgaXMgYSBwbHVzIHNpZ24gYmV0d2VlbiB0aGUgYGdncGxvdCgpYCBmdW5jdGlvbiBhbmQgdGhlIGBnZW9tX2hpc3RvZ3JhbSgpYCBmdW5jdGlvbi4gCldpdGggYGdncGxvdDJgIHdlIHNlbGVjdCB3aGF0IGRhdGEgd2Ugd291bGQgbGlrZSB0byBwbG90IHVzaW5nIHRoZSBmaXJzdCBmdW5jdGlvbiAoYGdncGxvdCgpYCkgYW5kIHRoZW4gd2UgYWRkIG9uIGFkZGl0aW9uYWwgbGF5ZXJzIG9mIGNvbXBsZXhpdHkgKHRoZXNlIGxheWVycyBjYW4gZXZlbiBpbnZvbHZlIGRpZmZlcmVudCBkYXRhKS4gCmBgYHtyfQogIGdncGxvdDI6OmdncGxvdChub3JtX0JNSV9leF9kYXRhLCBhZXMoeCA9IG5vcm1fZGF0YSkpICsgCiAgZ2dwbG90Mjo6Z2VvbV9oaXN0b2dyYW0oKSAKYGBgCgpIZXJlLCB3ZSBhcmUgdXNpbmcgdGhlIGNvbHVtbiBjYWxsZWQgYG5vcm1fZGF0YWAgd2l0aGluIGBub3JtX0JNSV9leF9kYXRhYC4KQXMgd2Ugbm90ZWQsIHdpdGggYGdncGxvdDJgIHdlIG11c3QgZmlyc3Qgc3BlY2lmeSB0aGUgZGF0YSB0byBwbG90IHdpdGggdGhlIGBnZ3Bsb3QoKWAgZnVuY3Rpb24uIApUaGVuLCB0aGUgYGdlb21fKmAgZnVuY3Rpb24gc3BlY2lmaWVzIHdoYXQgdHlwZSBvZiBwbG90IHRvIGNyZWF0ZSAoZS5nLiBgZ2VvbV9oaXN0b2dyYW0oKWAgY3JlYXRlIGEgaGlzdG9ncmFtKS4gCgpXZSBjb3VsZCBhbHNvIG1ha2UgdGhpcyBzYW1lIHBsb3QgYnkgcGlwaW5nIHRoZSBgbm9ybV9CTUlfZXhfZGF0YWAgZGF0YSBpbnRvIHRoZSBgZ2dwbG90KClgIGZ1bmN0aW9uOgpgYGB7cn0Kbm9ybV9CTUlfZXhfZGF0YSAlPiUgCiAgZ2dwbG90Mjo6Z2dwbG90KGFlcyh4ID0gbm9ybV9kYXRhKSkgKyAKICBnZ3Bsb3QyOjpnZW9tX2hpc3RvZ3JhbSgpIApgYGAKCldlIHdpbGwgc2VlIGxhdGVyIGhvdyB3ZSBjYW4gYWRkIG1hbnkgbGF5ZXJzIHRvIHBsb3RzIHdpdGggYGdncGxvdDJgLiBGb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBvbiB1c2luZyBgZ2dwbG90MmAsIHNlZSB0aGlzIFtjYXNlIHN0dWR5XShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LgoKCk5vdyBpbnN0ZWFkIG9mIHVzaW5nIHNpbXVsYXRlZCBkYXRhIGZyb20gYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBsZXQncyBtYWtlIGEgaGlzdG9ncmFtIG9mIG91ciBCTUkgZGF0YToKYGBge3J9CkJNSV9sb25nICU+JSAKICBnZ3Bsb3QoYWVzKHggPSBCTUkpKSArIAogIGdlb21faGlzdG9ncmFtKCkgCmBgYAoKSW50ZXJlc3RpbmchIFRoZSBkYXRhIGxvb2tzIGxpa2UgaXQgaGFzIG9uZSBtb2RlLCBidXQgaXQgZG9lcyBub3QgbG9vayBjb21wbGV0ZWx5IHN5bW1ldHJpYy4gSW4gZmFjdCBpdCBsb29rcyBsaWtlIGl0IG1pZ2h0IGJlIHdoYXQgaXMgY2FsbGVkIHJpZ2h0IHNrZXdlZC4gU2VlIFtoZXJlXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvZ2xvc3Nhcnkvc2tldy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHNrZXdlZCBkaXN0cmlidXRpb25zLgoKVG8gY2hlY2sgd2UgY2FuIGNhbGN1bGF0ZSB0aGUgbWVhbiBhbmQgbWVkaWFuIG9mIHRoZSBCTUkgZGF0YSB1c2luZyB0aGUgYmFzZSBgc3VtbWFyaXplKClgIGZ1bmN0aW9uIG9mIHRoZSBgZHBseXJgIHBhY2thZ2UuIElmIHRoZSBtZWFuIGFuZCBtZWRpYW4gYXJlIHZlcnkgc2ltaWxhciwgdGhlbiB3ZSB3aWxsIGtub3cgdGhhdCB0aGUgZGF0YSBpc24ndCBza2V3ZWQuIE5vdGUgdGhhdCBpdCBpcyBuZWNlc3NhcnkgdG8gZmlsdGVyIG91dCB0aGUgTkEgdmFsdWVzIGZpcnN0LgoKYGBge3J9CkJNSV9sb25nICU+JQogIGZpbHRlcighaXMubmEoQk1JKSklPiUKICBzdW1tYXJpemUobWVhbiA9IG1lYW4oQk1JKSwgbWVkaWFuID0gbWVkaWFuKEJNSSkpCmBgYApPSywgc28gdGhleSBhcmUgZXNzZW50aWFsbHkgdGhlIHNhbWUsIG1lYW49IDI0Ljg3IGFuZCBtZWRpYW4gPSAyNC45LCBzbyB0aGlzIGRvZXMgbm90IGZpdCB0aGUgaGFsbG1hcmsgb2YgcmlnaHQtc2tld2VkIGRhdGEgd2hlcmUgdGhlIHRoZSBtZWFuIGlzIGdyZWF0ZXIgdGhhbiB0aGUgbWVkaWFuLiAKCgpIb3dldmVyIHNvIGZhciB3ZSBoYXZlIG1hZGUgYSBoaXN0b2dyYW0gb2YgdGhlIEJNSSBkYXRhIGluIHRoZSBsb25nIGZvcm1hdCB3aGljaCBjb21iaW5lcyBCTUkgZXN0aW1hdGVzIGZvciBkaWZmZXJlbnQgc3ViZ3JvdXBzIG9mIHBlb3BsZSwgc28gcnVyYWwgd29tZW4sIHJ1cmFsIG1lbiwgdXJiYW4gd29tZW4sIHVyYmFuIG1lbiwgZXRjLiBhcmUgYWxsIGNvbWJpbmVkLiBJZiB3ZSB3YW50IHRvIG1ha2UgZ3JvdXAgY29tcGFyaXNvbnMsIHdlIG5lZWQgdG8gbG9vayBhdCB0aGUgZGlzdHJpYnV0aW9ucyBmb3IgdGhlIHNwZWNpZmljIGdyb3VwcyB0aGF0IHdlIGFyZSBldmFsdWF0aW5nLiBTbywgd2UgbmVlZCB0byBwaWNrIGEgcGFydGljdWxhciBwb3B1bGF0aW9uIG9mIGluZGl2aWR1YWxzIGFuZCBncmFwaCB0aGVpciBCTUksIGZvciBleGFtcGxlIGp1c3QgdGhlIG5hdGlvbmFsIGVzdGltYXRlcyBmb3Igd29tZW4gYW5kIGZvciBtZW4gaW4gMTk4NS4gIAoKVGhlIGVhc2llc3Qgd2F5IHRvIGRvIHRoaXMgaXMgdG8gdXNlIHNvbWUgb3RoZXIgZnVuY3Rpb25zIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZSwgcGFydGljdWxhcmx5IHRoZSBgZmFjZXRfd3JhcCgpYCBmdW5jdGlvbiwgd2hpY2ggd2lsbCBhbGxvdyB1cyB0byBsb29rIGF0IGRpZmZlcmVuY2VzIGluIHRoZSBkaXN0cmlidXRpb24gb2YgdGhlIEJNSSBlc3RpbWF0ZXMgc3RyYXRpZmllZCBieSBgWWVhcmAsIGBTZXhgLCBhbmQgYFJlZ2lvbmAuCldlIGNhbiBzZXF1ZW50aWFsbHkgZGl2aWRlIG91ciBwbG90cyBieSBkZWVwZXIgbGV2ZWxzIHVzaW5nIG11bHRpcGxlIHZhcmlhYmxlcyBhbmQgdGhlIGArYCBwbHVzIHNpZ24gd2l0aGluIGBmYWNldF93cmFwKClgLgoKYGBge3J9CkJNSV9sb25nICU+JQogIGdncGxvdChhZXMoeD1CTUkpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFllYXIgKyBSZWdpb24pIApgYGAKClNvbWUgb2YgdGhlc2UgcGxvdHMgbG9vayBwcmV0dHkgc2ltaWxhciB0byBhIG5vcm1hbCBkaXN0cmlidXRpb24sIGxpa2UgdGhlIGBXb21lbiAyMDE3IFVyYmFuYCBwbG90IChhbHRob3VnaCBpdCBtaWdodCBiZSByaWdodC1za2V3ZWQsIGFnYWluIHdlIGNvdWxkIGNoZWNrIHRoZSBtZWFuIGFuZCBtZWRpYW4gdG8gZGV0ZXJtaW5lIHRoYXQpLgpIb3dldmVyIHNvbWUgb2YgdGhlIG90aGVyIHBsb3RzLCBsaWtlIHRoZSBgTWVuIDIwMTcgVXJiYW5gIHBsb3QsIGxvb2sgdmVyeSBkaWZmZXJlbnQuIApUaGVzZSBwbG90cyBzaG93IHdoYXQgaXMgY2FsbGVkIGEgW2JpbW9kYWwgZGlzdHJpYnV0aW9uXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSwgbWVhbmluZyB0aGF0IHRoZXJlIGFwcGVhciB0byBiZSB0d28gcGVha3MgKG9yIG1vZGVzKSwgb3IgaW4gb3RoZXIgd29yZHMgdHdvIGRpZmZlcmVudCB2YWx1ZXMgKGFuZCB2YWx1ZXMgbmVhciBlYWNoIG9mIHRoZXNlKSB0aGF0IGFyZSB0aGUgbW9zdCBmcmVxdWVudC4KCiMjIyBRdWFudGlsZS1RdWFudGlsZSBQbG90cwoKQW5vdGhlciB1c2VmdWwgcGxvdCB0byBjcmVhdGUgd2hlbiBleHBsb3JpbmcgZGlzdHJpYnV0aW9ucyBpcyBzb21ldGhpbmcgY2FsbGVkIGEgInF1YW50aWxlLXF1YW50aWxlIiBwbG90IChvciA8Yj5RLVEgcGxvdDwvYj4gZm9yIHNob3J0KS4gV2hlbiB3ZSB0YWxrIGFib3V0IGEgPGI+cXVhbnRpbGU8L2I+LCB3ZSBhcmUgdGFsa2luZyBhYm91dCBkaXZpZGluZyB1cCB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBkYXRhIGludG8gcm91Z2hseSBlcXVhbCBwb3J0aW9ucyB3aGVyZSByb3VnaGx5IHRoZSBzYW1lIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgZmFsbCBpbnRvIGVhY2ggcG9ydGlvbi4gRm9yIGV4YW1wbGUsIGlmIHlvdSBkaXZpZGUgeW91ciBkYXRhIGludG8gMTAwIHF1YW50aWxlcywgeW91IGNhbiB0aGluayBhYm91dCB0aGlzIGFzIHBlcmNlbnRpbGVzLCBidXQgeW91IGNvdWxkIGFsc28gZGl2aWRlIHlvdXIgZGF0YSBpbnRvIDEwIHF1YW50aWxlcyBhbmQgdGhlc2Ugd291bGQgYmUgY2FsbGVkIGRlY2lsZXMuIAoKPGI+V2h5IFEtUSBwbG90cz88L2I+IFRoaXMgcGxvdCBhbGxvd3MgdXMgdG8gY29tcGFyZSB0aGUgcXVhbnRpbGVzIG9mIHR3byBkaXN0cmlidXRpb25zIHRvZ2V0aGVyOiAoMSkgcXVhbnRpbGVzIG9mIGEga25vd24gdGhlb3JldGljYWwgZGlzdHJpYnV0aW9uIChsaWtlIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uKSBjb21wYXJlZCB0byAoMikgcXVhbnRpbGVzIG9mIHRoZSBkaXN0cmlidXRpb24gb2Ygb3VyIGRhdGEuICBJZiB0aGUgcXVhbnRpbGVzIGZyb20gdGhlc2UgdHdvIGRpc3RyaWJ1dGlvbnMgbGluZSB1cCBpbiB0aGUgcGxvdCwgdGhlbiB0aGF0IGlzIGEgdmlzdWFsIHBpZWNlIG9mIGV2aWRlbmNlIHRoYXQgb3VyIGRhdGEgZm9sbG93IHRoYXQgdGhlb3JldGljYWwgZGlzdHJpYnV0aW9uIChsaWtlIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uKS4gIAoKPGI+SG93IGRvZXMgdGhpcyB3b3JrPzwvYj4gVG8gZG8gdGhpcyB3ZSB3aWxsIHBsb3QgdGhlIHF1YW50aWxlcyBvZiBvdXIgZGF0YSBvbiB0aGUgeS1heGlzIGFuZCB0aGUgcXVhbnRpbGVzIG9mIHRoZSB0aGVvcmV0aWNhbCBub3JtYWwgZGlzdHJpYnV0aW9uIG9uIHRoZSB4LWF4aXMuIElmIHRoZSBxdWFudGlsZXMgbGluZSB1cCB0aGVuIHdlIGNhbiBzYXkgdGhhdCBvdXIgZGF0YSBpcyBmYWlybHkgbm9ybWFsLiBTZWUgW2hlcmVdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9hZHZhbmNlZF9ncmFwaHMvcS1xX3Bsb3RzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgUS1RIHBsb3RzLgoKVXNpbmcgdGhlIGBzdGF0X3FxKClgIGZ1bmN0aW9uIG9mIHRoZSBgZ2dwbG90MmAgcGFja2FnZSwgd2UgY2FuIGVhc2lseSBjcmVhdGUgYSBRLVEgcGxvdCBmb3Igb3VyIGRhdGEgcmFuZG9tbHkgc2FtcGxlZCBmcm9tIGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiAoInNhbXBsZSIpIGFuZCBjb21wYXJlIGl0IHRvIHRoZSBxdWFudGlsZXMgZnJvbSBhIG5vcm1hbCBkaXN0cmlidXRpb24gKCJ0aGVvcmV0aWNhbCIpLiAgVGhlIGRlZmF1bHQgY29tcGFyaXNvbiBkaXN0cmlidXRpb24gZm9yIHRoZXNlIGZ1bmN0aW9ucyBpcyB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbiwgc28gd2UgZG9uJ3QgbmVlZCB0byBzcGVjaWZ5IGl0IGluIG91ciBjb2RlLgpgYGB7cn0Kbm9ybV9CTUlfZXhfZGF0YSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IG5vcm1fZGF0YSkpICsKICBzdGF0X3FxKCkgKyAKICBzdGF0X3FxX2xpbmUoKQpgYGAKClRoZSBgc3RhdF9xcV9saW5lKClgIGZ1bmN0aW9uIGlzIHVzZWQgdG8gYWRkIGEgbGluZSAoY29tcHV0ZXMgdGhlIHNsb3BlIGFuIGludGVyY2VwdCkgb24gdGhlIHBsb3QuIElmIHRoZSBwb2ludHMgbGllIG9uIHRoaXMgc3RyYWlnaHQgbGluZSwgdGhpcyBpcyBldmlkZW5jZSB0aGF0IHRoZSBkYXRhIGhhdmUgYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBub3QgdGhhdCB0aGUgZGF0YSBoYXZlIGEgcGFydGljdWxhciBub3JtYWwgZGlzdHJpYnV0aW9uLgpOb3Qgc3VycHJpc2luZ2x5LCB3ZSBzZWUgdGhhdCB0aGUgcG9pbnRzIG1vc3RseSBmYWxsIG9uIHRoZSBsaW5lLCBpbmRpY2F0aW5nIHRoYXQgdGhlIHF1YW50aWxlcyBhcmUgZmFpcmx5IHNpbWlsYXIgYmV0d2VlbiB0aGUgb2JzZXJ2ZWQgYW5kIHRoZW9yZXRpY2FsIGRhdGEuCgpUaGVyZSBhcmUgc29tZSBwb2ludHMgdGhhdCBhcmUgYSBiaXQgZnVydGhlciBmcm9tIHRoZSBsaW5lIGFzIHdlIGdldCB0byB0aGUgZXh0cmVtZSBxdWFudGlsZXMuCgpOb3RlIHRoYXQgdGhpcyBwbG90IGlzIGNvbXBhcmluZyBvdXIgYG5vcm1fQk1JX2V4X2RhdGFgIHdoaWNoIHdhcyByYW5kb21seSBzYW1wbGVkIGZyb20gYSBub3JtYWwgZGlzdHJpYnV0aW9uIHdpdGggbWVhbiAyNCBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIDEgdG8gYSAqc3RhbmRhcmQgbm9ybWFsIGRpc3RyaWJ1dGlvbiogd2l0aCBtZWFuIDAgYW5kIHN0YW5kYXJkIGRldmlhdGlvbiAxLCB3aGljaCBpcyB3aHkgdGhlIHZhbHVlcyBvbiB0aGUgeC1heGlzIGFyZSAtMyB0byAzIGluc3RlYWQgb2YgMjEgdG8gMjcuIAoKQXMgZXhwZWN0ZWQgd2Ugc2VlIHRoYXQgYWJvdXQgaGFsZiB0aGUgcG9pbnRzIGFyZSBiZWxvdyBvdXIgbWVhbiBvZiAyNCBvbiB0aGUgeS1heGlzLiAgCgpXZSBjYW4gc3BlY2lmeSBhIHNwZWNpZmljIG1lYW4gYW5kIHN0YW5kYXJkIGRldmlhdGlvbiBmb3Igb3VyIHRoZW9yZXRpY2FsIGRpc3RyaWJ1dGlvbiBpbiBvdXIgUS1RIHBsb3Q7IGhlcmUgd2Ugc3BlY2lmeSBhIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBtZWFuIDI0IGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gMSAoc28gdGhhdCB0aGUgdGhlb3JldGljYWwgZGlzdHJpYnV0aW9uIGxvb2tzIG1vcmUgbGlrZSBvdXIgZGF0YSk6CmBgYHtyfQpub3JtX0JNSV9leF9kYXRhICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gbm9ybV9kYXRhKSkgKwogIHN0YXRfcXEoZGlzdHJpYnV0aW9uID0gcW5vcm0sIGRwYXJhbXMgPSBjKG1lYW4gPSAyNCwgc2QgPSAxKSkgKyAKICBzdGF0X3FxX2xpbmUoZGlzdHJpYnV0aW9uID0gcW5vcm0sIGRwYXJhbXMgPSBjKG1lYW4gPSAyNCwgc2QgPSAxKSkKYGBgCk5vdGljZSB0aGF0IHRoZSBwbG90IGxvb2tzIHRoZSBzYW1lIGV4Y2VwdCBmb3IgdGhlIHZhbHVlcyBvbiB0aGUgeC1heGlzIGhhdmUgY2hhbmdlZCwgbWVhbmluZyBvdXIgaW50ZXJwcmV0YXRpb24gd2lsbCBiZSB0aGUgc2FtZSAtLSBpdCBsb29rcyBsaWtlIHRoZSB2YWx1ZXMgYXJlIGNvbnNpc3RlbnQgd2l0aCBhIG5vcm1hbCBkaXN0cmlidXRpb24uCgoKTm93LCBsZXQncyB0YWtlIGEgbG9vayBhdCBvdXIgYWN0dWFsIEJNSSBkYXRhOgpgYGB7cn0KQk1JX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPUJNSSkpICsKICBzdGF0X3FxKCkgKyAKICBzdGF0X3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFllYXIgKyBSZWdpb24pCmBgYAoKVGhpcyBpcyBhIGxpdHRsZSBoYXJkIHRvIHNlZSwgc29tZSBwbG90cyBzdWdnZXN0IHRob3NlIHN1YnNldHMgb2YgdGhlIGRhdGEgYXJlIHNpbWlsYXIgdG8gYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBidXQgb3RoZXJzIHNlZW0gdG8gYmUgc2tld2VkLiBMZXQncyB0YWtlIGEgY2xvc2VyIGxvb2suCgpGb3IgdGhlIHNha2Ugb2Ygc2ltcGxpY2l0eSwgd2UgYXJlIGdvaW5nIHRvIGZvY3VzIG9uIHRoZSBzdWJzZXQgb2YgZGF0YSBmb3IgdGhlIHdvbWVuLiAKVGhpcyBpcyBiZWNhdXNlIHdvbWVuIHdlcmUgaWRlbnRpZmllZCBpbiB0aGUgcGFwZXIgdG8gaGF2ZSBmYXN0ZXN0IGluY3JlYXNlcyBpbiBCTUkgb3ZlciB0aW1lLgpJZiB3ZSB3YW50IHRvIGNvbXBhcmUgdHdvIHN1YnNldHMgb2Ygd29tZW4gKGUuZy4gMTk4NSB2ZXJzdXMgMjAxNyBvciBydXJhbCB2ZXJzdXMgdXJiYW4pLCB0aGVuIHdlIG5lZWQgdG8gbG9vayBhdCB0aGUgZGlzdHJpYnV0aW9uIG9mIGVhY2ggb2YgdGhlc2Ugc3Vic2V0cy4KCmBgYHtyfQpCTUlfbG9uZyAlPiUKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gQk1JKSkgKwogIHN0YXRfcXEoKSArIAogIHN0YXRfcXFfbGluZSgpICsKICBmYWNldF93cmFwKH4gWWVhciArIFJlZ2lvbikKYGBgCgpXZSBjYW4gc2VlIHRoYXQgYXQgdGhlIGV4dHJlbWVzIG9mIG91ciBxdWFudGlsZXMsIGZvciBtb3N0IG9mIG91ciBkYXRhLCBvdXIgdGFpbHMgYXJlIG5vdCB2ZXJ5IHNpbWlsYXIgdG8gdGhlIHRoZW9yZXRpY2FsIGRpc3RyaWJ1dGlvbi4gCldlIGNhbiBjYW4gYWxzbyBzZWUgdGhhdCBvdXIgZGF0YSBpcyByaWdodC0gb3IgcG9zaXRpdmUtc2tld2VkLCBiZWNhdXNlIHRoZSBleHRyZW1lIHZhbHVlcyBhcmUgYWJvdmUgdGhlIGxpbmUuCgpUaGUgcnVyYWwgZGF0YSBsb29rcyBtb3JlIG5vcm1hbCB0aGFuIHRoZSB1cmJhbiBkYXRhLiAKWW91IG1pZ2h0IGJlIGFza2luZywgd2h5IGRvIHdlIGNhcmUgaWYgdGhlIGRhdGEgbG9vayBtb3JlIG5vcm1hbCBvciBub3Q/IApJdCB0dXJucyBvdXQgaWYgeW91IHdhbnQgdG8gYXNrIHF1ZXN0aW9ucyBsaWtlICJJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmcm9tIHdvbWVuIGluIDE5ODUgY29tcGFyZWQgdG8gd29tZW4gaW4gMjAxNz8iLCB3ZSB3aWxsIG5lZWQgdG8gdXNlIHNvbWUgb2YgdHlwZSBvZiBzdGF0aXN0aWNhbCB0ZXN0LiAKVGhlIG1vc3QgY29tbW9ubHkgdXNlZCBzdGF0aXN0aWNhbCB0ZXN0cyB0aGF0IGNhbiBhbnN3ZXIgdGhhdCBxdWVzdGlvbiByZWx5IG9uIGFuIGFzc3VtcHRpb24gYWJvdXQgdGhlIGRhdGEgeW91IGhhdmUsIG5hbWVseSB0aGF0IHlvdXIgZGF0YSBoYXZlIGEgc2ltaWxhciBzaGFwZSBhcyBhIHRoZW9yZXRpY2FsIG5vcm1hbCBkaXN0cmlidXRpb24uIApTbywgaWYgd2Ugd2FudCB0byB1c2UgdGhvc2UgcG93ZXJmdWwgc3RhdGlzdGljYWwgdGVzdHMgdGhhdCByZWx5IG9uIHRoaXMgYXNzdW1wdGlvbiBvZiAibm9ybWFsaXR5IiwgdGhlbiB3ZSBuZWVkIHRvIGNoZWNrIHRoYXQgYXNzdW1wdGlvbiBiZWZvcmUgdXNpbmcgdGhvc2UgdGVzdHMuIAoKV2UgY2FuIGNvbmNsdWRlIGZyb20gdGhlc2UgcGxvdHMgdGhhdCB0aGUgYXNzdW1wdGlvbiBvZiBub3JtYWxpdHkgYXBwZWFycyB0byBiZSB2aW9sYXRlZCBpbiBvdXIgZGF0YS4KCgojIyBEYXRhIEFuYWx5c2lzCgpJbiB0aGUgcHJldmlvdXMgc2VjdGlvbiwgd2UgaGludGVkIGF0IHRoZSBleGlzdGVuY2Ugb2Ygc3RhdGlzdGljYWwgdGVzdHMgdG8gYmUgYWJsZSB0byBhc3Nlc3MgaWYgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGluIHRoZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZXMgYmV0d2VlbiB0d28gZ3JvdXBzIChlLmcuIG5hdGlvbmFsIEJNSSBlc3RpbWF0ZXMgaW4gcnVyYWwgYXJlYXMgYW5kIG5hdGlvbmFsIEJNSSBlc3RpbWF0ZXMgaW4gdXJiYW4gYXJlYXMpLiAKT25lIHN1Y2ggdGVzdCBpcyB0aGUgW1N0dWRlbnQncyAkdCQtdGVzdF0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj10d28tc2FtcGxlJTIwdC10ZXN0KXt0YXJnZXQ9Il9ibGFuayJ9LCB3aGljaCBjYW4gYmUgdXNlZCB0byBkZXRlcm1pbmUgaWYgW3R3byBncm91cCBtZWFucyBhcmUgZGlmZmVyZW50XShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvZXN0aW1hdGlvbi9kaWZmZXJlbmNlX21lYW5zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uCkhvd2V2ZXIsIGFzIG1lbnRpb25lZCBiZWZvcmUsIHRoaXMgdGVzdCBkZXBlbmRzIG9uIGNlcnRhaW4gYXNzdW1wdGlvbiBvZiBvdXIgZGF0YS4gCgpJbiB0aGlzIHNlY3Rpb24sIHdlIGFyZSBnb2luZyB0byB0YWxrIGFib3V0IHRoaXMgdGVzdCBhbmQgb3RoZXIgdGVzdHMgdGhhdCBkbyBub3QgcmVxdWlyZSB0aGUgc2FtZSBhc3N1bXB0aW9ucyBhYm91dCBvdXIgZGF0YS4gCgojIyMgSHlwb3RoZXNpcyB0ZXN0aW5nCgpMZXQncyByZW1pbmQgb3Vyc2VsdmVzIG9mIG9uZSBvZiBvdXIgb3JpZ2luYWwgcXVlc3Rpb25zLCAKCj4gSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8KCkluIGh5cG90aGVzaXMgdGVzdGluZywgd2UgYXJlIGludGVyZXN0ZWQgaW4gY29tcGFyaW5nIHR3byBkaWZmZXJlbnQgaHlwb3RoZXNlczogYSAibnVsbCIgaHlwb3RoZXNpcyAoY2FuIGJlIHRob3VnaHQgb2YgbGlrZSBhIGJhc2VsaW5lIGUuZy4gdGhlIG1lYW5zIGJldHdlZW4gdHdvIGdyb3VwcyBhcmUgdGhlIHNhbWUpIGNvbXBhcmVkIHRvIGFuICJhbHRlcm5hdGl2ZSIgaHlwb3RoZXNpcyAoZS5nLiB0aGUgbWVhbnMgYmV0d2VlbiB0d28gZ3JvdXBzIGFyZSBkaWZmZXJlbnQpLiBXZSBhcmUgZ29pbmcgdG8gYXNrIGlmIHRoZXJlIGlzIGVub3VnaCBldmlkZW5jZSBpbiBvdXIgZGF0YSB0byByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcy4gIAoKTGV0J3MgdHJ5IHRvIGZvcm1hbGl6ZSB0aGlzIGEgYml0LiAKClN1cHBvc2Ugd2Ugd2FudCB0byB0ZXN0IHdoZXRoZXIgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgdXNpbmcgdGhlIGRhdGEgZnJvbSAxOTg1LiAgSW4gb3VyIGNhc2UsIHRoZW4sIHdlIHdhbnQgdG8gdGVzdCB3aGV0aGVyIHRoZSBtZWFuIEJNSSBlc3RpbWF0ZSBhbW9uZyB0aGUgcnVyYWwgYXJlYXMgaXMgdGhlIHNhbWUgYXMgdGhlIG1lYW4gQk1JIGVzdGltYXRlIGluIHRoZSB1cmJhbiBhcmVhcy4gSWYgd2UgY2FsbCB0aGUgdHJ1ZSB1bmtub3duIG1lYW5zIG9mIHRoZSB0d28gZ3JvdXBzICRcbXVfVSQgYW5kICRcbXVfUiQsIGZvciB0aGUgdXJiYW4gYW5kIHJ1cmFsIGFyZWFzLCByZXNwZWN0aXZlbHksIHRoZW4gd2UgY2FuIGRlZmluZSB0aGUgPGI+bnVsbCBoeXBvdGhlc2lzPC9iPiB0aGF0IHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UgaW4gdGhlIHR3byBtZWFuczoKCiQkIEhfMDogXG11X1UgPSBcbXVfUiAkJCAgCgpJbiBjb250cmFzdCwgd2UgYWxzbyBkZWZpbmUgYW4gPGI+YWx0ZXJuYXRpdmUgaHlwb3RoZXNpczwvYj4gdGhhdCB0aGVyZSBpcyBhIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgbWVhbiBCTUkgZXNpbWF0ZXM6IAoKJCQgSF9hOiBcbXVfVSBcbmVxIFxtdV9SICQkCgpUaGUgaWRlYSBiZWhpbmQgYSBoeXBvdGhlc2lzIHRlc3QgaXMgdGhhdCB3ZSBhc3N1bWUgdGhlIG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlIGFuZCB3ZSB1c2Ugb3VyIGRhdGEgdG8gaGVscCB1cyBpZGVudGlmeSBpZiB0aGVyZSBpcyBlbm91Z2ggZXZpZGVuY2UgdG8gX3JlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzXy4gCgpUaGlzIGlzIHNpbWlsYXIgdG8gdGhlIGlkZWEgb2YgYXNzdW1pbmcgdGhhdCBpbmRpdmlkdWFscyBhcmUgbm90IGd1aWx0eSB1bnRpbCBwcm92ZW4gb3RoZXJ3aXNlLgpJZiB0aGVyZSBpcyBub3QgZW5vdWdoIGV2aWRlbmNlIGluIHRoZSBkYXRhLCB0aGVuIHdlIHNheSB3ZSAiZmFpbCB0byByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcyIuCgpZb3UgbWlnaHQgYmUgYXNraW5nLCAiQnV0IHdlIGRvIG5vdCBrbm93IHdoYXQgdGhlIHRydWUgZ3JvdXAgbWVhbnMgYXJlPyIgClRoYXQgaXMgY29ycmVjdC4gSW5zdGVhZCwgd2UgbXVzdCBlc3RpbWF0ZSB0aGVzZSBtZWFucyBiYXNlZCBvbiB0aGUgZGF0YSB0aGF0IHdlIGhhdmUuCkZvciBleGFtcGxlLCBpbiBvdXIgZGF0YSwgd2UgY2FuIGVzdGltYXRlIHRoZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZXMgZm9yIHdvbWVuIGluIHJ1cmFsIGFuZCB1cmJhbiByZWdpb25zIGluIDE5ODUuIEhlcmUgd2Ugd2lsbCB1c2UgdGhlIGBzdW1tYXJpemUoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYGRwbHlyYCBwYWNrYWdlIGFnYWluLCB0aGlzIHRpbWUgdXNpbmcgdGhlIGFyZ3VtZW50IGBuYS5ybSA9IFRSVUVgIHRvIHJlbW92ZSBOQSB2YWx1ZXMuCgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGZpbHRlcihZZWFyID09IDE5ODUsIFNleCA9PSAiV29tZW4iLCBSZWdpb24gIT0gIk5hdGlvbmFsIikgJT4lIAogIGdyb3VwX2J5KFJlZ2lvbikgJT4lCiAgc3VtbWFyaXplKGF2Z19ibWkgPSBtZWFuKEJNSSwgbmEucm0gPSBUUlVFKSkgCmBgYAoKSGVyZSB3ZSBzZWUgdGhhdCB0aGF0IGluIDE5ODUsIHRoZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZSBmb3Igd29tZW4gYWNyb3NzIHVyYmFuIGFyZWFzIGlzIDI0LjYgY29tcGFyZWQgdG8gMjMuNiBhY3Jvc3MgcnVyYWwgYXJlYXMuICBJdCBsb29rcyBsaWtlIEJNSSBlc3RpbWF0ZXMgYXJlLCBvbiBhdmVyYWdlLCBoaWdoZXIgaW4gdXJiYW4gYXJlYXMgY29tcGFyZWQgdG8gcnVyYWwgYXJlYXMuICBIb3dldmVyLCBub3cgd2Ugd2FudCB0byB1c2UgYSBzdGF0aXN0aWNhbCB0ZXN0IHRvIGFzc2VzcyBpZiB0aGlzIGRpZmZlcmVuY2UgaXMgc3RhdGlzdGljYWxseSBtZWFuaW5nZnVsIG9yIGEgZGlmZmVyZW5jZSBvZiB0aGlzIHNpemUgY291bGQgYmUgZm91bmQgZHVlIHRvIHJhbmRvbSBjaGFuY2UuIAoKIyMjIFR3by1zYW1wbGUgdC10ZXN0CgpUaGUgdHdvLXNhbXBsZSAkdCQtdGVzdCBpcyBhIGNvbW1vbiB3YXkgdG8gZGV0ZXJtaW5lIGlmIHRoZSBtZWFucyBvZiB0d28gZ3JvdXBzIGFyZSBkaWZmZXJlbnQuIEl0IGRvZXMgdGhpcyBieSBjYWxjdWxhdGluZyBhIG9ic2VydmVkIHRlc3Qtc3RhdGlzdGljLCAkdCQsIHRoYXQgbG9va3MgYXQgdGhlIGRpZmZlcmVuY2UgaW4gdGhlIHNhbXBsZSBtZWFucyBvZiB0aGUgdHdvIGdyb3VwcyBkaXZpZGVkIGJ5IGFuIGVzdGltYXRlIG9mIHRoZSB2YXJpYWJpbGl0eSBpbiB0aGUgZGlmZmVyZW5jZSBpbiBzYW1wbGUgbWVhbnMuICBIZXJlICRzX3twb29sZWR9JCBpcyBzdGFuZGFyZCBkZXZpYXRpb24gb2YgdGhlIGRhdGEgd2hlbiBwb29saW5nIHRoZSBzYW1wbGVzIHRvZ2V0aGVyLgokJAp0ID0gXGZyYWN7XGJhcntYfV9VLVxiYXJ7WH1fUn17c197cG9vbGVkfVxzcXJ0e1xmcmFjezF9e25fVX0gKyBcZnJhY3sxfXtuX1J9fX0KJCQKSWYgdGhlIG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlLCBhbmQgdGhlIG1lYW5zIGZvciB1cmJhbiBhbmQgcnVyYWwgYXJlYXMgYXJlIHRoZSBzYW1lLCB0aGVuIHRoZSBzYW1wbGUgbWVhbnMgaW4gdGhlIG51bWVyYXRvciB3aWxsIGJlIHNpbWlsYXIgYW5kIHRoaXMgdGVzdCBzdGF0aXN0aWMgd2lsbCBiZSBjbG9zZSB0byAwLiAgSG93ZXZlciwgaWYgdGhlIHRlc3Qgc3RhdGlzdGljIGlzIG5vdCBjbG9zZSB0byAwLCB0aGlzIHByb3ZpZGVzIGV2aWRlbmNlIHRoZSBtZWFucyBmb3IgdGhlIHVyYmFuIGFuZCBydXJhbCBhcmVhcyBhcmUgZGlmZmVyZW5jZSwgYW5kIHNvIHdlIG1heSBjaG9vc2UgdG8gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMuICAKClRvIGZvcm1hbGx5IGRlY2lkZSB3aGV0aGVyIHRvIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzLCB3ZSBjb21wYXJlIHRoZSBvYnNlcnZlZCB0ZXN0IHN0YXRpc3RpYyB0byB0aGUgZGlzdHJpYnV0aW9uIG9mIHBvc3NpYmxlIHRlc3Qgc3RhdGlzdGljcyB0aGF0IGNvdWxkIG9jY3VyIGlmIHRoZSBudWxsIGh5cG90aGVzaXMgd2VyZSB0cnVlIHVzaW5nIHdoYXQgd2UgY2FsbCBhICoqcC12YWx1ZSoqLiAgVGhlIHAtdmFsdWUgdGVsbHMgdXMgdGhlIHByb2JhYmlsaXR5IG9mIG9ic2VydmluZyBhIHRlc3Qgc3RhdGlzdGljIGFzIG9yIG1vcmUgZXh0cmVtZSB0aGFuIHRoZSBvbmUgd2Ugb2JzZXJ2ZWQgaWYgdGhlIG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlLiAgSWYgdGhlIHAtdmFsdWUgaXMgc21hbGwsIHNheSBsZXNzIHRoYW4gMC4wNSwgdGhlbiBvdXIgb2JzZXJ2ZWQgdGVzdCBzdGF0aXN0aWMgaXMgcHJldHR5IHJhcmUgaWYgdGhlIG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlLiAgVGhpcyB3b3VsZCBsZWFkIHVzIHRvIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzIGFuZCBjb25jbHVkZSB0aGF0IHRoZSBtZWFucyBvZiB0aGUgdHdvIGdyb3VwcyBhcmUgZGlmZmVyZW50LiBXZSB3aWxsIHRhbGsgbW9yZSBhYm91dCBwLXZhbHVlcywgYW5kIGluIHBhcnRpY3VsYXIgb3VyIGNob2ljZSBvZiAwLjA1IGFzIGEgY29tcGFyaXNvbiBmb3IgdGhlIHAtdmFsdWUsIGEgbGl0dGxlIGxhdGVyLgoKSGVyZSB3ZSBwZXJmb3JtIGEgdHdvLXNhbXBsZSAkdCQtdGVzdCBjb21wYXJpbmcgZXN0aW1hdGUgZm9yIHJ1cmFsIHdvbWVuIGluIDE5ODUgdG8gZXN0aW1hdGVzIGZvciB1cmJhbiB3b21lbiBpbiAxOTg1LiAgV2UgdXNlIHRoZSBgdmFyLmVxdWFsID0gVFJVRWAgb3B0aW9uIGhlcmUgdG8gdXNlIHRoZSBwb29sZWQgc3RhbmRhcmQgZGV2aWF0aW9uICRzX3twb29sZWR9JCBmcm9tIHRoZSBmb3JtdWxhIGFib3ZlLgpgYGB7cn0KdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwgCiAgICAgICB2YXIuZXF1YWwgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwpgYGAKCkluIHRoaXMgY2FzZSB0aGUgcC12YWx1ZSBmb3IgdGhlIHRlc3QgaXMgMC4wMDAxMiwgd2hpY2ggaXMgcXVpdGUgc21hbGwuICBIZXJlIHdvdWxkIHdvdWxkIHJlamVjdCB0aGUgbnVsbCBoeXB0aGVzaXMgdGhhdCB0aGUgbWVhbnMgaW4gdGhlIHR3byBncm91cHMgYXJlIGVxdWFsIGFuZCBjb25jbHVkZSB0aGVyZSBhcmUgZGlmZmVyZW5jZXMgaW4gbWVhbiBCTUkgZXN0aW1hdGVzIGZvciB3b21lbiBpbiB1cmJhbiBhbmQgcnVyYWwgYXJlYXMuICAKCkJ1dCB3YWl0ISAgV2UgbmVlZCB0byBjaGVjayB0aGUgYXNzdW1wdGlvbnMgb2YgdGhlIHN0YXRpc3RpY2FsIHRlc3Qgd2UgdXNlZCB0byBiZSBzdXJlIGl0IGlzIHZhbGlkLiAgVGhlIHR3by1zYW1wbGUgJHQkLXRlc3QgcmVsaWVzIG9uIHNldmVyYWwgPHU+PGI+YXNzdW1wdGlvbnM8L2I+PC91PjoKCjEpIFRoZSBkYXRhIGZvciBlYWNoIGdyb3VwIGlzIFtub3JtYWxseSBkaXN0cmlidXRlZF0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uCjIpIFRoZSBbdmFyaWFuY2VdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dmFyaWFuY2Upe3RhcmdldD0iX2JsYW5rIn0gb2YgYm90aCBncm91cHMgaXMgc2ltaWxhci4KMykgVGhlIG9ic2VydmF0aW9ucyBmcm9tIHRoZSB0d28gZ3JvdXBzIGFyZSBbaW5kZXBlbmRlbnRdKGh0dHBzOi8vd3d3LnN0YXQuY211LmVkdS9+Y3NoYWxpemkvMzYtMjIwL2xlY3R1cmUtNS5wZGYpe3RhcmdldD0iX2JsYW5rIn0gKG1lYW5pbmcgdGhhdCBvYnNlcnZhdGlvbnMgZG8gbm90IGluZmx1ZW5jZSBlYWNoIG90aGVyKS4KNCkgVGhlIG9ic2VydmF0aW9ucyB3aXRoaW4gZWFjaCBncm91cCBhcmUgW2luZGVwZW5kZW50XShodHRwczovL3d3dy5zdGF0LmNtdS5lZHUvfmNzaGFsaXppLzM2LTIyMC9sZWN0dXJlLTUucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IChtZWFuaW5nIHRoYXQgb2JzZXJ2YXRpb25zIGRvIG5vdCBpbmZsdWVuY2UgZWFjaCBvdGhlcikuCgoKSWYgdGhlc2UgYXNzdW1wdGlvbnMgYXJlIHZpb2xhdGVkLCB0aGlzIGRvZXNuJ3QgbmVjZXNzYXJpbHkgbWVhbiB3ZSBjYW4ndCBwZXJmb3JtIGEgc3RhdGlzdGljYWwgdGVzdC4gSXQganVzdCBtZWFucyB3ZSBtYXkgbmVlZCB0byBjb25zaWRlciB0aGUgZm9sbG93aW5nIG9wdGlvbnM6CgoxKSBJZiB0aGUgZGF0YSBpc24ndCBub3JtYWxseSBkaXN0cmlidXRlZCwgd2UgbWF5IG5lZWQgdG8gY29uc2lkZXIgZWl0aGVyIGEgW3RyYW5zZm9ybWF0aW9uXShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS90cmFuc2Zvcm1hdGlvbi1zdGF0aXN0aWNzLyl7dGFyZ2V0PSJfYmxhbmsifSBvZiB0aGUgZGF0YSB0byBtYWtlIGl0IG1vcmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgb3IgYSBbbm9ucGFyYW1ldHJpY10oaHR0cHM6Ly93d3cubWF5by5lZHUvcmVzZWFyY2gvZG9jdW1lbnRzL3BhcmFtZXRyaWMtYW5kLW5vbnBhcmFtZXRyaWMtZGVteXN0aWZ5aW5nLXRoZS10ZXJtcy9kb2MtMjA0MDg5NjApe3RhcmdldD0iX2JsYW5rIn0gdGVzdCB3aGljaCBkb2Vzbid0IHJlbHkgb24gdGhlIG5vcm1hbGl0eSBhc3N1bXB0aW9uLgoyKSBJZiB0aGUgdmFyaWFuY2VzIG9mIHRoZSB0d28gZ3JvdXBzIGFyZW4ndCBzaW1pbGFyLCB3ZSBjYW4gdG8gYSBbV2VsY2gncyAkdCQtdGVzdF0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vd2VsY2hzLXRlc3QtZm9yLXVuZXF1YWwtdmFyaWFuY2VzLyl7dGFyZ2V0PSJfYmxhbmsifSAoYWxzbyBjYWxsZWQgdGhlIHVuZXF1YWwgdmFyaWFuY2UgJHQkLXRlc3QpIHRvIGFjY291bnQgZm9yIGRpZmZlcmVuY2UgdmFyaWFuY2VzLiAgVGhpcyBtb2RpZmllcyB0aGUgZGVub21pbmF0b3Igb2YgdGhlIHRlc3Qgc3RhdGlzdGljIHRvIG5vIGxvbmdlciB1c2UgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBmcm9tIHBvb2xpbmcgdGhlIHNhbXBsZXMuICBXZSBjYW4gZG8gdGhpcyBpbiBgUmAgYnkgdXNpbmcgdGhlIGB2YXIuZXF1YWwgPSBUUlVFYCBvcHRpb24gaW4gdGhlIGB0LnRlc3QoKWAgZnVuY3Rpb24uCjMpIElmIHRoZSBkYXRhIGluIHRoZSB0d28gc2FtcGxlcyBhcmUgbm90IGluZGVwZW5kZW50IGFuZCBhcmUgaW5zdGVhZCB3aGF0IHdlIGNhbGwgcGFpcmVkLCB3ZSBzaG91bGQgdXNlIHRoZSBbUGFpcmVkICR0JC10ZXN0XShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM1NTc5NDY1Lyl7dGFyZ2V0PSJfYmxhbmsifS4KNCkgSWYgdGhlIGRhdGEgd2l0aGluIGEgZ3JvdXAgaXMgbm90IGluZGVwZW5kZW50LCB3ZSB3b3VsZCBuZWVkIHRvIGNvbnNpZGVyIG1ldGhvZHMgYmV5b25kIHRoZSBzY29wZSBvZiB0aGlzIGNhc2Ugc3R1ZHkuCgpBcmUgdGhlc2UgYXNzdW1wdGlvbnMgbWV0IGluIG91ciBjYXNlPyAgV2UndmUgYWxyZWFkeSBzZWVuLCB1c2luZyBRLVEgcGxvdHMsIHRoYXQgdGhlc2UgQk1JIGVzdGltYXRlcyBtYXkgbm90IGJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLiAgV2UgaGF2ZW4ndCBjaGVja2VkIHRoZSBhc3N1bXB0aW9uIG9mIGVxdWFsIHZhcmlhbmNlIHlldC4gIEJ1dCBpdCBzZWVtcyBjbGVhciB0aGF0IHRoZSBsYXN0IGFzc3VtcHRpb24gKG9mIGluZGVwZW5kZW50IHNhbXBsZXMpIGlzIHZpb2xhdGVkIGluIG91ciBjYXNlISAgVGhlIEJNSSBkYXRhIGZvciBydXJhbCBhcmVhcyBjb21lcyBmcm9tIHRoZSBzYW1lIGNvdW50cmllcyBhbmQgdGhlIEJNSSBkYXRhIGZvciB1cmJhbiBhcmVhcywgbWVhbmluZyB0aGUgc2FtcGxlcyBhcmUgbm90IGluZGVwZW5kZW50IGFuZCBhcmUgaW5zdGVhZCB3aGF0IHdlIGNhbGwgW3BhaXJlZF0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wbWMvYXJ0aWNsZXMvUE1DNTU3OTQ2NS8pe3RhcmdldD0iX2JsYW5rIn0uIFdlIG5lZWQgdG8gYWNjb3VudCBmb3IgdGhpcyBiZWNhdXNlIHBhaXJlZCB2YWx1ZXMgbWF5IGJlIG1vcmUgc2ltaWxhciB0byBvbmUgYW5vdGhlciBiZWNhdXNlIHRoZXkgY29tZSBmcm9tIHRoZSBzYW1lIGNvdW50cnkuIE5vdGUgdGhhdCB0aGlzIHdvdWxkIGFsc28gYmUgdHJ1ZSBmb3IgdGhlIG1hbGUgYW5kIGZlbWFsZSBtZWFzdXJlbWVudHMgZnJvbSB0aGUgc2FtZSBjb3VudHJ5IG9yIHRoZSB2YWx1ZXMgaW4gdGhlIHNhbWUgY291bnRyaWVzIGZyb20gMTk4NSBhbmQgbGF0ZXIgaW4gMjAxNy4gCgojIyMgUGFpcmVkIHQtdGVzdAoKV2hlbiB3ZSBwZXJmb3JtIGEgcGFpcmVkICR0JC10ZXN0LCBpbnN0ZWFkIG9mIGxvb2tpbmcgYXQgdGhlIG1lYW5zIG9mIHRoZSB0d28gc2FtcGxlcyBzZXBhcmF0ZWx5LCB3ZSBjb21iaW5lIG9ic2VydmF0aW9ucyBpbiBhIHBhaXIgKGZyb20gdGhlIHNhbWUgY291bnRyeSBpbiBvdXIgY2FzZSkgdG8gY2FsY3VsYXRlIGEgZGlmZmVyZW5jZSBpbiB2YWx1ZXMgYmV0d2VlbiB0aGUgdHdvIHNhbXBsZXMuICBGb3IgZXhhbXBsZSwgd2UgYXJlIHJlYWxseSB0ZXN0aW5nIHRoZSBgYm1pX2RpZmZgIGNvbHVtbiBpbiB0aGUgZGF0YSBiZWxvdzoKYGBge3J9CkJNSV9sb25nICU+JSAKICBmaWx0ZXIoWWVhciA9PSAxOTg1LCBTZXggPT0gIldvbWVuIiwgUmVnaW9uICE9ICJOYXRpb25hbCIpICU+JSAKICBncm91cF9ieShDb3VudHJ5KSAlPiUKICBzdW1tYXJpemUoYm1pX3J1cmFsID0gQk1JW1JlZ2lvbiA9PSAiUnVyYWwiXSwKICAgICAgICAgICAgYm1pX3VyYmFuID0gQk1JW1JlZ2lvbiA9PSAiVXJiYW4iXSwKICAgICAgICAgICAgYm1pX2RpZmYgPSBibWlfcnVyYWwgLSBibWlfdXJiYW4pIApgYGAKClRoaXMgbWVhbnMgb3VyIGh5cG90aGVzZXMgYXJlIHNsaWdodGx5IGRpZmZlcmVudCBmcm9tIHRoZSB0d28tc2FtcGxlICR0JC10ZXN0LiBJbiB0aGlzIGNhc2Ugd2UgYXJlIHRlc3RpbmcgdGhlIGRpZmZlcmVuY2VzIGFtb25nIHRoZSBwYWlycyBvZiBvYnNlcnZhdGlvbnMgYW5kIGhvdyBjbG9zZSB0aGVzZSBkaWZmZXJlbmNlcyBhcmUgdG8gemVyby4gKEEgbWVhbiBkaWZmZXJlbmNlIG9mIHplcm8gd291bGQgbWVhbiB0aGUgQk1JIGVzdGltYXRlcyBhcmUgdGhlIHNhbWUgaW4gdGhlIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcy4pIElmIHdlIGxldCAkXG11X2QkIHJlcHJlc2VudCB0aGUgdHJ1ZSBtZWFuIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgcGFpcmVkIG9ic2VydmF0aW9ucyBvZiB0aGUgdHdvIGdyb3VwcywgdGhlbiBvdXIgbnVsbCBoeXBvdGhlc2lzIGlzIHRoYXQgdGhlIG1lYW4gb2YgdGhlIGRpZmZlcmVuY2VzIGlzIGVxdWFsIHRvIHplcm86CiQkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIXzAgOiBcbXVfZCA9IDAKJCQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgpBbmQgdGhlIGFsdGVybmF0aXZlIGh5cG90aGVzaXMgaXMgdGhhdCB0aGUgbWVhbiBvZiB0aGUgZGlmZmVyZW5jZXMgaXMgbm90IGVxdWFsIHRvIHplcm86CiQkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIX2EgOiBcbXVfZCBcbmVxIDAKJCQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAoKV2UgY2FuIHBlcmZvcm0gYSBwYWlyZWQgJHQkLXRlc3QgYnkgYWRkaW5nIHRoZSBvcHRpb24gYHBhaXJlZCA9IFRSVUVgIHRvIHRoZSBgdC50ZXN0KClgIGNvbW1hbmQuICBOb3RlIHRoYXQgd2UgZG9uJ3QgbmVlZCB0byBzcGVjaWZ5IGFueXRoaW5nIGFib3V0IGVxdWFsaXR5IG9mIHZhcmlhbmNlcyBub3csIGJlY2F1c2UgdGhlcmUgaXMgb25seSBvbmUgdmFyaWFuY2UsIHRoZSB2YXJpYW5jZSBvZiB0aGUgcGFpcmVkIGRpZmZlcmVuY2VzIQpgYGB7cn0KdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwgCiAgICAgICBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwpgYGAKCiMjIyMgey5xdWVzdGlvbl9ibG9ja30KPHU+UXVlc3Rpb24gb3Bwb3J0dW5pdHk6PC91PiAKTG9va2luZyBhdCB0aGUgdCB2YWx1ZSwgd2FzIGdsb2JhbCBCTUkgbG93ZXIgaW4gUnVyYWwgb3IgVXJiYW4gYXJlYXMgaW4gMTk4NT8KCiMjIyMKCkxldCdzIGNvbWUgYmFjayB0byB0aGUgb3RoZXIgJHQkLXRlc3QgYXNzdW1wdGlvbnMgbm93LiAgV2l0aCBhIHBhaXJlZCAkdCQtdGVzdCwgd2Ugbm8gbG9uZ2VyIG5lZWQgdG8gYXNzZXNzIHRoZSBhc3N1bXB0aW9uIGFib3V0IGVxdWFsIHZhcmlhbmNlLCBzaW5jZSB3ZSBhcmUgcmVhbGx5IHRlc3RpbmcgdGhlIG1lYW4gb2Ygb25lIHNhbXBsZSAob2YgcGFpcmVkIGRpZmZlcmVuY2VzKSByYXRoZXIgdGhhbiBjb21wYXJpbmcgdHdvIHNhbXBsZXMuICBIb3dldmVyLCB3ZSBzdGlsbCBoYXZlIHRvIGNoZWNrIG5vcm1hbGl0eSBhbmQgaW5kZXBlbmRlbmNlIG9mIG9ic2VydmF0aW9ucy4gIFdlIGNhbiByZXBocmFzZSB0aGVzZSBub3cgdG8gYmUgYWJvdXQgdGhlIHBhaXJlZCBkaWZmZXJlbmNlcyByYXRoZXIgdGhhbiB0aGUgdHdvIHNlcGFyYXRlIHNhbXBsZXM6CgoxKSBUaGUgcGFpcmVkIGRpZmZlcmVuY2VzIGFyZSBbbm9ybWFsbHkgZGlzdHJpYnV0ZWRdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9pbnRyb2R1Y3Rpb24vZGlzdHJpYnV0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LgoyKSBUaGUgcGFpcmVkIGRpZmZlcmVuY2VzIGFyZSBbaW5kZXBlbmRlbnRdKGh0dHBzOi8vd3d3LnN0YXQuY211LmVkdS9+Y3NoYWxpemkvMzYtMjIwL2xlY3R1cmUtNS5wZGYpe3RhcmdldD0iX2JsYW5rIn0gKG1lYW5pbmcgdGhhdCBvYnNlcnZhdGlvbnMgZG8gbm90IGluZmx1ZW5jZSBlYWNoIG90aGVyKS4KCklmIHdlIGFzc3VtZSB0aGF0IG1lYXN1cmVtZW50cyBiZXR3ZWVuIGRpZmZlcmVudCBjb3VudHJpZXMgYXJlIGluZGVwZW5kZW50LCB0aGlzIHNlY29uZCBhc3N1bXB0aW9uIGlzIG5vdCB2aW9sYXRlZC4gIFRoZXJlZm9yZSwgd2Ugb25seSBub3cgbmVlZCB0byBjaGVjayBub3JtYWxpdHkgb2YgdGhlc2UgcGFpcmVkIGRpZmZlcmVuY2VzLgoKV2UgY2FuIHN0YXJ0IGJ5IG1ha2luZyBhIFEtUSBwbG90IG9mIHRoZSBwYWlyZWQgZGlmZmVyZW5jZXMuCmBgYHtyfQpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFllYXIgPT0gMTk4NSwgU2V4ID09ICJXb21lbiIsIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUgCiAgZ3JvdXBfYnkoQ291bnRyeSkgJT4lCiAgc3VtbWFyaXplKGJtaV9ydXJhbCA9IEJNSVtSZWdpb24gPT0gIlJ1cmFsIl0sCiAgICAgICAgICAgIGJtaV91cmJhbiA9IEJNSVtSZWdpb24gPT0gIlVyYmFuIl0sCiAgICAgICAgICAgIGJtaV9kaWZmID0gYm1pX3J1cmFsIC0gYm1pX3VyYmFuKSAgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBibWlfZGlmZikpICsKICBzdGF0X3FxKCkgKwogIHN0YXRfcXFfbGluZSgpCmBgYAoKV2Ugc2VlIHRoYXQgdGhlc2UgcGFpcmVkIGRpZmZlcmVuY2VzIGRvIG5vdCBhcHBlYXIgdG8gYmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQgYmVjYXVzZSB0aGUgcG9pbnRzIGRvIG5vdCBsaWUgb24gdGhlIHN0cmFpZ2h0IGxpbmUuICBXZSBjYW4gYWxzbyBzZWUgdGhpcyBieSBtYWtpbmcgYSBoaXN0b2dyYW0gb2YgdGhlc2UgcGFpcmVkIGRpZmZlcmVuY2VzOgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGZpbHRlcihZZWFyID09IDE5ODUsIFNleCA9PSAiV29tZW4iLCBSZWdpb24gIT0gIk5hdGlvbmFsIikgJT4lIAogIGdyb3VwX2J5KENvdW50cnkpICU+JQogIHN1bW1hcml6ZShibWlfcnVyYWwgPSBCTUlbUmVnaW9uID09ICJSdXJhbCJdLAogICAgICAgICAgICBibWlfdXJiYW4gPSBCTUlbUmVnaW9uID09ICJVcmJhbiJdLAogICAgICAgICAgICBibWlfZGlmZiA9IGJtaV9ydXJhbCAtIGJtaV91cmJhbikgICU+JQogIGdncGxvdChhZXMoeCA9IGJtaV9kaWZmKSkgKwogIGdlb21faGlzdG9ncmFtKCkKYGBgCgpUaGlzIGhpc3RvZ3JhbSBhcHBlYXJzIHRvIHNob3cgc2hvdyBhIGJpbW9kYWwgZGlzdHJpYnV0aW9uLCBtZWFuaW5nIHR3byBncm91cHMgb2YgY291bnRyaWVzIC0tIG1vc3QgY291bnRyaWVzIGhhdmUgYSBydXJhbCBCTUkgZXN0aW1hdGVzIGxvd2VyIHRoYW4gdXJiYW4gQk1JIGVzdGltYXRlcyAoYGJtaV9kaWZmYCA8IDApLCB3aGlsZSBhIHNtYWxsZXIgZ3JvdXAgb2YgY291bnRyaWVzIGhhdmUgdXJiYW4gQk1JIGVzaW1hdGVzIGhpZ2hlciB0aGFuIHVyYmFuIEJNSSBlc3RpbWF0ZXMgKGBibWlfZGlmZmAgPjApLgoKRmlyc3Qgd2Ugd2lsbCB0cnkgdHJhbnNmb3JtIG91ciBkYXRhIHRvIG1ha2UgaXQgbW9yZSBub3JtYWxseSBkaXN0cmlidXRlZC4gT25lIHdheSB0byBkbyB0aGlzIGlzIHRvIHRha2UgdGhlIGxvZ2FyaXRobSBvZiB0aGUgZGF0YSB2YWx1ZXMuIExvZ2FyaXRobXMgbWFrZSBleHRyZW1lIHZhbHVlcyBsZXNzIGV4dHJlbWUsIHNvIGNhbiBiZSBoZWxwZnVsIHdoZW4gZGF0YSBoYXMgYSByaWdodCBza2V3LgoKYGBge3J9CiMgY3JlYXRlIGEgbmV3IGRhdGFzZXQgd2l0aCB0aGUgcGFpcmVkIGRpZmZlcmVuY2VzCiMgY3JlYXRlIGEgbG9nIHZlcnNpb24gb2YgdGhlIGRpZmZlcmVuY2UgdmFyaWFibGUgdXNpbmcgbXV0YXRlKCkKQk1JX2RpZmZfbG9nIDwtIEJNSV9sb25nICU+JQogIGZpbHRlcihZZWFyID09IDE5ODUsIFNleCA9PSAiV29tZW4iLCBSZWdpb24gIT0gIk5hdGlvbmFsIikgJT4lIAogIGdyb3VwX2J5KENvdW50cnkpICU+JQogIHN1bW1hcml6ZShibWlfcnVyYWwgPSBCTUlbUmVnaW9uID09ICJSdXJhbCJdLAogICAgICAgICAgICBibWlfdXJiYW4gPSBCTUlbUmVnaW9uID09ICJVcmJhbiJdLAogICAgICAgICAgICBibWlfZGlmZiA9IGJtaV9ydXJhbCAtIGJtaV91cmJhbikgJT4lICAKICBtdXRhdGUobG9nX2RpZmY9bG9nKGJtaV9kaWZmKSkKYGBgCgpOb3RpY2UgdGhlIHdhcm5pbmcgbWVzc2FnZSB0aGF0IGBJbiBsb2coYm1pX2RpZmYpIDogIE5hTnMgcHJvZHVjZWRgLiAgVGhpcyBpcyBiZWNhdXNlIHNvbWUgb2Ygb3VyIGRpZmZlcmVuY2VzIHdlcmUgbGVzcyB0aGFuIHplcm8sIGFuZCB0aGUgbG9nYXJpdGhtIG9mIGEgbmVnYXRpdmUgbnVtYmVyIGlzIG5vdCBkZWZpbmVkLiAgV2UgY2FuIGZpeCB0aGlzIGlzc3VlIGJ5IGFkZGluZyB0aGUgc2FtZSBwb3NpdGl2ZSBudW1iZXIsIHNheSA1LCB0byBlYWNoIGRpZmZlcmVuY2UgYmVmb3JlIHRha2luZyB0aGUgbG9nYXJpdGhtOgpgYGB7cn0KQk1JX2RpZmZfbG9nIDwtIEJNSV9sb25nICU+JQogIGZpbHRlcihZZWFyID09IDE5ODUsIFNleCA9PSAiV29tZW4iLCBSZWdpb24gIT0gIk5hdGlvbmFsIikgJT4lIAogIGdyb3VwX2J5KENvdW50cnkpICU+JQogIHN1bW1hcml6ZShibWlfcnVyYWwgPSBCTUlbUmVnaW9uID09ICJSdXJhbCJdLAogICAgICAgICAgICBibWlfdXJiYW4gPSBCTUlbUmVnaW9uID09ICJVcmJhbiJdLAogICAgICAgICAgICBibWlfZGlmZiA9IGJtaV9ydXJhbCAtIGJtaV91cmJhbikgJT4lICAKICBtdXRhdGUobG9nX2RpZmY9bG9nKGJtaV9kaWZmICsgNSkpCmBgYAoKTGV0J3MgbG9vayBhdCBhIFEtUSBwbG90IGFuZCBoaXN0b2dyYW0gb2YgdGhpcyB0cmFuc2Zvcm1lZCBkYXRhOgpgYGB7cn0KQk1JX2RpZmZfbG9nICU+JSAKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IGxvZ19kaWZmKSkgKwogIHN0YXRfcXEoKSArCiAgc3RhdF9xcV9saW5lKCkKCkJNSV9kaWZmX2xvZyAlPiUgCiAgZ2dwbG90KGFlcyh4ID0gbG9nX2RpZmYpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKQpgYGAKClRoZSB0cmFuc2Zvcm1lZCBkYXRhIHN0aWxsIGRvZXMgbm90IGFwcGVhciB0byBiZSBub3JtYWxseSBkaXN0cmlidXRlZCBhbmQgdGhlIGJpbW9kYWwgbmF0dXJlIG9mIHRoZSBkaXN0cmlidXRpb24gaXMgc3RpbGwgYXBwYXJlbnQgaW4gdGhlIGhpc3RvZ3JhbS4gIFdoYXQgc2hvdWxkIHdlIGRvPyAgVGhlICR0JC10ZXN0IGlzIGZhaXJseSAqKnJvYnVzdCoqIHRvIHZpb2xhdGlvbnMgb2YgdGhlIG5vcm1hbGl0eSBhc3N1bXB0aW9uIGlmIHRoZSBzYW1wbGUgc2l6ZSBpcyByZWxhdGl2ZWx5IGxhcmdlLCBkdWUgdG8gd2hhdCBpcyBjYWxsZWQgdGhlIFtjZW50cmFsIGxpbWl0IHRoZW9yZW1dKGh0dHBzOi8vd3d3LmFuYWx5dGljc3ZpZGh5YS5jb20vYmxvZy8yMDE5LzA1L3N0YXRpc3RpY3MtMTAxLWludHJvZHVjdGlvbi1jZW50cmFsLWxpbWl0LXRoZW9yZW0vKXt0YXJnZXQ9Il9ibGFuayJ9LCB3aGljaCBzdGF0ZXMgdGhhdCBhcyBzYW1wbGVzIGdldCBsYXJnZXIsIHRoZSBzYW1wbGUgbWVhbiBoYXMgYW4gYXBwcm94aW1hdGUgbm9ybWFsIGRpc3RyaWJ1dGlvbi4gIAoKV2l0aCBvdXIgc2FtcGxlIHNpemUgb2YgMjAwLCB3ZSBjb3VsZCBjb25zaWRlciB1c2luZyB0aGUgcGFpcmVkICR0JC10ZXN0IGV2ZW4gd2l0aCBvdXIgbm9uLW5vcm1hbCBkYXRhLiAgSG93ZXZlciwgaWYgd2UgaGFkIGEgc21hbGxlciBzYW1wbGUsIHdlIG1pZ2h0IHN0aWxsIG5lZWQgdG8gY29uc2lkZXIgYW5vdGhlciBhbHRlcm5hdGl2ZSBzaW5jZSB0aGUgbG9nLXRyYW5zZm9ybWVkIGRhdGEgc3RpbGwgZG9lc24ndCBsb29rIG5vcm1hbC4gIFdlIG1pZ2h0IHdhbnQgdG8gY29uc2lkZXIgYSBub24tcGFyYW1ldHJpYyB0ZXN0IGluIHRoYXQgY2FzZS4KCiMjIyBOb25wYXJhbWV0cmljIHRlc3RzCgpXaGVuIHRoZSBub3JtYWxpdHkgYXNzdW1wdGlvbiBvZiBhIHBhaXJlZCAkdCQtdGVzdCBpcyB2aW9sYXRlZCwgd2UgY2FuIGNvbnNpZGVyIGEgbm9ucGFyYW1ldHJpYyBhbHRlcm5hdGl2ZSBpbnN0ZWFkLiAgV2hhdCdzIGEgbm9uLXBhcmFtZXRyaWMgdGVzdD8gIDxiPlBhcmFtZXRyaWMgdGVzdHM8L2I+IGFyZSBiYXNlZCBvbiBhc3N1bXB0aW9ucyBhYm91dCB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHdoaWxlIDxiPm5vbnBhcmFtZXRyaWMgdGVzdHM8L2I+IGRvIG5vdCByZWx5IG9uIHRoZXNlIGRpc3RyaWJ1dGlvbmFsIGFzc3VtcHRpb25zLiAKClNlZSBbaGVyZV0oaHR0cHM6Ly93d3cubWF5by5lZHUvcmVzZWFyY2gvZG9jdW1lbnRzL3BhcmFtZXRyaWMtYW5kLW5vbnBhcmFtZXRyaWMtZGVteXN0aWZ5aW5nLXRoZS10ZXJtcy9kb2MtMjA0MDg5NjApe3RhcmdldD0iX2JsYW5rIn0gZm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGVzZSB0d28gY2xhc3NlcyBvZiB0ZXN0cy4KClRoZSBub25wYXJhbWV0cmljIGFsdGVybmF0aXZlIHRvIHRoZSBwYWlyZWQgJHQkLXRlc3QgaXMgY2FsbGVkIHRoZSBbV2lsY294b24gc2lnbmVkLXJhbmsgdGVzdF0oaHR0cDovL3d3dy5iaW9zdGF0aGFuZGJvb2suY29tL3dpbGNveG9uc2lnbmVkcmFuay5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LiAgVGhpcyB0ZXN0IGRvZXNuJ3QgcmVxdWlyZSB0aGUgc2FtZSBub3JtYWxpdHkgYXNzdW1wdGlvbiBhcyB0aGUgJHQkLXRlc3QsIHNvIGNhbiBiZSBjb25zaWRlcmVkIHdpdGggdGhlIGRhdGEgZG9lcyBub3QgYXBwZWFyIHRvIGJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGFuZCBwYXJ0aWN1bGFybHkgd2hlbiB0aGUgbnVtYmVyIG9mIHNhbXBsZXMgaXMgbG93LiBUaGUgbnVsbCBoeXBvdGhlc2lzIGZvciB0aGlzIHRlc3QgaXMgdGhhdCB0aGUgKiptZWRpYW4qKiBvZiB0aGUgcGFpcmVkIGRpZmZlcmVuY2VzIGlzIDAuCgpUbyBkbyBhIFdpbGNveG9uIHRlc3QsIHdlIHVzZSB0aGUgYHdpbGNveC50ZXN0KClgIGZ1bmN0aW9uOgpgYGB7cn0Kd2lsY294LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksCiAgICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgICAgIHBhaXJlZCA9IFRSVUUpCmBgYAoKV2l0aCB0aGlzIG5vbnBhcmFtZXRyaWMgdGVzdCwgd2Ugc3RpbGwgc2VlIGEgc21hbGwgcC12YWx1ZSwgaW5kaWNhdGluZyB0aGF0IEJNSSBlc3RpbWF0ZXMgYmV0d2VlbiB1cmJhbiBhbmQgcnVyYWwgYXJlYXMgYXJlIGRpZmZlcmVudC4gV2Ugd291bGQgY29uY2x1ZGUgdGhhdCB0aGVyZSdzIGEgZGlmZmVyZW5jZSBpbiB0aGUgbWVkaWFuIEJNSSBlc3RpbWF0ZXMgYmV0d2VlbiB0aGVzZSB0eXBlcyBvZiByZWdpb25zLgoKIyMjIE11bHRpcGxlIFRlc3RpbmcgQ29ycmVjdGlvbgoKTGV0J3MgdGFrZSBhIGxvb2sgYmFjayBhdCB0aGUgcXVlc3Rpb25zIHdlIHdhbnRlZCB0byBhbnN3ZXI6CjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMikgSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PyBBZ2FpbiwgSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwozKSBIb3cgZG8gZGlmZmVyZW50IGNvdW50cmllcyBjb21wYXJlIGZvciBCTUkgZXN0aW1hdGVzPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCkl0J3MgaW1wb3J0YW50IHRvIG5vdGUgdGhhdCB1bHRpbWF0ZWx5IHdlIHdhbnRlZCB0byB0ZXN0IDQgZGlmZmVyZW50IHRlc3RzIHRvIGFuc3dlciBxdWVzdGlvbiAxIGFuZCAyOgoKMSkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGluIG1lYW4gQk1JIGZvciB3b21lbiBiZXR3ZWVuIFJ1cmFsIGFuZCBVcmJhbiBhcmVhcyBpbiAxOTg1PwoyKSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gbWVhbiBCTUkgZm9yIHdvbWVuIGJldHdlZW4gUnVyYWwgYW5kIFVyYmFuIGFyZWFzIGluIDIwMTc/CjMpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBpbiBtZWFuIEJNSSBmb3Igd29tZW4gYmV0d2VlbiAxOTg1IGFuZCAyMDE3IGluIFJ1cmFsIGFyZWFzPwo0KSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gbWVhbiBCTUkgZm9yIHdvbWVuIGJldHdlZW4gMTk4NSBhbmQgMjAxNyBpbiBVcmJhbiBhcmVhcz8KClNvIGZhciB3ZSBoYXZlIG9ubHkgbG9va2VkIGF0IHRoZSBmaXJzdCB0ZXN0LiAgTGV0J3MgcGVyZm9ybSBhbGwgNCBvZiB0aGVzZSB0ZXN0cyB1c2luZyB0aGUgbm9uLXBhcmFtZXRyaWMgV2lsY294b24gc2lnbmVkLXJhbmsgdGVzdDoKYGBge3J9CndpbGNveC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLAogICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgICAgICBwYWlyZWQgPSBUUlVFKQoKd2lsY294LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksCiAgICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgICAgIHBhaXJlZCA9IFRSVUUpCgp3aWxjb3gudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwKICAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksCiAgICAgICAgICAgcGFpcmVkID0gVFJVRSkKCndpbGNveC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgICAgICBwYWlyZWQgPSBUUlVFKQpgYGAKSW4gZWFjaCBvZiB0aGVzZSB0ZXN0cywgdGhlIHZlcnkgc21hbGwgcC12YWx1ZSB0aGF0IHdvdWxkIGxlYWQgdXMgdG8gY29uY2x1ZGUgdGhhdCB0aGVyZSBpcyBhIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUgdHdvIGdyb3VwcyB3ZSBhcmUgY29tcGFyaW5nLiAgSG93ZXZlciwgd2hlbiB3ZSB0ZXN0IG11bHRpcGxlIHF1ZXN0aW9ucyBsaWtlIHRoaXMsIHdlIG5lZWQgdG8gY29ycmVjdCBmb3IgdGhlIG11bHRpcGxlIHRlc3RzIHRoYXQgd2UgYXJlIHBlcmZvcm1pbmcuCgpUaGUgbW9yZSB3ZSB0ZXN0IGRhdGEsIHRoZSBtb3JlIGxpa2VseSB3ZSBhcmUgdG8gc2VlIGEgc2lnbmlmaWNhbnQgZmluZGluZyBqdXN0IGJ5IFtyYW5kb20gY2hhbmNlXShodHRwczovL3d3dy5zdGF0LmJlcmtlbGV5LmVkdS9+bWdvbGRtYW4vU2VjdGlvbjA0MDIucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IGV2ZW4gd2hlbiB0aGUgZmluZGluZyBpcyBpbiBmYWN0IG5vdCByZWFsLiBJdCBhbGwgY29tZXMgZG93biB0byBwcm9iYWJpbGl0eS4KCiMjIyMgUHJvYmFiaWxpdHkKCllvdSBtYXkgcmVjYWxsIHRoYXQgcHJvYmFiaWxpdHkgaXMgdGhlIGNoYW5jZSB0aGF0IGFuIGV2ZW50IHdpbGwgaGFwcGVuIGFuZCBpdCByYW5nZXMgZnJvbSAwIHRvIDEuIApZb3UgY2FuIGFsc28gdGhpbmsgb2YgaXQgYXMgYSBwZXJjZW50YWdlIG9mIDAlIChwcm9iYWJpbGl0eSA9MCkgdG8gMTAwJSAocHJvYmFiaWxpdHkgPSAxKSBvZiBjaGFuY2UgdGhhdCBhbiBldmVudCB3aWxsIGhhcHBlbi4KCiFbXShodHRwczovL3d3dy5tYXRoc2lzZnVuLmNvbS9kYXRhL2ltYWdlcy9wcm9iYWJpbGl0eS1saW5lLnN2ZykKW1tzb3VyY2VdKGh0dHBzOi8vd3d3Lm1hdGhzaXNmdW4uY29tL2RhdGEvaW1hZ2VzL3Byb2JhYmlsaXR5LWxpbmUuc3ZnKXt0YXJnZXQ9Il9ibGFuayJ9XQoKSWYgd2UgY29uc2lkZXIgZmxpcHBpbmcgYSBjb2luLCB0aGUgcHJvYmFiaWxpdHkgb2YgYW4gZXZlbnQgaGFwcGVuaW5nIChoZWFkcykgaXMgYWx3YXlzIGVxdWFsIHRvICAxICggb3IgMTAwJSBjaGFuY2UpIG1pbnVzIHRoZSBwcm9iYWJpbGl0eSBvZiB0aGUgZXZlbnQgbm90IGhhcHBlbmluZyAodGFpbHMgaW5zdGVhZCBvZiBoZWFkcykgYmVjYXVzZSB0aGUgdG90YWwgcHJvYmFiaWxpdHkgY2FuIG5vdCBleGNlZWQgMTAwJS4KCiAgICAgICAgcHJvYmFiaWxpdHkgb2YgMSAoMTAwJSBjaGFuY2UpID0gdGhlIHByb2JhYmlsdHkgb2YgaGVhZHMgKDUwJSBjaGFuY2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyB0aGUgcHJvYmFiaWxpdHkgb2YgdGFpbHMgKDUwJSBjaGFuY2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA9IFAoaGVhZHMpICsgUCh0YWlscykKICAgICAgICAgICAgcHJvYmFiaWxpdHkgb2Ygb25lIG91dGNvbWUgPSAxIC0gdGhlIHByb2JhYmlsaXR5IG9mIHRoZSBvdGhlciBvdXRjb21lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAoaGVhZHMpID0gMSAtIFAodGFpbHMpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUCh0YWlscykgPSAxIC0gUChoZWFkcykKCklmIHdlIHRoaW5rIGFib3V0IHRoZSBwcm9iYWJpbGl0eSBvZiBnZXR0aW5nIHNpZ25pZmljYW50IG9yIG5vbnNpZ25pZmljYW50IHJlc3VsdHMgd2UgY2FuIHRoaW5rIG9mIGl0IGxpa2UgdGhpczoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxID0gUChzaWduaWZpYW50IHJlc3VsdHMpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIFAobm8gc2lnbmlmaWNhbnQgcmVzdWx0cykKICAgICAgICAgICAgICAgIFAoc2lnbmlmaWNhbnQgcmVzdWx0cykgPSAxIC0gUChubyBzaWduaWZpY2FudCByZXN1bHRzKQoKIyMjIEFscGhhCgpBbHBoYSBpcyB0aGUgYW1vdW50IG9mIHJpc2sgdGhhdCB5b3UgYXJlIHdpbGxpbmcgdG8gYWNjZXB0IHRoYXQgYSBzdGF0aXN0aWNhbCB0ZXN0IHJlc3VsdCBpcyBhY3R1YWxseSBhIGZhbHNlIHBvc2l0aXZlLCBpbiBvdGhlciB3b3JkcyB3ZSByZWplY3QgdGhlIG51bGwgaHlwb3RoZXNpcyB3aGVuIHRoZSBudWxsIGh5cG90aGVzaXMgaXMgdHJ1ZS4gVGhpcyBpcyBhbHNvIGNhbGxlZCBbdHlwZSAxIGVycm9yXShodHRwczovL3dlYi5tYS51dGV4YXMuZWR1L3VzZXJzL21rcy9zdGF0bWlzdGFrZXMvZXJyb3J0eXBlcy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LiBBIHNpZ25pZmljYW5jZSB0aHJlc2hvbGQgb2YgLjA1IGlzIGN1c3RvbWFyeSBhbmQgaXQgbWVhbnMgdGhhdCB3ZSBhcmUgYWNjZXB0aW5nIGEgNSUgY2hhbmNlIHRoYXQgb3VyIHJlc3VsdCBpcyBhY3R1YWxseSBhIGZhbHNlIHBvc2l0aXZlLgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEgPSBwcm9iYWJpbGl0eSBvZiBmYWxzZSBzaWduaWZpY2FudCByZXN1bHRzIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIM6xID0gUChNYWtpbmcgYSB0eXBlIDEgZXJyb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgClJlbWVtYmVyIHRoYXQgaW4gb3VyIHN0YXRpc3RpY2FsIHRlc3RzIGlmIHRoZSBwLXZhbHVlIDwgYWxwaGEgaXQgaXMgY29uc2lkZXJlZCBzaWduaWZpY2FudCBhbmQgaWYgcC12YWx1ZSA+IGFscGhhIGl0IGlzIGNvbnNpZGVyZWQgbm90IHNpZ25pZmljYW50CgoKQnV0IHdoYXQgcmVhbGx5IGlzIHRoZSBbcC12YWx1ZV0oaHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL3AtdmFsdWVzLWV4cGxhaW5lZC1ieS1kYXRhLXNjaWVudGlzdC1mNDBhNzQ2Y2ZjOCl7dGFyZ2V0PSJfYmxhbmsifT8KCiMjIyBwLXZhbHVlcwoKVGhlIHAgaW4gcC12YWx1ZSBzdGFuZHMgZm9yIDxiPnByb2JhYmlsaXR5PC9iPiAtIHRoZSBwcm9iYWJpbGl0eSB0aGF0IHdlIHdvdWxkIG9idGFpbiB0aGUgc3RhdGlzdGljcyAoZm9yIGV4YW1wbGUgdGhlIHQgaW4gb3VyIHN0dWRlbnQgJHQkLXRlc3RzIGJhc2VkIG9uIHRoZSBtZWFucyBvZiBvdXIgZ3JvdXBzIG9mIGNvbXBhcmlzb24pIGp1c3QgYnkgcmFuZG9tIGNoYW5jZSBhbG9uZS4gVGhlcmVmb3JlIGEgcC12YWx1ZSBvZiAwLjAyIG1lYW5zIHRoYXQgdGhlcmUgaXMgYSAyIHBlcmNlbnQgY2hhbmNlIHRoYXQgb3V0IGRhdGEgbWF5IGxvb2sgdGhlIHdheSBpdCBkb2VzIGp1c3QgYmVjYXVzZSBvZiByYW5kb20gY2hhbmNlIGFuZCBub3QgYmVjYXVzZSB0aGVyZSBpcyByZWFsbHkgYSBkaWZmZXJlbmNlIGluIHRoZSBtZWFucyBvZiB0aGUgZ3JvdXBzIG9mIGludGVyZXN0LgoKU28gdGhlbiBpZiBhbHBoYSBpcyB0aGUgdGhyZXNob2xkIGZvciB0aGUgcC12YWx1ZSBmb3Igb2J0YWluaW5nIGZhbHNlIHNpZ25pZmljYW50IHJlc3VsdHMgdGhlbiB0aGUgcHJvYmFiaWxpdHkgb2Ygbm90IG1ha2luZyBpbmNvcnJlY3QgY29uY2x1c2lvbnMgaXMgMSAtIGFscGhhOgoKICAgICAgICAgICAgICAgICBQKE5vdCBtYWtpbmcgYW4gZXJyb3IpID0gMSAtIM6xCgpgYGB7cn0KI1AoTm90IG1ha2luZyBhbiBlcnJvcikgPSAxIC0gzrEKMS0uMDUgCgpgYGAKICAKT0sgc28gaWYgd2UgdXNlIGFuIGFscGhhIG9mIC4wNSB3ZSBhcmUgYWNjZXB0aW5nIHRoYXQgOTUlIG9mIHRoZSB0aW1lIHdlIHdpbGwgbm90IG1ha2UgYSBUeXBlIDEgZXJyb3IgYW5kIDUgJSBvZiB0aGUgdGltZSB3ZSB3aWxsIGp1c3QgYnkgcmFuZG9tIGNoYW5jZS4gICAgICAgICAgICAgIApUYWtpbmcgdGhpcyBvbmUgc3RlcCBmdXJ0aGVyOgoKICAgICAgICAgICAgICAgICAgICAgUChNYWtpbmcgYW4gZXJyb3IpID0gMSAtIFAoTm90IG1ha2luZyBhbiBlcnJvcikKICAgICAgICAgICAgICAgICAgICAgUChNYWtpbmcgYW4gZXJyb3IpID0gMSAtICgxIC0gzrEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKSGVyZSB3ZSBjYW4gc2VlIHRoYXQgdGhpcyBjaGVja3Mgb3V0OiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCmBgYHtyfQojUChNYWtpbmcgYW4gZXJyb3IpID0gMSAtICgxIC0gzrEpCjEtKDEtLjA1KQpgYGAKClNvIHdoYXQgaGFwcGVucyBpZiB3ZSBwZXJmb3JtIG11bHRpcGxlIHRlc3RzPwoKVGhlIHByb2JhYmlsaXR5IG9mIG5vdCBtYWtpbmcgYSB0eXBlIDEgZXJyb3Igd291bGQgcmVtYWluIHRoZSBzYW1lIGZvciBlYWNoIHRlc3QuIFRoZXJlZm9yZSB3ZSBuZWVkIHRvIG11bHRpcGx5IHRoZSBwcm9iYWJpbGl0aWVzIHRvZ2V0aGVyIGVhY2ggdGltZSB0byBkZXRlcm1pbmUgdGhlIG92ZXIgYWxsIHByb2JhYmlsaXR5IG9mIG1ha2luZyBhbiBlcnJvciBhY3Jvc3MgbXVsdGlwbGUgdGVzdHMuIFNlZSBbaGVyZV0oaHR0cDovL21hdGhmb3J1bS5vcmcvbGlicmFyeS9kcm1hdGgvdmlldy83NDA2NS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGFib3V0IHdoeSB3ZSBtdWx0aXBseSBwcm9iYWJpbGl0aWVzIHRvZ2V0aGVyLgoKICAgICAgICBQKE5vdCBtYWtpbmcgYW4gZXJyb3IgaW4gbSB0ZXN0cykgPSAoMSAtIM6xKV5tCiAgICBQKE1ha2luZyBhdCBsZWFzdCAxIGVycm9yIGluIG0gdGVzdHMpID0gMSAtICgxIC0gzrEpXm0KCkxldCdzIGNvbnNpZGVyIGlmIHdlIHBlcmZvcm1lZCAxMCBkaWZmZXJlbnQgc3RhdGlzdGljYWwgdGVzdHMgYW5kIGlmIHdlIGFzIHVzdWFsIGNvbnNpZGVyZWQgdGhlIHNpZ25pZmljYW5jZSB0aHJlc2hvbGQgYWxwaGEgb2YgLjA1OgoKU28gdGhlIHByb2JhYmlsaXR5IG9mIGdldHRpbmcgMSBzaWduaWZpY2FudCByZXN1bHQgd2l0aCAxMCB0ZXN0cyBpczogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApgYGB7Un0KI1AoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gMTAgdGVzdHMpID0gMSAtICgoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSkKI3RoaXMgaXMgdGhlIHNhbWUgYXM6CiNQKE1ha2luZyBhdCBsZWFzdCAxIGVycm9yIGluIDEwIHRlc3RzKSA9IDEgLSAoMSAtIM6xKV4xMAogMS0gKDEtLjA1KV4xMApgYGAKClNvIHRoZXJlIGlzIGEgNDAlIGNoYW5jZSB0aGF0IHRoYXQgdGhlcmUgd2lsbCBiZSBhIHNpZ25pZmljYW50IGZpbmRpbmcgc2ltcGx5IGR1ZSB0byByYW5kb20gY2hhbmNlIGFsb25lLgoKV2hhdCBhYm91dCAxMDAgdGVzdHM/CgpgYGB7Un0KCiNQKE1ha2luZyBhdCBsZWFzdCAxIGVycm9yIGluIDEwMCB0ZXN0cykgPSAxIC0gKDEgLSDOsSleMTAwCiAxLSAoMS0uMDUpXjEwMApgYGAKICAgICAgICAgICAgICAgICAgICAgICAgCllpa2VzISEgVGhhdCBpcyBhbG1vc3QgYSAxMDAlIGNoYW5jZSB0aGF0IHRoZXJlIHdpbGwgYmUgYSBzaWduaWZpY2FudCBmaW5kaW5nIHNpbXBseSBkdWUgdG8gY2hhbmNlIGFsb25lIQoKTXVjaCBvZiB0aGlzIGV4cGxhbmF0aW9uIGlzIGRlc2NyaWJlZCBpbiB0aGlzIFtsZWN0dXJlXShodHRwczovL3d3dy5ncy53YXNoaW5ndG9uLmVkdS9hY2FkZW1pY3MvY291cnNlcy9ha2V5LzU2MDA4L2xlY3R1cmUvbGVjdHVyZTEwLnBkZil7dGFyZ2V0PSJfYmxhbmsifS4KCgpPbmUgd2F5IHRvIGNvcnJlY3QgZm9yIHRoaXMgaXMgbXVsdGlwbGUgdGVzdGluZyBpc3N1ZSBpcyB1c2luZyB0aGUgW0JvbmZlcnJvbmkgbWV0aG9kXShodHRwOi8vbWF0aHdvcmxkLndvbGZyYW0uY29tL0JvbmZlcnJvbmlDb3JyZWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uIAoKSW4gdGhpcyBtZXRob2Qgd2Ugd291bGQgZGl2aWRlIG91ciBzaWduaWZpY2FuY2UgdGhyZXNob2xkIChnZW5lcmFsbHkgMC4wNSkgYnkgdGhlIG51bWJlciBvZiB0ZXN0cy4KCmBgYHtyfQouMDUvNCAjIDQgdGVzdHMKYGBgCgpPdXIgbmV3IHNpZ25pZmljYW5jZSB0aHJlc2hvbGQgaXMgbm93IDAuMDEyNS4gClRodXMgb3VyIHAtdmFsdWVzIHNob3VsZCBiZSBsZXNzIHRoYW4gdGhpcyB2YWx1ZSBmb3IgdXMgdG8gcmVqZWN0IHRoZSBudWxsIHRoYXQgdGhlcmUgaXMgbm8gZGlmZmVyZW5jZSBpbiBtZWFucy4KSW4gb3VyIDQgV2lsY294b24gdGVzdHMsIG91ciBwLXZhbHVlcyB3ZXJlIGxlc3MgdGhhbiAwLjAxMjUuClNvIHdlIHNlZSBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zIG9mIHRoZSBncm91cHMgYWZ0ZXIgbXVsdGlwbGUgdGVzdGluZyBjb3JyZWN0aW9uIGZvciBvdXIgZm91ciBkaWZmZXJlbnQgdGVzdHMuCgojIyBEYXRhIFZpc3VhbGl6YXRpb24KCkFnYWluIHdlIHdpbGwgdXRpbGl6ZSBgZ2dwbG90MmAgdG8gY3JlYXRlIHBsb3RzIHRvIGxvb2sgYXQgdGhlIGRpcmVjdGlvbmFsIGFuZCBtYWduaXR1ZGUgb2YgdGhlIGRpZmZlcmVuY2VzIGluIEJNSSB3ZSBhcmUgaW50ZXJlc3RlZCBpbi4gSWYgeW91IG5lZWQgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBwbGVhc2Ugc2VlIFtoZXJlXShodHRwczovL29wZW5jYXNlc3R1ZGllcy5naXRodWIuaW8vb2NzLWhlYWx0aGV4cGVuZGl0dXJlL29jcy1oZWFsdGhleHBlbmRpdHVyZS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LiBUaGUgdG9wIHR3byBsaW5lcyBvZiB0aGUgY29kZSBmb3IgdGhlIGZvbGxvd2luZyBwbG90cywgZmlsdGVyIHRoZSBkYXRhIHRvIG9ubHkgc3BlY2lmaWMgdmFsdWVzIG9mIGludGVyZXN0LiBUaGVuIHdlIGxheWVyIHdoYXQgaXMgY2FsbGVkIGEgaml0dGVyIG9uIHRvcCBvZiBhIGJveCBwbG90LiBBIGppdHRlciBpcyBlc3NlbnRpYWxseSBhIGRvdCBwbG90IGJ1dCB3aXRoIHNvbWUgdmFyaWF0aW9uIG9uIHRoZSBsb2NhdGlvbiBvZiB0aGUgcG9pbnRzIHNvIHRoYXQgdGhleSBkbyBub3QgbGluZSB1cCB2ZXJ0aWNhbGx5IHdoaWNoIGNhbiBtYWtlIHRoZSBpbmRpdmlkdWFsIHBvaW50cyBkaWZmaWN1bHQgdG8gc2VlLgoKT3VyIGZpcnN0IG1haW4gcXVlc3Rpb24gd2FzOiBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gQk1JIGVzdGltYXRlcyBhcm91bmQgdGhlIHdvcmxkPwpMZXQncyBsb29rIGF0IHRoZSBuYXRpb25hbCBtZWFuIEJNSSBlc3RpbWF0ZXMgZm9yIGVhY2ggb2YgdGhlIHllYXJzOgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgUmVnaW9uICE9ICJOYXRpb25hbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFJlZ2lvbiwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAuMykgCiMgdGhlIHdpZHRoIGRldGVybWluZXMgaG93IHdpZGUgdGhlIHBvaW50cyBhcmUgcGxvdHRlZAoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgUmVnaW9uICE9ICJOYXRpb25hbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFJlZ2lvbiwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAuMykKCmBgYAoKT3VyIDJuZCBtYWluIHF1ZXN0aW9uIHdhczogSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PwpMZXQncyBsb29rIGF0IHRoZSBjaGFuZ2UgaW4gcnVyYWwgYW5kIHVyYmFuIG1lYW4gQk1JIGVzdGltYXRlcyBvdmVyIHRpbWU6CmBgYHtyfQojdGhpcyB0aW1lIHdlIHdpbGwgYWRkIHRpdGxlcyBmb3IgUnVyYWwgYW5kIFVyYmFuIHVzaW5nIGdndGl0bGUoKQpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogICMgZmlsdGVyaW5nIHRoaXMgd2F5IGFsbG93cyB1cyB0byBrZWVwIGRhdGEgZnJvbSBib3RoIHllYXJzCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAuMykgKwogIGdndGl0bGUoIlJ1cmFsIikKCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gPT0gIlVyYmFuIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAuMykgKwogIGdndGl0bGUoIlVyYmFuIikKCmBgYAoKTGV0J3MgcHV0IHRoZSBwbG90cyB0b2dldGhlciB0byBzZWUgaG93IHRoZSBjaGFuZ2Ugb3ZlciB0aGUgeWVhcnMgZGlmZmVycyBiZXR3ZWVuIHRoZSByZWdpb25zLgpXZSB3aWxsIHVzZSBhZ2FpbiB1c2UgYGZhY2V0X3dyYXAoKWAgdG8gZG8gdGhpczoKCmBgYHtyfQoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiAlaW4lIGMoIlJ1cmFsIiwgIlVyYmFuIikpICU+JQogICMgZmlsdGVyaW5nIHRoaXMgd2F5IGFsbG93cyB1cyB0byBrZWVwIGRhdGEgZnJvbSBib3RoIHllYXJzCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3QoKSArCiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAuMykgKwogIGZhY2V0X3dyYXAofiBSZWdpb24pCgojIHdlIHdvdWxkIGFsc28gZ2V0IG5hdGlvbmFsIGRhdGEgd2l0aG91dCBgUmVnaW9uICVpbiUgYygiUnVyYWwiLCAiVXJiYW4iKSlgCgpgYGAKSW5kZWVkIHRoZSBjaGFuZ2UgaW4gQk1JIG92ZXIgdGltZSBsb29rcyBiaWdnZXIgaW4gdGhlIHJ1cmFsIGFyZWFzIQoKCk9uZSB0aGlyZCBtYWluIHF1ZXN0aW9ucyB3YXM6IEhvdyBkbyB0aGUgZGlmZmVyZW50IGNvdW50cmllcyBjb21wYXJlPyAgT3IgaW4gb3RoZXIgd29yZHMgd2hhdCBkbyB0aGUgaW5kaXZpZHVhbCBkb3RzIHJlcHJlc2VudCBpbiBvdXIgYm94IHBsb3RzPwpXZSB3aWxsIHRha2UgYSBsb29rIHVzaW5nIGBnZW9tX2xhYmVsKClgOgoKYGBge3J9CgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBnZW9tX2xhYmVsKGFlcyhsYWJlbCA9IENvdW50cnkpKQoKYGBgCgpJZiB3ZSBpbmNsdWRlIGFsbCBjb3VudHJ5IG5hbWVzIHRoaXMgaXMgYSBiaXQgdG9vIG11Y2guLi4gc28gcGVyaGFwcyB3ZSBzaG91bGQgZm9jdXMgb24ganVzdCB0aGUgZXh0cmVtZSBCTUkgdmFsdWVzIHVzaW5nIGBmaWx0ZXIoKWAgZnVuY3Rpb24gb2YgdGhlYGRwbHlyYCBwYWNrYWdlLiBXZSB3aWxsIGFsc28gdXNlIHRoZSBgZ2dyZXBlbGAgcGFja2FnZSB0byBoYXZlIG91ciBsYWJlbHMgbm90IG92ZXJsYXAgZWFjaCBvdGhlci4KClBhcnQgb2YgdGhlIHRoaXJkIHF1ZXN0aW9uIHdhczogSG93IGRvZXMgdGhlIFVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSBjb21wYXJlPyBTbyBsZXQncyBsYWJlbCB0aGUgZGF0YSBwb2ludHMgZm9yIHRoZSBVbml0ZWQgc3RhdGVzLgoKYGBge3J9CgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKGRhdGE9Qk1JX2xvbmcgJT4lIAogICAgICAgICAgICAgIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoQk1JPjMxIHwgQk1JPDE5IHwgQ291bnRyeSA9PSAiVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIiksIAogICAgICAgICAgICAgIGFlcyh4ID1ZZWFyLCB5ID1CTUkpLAogICAgICAgICAgICAgIHdpZHRoID0gLjAyKSArCiAgZ2dyZXBlbDo6Z2VvbV90ZXh0X3JlcGVsKGRhdGE9Qk1JX2xvbmcgJT4lIAogICAgICAgICAgICAgIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICAgICAgICAgICAgICBmaWx0ZXIoQk1JPjMxIHwgQk1JPDE5IHwgQ291bnRyeSA9PSAiVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIiksIAogICAgICAgICAgICAgIGFlcyh4ID1ZZWFyLCB5ID1CTUksIGxhYmVsID0gQ291bnRyeSkpCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgCmBgYAoKQW5kIGxldCdzIGZpbGwgdGhlIGJveCBwbG90cyB3aXRoIGNvbG9yIGFuZCBvdXRsaW5lIGluIGJsYWNrOgpgYGB7cn0KCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gWWVhciwgeSA9IEJNSSkpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIsIGFlcyhmaWxsID0gWWVhcikpICsKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgc3Vic2V0KEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JKSwKICAgICAgICAgICAgICB3aWR0aCA9IC4wMikgKwogIGdncmVwZWw6Omdlb21fdGV4dF9yZXBlbChkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgc3Vic2V0KEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JLCBsYWJlbCA9IENvdW50cnkpKQoKYGBgCgoKIyMjIE92ZXJhbGwgZGlmZmVyZW5jZXMKCkxldCdzIHRha2UgYSBsb29rIGF0IGFsbCB0aGUgZGF0YSB0b2dldGhlciwgaW5jbHVkaW5nIHRoZSBkYXRhIGZvciBtZW46CmBgYHtyfQpnZ3Bsb3QoQk1JX2xvbmcsIGFlcyh4ID0gWWVhciwgeSA9IEJNSSwgY29sID0gUmVnaW9uKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEsIGNvbG9yID0gImJsYWNrIiAsIGFlcyhmaWxsID0gUmVnaW9uKSkgKyAKICBmYWNldF9ncmlkKH4gU2V4KSAgIApgYGAKClRoYXQncyB1c2VmdWwsIGJ1dCBsZXQncyBsb29rIGF0IHRoZSBpbmRpdmlkdWFsIHBvaW50cyBhbmQgaW5jbHVkZSBvdXIgY291bnRyeSBsYWJlbHMsIHRvIGRvIHNvIGxldHMgY2hhbmdlIG91ciBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EgbGFiZWwgdG8gVVNBOgoKYGBge3J9CkJNSV9sb25nW1siQ291bnRyeSJdXSA8LUJNSV9sb25nW1siQ291bnRyeSJdXSAlPiUKICBzdHJfcmVwbGFjZSggcGF0dGVybiA9ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiLCByZXBsYWNlbWVudCA9ICJVU0EiKQoKCmdncGxvdChCTUlfbG9uZywgYWVzKHggPSBZZWFyLCB5ID0gQk1JLCBjb2wgPSBZZWFyKSkgKyAKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIgLCBhZXMoZmlsbCA9IFNleCkpICsgCiAgZmFjZXRfZ3JpZCh+IFNleCArIFJlZ2lvbikgKyAKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQ9MzAsIGxpbmV0eXBlPSJkYXNoZWQiLCBjb2xvciA9ICJyZWQiLCBzaXplID0xKSArIAogICMgVGhpcyB3aWxsIGFkZCBhIGhvcml6b250YWwgZGFzaGVkIGxpbmUgdG8gaW5kaWNhdGUgdGhlIG9iZXNpdHkgQk1JIHRocmVzaG9sZAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksIAogICAgICAgICAgICAgIHdpZHRoID0gLjIsIHNpemUgPTIsIHNoYXBlID0yMSwgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCB0aGUgaW5kaXZpZHVhbCBjb3VudHJ5IGRhdGEgcG9pbnRzCiAgIyBUaGUgc2hhcGUgMjEgYWxsb3dzIGZvciBhIGRpZmZlcmVudCBmaWxsIGFuZCBvdXRsaW5lIGNvbG9yCiAgIyBUaGUgd2lkdGggZGV0ZXJtaW5lcyBob3cgd2lkZSB0aGUgaml0dGVyIHBvaW50cyBhcmUgcGxvdHRlZAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nLCBDb3VudHJ5ID09ICJVU0EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksIAogICAgICAgICAgICAgIHdpZHRoID0gLjAyLCBzaXplID0xMiwgc2hhcGUgPTIxLCBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHBvaW50cyB0aGF0IGFyZSBsYXJnZXIgZm9yIHRoZSBVU0EgZGF0YQogIGdlb21fdGV4dChkYXRhPXN1YnNldChCTUlfbG9uZywgIENvdW50cnkgPT0gIlVTQSIpLCAKICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSxsYWJlbD1Db3VudHJ5KSwgCiAgICAgICAgICAgIGNvbG9yID0gImJsYWNrIikgKyAKICAjIFRoaXMgd2lsbCBhZGQgVVNBIGxhYmVscyB0byB0aGUgVVNBIHBvaW50cwogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgCiAgIyBUaGlzIGlzIHVzZWZ1bCBmb3IgcmVtb3ZpbmcgdGhlIGxlZ2VuZAogICAgICAgIGF4aXMudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSxhbmdsZSA9IDMwKSwgCiAgICAgICAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgYW5kIGFuZ2xlIG9mIHRoZSB4IGF4aXMgcG9pbnQgbGFiZWxzIAogICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAyMCksIAogICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIHN0cmlwLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUpKSArCiAgIyBUaGlzIGNoYW5nZXMgdGhlIHNpemUgb2YgeCBheGlzIGxhYmVscyBmb3IgdGhlIGZhY2V0IAogICAgICAgIGdndGl0bGUoICJEaWZmZXJlbmNlcyBpbiBCTUkgT3ZlciBUaW1lIGFuZCBBY3Jvc3MgUmVnaW9uIFR5cGUgYW5kIEdlbmRlciIpICsKICAjIEFkZCBhICBwbG90IHRpdGxlCiAgICAgICAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzPWMoImRvZGdlcmJsdWUiLCAib3JjaGlkMiIpKQoKYGBgCgpIZXJlIHdlIGNhbiBzZWUgdGhhdCBvdmVyYWxsIEJNSSBhcHBlYXJzIHRvIGJlIGluY3JlYXNpbmcgZ2xvYmFsbHkgb3ZlciB0aW1lLiBBZGRpdGlvbmFsbHkgd2UgY2FuIHNlZSB0aGF0IHRoaXMgaXMgb2NjdXJyaW5nIG5vdCBqdXN0IGluIHVyYmFuIGFyZWFzLCBidXQgYWxzbyBpbiBydXJhbCBhcmVhcy4gVGhlIFVTIGlzIGNvbnNpc3RlbnRseSBhYm92ZSB0aGUgbWVkaWFuIGluIGFsbCBzdHJhdGEgb2YgdGhlIGRhdGEuIEluIGdlbmVyYWwsIHRoZSBmZW1hbGUgZGF0YSBzaG93cyBoaWdoZXIgQk1JIHZhbHVlcyB0aGFuIHRoZSBtYWxlIGRhdGEuIFRoZSBydXJhbCBVU0EgQk1JIGFwcGVhcnMgdG8gYmUgaGlnaGVyIHRoYW4gdGhlIHVyYmFuIEJNSSBmb3IgYm90aCBtZW4gYW5kIHdvbWVuLiBNYW55IGNvdW50cmllcyBoYXZlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBhYm92ZSB0aGUgb2Jlc2l0eSB0aHJlc2hvbGQgb2YgMzAuIFRodXMgaXQgYXBwZWFycyB0aGF0IGVkdWNhdGlvbiBhbmQgb3V0cmVhY2ggcHJvZ3JhbXMgZm9yIHdlaWdodCBtYW5hZ2VtZW50IHNob3VsZCBmb2N1cyBvbiBib3RoIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcyBhbmQgYm90aCBnZW5kZXJzLiBFZHVjYXRpb24gYW5kIGFzc2lzdGFuY2UgZm9yIHdvbWVuIG1heSBiZSBlc3BlY2lhbGx5IGhlbHBmdWwuIAoKIyMjIERpZmZlcmVuY2VzIGluIHJhdGUgb2YgY2hhbmdlCgpIb3cgZG9lcyB0aGUgcmF0ZSBvZiBjaGFuZ2UgaW4gQk1JIGRpZmZlciBiZXR3ZWVuIGdyb3Vwcz8gV2hpY2ggZ3JvdXAgbWlnaHQgZXNwZWNpYWxseSBuZWVkIGF0dGVudGlvbj8KCkZpcnN0IGxldCdzIGNhbGN1bGF0ZSB0aGUgZGlmZmVyZW5jZXMgaW4gQk1JIGZyb20gMjAxNyBhbmQgMTk4NSBhbmQgYWRkIHRoaXMgdG8gb3VyIEJNSV9sb25nIGRhdGEgb2JqZWN0LiBUaGlzIHdpbGwgY3JlYXRlIG5ldyB2YXJpYWJsZXMgY2FsbGVkIGBSdXJhbF9kaWZmZXJlbmNlLGAgYFVyYmFuX2RpZmZlcmVuY2VgLCBhbmQgYE5hdGlvbmFsX2RpZmZlcmVuY2VgLgpgYGB7cn0KCkJNSV9udW1lcmljW1siUnVyYWxfZGlmZmVyZW5jZSJdXSA8LSAKICAgICBCTUlfbnVtZXJpY1tbIlJ1cmFsX0JNSV8yMDE3Il1dIC0gQk1JX251bWVyaWNbWyJSdXJhbF9CTUlfMTk4NSJdXQoKQk1JX251bWVyaWNbWyJVcmJhbl9kaWZmZXJlbmNlIl1dIDwtIAogICAgIEJNSV9udW1lcmljW1siVXJiYW5fQk1JXzIwMTciXV0gLSBCTUlfbnVtZXJpY1tbIlVyYmFuX0JNSV8xOTg1Il1dCgpCTUlfbnVtZXJpY1tbIk5hdGlvbmFsX2RpZmZlcmVuY2UiXV0gPC0gCiAgICAgQk1JX251bWVyaWNbWyJOYXRpb25hbF9CTUlfMjAxNyJdXSAtIEJNSV9udW1lcmljW1siTmF0aW9uYWxfQk1JXzE5ODUiXV0KCkJNSV9kaWZmX2xvbmcgPC0gQk1JX251bWVyaWMgJT4lIAogIHNlbGVjdChDb3VudHJ5Ok5hdGlvbmFsX2RpZmZlcmVuY2UpICU+JSAKZ2F0aGVyKGtleSA9IFR5cGUsIHZhbHVlID0gRGlmZmVyZW5jZSAsIFJ1cmFsX2RpZmZlcmVuY2U6TmF0aW9uYWxfZGlmZmVyZW5jZSkKCgpCTUlfZGlmZl9sb25nIDwtIEJNSV9udW1lcmljICU+JSAKICBzZWxlY3QoQ291bnRyeTogTmF0aW9uYWxfZGlmZmVyZW5jZSkgJT4lIApwaXZvdF9sb25nZXIoIG5hbWVzX3RvID0gIkRpZmZlcmVuY2UiICwgY29scyA9IFJ1cmFsX2RpZmZlcmVuY2U6TmF0aW9uYWxfZGlmZmVyZW5jZSkKCgoKaGVhZChCTUlfZGlmZl9sb25nKQpgYGAKCkxldCdzIHJlcGxhY2UgIlVuaXRlZCBzdGF0ZXMgb2YgQW1lcmljYSIgd2l0aCAiVVNBIiBhbmQgbWFrZSBhIHBsb3Qgd2l0aCB0aGlzIGRhdGEgdG8gY29tcGFyZSB0aGUgY2hhbmdlIGluIEJNSToKCmBgYHtyfQoKQk1JX2RpZmZfbG9uZ1tbIkNvdW50cnkiXV0gPC1CTUlfZGlmZl9sb25nW1siQ291bnRyeSJdXSAlPiUKICBzdHJfcmVwbGFjZSggcGF0dGVybiA9ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiLCByZXBsYWNlbWVudCA9ICJVU0EiKQoKCmdncGxvdChCTUlfZGlmZl9sb25nLCBhZXMoeCA9IERpZmZlcmVuY2UsIHkgPSB2YWx1ZSwgY29sID0gRGlmZmVyZW5jZSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBEaWZmZXJlbmNlKSkgKyAKICBmYWNldF9ncmlkKH4gU2V4KSArCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyksIAogICAgICAgICAgICAgIGFlcyh4ID1EaWZmZXJlbmNlLCB5ID12YWx1ZSksIAogICAgICAgICAgICAgIHdpZHRoID0gLjIsIHNpemUgPSAyLCBzaGFwZSA9IDIxLCBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHRoZSBpbmRpdmlkdWFsIGNvdW50cnkgZGF0YSBwb2ludHMKICAjIFRoZSBzaGFwZSAyMSBhbGxvd3MgZm9yIGEgZGlmZmVyZW50IGZpbGwgYW5kIG91dGxpbmUgY29sb3IKICAjIFRoZSB3aWR0aCBkZXRlcm1pbmVzIGhvdyB3aWRlIHRoZSBqaXR0ZXIgcG9pbnRzIGFyZSBwbG90dGVkCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZywgQ291bnRyeSA9PSAiVVNBIiksIAogICAgICAgICAgICAgIGFlcyh4ID0gRGlmZmVyZW5jZSwgeSA9IHZhbHVlKSwgCiAgICAgICAgICAgICAgd2lkdGggPSAuMDIsIHNpemUgPSAxMiwgc2hhcGUgPSAyMSwgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZywgIENvdW50cnkgPT0gIlVTQSIpLCAKICAgICAgICAgICAgYWVzKHggPURpZmZlcmVuY2UsIHkgPSB2YWx1ZSwgbGFiZWwgPSBDb3VudHJ5KSwgY29sb3IgPSAiYmxhY2siKSArIAogICMgVGhpcyB3aWxsIGFkZCBVU0EgbGFiZWxzIHRvIHRoZSBVU0EgcG9pbnRzCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLCAKICAjIFRoaXMgaXMgdXNlZnVsIGZvciByZW1vdmluZyB0aGUgbGVnZW5kCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1LGFuZ2xlID0gMzApLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSksIAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUpLCAKICAgICAgICBzdHJpcC50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1KSkgKwogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIG9mIHggYXhpcyBsYWJlbHMgZm9yIHRoZSBmYWNldAogICAgICAgIGdndGl0bGUoICJDaGFuZ2UgaW4gQk1JIE92ZXIgVGltZSBhbmQgQWNyb3NzIFJlZ2lvbiBUeXBlIGFuZCBHZW5kZXIiKQogICAgICAgICMgQWRkIGEgcGxvdCB0aXRsZSAgCgoKCmBgYAoKV2UgY2FuIG5vdyBzZWUgdGhhdCB0aGUgcmF0ZSBvZiBjaGFuZ2UgZnJvbSAxOTg1IHRvIDIwMTcgYXBwZWFycyB0byBiZSBsYXJnZXIgaW4gdGhlIHdvbWVuIGNvbXBhcmVkIHRvIHRoZSBtZW4gaW4gYWxsIHJlZ2lvbnMuIFRoZSBncm91cCB3aXRoIHRoZSBsYXJnZXN0IGluY3JlYXNlIGluIHRoZSBVU0EgaXMgdGhlIHdvbWVuIGxpdmluZyBpbiBydXJhbCBhcmVhcy4KCgoKTGV0J3MgY2hlY2sgdGhlIGRpZmZlcmVuY2Ugd2l0aCBzb21lIHN0YXRpc3RpY2FsIHRlc3RzOgoKYGBge3J9CiNmaXJzdCBsZXRzIGxvb2sgYXQgdGhlIG5vcm1hbGl0eSBvZiB0aGUgZGlmZmVyZW5jZSBpbiBCTUkKQk1JX2RpZmZfbG9uZyAlPiUKICBnZ3Bsb3QoYWVzKHg9dmFsdWUpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIERpZmZlcmVuY2UpCiMgaW50ZXJlc3RpbmcuLi50aGUgc3ByZWFkIG9mIGRpZmZlcmVuY2UgaXMgbXVjaCBicm9hZGVyIGZvciB3b21lbiB0aGFuIGZvciBtZW4gCiMgc29tZSB3b21lbiBpbiBzb21lIGNvdW50cmllcyBlc3BlY2lhbGx5IG5lZWQgaGVscCB3aXRoIG9iZXNpdHkKIyB3aGlsZSBvdGhlciBjb3VudHJpZXMgYXJlIGFjdHVhbGx5IHNob3dpbmcgYSBsb3NzIG9mIEJNSQojIHRoZXNlIGNvdW50cmllcyBhcmUgdGhlIHBvaW50cyBvbiBvdXIgcHJldmlvdXMgcGxvdCB3aXRoIGEgZGlmZmVyZW5jZSBiZWxvdyAwCgojTGV0J3Mgc2VlIHdobzoKQk1JX2RpZmZfbG9uZyAlPiUgCiAgYXJyYW5nZSh2YWx1ZSkKCiMgSW4gZ2VuZXJhbCwgcGVvcGxlIGFwcGVhciB0byBoYXZlIGxvc3Qgd2VpZ2h0IGluIEdyZWVjZQoKIyBMZXQncyBsb29rIGF0IFEtUSBwbG90czoKQk1JX2RpZmZfbG9uZyAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IHZhbHVlKSkgKwogIHN0YXRfcXEoKSArICMgdG8gYWRkIHRoZSBsaW5lIHdlIG5lZWQgdG8gYWxzbyBpbmNsdWRlIHN0YXRfcXFfbGluZSgpCiAgc3RhdF9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofiBTZXggKyBEaWZmZXJlbmNlKQoKIyBvayBzbyBzb21lIG9mIHRoZSBkYXRhIGZvciBNZW4gbG9va3MgZmFpcmx5IG5vcm1hbCBidXQgbm90IGFzIG11Y2ggZm9yIFdvbWVuCgojIE5vdyB3ZSB3aWxsIGNoZWNrIHRoZSB2YXJpYW5jZQoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgRGlmZmVyZW5jZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCB2YWx1ZSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBEaWZmZXJlbmNlID09ICJVcmJhbl9kaWZmZXJlbmNlIiksIHZhbHVlKSkKI3JlamVjdCB0aGUgbnVsbCAtIGNvbmNsdWRlIHRoYXQgdmFyaWFuY2UgaXMgbm90IGVxdWFsCgptb29kLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgICAgRGlmZmVyZW5jZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCB2YWx1ZSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgICAgRGlmZmVyZW5jZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCB2YWx1ZSkpCiNmYWlsIHRvIHJlamVjdCB0aGUgbnVsbCB0aGUgbnVsbCAtIGNvbmNsdWRlIHRoYXQgdmFyaWFuY2UgaXMgZXF1YWwKCm1vb2QudGVzdChwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgdmFsdWUpLCAKICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJNZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgdmFsdWUpKQojcmVqZWN0IHRoZSBudWxsIC0gY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBub3QgZXF1YWwKCgojIGxldCdzIGNvbXBhcmUgdGhlIGdyb3VwcwojIHRoaXMgaXMgYWdhaW4gc3RpbGwgcGFpcmVkIGRhdGEKIyB0aGlzIGlzIGJlY2F1c2UgZWFjaCB2YWx1ZSBvZiAiUnVyYWxfZGlmZmVyZW5jZSIgYW5kICJVcmJhbl9kaWZmZXJlbmNlIiBjb3JyZXNwb25kIHRvIHRoZSBzYW1lIGNvdW50cnkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsICAKICAgICAgICAgICAgICAgICAgICBEaWZmZXJlbmNlID09ICJSdXJhbF9kaWZmZXJlbmNlIiksIHZhbHVlKSwgCiAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgIAogICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlVyYmFuX2RpZmZlcmVuY2UiKSwgdmFsdWUpLAogICAgICAgIHBhaXJlZCA9IFRSVUUpCgprcy50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsCiAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJNZW4iLAogICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgdmFsdWUpLCAKICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLAogICAgICAgICAgICAgICAgICAgIFNleCA9PSAiTWVuIiwgCiAgICAgICAgICAgICAgICAgICAgRGlmZmVyZW5jZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCB2YWx1ZSksCiAgICAgICAgcGFpcmVkID0gVFJVRSkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgdmFsdWUpLCAKICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgIAogICAgICAgICAgICAgICAgICAgIERpZmZlcmVuY2UgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgdmFsdWUpLAogICAgICAgIHBhaXJlZCA9IFRSVUUpCgpgYGAKCk5vdyB3ZSBoYXZlIHBlcmZvcm1lZCBzZXZlbiBjb21wYXJpc29ucyAoNCBlYXJsaWVyKSBzbyB3ZSBzaG91bGQgYXBwbHkgb3VyIG11bHRpcGxlIHRlc3RpbmcgY29ycmVjdGlvbgpgYGB7cn0KLjA1LzcKCmBgYAoKV2Ugc2VlIHRoYXQgdGhlcmUgaXMgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIHRoZSBjaGFuZ2UgaW4gQk1JIFJ1cmFsIGNvbW11bml0aWVzIGJldHdlZW4gbWVuIGFuZCB3b21lbi4gVGhpcyBjaGFuZ2UgaXMgbGFyZ2VyIGZvciB3b21lbi4KCkltcG9ydGFudGx5LSB3ZSBub3RpY2VkIHRoYXQgaXQgYXBwZWFycyB0byBiZSBzcGVjaWZpYyBjb3VudHJpZXMgd2hlcmUgQk1JIHNob3dzIGEgcGFydGljdWxhciBpbmNyZWFzZSBlc3BlY2lhbGx5IGZvciB3b21lbi4gV2hpY2ggY291bnRyaWVzIGFyZSB0aG9zZT8gaG93IGRvZXMgdGhhdCBjb21wYXJlIHdpdGggdGhlIFVTPyBDbGVhcmx5IHRoZSBVUyBpcyBhbW9uZyB0aGUgY291bnRyaWVzIHdpdGggdGhlIGhpZ2hlc3QgZGlmZmVyZW5jZXMuIAoKYGBge3J9CkJNSV9kaWZmX2xvbmcgJT4lIAogIGZpbHRlcihDb3VudHJ5ID09ICJVU0EiKQoKYGBgCgpJbiB0aGUgVVMsIGZvY3VzIHNob3VsZCBiZSBwbGFjZWQgb24gPGI+IGJvdGggdXJiYW4gYW5kIHJ1cmFsIDwvYj4gd29tZW4gdG8gaW1wcm92ZSB0aGlzIHB1YmxpYyBoZWFsdGggaXNzdWUuIAoKSGVyZSB3ZSBjYW4gc2VlIHRoZSBjb3VudHJpZXMgaGF2ZSB0aGUgbGFyZ2VzdCBkaWZmZXJlbmNlcyBpbiBCTUkgZnJvbSAxOTg1LTIwMTc6CgpgYGB7cn0KQk1JX2RpZmZfbG9uZyAlPiUKICBmaWx0ZXIodmFsdWU+NC45KSAlPiUKICBhcnJhbmdlKC12YWx1ZSkKI2hlcmUgd2Ugc29ydGVkIGJ5IHRoZSBoaWdoZXN0IHRvIGxvd2VzdCB2YWx1ZXMgb2YgQk1JIERpZmZlcmVuY2UKYGBgCgoKSG93ZXZlciBpdCBpcyBpbXBvcnRhbnQgdG8gc2VlIHdoYXQgdGhlIG1lYW4gQk1JIHZhbHVlcyB3ZXJlIGZvciB0aGVzZSBjb3VudHJpZXMgaW4gMjAxNy4gCkl0IGNvdWxkIGJlIHRoYXQgdGhlIGF2ZXJhZ2Ugd2FzIHVuZGVyd2VpZ2h0IGluIDE5ODUuLi4gbGV0J3MgdGFrZSBhIGxvb2suCgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGZpbHRlcihDb3VudHJ5ICVpbiUgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgdmFsdWU+NC45KSwgQ291bnRyeSksIAogICAgICAgICAgICAgICAgICAgIFNleCAlaW4lIHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIHZhbHVlPjQuOSksIFNleCksCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSIyMDE3IikgJT4lCiAgYXJyYW5nZSgtQk1JKQoKI0hlcmUgaXMgdGhlIGRhdGEganVzdCBmb3IgdGhlIGNoYW5nZXMgaW4gQk1JIGluIEVneXB0CmZpbHRlcihCTUlfZGlmZl9sb25nLCBDb3VudHJ5ID09ICJFZ3lwdCIpICU+JSAKICBhcnJhbmdlKC12YWx1ZSkKCmBgYApUaHVzIHJ1cmFsIHdvbWVuIGluIEVneXB0IGhhZCB0aGUgZ3JlYXRlc3QgaW5jcmVhc2UgaW4gQk1JIGZyb20gMTk4NSB0byAyMDE3IGluIHRoaXMgZGF0YSAoNS45KSBhbmQgdGhlIGF2ZXJhZ2UgQk1JIGlzIG5vdyBvdmVyIHRoZSBvYmVzaXR5IHRocmVzaG9sZCBvZiAzMC4KClRoZSBkYXRhIHN1Z2dlc3RzIHRoYXQgcnVyYWwgd29tZW4gaW4gRWd5cHQgYW5kIG90aGVyIGNvdW50cmllcyBtYXkgZXNwZWNpYWxseSBiZW5lZml0IGZyb20gZGlldGFyeSByZXNvdXJjZXMgYW5kIG91ciBpbnRlcnZlbnRpb25zIGFuZCBwcm9ncmFtcyB0byBhc3Npc3Qgd2l0aCB3ZWlnaHQgbWFuYWdlbWVudC4KCk5vdyBsZXQncyBtYWtlIGEgcGxvdCB0aGF0IHN1bW1hcml6ZXMgb3VyIGZpbmRpbmdzLiBUbyBkbyB0aGlzIHdlIHdpbGwgc2ltcGxpZnkgdGhlIG90aGVyIHBsb3RzIHdlIG1hZGUgYW5kIHRoZW4gY29tYmluZSB0aGVtIHRvZ2V0aGVyLgoKYGBge3J9CgojIHNpbXBsaWZpZWQgbmF0aW9uYWwgbWVhbnMgcGxvdApNZWFuc19wbG90PC1CTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJOYXRpb25hbCIpICU+JQpnZ3Bsb3QoYWVzKHggPSBTZXgsIHkgPSBCTUkpKSArIAogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEsIGNvbG9yID0gImJsYWNrIiAsIGFlcyhmaWxsID0gU2V4KSkgKyAKIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcz1jKCJkb2RnZXJibHVlIiwgIm9yY2hpZDIiKSkgKwogIGZhY2V0X2dyaWQofiBZZWFyKSArIAogIGdlb21faGxpbmUoeWludGVyY2VwdD0zMCwgbGluZXR5cGU9ImRhc2hlZCIsIGNvbG9yID0gInJlZCIsIHNpemUgPTEpICsgCiAgZ2VvbV9qaXR0ZXIoZGF0YT1CTUlfbG9uZyAlPiUKICAgICAgICAgICAgICAgIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIk5hdGlvbmFsIiksCiAgICAgICAgICAgICAgICBhZXMoeCA9U2V4LCB5ID1CTUkpLCAKICAgICAgICAgICAgICAgIHdpZHRoID0gLjIsIHNpemUgPTIsIHNoYXBlID0yMSwgCiAgICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsKICBnZW9tX2ppdHRlcihkYXRhPXN1YnNldChCTUlfbG9uZyAlPiUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIk5hdGlvbmFsIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnRyeSA9PSAiVVNBIikpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZXMoeCA9U2V4LCB5ID1CTUkpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IC4wMiwgc2l6ZSA9MTIsIHNoYXBlID0yMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2xvbmclPiUKICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIk5hdGlvbmFsIiwgQ291bnRyeSA9PSAiVVNBIikpLAogICAgICAgICAgICAgICAgICAgICAgICAgIGFlcyh4ID1TZXgsIHkgPUJNSSxsYWJlbD1Db3VudHJ5KSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAiYmxhY2siKSArIAogICMgVGhpcyB3aWxsIGFkZCBVU0EgbGFiZWxzIHRvIHRoZSBVU0EgcG9pbnRzCiAgdGhlbWVfbGluZWRyYXcoKSArCiAgIyBUaGlzIHdpbGwgbWFrZSB0aGViYWNrZ3JvdW5kIG9mIHRoZSBwbG90IHdoaXRlIGFuZCB0aGUgZmFjZXQgbGFiZWxzIGJsYWNrCiAgdGhlbWUobGVnZW5kLnBvc2l0aW9uID0gIm5vbmUiLCAKICAjIFRoaXMgaXMgdXNlZnVsIGZvciByZW1vdmluZyB0aGUgbGVnZW5kCiAgICAgICAgYXhpcy50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1LGFuZ2xlID0gMzAsIHZqdXN0ID0gMC41KSwgCiAgICAgICAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgYW5kIGFuZ2xlIG9mIHRoZSB4IGF4aXMgcG9pbnQgbGFiZWxzIAogICAgICAgIGF4aXMudGV4dC55ID0gZWxlbWVudF90ZXh0KHNpemUgPSAyMCksIAogICAgICAgIGF4aXMudGl0bGUueSA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIGF4aXMudGl0bGUueCA9IGVsZW1lbnRfdGV4dChzaXplID0xNSksIAogICAgICAgIHN0cmlwLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUpKQogICAKI1NpbXBsaWZpZWQgZGlmZmVyZW5jZSBwbG90IApCTUlfZGlmZl9sb25nW1siRGlmZmVyZW5jZSJdXSA8LUJNSV9kaWZmX2xvbmdbWyJEaWZmZXJlbmNlIl1dJT4lCiAgc3RyX3JlcGxhY2UoIHBhdHRlcm4gPSAiX2RpZmZlcmVuY2UiLCByZXBsYWNlbWVudCA9ICIiKQoKRGlmZl9wbG90PC1CTUlfZGlmZl9sb25nICU+JSAKICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksIAogICAgICAgICBEaWZmZXJlbmNlICE9ICJOYXRpb25hbCIpICU+JQpnZ3Bsb3QoIGFlcyh4ID0gRGlmZmVyZW5jZSwgeSA9IHZhbHVlLCBjb2wgPSBEaWZmZXJlbmNlKSkgKyAKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIgLCBhZXMoZmlsbCA9IFNleCkpICsgCiAgc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzPWMoImRvZGdlcmJsdWUiLCAib3JjaGlkMiIpKSArCiAgZmFjZXRfZ3JpZCh+IFNleCkgKwogIGdlb21faml0dGVyKGRhdGE9Qk1JX2RpZmZfbG9uZyAlPiUgCiAgICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksIAogICAgICAgICAgIERpZmZlcmVuY2UgIT0gIk5hdGlvbmFsIiksIAogICAgYWVzKHggPURpZmZlcmVuY2UsIHkgPSB2YWx1ZSksIAogICAgd2lkdGggPSAuMiwgc2l6ZSA9IDIsIHNoYXBlID0gMjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9kaWZmX2xvbmcgJT4lIAogICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICBEaWZmZXJlbmNlICE9ICJOYXRpb25hbCIsIAogICAgICAgICAgIENvdW50cnkgPT0gIlVTQSIpKSwgCiAgICBhZXMoeCA9IERpZmZlcmVuY2UsIHkgPSB2YWx1ZSksIAogICAgd2lkdGggPSAuMDIsIHNpemUgPTEyLCBzaGFwZSA9MjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyAlPiUgCiAgICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksCiAgICAgICAgICAgRGlmZmVyZW5jZSAhPSAiTmF0aW9uYWwiKSwgCiAgICAgICAgICAgQ291bnRyeSA9PSAiVVNBIiksCiAgICBhZXMoeCA9IERpZmZlcmVuY2UsIHkgPSB2YWx1ZSxsYWJlbD1Db3VudHJ5KSwgCiAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZV9saW5lZHJhdygpICsKICAgICMgVGhpcyB3aWxsIG1ha2UgdGhlIGJhY2tncm91bmQgb2YgdGhlIHBsb3Qgd2hpdGUgYW5kIHRoZSBmYWNldCBsYWJlbHMgYmxhY2sKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCwgdmp1c3QgPSAwLjUpLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSkpCiAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgb2YgeCBheGlzIGxhYmVscyBmb3IgdGhlIGZhY2V0CgojYWRkIGxhYmVscwpEaWZmX3Bsb3Q8LURpZmZfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiQ2hhbmdlIGluIEJNSSBieSByZWdpb24iLCAKICAgICAgICAgICAgIHggPSAiIiwgCiAgICAgICAgICAgICB5ID0gIkNoYW5nZSBpbiBCTUkgXG4gKDE5ODUgdG8gMjAxNykiKSArCiAgICAgICAgdGhlbWUodGl0bGUgPSBlbGVtZW50X3RleHQgKHNpemUgPSAxMiwgZmFjZSA9ICJib2xkIikpCgpNZWFuc19wbG90IDwtTWVhbnNfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiTWVhbiBOYXRpb25hbCBCTUkgb3ZlciB0aW1lIiwgCiAgICAgICAgICAgICB4ID0gIiIsIAogICAgICAgICAgICAgeSA9ICJNZWFuIEJNSSIpICsKICAgICAgICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dCAoc2l6ZSA9IDEyLCBmYWNlID0gImJvbGQiKSkKCgoKb2Jlc2l0eV90ZXh0PC10aWJibGUoWWVhcj1jKDE5ODUpLEJNST1jKDMxKSxTZXg9YygiTWVuIiksbGFiZWw9YygiT2Jlc2l0eSIpKQoKTWVhbnNfcGxvdCA8LU1lYW5zX3Bsb3QgKyAKICAgICAgICAgICAgIGdlb21fdGV4dChkYXRhID0gb2Jlc2l0eV90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXB1bGwob2Jlc2l0eV90ZXh0LGxhYmVsKSwgCiAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgYWVzKCBmb250ZmFjZSA9ImJvbGQuaXRhbGljIiwgc2l6ZSA9IDEzKSkKCmNvd3Bsb3Q6OnBsb3RfZ3JpZChNZWFuc19wbG90LCBEaWZmX3Bsb3QsIGxhYmVscyA9IGMoIkEiLCAiQiIpKQpgYGAKCldlIGNvdWxkIG1ha2UgYSBzaW1pbGFyIHBsb3Qgd2l0aCB0aGUgYHBhdGNod29ya2AgcGFja2FnZToKYGBge3J9Ck1lYW5zX3Bsb3QgK2xhYnModGFnID0gJ0EnKSArIERpZmZfcGxvdCsgbGFicyh0YWcgPSAnQicpICsKICBwbG90X2xheW91dChndWlkZXMgPSAnY29sbGVjdCcsIG5jb2wgPSAyKQpgYGAKCkdyZWF0LCBub3cgd2UgaGF2ZSBwdXQgdHdvIHBsb3RzIHRvZ2V0aGVyIHVzaW5nIHRoZSBgcGxvdF9ncmlkKClgIGZ1bmN0aW9uIG9mIHRoZSBgY293cGxvdGAgcGFja2FnZS4gVGhpcyB3YXkgd2UgY2FuIGNsZWFybHkgY29tbXVuaWNhdGUgdHdvIG1lc3NhZ2VzLiBUaGUgZmlyc3QgYmVpbmcgdGhhdCBCTUkgaGFzIGluY3JlYXNlZCBvdmVyIHRpbWUgZ2xvYmFsbHkgYW5kIHRoYXQgbWFueSBjb3VudHJpZXMgaW5jbHVkaW5nIHRoZSBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EgYXJlIGFwcHJvYWNoaW5nIGEgbWVhbiBCTUkgdGhhdCBpcyBhYm92ZSB0aGUgb2Jlc2l0eSB0aHJlc2hvbGQgb2YgMzAuIFdlIGNhbiBhbHNvIHNlZSB0aGF0IHdvbWVuIG9uIGF2ZXJhZ2UgaGF2ZSBsYXJnZXIgQk1JIHZhbHVlcyB0aGFuIG1hbGVzLCBidXQgdGhhdCBib3RoIGdlbmRlcnMgc2hvdyBpbmNyZWFzZWQgbGV2ZWxzIG92ZXIgdGltZS4gSW4gdGhlIHNlY29uZCBwbG90IHdlIGNhbiBzZWUgdGhhdCB0aGUgaW5jcmVhc2UgaW4gQk1JIGlzIG5vdCBqdXN0IGhhcHBlbmluZyBpbiAgdXJiYW4gY29tbXVuaXRpZXMsIGJ1dCBpbiBib3RoIHJ1cmFsIGFuZCB1cmJhbiBjb21tdW5pdGllcyBhbmQgcGFydGljdWxhcmx5IGluIHdvbWVuLiAKCk91ciBwbG90IHZpc3VhbGx5IGV4cGxvcmVzIGFsbCBvZiBvdXIgbWFpbiBxdWVzdGlvbnM6CjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMikgSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PyBBZ2FpbiwgSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwozKSBIb3cgZG8gZGlmZmVyZW50IGNvdW50cmllcyBjb21wYXJlIGZvciBCTUkgZXN0aW1hdGVzPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCk5vdyBsZXQncyBzYXZlIG91ciBwbG90IGFzIGEgcG5nIGZpbGUgdXNpbmcgdGhlIGBwbmcoKWAgZnVuY3Rpb246CgpgYGB7cn0KcG5nKGhlcmU6OmhlcmUoImltZyIsICJtYWluX3Bsb3QucG5nIiksIGhlaWdodCA9IDE1MDAsIHdpZHRoID0gMjAwMCwgcmVzID0gMzAwKQpNZWFuc19wbG90ICtsYWJzKHRhZyA9ICdBJykgKyBEaWZmX3Bsb3QrIGxhYnModGFnID0gJ0InKSArCiAgcGxvdF9sYXlvdXQoZ3VpZGVzID0gJ2NvbGxlY3QnLCBuY29sID0gMikKZGV2Lm9mZigpCmBgYAoKWW91IG1pZ2h0IHRoaW5rIHRoYXQgdGhlc2UgdHdvIHBsb3RzIGxvb2sgYSBiaXQgb2RkIHRvZ2V0aGVyLCB0aGF0IGlmIHlvdSBsb29rIGF0IHRoZSBjaGFuZ2UgaW4gdGhlIGJveHBsb3RzIGluIHBhcnQgQSwgdGhhdCB0aGUgZGF0YSBmb3IgTWVuIHNob3dzIGEgYmlnZ2VyIGNoYW5nZSwgaG93ZXZlciwgd2UgY2FuJ3QgdGVsbCBmcm9tIHRoaXMgcGxvdCBob3cgdGhlIGluZGl2aWR1YWwgY291bnRyaWVzIGFyZSBjaGFuZ2luZy4gUGFydCBCIG9mIHRoZSBmaWd1cmUgbG9va3MgYXQgdGhlIHNwZWNpZmljIGNoYW5nZSBmb3IgZWFjaCBjb3VudHJ5LgoKV2UgY291bGQgY2hlY2sgb3VyIHBsb3QgdXNpbmcgdGhlIGZvbGxvd2luZyBjb2RlOgpgYGB7cn0KQk1JX2RpZmZfbG9uZyAlPiUKICBncm91cF9ieShTZXgsIERpZmZlcmVuY2UpICU+JQogIGZpbHRlcighaXMubmEodmFsdWUpKSU+JQogIGZpbHRlcihDb3VudHJ5ID09ICJVU0EiKSAlPiUKICBzdW1tYXJpemUobWVhbiA9IG1lYW4odmFsdWUpLCBtZWRpYW4gPSBtZWRpYW4odmFsdWUpKQoKQk1JX2RpZmZfbG9uZyAlPiUKICBncm91cF9ieShTZXgsIERpZmZlcmVuY2UpICU+JQogIGZpbHRlcighaXMubmEodmFsdWUpKSU+JQogIHN1bW1hcml6ZShtZWFuID0gbWVhbih2YWx1ZSksIG1lZGlhbiA9IG1lZGlhbih2YWx1ZSkpCgpCTUlfbG9uZyAlPiUKICBncm91cF9ieShTZXgsIFllYXIsIFJlZ2lvbikgJT4lCiAgZmlsdGVyKCFpcy5uYShCTUkpKSU+JQogIGZpbHRlcihDb3VudHJ5ID09ICJVU0EiKSAlPiUKICBzdW1tYXJpemUobWVhbiA9IG1lYW4oQk1JKSwgbWVkaWFuID0gbWVkaWFuKEJNSSkpCgpCTUlfbG9uZyAlPiUKICBncm91cF9ieShTZXgsIFllYXIsIFJlZ2lvbikgJT4lCiAgZmlsdGVyKCFpcy5uYShCTUkpKSU+JQogIHN1bW1hcml6ZShtZWFuID0gbWVhbihCTUkpLCBtZWRpYW4gPSBtZWRpYW4oQk1JKSkKCkJNSV9udW1lcmljICU+JQogICAgZ3JvdXBfYnkoU2V4KSU+JQogIHN1bW1hcml6ZShOYXRfbWVhbjE5ODUgPSBtZWFuKE5hdGlvbmFsX0JNSV8xOTg1KSwgTmF0X21lYW4yMDE3ID0gbWVhbihOYXRpb25hbF9CTUlfMjAxNykpCgpCTUlfbnVtZXJpYyAlPiUKICAgIGdyb3VwX2J5KFNleCklPiUKICBzdW1tYXJpemUoTmF0X21lZDE5ODUgPSBtZWRpYW4oTmF0aW9uYWxfQk1JXzE5ODUpLCBOYXRfbWVkMjAxNyA9IG1lZGlhbihOYXRpb25hbF9CTUlfMjAxNykpCmBgYAoKCldlIGNhbiBzZWUgdGhhdCB0aGUgbGFyZ2VzdCBjaGFuZ2VzIG9jY3VyIGZvciBXb21lbi4KClNjcm9sbCB0aHJvdWdoIHRoZSBvdXRwdXQhCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyfQpCTUlfZGlmZl9sb25nICU+JQogIGZpbHRlcih2YWx1ZT4zLjUpICU+JQogIGFycmFuZ2UoLXZhbHVlKSAlPiUKICAjIHRoaXMgYWxsb3dzIHVzIHRvIHNob3cgdGhlIGZ1bGwgb3V0cHV0CiAgcHJpbnQobiA9IDFlMykKYGBgCiMjIyMKCiMjIFN1bW1hcnkKCldlIGhhdmUgZXZhbHVhdGVkIEJNSSBhdmVyYWdlIGVzdGltYXRlcyBmcm9tIDIwMCBkaWZmZXJlbnQgY291bnRyaWVzIGFyb3VuZCB0aGUgd29ybGQuIFRvIGRvIHNvIHdlIGltcG9ydGVkIGRhdGEgZnJvbSBhIHBkZiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlLiBXZSB1c2VkIGB0aWR5dmVyc2VgIHBhY2thZ2VzIHN1Y2ggYXMgYGRwbHlyYCwgYHN0cmluZ3JgLCBhbmQgYHRpZHlgIHRvIGNsZWFuIHRoZSBkYXRhIGFuZCBnZXQgaXQgaW4gYSB3b3JrYWJsZSBmb3JtYXQuIE91ciBzdGF0aXN0aWNhbCBhbmFseXNpcyBmb2N1c2VkIG9uIGV2YWx1YXRpbmcgZGlmZmVyZW5jZXMgaW4gQk1JIGluIGZlbWFsZXMgYXJvdW5kIHRoZSB3b3JsZCBhY3Jvc3MgdGltZSBhbmQgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gYXJlYXMuIFdlIGZvdW5kIGEgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBib3RoIGJldHdlZW4geWVhcnMgYW5kIGJldHdlZW4gdGhlIHR5cGUgb2YgY29tbXVuaXR5IGFtb25nIHdvbWVuIGdsb2JhbGx5IHVzaW5nIFskdCQtdGVzdHNdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dHdvLXNhbXBsZSUyMHQtdGVzdCl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgW25vbnBhcmFtZXRyaWNdKGh0dHBzOi8vd3d3Lm1heW8uZWR1L3Jlc2VhcmNoL2RvY3VtZW50cy9wYXJhbWV0cmljLWFuZC1ub25wYXJhbWV0cmljLWRlbXlzdGlmeWluZy10aGUtdGVybXMvZG9jLTIwNDA4OTYwKXt0YXJnZXQ9Il9ibGFuayJ9IHRlc3RzLiBUaHVzIEJNSSBoYXMgaW5jcmVhc2VkIGluIHdvbWVuIHNpbmNlIDE5ODUuIEFsdGhvdWdoIEJNSSBlc3RpbWF0ZXMgYXJlIHNpZ25pZmljYW50bHkgaGlnaGVyIGluIFVyYmFuIGFyZWFzIGNvbXBhcmVkIHRvIHJ1cmFsIGFyZWFzLCBCTUkgZXN0aW1hdGVzIGhhdmUgaW5jcmVhc2VkIGluIGJvdGggcmVnaW9ucy4gV2UgbGVhcm5lZCB0aGF0IHRoZXJlIGFyZSBhc3N1bXB0aW9ucyBhbmQgY29uc2lkZXJhdGlvbnMgdG8ga2VlcCBpbiBtaW5kIHdoZW4gcGVyZm9ybWluZyB0ZXN0cyB0aGF0IGNvbXBhcmUgdHdvIGdyb3Vwcy4gCgo8dT4gV2UgbGVhcm5lZCB0aGF0IHRoZSAkdCQtdGVzdCByZWxpZXMgb246PC91PgoKMSkgbm9ybWFsaXR5IG9mIHRoZSBkYXRhIGZvciBib3RoIGdyb3VwcyAodGhpcyBpcyBub3QgYXMgbXVjaCBvZiBhbiBpc3N1ZSBpZiB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBpcyByZWxhdGl2ZWx5IGxhcmdlIHRvdGFsIG4+MzApCjIpIGVxdWFsIHZhcmlhbmNlIGJldHdlZW4gdGhlIHR3byBncm91cHMgKG1ha2Ugc3VyZSB5b3UgZG8gdGhlIGNvcnJlY3QgdGVzdCBpZiB0aGUgZGF0YSBpcyBub3Qgbm9ybWFsKQozKSBpbmRlcGVuZGVudCBvYnNlcnZhdGlvbnMgKG9yIGluZGVwZW5kZW50IHBhaXJlZCBvYnNlcnZhdGlvbnMpCgpXZSBsZWFybmVkIHRoYXQgd2UgY2FuIGV2YWx1YXRlIGlmIG91ciBkYXRhIGlzIFtub3JtYWxseSBkaXN0cmlidXRlZF0oaHR0cHM6Ly93d3cucGh5c2lvbG9neS5vcmcvZG9pL2Z1bGwvMTAuMTE1Mi9hZHZhbi4wMDA2NC4yMDE3KXt0YXJnZXQ9Il9ibGFuayJ9IGJ5IHBsb3R0aW5nIHRoZSBkaXN0cmlidXRpb24gYW5kIGJ5IGNyZWF0aW5nIFEtUSBwbG90cy4KCjx1PldlIGxlYXJuZWQgdGhhdCBpZiBvdXIgZGF0YSBpcyBub3Qgbm9ybWFsbHkgZGlzdHJpYnV0ZWQsIHdlIGNhbiBjb25zaWRlciB0aGVzZSBvcHRpb25zOjwvdT4KCjEpIFdlIGNhbiBzdGlsbCBwZXJmb3JtIGEgJHQkLXRlc3QgaWYgb3VyIG4gaXMgbGFyZ2UKMikgV2UgY2FuIHRyYW5zZm9ybSB0aGUgZGF0YSBiZWZvcmUgcGVyZm9ybWluZyBhICR0JC10ZXN0CjMpIFdlIGNhbiB1c2UgYSBub25wYXJhbWV0cmljIHRlc3QgKFdpbGNveG9uIHNpZ25lZCByYW5rIHRlc3QsIHRoZSBXaWxjb3hvbiByYW5rIHN1bSB0ZXN0LCBhbmQgdGhlIFR3by1zYW1wbGUgS29sbW9nb3Jvdi1TbWlybm92IChLUykgdGVzdCkKNCkgV2UgY2FuIHBlcmZvcm0gYSAkdCQtdGVzdCB3aXRoIHJlc2FtcGxpbmcgbWV0aG9kcyBmb3IgdmlvbGF0aW9ucyBvZiBub3JtYWxpdHkgKHdoaWNoIHNob3VsZCBiZSBlc3BlY2lhbGx5IGNvbnNpZGVyZWQgd2hlbiB0aGUgZ3JvdXBzIGFyZSBpbWJhbGFuY2VkKQoKV2UgbGVhcm5lZCB0aGF0IGlmIG91ciBncm91cHMgZG8gbm90IGhhdmUgZXF1YWwgdmFyaWFuY2UsIHRoYXQgd2UgbmVlZCB0byB1c2UgYSBtb2RpZmllZCAkdCQtdGVzdCB0byBhY2NvdW50IGZvciB0aGlzIG9yIHRoZSBjb3JyZWN0IG5vbnBhcmFtZXRyaWMgdGVzdCB0aGF0IGRvZXMgbm90IHJlbHkgb24gdGhpcyBhc3N1bXB0aW9uIChUd28tc2FtcGxlIEtvbG1vZ29yb3YtU21pcm5vdiB0ZXN0KS4KCgpGaW5hbGx5IGl0cyBhbHNvIGltcG9ydGFudCB0byByZW1lbWJlciB0aGF0IHdoZW4gd2UgaGF2ZSBbcGFpcmVkIGRhdGFdKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL3BhaXJlZC1kYXRhLyl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgaW50ZW5kIHRvIGNvbXBhcmUgbWVhbnMsIHdlIHNob3VsZCBwZXJmb3JtIGEgcGFpcmVkIHRlc3QgKFtwYWlyZWQgJHQkLXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL2h5cG90aGVzaXMtdGVzdC9wYWlyZWQtbWVhbnMuYXNweCNleGFtcGxlMSl7dGFyZ2V0PSJfYmxhbmsifSwgV2lsY294b24gc2lnbmVkIHJhbmsgdGVzdCwgb3IgcGFpcmVkIEtTIHRlc3QpLiBPdXIgZGF0YSB1c2VkIGluIHRoaXMgY2FzZSBzdHVkeSB3YXMgcGFpcmVkIGJlY2F1c2Ugb2JzZXJ2YXRpb25zIHdlcmUgdGFrZW4gZm9yIHRoZSBzYW1lIGNvdW50cmllcyBmb3IgZGlmZmVyZW50IGNhdGVnb3JpZXMgb2YgcG9wdWxhdGlvbnMgLSB0aHVzLCB3ZSB3YW50ZWQgdG8gY29tcGFyZSB0aGVzZSBwb3B1bGF0aW9ucyB3aXRoaW4gdGhlIHNhbWUgY291bnRyeSAobWFsZSB2cyBmZW1hbGUsIHJ1cmFsIHZzIHVyYmFuIGV0Yy4pLiBPdGhlciBleGFtcGxlcyB3b3VsZCBiZSBpbiBhIGNhc2UtY29udHJvbCBzdHVkeSAoaWYgc2FtcGxlcyBhcmUgbWF0Y2hlZCBmb3IgdmFyaW91cyBkZW1vZ3JhcGhpY3MpIG9yIGEgc3R1ZHkgd2l0aCByZXBlYXRlZCBtZWFzdXJlcyAoZm9yIGV4YW1wbGUsIHN5bXB0b20gbWVhc3VyZXMgZnJvbSB0aGUgc2FtZSBpbmRpdmlkdWFsIGJlZm9yZSBhbmQgYWZ0ZXIgYSB0cmVhdG1lbnQpLiAKCgpVc2luZyB0aGUgYGdncGxvdDJgIHBhY2thZ2Ugd2Ugd2VyZSBhYmxlIHRvIHZpc3VhbGl6ZSB0cmVuZHMgaW4gdGhlIGRhdGEuIEltcG9ydGFudGx5LCB0aGUgbGFyZ2VzdCBpbmNyZWFzZSBhcHBlYXJzIHRvIGJlIGluIHRoZSBydXJhbCBhcmVhcyBwYXJ0aWN1bGFybHkgZm9yIHdvbWVuLiBXZSB3ZXJlIGFsc28gYWJsZSB0byBpZGVudGlmeSBob3cgdGhlIFVTIGNvbXBhcmVkIHRvIG90aGVyIGNvdW50cmllcyBhbmQgd2hpY2ggY291bnRyaWVzIHNob3dlZCB0aGUgbGFyZ2VzdCBpbmNyZWFzZSBpbiBCTUkgb3ZlciB0aW1lLiBBbmFseXNlcyBsaWtlIHRoaXMgYXJlIGltcG9ydGFudCBmb3IgZGVmaW5pbmcgd2hpY2ggZ3JvdXBzIGNvdWxkIGJlbmVmaXQgdGhlIG1vc3QgZnJvbSBpbnRlcnZlbnRpb25zLCBlZHVjYXRpb24sIGFuZCBwb2xpY3kgY2hhbmdlcyB3aGVuIGF0dGVtcHRpbmcgdG8gbWl0aWdhdGUgcHVibGljIGhlYWx0aCBjaGFsbGVuZ2VzLiBZb3UgY2FuIHNlZSBpbiB0aGUgW2FydGljbGVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg2LTAxOS0xMTcxLXgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHRoYXQgdGhpcyBkYXRhIGNhbWUgZnJvbSB0aGF0IG1hbnkgYWRkaXRpb25hbCBjb25zaWRlcmF0aW9ucyB3b3VsZCBiZSBpbnZvbHZlZCB0byBwZXJmb3JtIHN1Y2ggYW4gYW5hbHlzaXMuCgoKIyMjIFN1Z2dlc3RlZCBIb21ld29yawoKU3R1ZGVudHMgY2FuIGV2YWx1YXRlIHRoZSBjaGFuZ2UgaW4gQk1JIG92ZXIgdGltZSB1c2luZyB0aGUgZ2xvYmFsIGRhdGEgYXZhaWxhYmxlIGZvciBlYWNoIHllYXIgYmV0d2VlbiAyMDE1IGFuZCAyMDE3LiBUaGUgZGF0YSBjYW4gYmUgZm91bmQgW2hlcmVdKGh0dHA6Ly93d3cubmNkcmlzYy5vcmcvZG93bmxvYWRzL2JtaS9OQ0RfUmlzQ19MYW5jZXRfMjAxN19CTUlfYWdlX3N0YW5kYXJkaXNlZF93b3JsZC5jc3Ype3RhcmdldD0iX2JsYW5rIn0uCgojIyMgSGVscGZ1bCBMaW5rcwoKW0JNSV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9oZWFsdGh5d2VpZ2h0L2Fzc2Vzc2luZy9ibWkvYWR1bHRfYm1pL2luZGV4Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbTG9uZyBhbmQgV2lkZSBEYXRhIEZvcm1hdHNdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbRGlzdHJpYnV0aW9uc10oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KW05vcm1hbCBEaXN0cmlidXRpb25dKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9pbnRyb2R1Y3Rpb24vZGlzdHJpYnV0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9CltTa2V3ZWQgRGlzdHJpYnV0aW9uc10oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2dsb3NzYXJ5L3NrZXcuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAKW0JpbW9kYWwgRGlzdHJpYnV0aW9uXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAKW2dncGxvdDJdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gICAgCltRLVEgUGxvdHNdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9hZHZhbmNlZF9ncmFwaHMvcS1xX3Bsb3RzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbU3R1ZGVudCAkdCQtdGVzdF0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj10d28tc2FtcGxlJTIwdC10ZXN0KSAgIApbUGFpcmVkIERhdGFdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzU1Nzk0NjUvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1dlbGNoJ3MgJHQkLXRlc3RdKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL3dlbGNocy10ZXN0LWZvci11bmVxdWFsLXZhcmlhbmNlcy8pe3RhcmdldD0iX2JsYW5rIn0gICAgCltQYXJhbWV0cmljIGFuZCBOb25wYXJhbWV0cmljIE1ldGhvZHNdKGh0dHBzOi8vd3d3Lm1heW8uZWR1L3Jlc2VhcmNoL2RvY3VtZW50cy9wYXJhbWV0cmljLWFuZC1ub25wYXJhbWV0cmljLWRlbXlzdGlmeWluZy10aGUtdGVybXMvZG9jLTIwNDA4OTYwKSAgCltWYXJpYW5jZV0oaHR0cHM6Ly9zdGF0dHJlay5jb20vc3RhdGlzdGljcy9kaWN0aW9uYXJ5LmFzcHg/ZGVmaW5pdGlvbj12YXJpYW5jZSl7dGFyZ2V0PSJfYmxhbmsifSAgCltCYWxhbmNlZCBTdHVkeSBEZXNpZ25dKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL2JhbGFuY2VkLWFuZC11bmJhbGFuY2VkLWRlc2lnbnMvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW0luZGVwZW5kZW50IE9ic2VydmF0aW9uc10oaHR0cHM6Ly93d3cuc3RhdC5jbXUuZWR1L35jc2hhbGl6aS8zNi0yMjAvbGVjdHVyZS01LnBkZil7dGFyZ2V0PSJfYmxhbmsifSAgCltUcmFuc2Zvcm1hdGlvbl0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vdHJhbnNmb3JtYXRpb24tc3RhdGlzdGljcy8pe3RhcmdldD0iX2JsYW5rIn0gIApbUGVybXV0YXRpb24vUmVzYW1wbGluZyBNZXRob2RzXShodHRwczovL2podS1hZHZkYXRhc2NpLmdpdGh1Yi5pby8yMDE5L2xlY3R1cmVzLzIxLXJlc2FtcGxpbmctdGVjaG5pcXVlcy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgCltDZW50cmFsIExpbWl0IFRoZW9yZW1dKGh0dHBzOi8vd3d3LmFuYWx5dGljc3ZpZGh5YS5jb20vYmxvZy8yMDE5LzA1L3N0YXRpc3RpY3MtMTAxLWludHJvZHVjdGlvbi1jZW50cmFsLWxpbWl0LXRoZW9yZW0vKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW01vb2QncyBUd28tU2FtcGxlIFNjYWxlIFRlc3RdKGh0dHBzOi8vZmlsZXMuZXJpYy5lZC5nb3YvZnVsbHRleHQvRUQwNjU1NTkucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1dpbGNveG9uIFNpZ25lZCBSYW5rIFRlc3RdKGh0dHA6Ly93d3cuYmlvc3RhdGhhbmRib29rLmNvbS93aWxjb3hvbnNpZ25lZHJhbmsuaHRtbCkgICAKW1dpbGNveG9uIFJhbmsgU3VtIFRlc3RdKGh0dHA6Ly9zcGh3ZWIuYnVtYy5idS5lZHUvb3RsdC9tcGgtbW9kdWxlcy9icy9iczcwNF9ub25wYXJhbWV0cmljL0JTNzA0X05vbnBhcmFtZXRyaWM0Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbVHdvLXNhbXBsZSBLb2xtb2dvcm92LVNtaXJub3YgVGVzdF0oaHR0cHM6Ly93d3cuaXRsLm5pc3QuZ292L2Rpdjg5OC9zb2Z0d2FyZS9kYXRhcGxvdC9yZWZtYW4xL2F1eGlsbGFyL2tzMnNhbXAuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1R5cGUgMSBFcnJvcl0oaHR0cHM6Ly93ZWIubWEudXRleGFzLmVkdS91c2Vycy9ta3Mvc3RhdG1pc3Rha2VzL2Vycm9ydHlwZXMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgCltwLXZhbHVlXShodHRwczovL3Rvd2FyZHNkYXRhc2NpZW5jZS5jb20vcC12YWx1ZXMtZXhwbGFpbmVkLWJ5LWRhdGEtc2NpZW50aXN0LWY0MGE3NDZjZmM4KXt0YXJnZXQ9Il9ibGFuayJ9ICAKW011bHRpcGxlIFRlc3RpbmddKGh0dHBzOi8vd3d3LmdzLndhc2hpbmd0b24uZWR1L2FjYWRlbWljcy9jb3Vyc2VzL2FrZXkvNTYwMDgvbGVjdHVyZS9sZWN0dXJlMTAucGRmKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIApbQm9uZmVycm9uaSBNZXRob2Qgb2YgTXVsdGlwbGUgVGVzdGluZyBDb3JyZWN0aW9uXShodHRwOi8vbWF0aHdvcmxkLndvbGZyYW0uY29tL0JvbmZlcnJvbmlDb3JyZWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KCgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
