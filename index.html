<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Open Case Studies: Exploring global patterns of obesity across rural and urban regions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Open Case Studies: Exploring global patterns of obesity across rural and urban regions</h1>

</div>


<style>
#TOC {
  background: url("https://opencasestudies.github.io/img/logo.jpg");
  background-size: contain;
  padding-top: 240px !important;
  background-repeat: no-repeat;
}
</style>
<div id="section" class="section level4 outline">
<h4></h4>
<p><img src="img/main_plot.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level2 disclaimer_block">
<h2></h2>
<p><strong>Disclaimer</strong>: The purpose of the <a href="https://opencasestudies.github.io" target="_blank">Open Case Studies</a> project is <strong>to demonstrate the use of various data science methods, tools, and software in the context of messy, real-world data</strong>. A given case study does not cover all aspects of the research process, is not claiming to be the most appropriate way to analyze a given dataset, and should not be used in the context of making policy decisions without external consultation from scientific experts.</p>
</div>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Body mass index (<a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html">BMI</a>){target=&quot;_blank&quot;} is often used as a proxy for <strong>adiposity</strong> (the condition of having excess body fat) and is measured as an individual’s weight in kilograms (kg) or pounds (lbs) divided by the individual’s height in meters (<span class="math inline">\(m^2\)</span>) squared.</p>
<p>There are different categories of weight defined using different BMI thresholds as defined by the <a href="http://www.euro.who.int/en/health-topics/disease-prevention/nutrition/a-healthy-lifestyle/body-mass-index-bmi" target="_blank">World Health Organization</a> (WHO), the <a href="https://www.cdc.gov/obesity/adult/defining.html" target="_blank">Centers for Disease Control and Prevention</a>, and the <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf" target="_blank">National Institutes of Health</a>. For example, these are the categories defined by the WHO:</p>
<p><img src="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg" width="90%" style="display: block; margin: auto;" /></p>
<div id="source" class="section level6">
<h6>[<a href="https://www.ncbi.nlm.nih.gov/books/NBK535456/bin/bmi_WHO.jpg" target="_blank">source</a>]</h6>
<p>The following chart can help you identify your estimate of BMI: <img src="http://content.everydayhealth.com/mayodiet/images/BMI-chart.jpg" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-1" class="section level6">
<h6>[<a href="http://diet.mayoclinic.org/diet/eat/what-is-your-bmi?xid=nl_MayoClinicDiet_20160426" target="_blank">source</a>]</h6>
<p>Previous work has shown higher BMI (&gt;30) is associated with <a href="https://www.nhlbi.nih.gov/sites/default/files/media/docs/obesity-evidence-review.pdf" target="_blank">higher rates of all-causes of mortality</a>, as well as increased rates of type 2 diabetes, cancer, heart disease, and stroke.</p>
<p>Recently, an <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf" target="_blank">article</a> published in <a href="https://www.nature.com" target="_blank"><em>Nature</em></a> evaluated and compared the Body-Mass Index (BMI) of populations in rural and urban communities around the world:</p>
<p><img src="img/paper.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="section-2" class="section level4 reference_block">
<h4></h4>
<p>NCD Risk Factor Collaboration (NCD-RisC). Rising rural body-mass index is the main driver of the global obesity epidemic in adults. <em>Nature</em> <strong>569</strong>, 260–264 (2019).</p>
</div>
<div id="section-3" class="section level4">
<h4></h4>
<p>The article challenged the widely-held view that increased urbanization was one of the major reasons for increased global obesity rates. This view came about because many countries around the world have shown increased urbanization levels in parallel with increased obesity rates. In this article, however, the NCD-RisC argued that this might not be the case and that in fact for most regions around the world, BMI measurements are increasing in rural populations just as much, if not more so, than urban populations. Furthermore, this study suggested that obesity has particularly increased in female populations in rural regions:</p>
<blockquote>
<p>“We noted a persistently higher rural BMI, especially for women.”</p>
</blockquote>
<p>In this case study, we will evaluate the data reported in this article to explore regional and gender specific differences in the obesity rates around the world in 1985 and 2017. Most importantly we will test if there is a difference in obesity rates between rural and urban communities and if there has been a change in obesity over time for these regions, particularly for women. To do this we will test if there is a difference between the average BMI for each group.</p>
<p>While <a href="https://www.genderspectrum.org/quick-links/understanding-gender/" target="_blank">gender</a> and <a href="https://www.who.int/genomics/gender/en/index1.html" target="_blank">sex</a> are not actually binary, the data presented that is used in this analysis only contain data for groups of individuals described as men or women.</p>
</div>
<div id="main-questions" class="section level3">
<h3>Main Questions</h3>
<div id="section-4" class="section level4 main_question_block">
<h4></h4>
<p><b><u> Our main questions are: </u></b></p>
<ol style="list-style-type: decimal">
<li>Is there a difference between rural and urban BMI estimates around the world? In particular, what does this difference look like for women?</li>
<li>How have BMI estimates changed from 1985 to 2017? In particular, what does this change over time look like for women?</li>
<li>How do different countries vary in terms of estimates of BMI? In particular, how does the United States compare to the rest of the world?</li>
</ol>
</div>
<div id="section-5" class="section level4">
<h4></h4>
</div>
</div>
<div id="learning-objectives" class="section level3">
<h3>Learning Objectives</h3>
<p>In this case study, we will walk you through importing data from a pdf, cleaning, wrangling and visualizing the data, and <b> comparing two groups </b>.</p>
<p>We will use well-established and commonly used packages, including <code>stringr</code>, <code>tidyr</code>, <code>dplyr</code>, <code>purrr</code>, and <code>ggplot2</code> from the <a href="https://www.tidyverse.org/" target="_blank"><code>tidyverse</code></a>. Specifically, the tidyverse is</p>
<blockquote>
<p>“an opinionated collection of R packages designed for data science. All packages share an underlying philosophy and common APIs”.</p>
</blockquote>
<p>Another way of putting it is that it’s a set of packages that are useful specifically for data manipulation, exploration and visualization with a common philosophy. While some students may be familiar with previous packages from the R programming language, these packages make data science in R especially efficient.</p>
<p><img src="https://tidyverse.tidyverse.org/logo.png" width="20%" style="display: block; margin: auto;" /></p>
<p>We will begin by loading the packages that we will need with a brief explanation:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(pdftools)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">library</span>(patchwork)</a></code></pre></div>
<table>
<colgroup>
<col width="43%" />
<col width="56%" />
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/jennybc/here_here" target="_blank">here</a></td>
<td>to easily load and save data with relative paths</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/pdftools/pdftools.pdf" target="_blank">pdftools</a></td>
<td>to read a text from pdf into R</td>
</tr>
<tr class="odd">
<td><a href="https://stringr.tidyverse.org/articles/stringr.html" target="_blank">stringr</a></td>
<td>to manipulate the text data</td>
</tr>
<tr class="even">
<td><a href="https://readr.tidyverse.org/" target="_blank">readr</a></td>
<td>to manipulate the text data within the pdf into individual lines</td>
</tr>
<tr class="odd">
<td><a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a></td>
<td>to arrange/filter/select subsets of the data</td>
</tr>
<tr class="even">
<td><a href="https://tibble.tidyverse.org/" target="_blank">tibble</a></td>
<td>to create data objects that we can manipulate with <code>dplyr</code>/<code>stringr</code>/<code>tidyr</code>/<code>purrr</code></td>
</tr>
<tr class="odd">
<td><a href="https://magrittr.tidyverse.org/articles/magrittr.html" target="_blank">magrittr</a></td>
<td>to use the <code>%&lt;&gt;%</code> piping operator</td>
</tr>
<tr class="even">
<td><a href="https://www.tidyverse.org/blog/2017/10/glue-1.2.0/" target="_blank">glue</a></td>
<td>to paste or combine character strings and data together</td>
</tr>
<tr class="odd">
<td><a href="https://purrr.tidyverse.org/" target="_blank">purrr</a></td>
<td>to perform functions on all columns of a tibble</td>
</tr>
<tr class="even">
<td><a href="https://tidyr.tidyverse.org/" target="_blank">tidyr</a></td>
<td>to convert data from ‘wide’ to ‘long’ format</td>
</tr>
<tr class="odd">
<td><a href="https://ggplot2.tidyverse.org/">ggplot2</a></td>
<td>to make visualizations with multiple layers</td>
</tr>
<tr class="even">
<td><a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html" target="_blank">ggrepel</a></td>
<td>to allow labels in figures not to overlap</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html" target="_blank">cowplot</a> and <a href="https://github.com/thomasp85/patchwork" target="_blank">patchwork</a></td>
<td>to allow plots to be combined</td>
</tr>
</tbody>
</table>
<hr />
<p>The first time we use a function, we will use the <code>::</code> to indicate which package we are using (e.g. <code>stringr::str_detect()</code>). Unless we have overlapping function names, this is not necessary, but we will include it here to be informative about where the functions we will use come from.</p>
</div>
<div id="context" class="section level3">
<h3>Context</h3>
<p>The measurement of BMI has some <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/pdf/nt-50-117.pdf" target="_blank">limitations</a> that are well recognized, as it does not account for the composition of body mass, the location of body fat, or the contribution of body frame size. However, <a href="https://journals.lww.com/acsm-healthfitness/Fulltext/2016/07000/THE_BENEFITS_OF_BODY_MASS_INDEX_AND_WAIST.8.aspx#pdf-link" target="_blank">BMI has been a useful health indicator</a> for risk for many diseases and conditions particularly when combined with other risk factor information.</p>
</div>
</div>
<div id="what-are-the-data" class="section level2">
<h2>What are the data?</h2>
<p>We will be using data located within a table of the <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf" target="_blank">supplementary material</a> for the NCD-RisC paper referenced above.</p>
<p>This is a pdf that can be found freely available online. Here is a screenshot of the first few rows of this table:</p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>You can see that the data contain average BMI estimates for both men and women in countries at the national level, as well as the average BMI estimates for the rural and urban areas of these countries in both 1985 and 2017.</p>
<p>The data within the parentheses are the 95% <a href="https://en.wikipedia.org/wiki/Credible_interval" target="_blank">credible intervals</a> (CIs) for the average BMI estimates. The authors provide these CIs as a guide to understand how likely the estimate is for the true population mean BMI. A wider range suggests that the estimate is less accurate, as there are more possible values for the true mean with credible evidence. Notice that the mean BMI values are “age-standardized,” this means that the mean values were adjusted for the different age distributions of the various countries so that the countries can be more fairly compared. For example, if one country has a population that is considerably younger, the mean BMI might be quite low (as younger individuals tend to have lower BMI values due to faster metabolic rates). One might falsely conclude that people in that country generally have lower BMI values than people in most other countries, however the lower overall BMI mean might simply be due to the fact that the country has a younger population than those other countries.</p>
</div>
<div id="data-import" class="section level2">
<h2>Data Import</h2>
<p>First let’s download the data from the PDF file. We use <code>file.exists()</code> from base R to check if the file we want to download already exists. If not, then we download it using the function <code>utils::download.file()</code>. We also use the <code>here()</code> function of the <code>here</code> package to look specifically in the <code>docs</code> directory` of the directory where our open Rstudio project file is located. This helps us, as we do not need to write the full path to the document. This makes our code more reproducible for someone else, who may have a different overall file structure on their computer but downloads our case study files from GitHub and therefore has the same file structure specifically for the files included in our GitHub repository. Thus our commands about file locations still work on their local machine.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))){</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  url &lt;-<span class="st"> &quot;https://static-content.springer.com/esm/art%3A10.1038%2Fs41586-019-1171-x/MediaObjects/41586_2019_1171_MOESM1_ESM.pdf&quot;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  utils<span class="op">::</span><span class="kw">download.file</span>(url, <span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a></code></pre></div>
<p>Now that we have downloaded the PDF file, we will read it in to R using the <code>pdftools</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">pdf_obesity &lt;-<span class="st"> </span>pdftools<span class="op">::</span><span class="kw">pdf_text</span>(<span class="kw">here</span>(<span class="st">&quot;docs&quot;</span>, <span class="st">&quot;paper_supplement.pdf&quot;</span>))</a></code></pre></div>
<p>Let’s take a look at the data – the <code>summary()</code> function from base R helps us to look at the structure of R objects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">summary</span>(pdf_obesity)</a></code></pre></div>
<pre><code>   Length     Class      Mode 
       63 character character </code></pre>
<p>We can see that we have 63 elements that are character strings. You may also notice that the original PDF has 63 pages. Let’s take a look at some of these elements and compare them to the pages in the original document.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">pdf_obesity[<span class="dv">1</span>] <span class="co"># this looks like the first page</span></a></code></pre></div>
<pre><code>[1] &quot;Letter                                                                                https://doi.org/10.1038/s41586-019-1171-x\nRising rural body-mass index is the main driver of\nthe global obesity epidemic in adults\nNCD Risk Factor Collaboration (NCD-RisC)*\n*A list of authors and their affiliations appears in the online version of the paper.\n2 6 0 | N A T U RE | V O L 5 6 9 | 9 M A Y 2 0 1 9\n&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pdf_obesity[<span class="dv">2</span>] <span class="co"># this looks like the second page</span></a></code></pre></div>
<pre><code>[1] &quot;Supplementary Information. Statistical model for estimating BMI trends by rural and urban\nplace of residence.\n                                          1\n&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">str</span>(pdf_obesity[<span class="dv">52</span>], <span class="dt">nchar.max =</span> <span class="dv">1600</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                          2                                                           2\n                                  Age-standardised mean BMI in 1985 (kg/m )                   Age-standardised mean BMI in 2017 (kg/m )\n             Country     Sex\n                             National               Rural                Urban           National               Rural                Urban\n                     Men     20.2 (17.8-22.7)      19.7 (17.2-22.2)     22.4 (20.0-25.0) 22.8 (20.3-25.3)      22.5 (20.0-25.0)     23.6 (21.0-26.1)\nAfghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)\n                     Men     25.2 (23.9-26.5)      25.0 (23.7-26.4)     25.4 (24.0-26.7) 27.0 (26.0-27.9)      26.9 (25.9-27.9)     27.0 (26.0-28.0)\nAlbania              Women   26.0 (24.1-27.9)      26.1 (24.1-28.1)     25.9 (23.9-27.8) 26.0 (24.8-27.2)      26.2 (24.8-27.5)     25.9 (24.6-27.2)\n                     Men     22.1 (20.8-23.3)      21.8 (20.5-23.1)     22.3 (21.0-23.6) 25.1 (24.5-25.7)      24.8 (24.1-25.4)     25.2 (24.6-25.9)\nAlgeria              Women   24.0 (22.2-25.7)      23.3 (21.4-25.1)     24.8 (22.9-26.6) 27.4 (26.7-28.0)      27.0 (26.3-27.8)     27.5 (26.7-28.2)\n                     Men     33.7 (32.7-34.7)      32.6 (31.7-33.5)     34.0 (32.9-35.1) 34.3 (33.0-35.6)      34.6 (33.1-35.9)     34.2 (32.9-35.6)\nAmerican Samoa       Women   34.3 (33.1-35.6)      34.1 (33.0-35.2)     34.4 (33.0-35.8) &quot;| __truncated__</code></pre>
<p>Yes, this looks like data in a the table we want. We are using the <code>str()</code> function to print just a portion of the data. The <code>str()</code> function compactly displays the structure of arbitrary R objects. The <code>nchar.max</code> argument let’s us define the maximal number of characters to show. Note <code>print(pdf_obesity[52])</code> would show the entire contents of the this page of the table.</p>
<p>Here is the PDF version again: <img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that the output looks pretty similar to the pages of the pdf, but the spacing is a bit awkward. Note that the way the data is displayed is partially influenced by the width setting of the RStudio window.</p>
<p>Now, we are interested in a supplementary Table 3, which has multiple pages and includes the same header on each page. We can use that to determine what elements of our <code>pdf_obesity</code> character strings include our table. We will use the <code>str_detect()</code> function from the <code>stringr</code> package to search for the elements that contain text that is consistently in the header. The output of of this function will show which elements of the object (in this case pages of the pdf) include this pattern indicated as a <code>TRUE</code> or <code>FALSE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">stringr<span class="op">::</span><span class="kw">str_detect</span>(<span class="dt">pattern =</span> <span class="st">&quot;Age-standardised mean BMI&quot;</span>, </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                    <span class="dt">string =</span> pdf_obesity)</a></code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[45] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[56]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>We note, the “Age-standardised mean BMI” is part of the header in the table on every page. The code above shows the pages that contain our table of interest (as <code>TRUE</code> values).</p>
<p>Now we will extract just the data for the table now and call it <code>rural_urban</code>. To do this we will use the <code>str_subset()</code> function of the <code>stringr</code> package.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">rural_urban &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_subset</span>(<span class="dt">pattern =</span> <span class="st">&quot;Age-standardised mean BMI&quot;</span>, </a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                                   <span class="dt">string =</span> pdf_obesity)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">summary</span>(rural_urban) </a></code></pre></div>
<pre><code>   Length     Class      Mode 
       10 character character </code></pre>
<p>Here, we see there are 10 pages worth of elements in our <code>rural_urban</code> object.</p>
<p>Let’s check the first and last page:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">str</span>(rural_urban[<span class="dv">1</span>], <span class="dt">nchar.max =</span> <span class="dv">1600</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                          2                                                           2\n                                  Age-standardised mean BMI in 1985 (kg/m )                   Age-standardised mean BMI in 2017 (kg/m )\n             Country     Sex\n                             National               Rural                Urban           National               Rural                Urban\n                     Men     20.2 (17.8-22.7)      19.7 (17.2-22.2)     22.4 (20.0-25.0) 22.8 (20.3-25.3)      22.5 (20.0-25.0)     23.6 (21.0-26.1)\nAfghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)\n                     Men     25.2 (23.9-26.5)      25.0 (23.7-26.4)     25.4 (24.0-26.7) 27.0 (26.0-27.9)      26.9 (25.9-27.9)     27.0 (26.0-28.0)\nAlbania              Women   26.0 (24.1-27.9)      26.1 (24.1-28.1)     25.9 (23.9-27.8) 26.0 (24.8-27.2)      26.2 (24.8-27.5)     25.9 (24.6-27.2)\n                     Men     22.1 (20.8-23.3)      21.8 (20.5-23.1)     22.3 (21.0-23.6) 25.1 (24.5-25.7)      24.8 (24.1-25.4)     25.2 (24.6-25.9)\nAlgeria              Women   24.0 (22.2-25.7)      23.3 (21.4-25.1)     24.8 (22.9-26.6) 27.4 (26.7-28.0)      27.0 (26.3-27.8)     27.5 (26.7-28.2)\n                     Men     33.7 (32.7-34.7)      32.6 (31.7-33.5)     34.0 (32.9-35.1) 34.3 (33.0-35.6)      34.6 (33.1-35.9)     34.2 (32.9-35.6)\nAmerican Samoa       Women   34.3 (33.1-35.6)      34.1 (33.0-35.2)     34.4 (33.0-35.8) &quot;| __truncated__</code></pre>
<p>Using <code>[1]</code> shows just the first page of the 10 pages that contain the table. Also, notice the new line <code>&quot;\n&quot;</code> values that indicate new lines.</p>
<p><img src="img/first_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This looks the same as the beginning… how about the end?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">str</span>(rural_urban[<span class="dv">10</span>], <span class="dt">nchar.max =</span> <span class="dv">1800</span>)</a></code></pre></div>
<pre><code> chr &quot;                                                                                                            2                                                                  2\n                                                                   Age-standardised mean BMI in 1985 (kg/m )                           Age-standardised mean BMI in 2017 (kg/m )\n              Country                         Sex\n                                                              National               Rural                 Urban                  National               Rural                Urban\n                                        Men                   20.0 (18.6-21.4)      19.6 (18.1-21.1)      20.7 (19.2-22.0)        22.2 (21.6-22.9)      21.7 (21.0-22.4)     23.0 (22.3-23.7)\nZambia                                  Women                 21.4 (20.3-22.6)      20.7 (19.5-21.9)      22.5 (21.3-23.7)        23.9 (23.3-24.5)      22.7 (22.1-23.3)     25.5 (24.9-26.2)\n                                        Men                   21.2 (20.2-22.3)      20.9 (19.8-22.1)      22.1 (21.1-23.1)        22.3 (21.7-22.9)      21.9 (21.2-22.5)     23.3 (22.6-23.9)\nZimbabwe                                Women                 24.6 (23.5-25.9)      24.0 (22.8-25.4)      26.5 (25.3-27.8)        25.3 (24.6-26.1)      24.5 (23.7-25.3)     27.1 (26.2-27.9)\n*The entire population live in areas classified as urban (Bermuda, Hong Kong (from 1992 onwards), Nauru and Singapore) or rural (Tokelau).\nNumbers in parentheses show 95% credible intervals.\n                                                                                                 60\n&quot;</code></pre>
<p><img src="img/last_page.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great! Our <code>rural_urban</code> object looks like it contains the entire Supplementary 3 table, as both the beginning and the end include the data we expected.</p>
</div>
<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>At this point we have large strings now for each page of the table, but this is not very convenient to work with. Now, we will wrangle the data into a more usable form. Ideally, we would like our data to be in some sort of tabular form.</p>
<div id="separate-the-data-into-lines" class="section level3">
<h3>Separate the data into lines</h3>
<p>First, it would be useful to separate the data that is currently in 10 giant string chunks into individual lines or rows of the table. To do this we can use the <code>read_lines()</code> function of the <code>readr</code> package which will separate the lines based on the <code>&quot;\n&quot;</code> new line characters.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">summary</span>(rural_urban)</a></code></pre></div>
<pre><code>   Length     Class      Mode 
       10 character character </code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">rural_urban &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_lines</span>(rural_urban)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">summary</span>(rural_urban) </a></code></pre></div>
<pre><code>   Length     Class      Mode 
      461 character character </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># now we have 461 lines</span></a></code></pre></div>
<p>We can see that each string in the <code>rural_urban</code> object is now a single line from the table.</p>
<p>For example, line 6 shows the data for women in Afghanistan.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">rural_urban[<span class="dv">6</span>] </a></code></pre></div>
<pre><code>[1] &quot;Afghanistan          Women   20.6 (18.4-22.8)      20.1 (17.8-22.4)     23.2 (20.9-25.4) 24.4 (23.3-25.4)      23.6 (22.5-24.8)     26.3 (25.1-27.4)&quot;</code></pre>
</div>
<div id="removing-excess-white-space" class="section level3">
<h3>Removing excess white-space</h3>
<p>We also have a lot of white-space. Let’s get rid of the excess white spaces using <code>str_squish()</code> also from the <code>stringr</code> package.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">rural_urban &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_squish</span>(rural_urban) </a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;2 2&quot;                                                                                                                    
[2] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                    
[3] &quot;Country Sex&quot;                                                                                                            
[4] &quot;National Rural Urban National Rural Urban&quot;                                                                              
[5] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[6] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;</code></pre>
<p>Now it is much easier to see the data.</p>
<p>If we look at the part of our data that contains the end of the first page of the table and the start of the second we can see that the header information is repeated, as well as a line with the page number and an empty line, and a line that says “2 2”.</p>
<div id="section-6" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">rural_urban[<span class="dv">44</span><span class="op">:</span><span class="dv">56</span>] <span class="co"># scroll through!</span></a></code></pre></div>
<pre><code> [1] &quot;Benin Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;  
 [2] &quot;Men 24.3 (21.8-26.8) na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* 26.7 (24.3-29.2)&quot;                                    
 [3] &quot;Bermuda Women 25.4 (22.2-28.6) na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* 28.5 (25.3-31.6)&quot;                          
 [4] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;          
 [5] &quot;Bhutan Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot; 
 [6] &quot;51&quot;                                                                                                                 
 [7] &quot;&quot;                                                                                                                   
 [8] &quot;2 2&quot;                                                                                                                
 [9] &quot;Age-standardised mean BMI in 1985 (kg/m ) Age-standardised mean BMI in 2017 (kg/m )&quot;                                
[10] &quot;Country Sex&quot;                                                                                                        
[11] &quot;National Rural Urban National Rural Urban&quot;                                                                          
[12] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;          
[13] &quot;Bolivia Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;</code></pre>
</div>
<div id="section-7" class="section level4">
<h4></h4>
<p>Although the header was necessary on all of the pages of the pdf version of the table, we only need that information once in our data.</p>
</div>
</div>
<div id="removing-unnecessary-repeated-header-information" class="section level3">
<h3>Removing unnecessary repeated header information</h3>
<p>So, let’s remove all the header information and the page number lines from the <code>rural_urban</code> object, then we will make a single line header for the beginning. One way to do this is to find all lines that include either “Women” or “Men” and only keep this data.</p>
<p>First, let’s see how many lines include “Women” or “Men”. We can do this by first identifying the lines that contain these patterns and then check the length of the resulting vector for the line numbers that contain these patterns. Note, the <code>&quot;|&quot;</code> indicates that we are looking for either “Women” or “Men”.</p>
<div id="section-8" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co">#scroll through the output!</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb31-3" data-line-number="3">                   <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<pre><code>  [1]   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21
 [18]  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38
 [35]  39  40  41  42  43  44  45  46  47  48  55  56  57  58  59  60  61
 [52]  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78
 [69]  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
 [86]  96  97  98 105 106 107 108 109 110 111 112 113 114 115 116 117 118
[103] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135
[120] 136 137 138 139 140 141 142 143 144 145 146 147 148 155 156 157 158
[137] 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175
[154] 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192
[171] 193 194 195 196 197 198 205 206 207 208 209 210 211 212 213 214 215
[188] 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232
[205] 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 255
[222] 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272
[239] 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289
[256] 290 291 292 293 294 295 296 297 298 305 306 307 308 309 310 311 312
[273] 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329
[290] 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346
[307] 347 348 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369
[324] 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386
[341] 387 388 389 390 391 392 393 394 395 396 397 398 405 406 407 408 409
[358] 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426
[375] 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443
[392] 444 445 446 447 448 455 456 457 458</code></pre>
</div>
<div id="section-9" class="section level4">
<h4></h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">length</span>(stringr<span class="op">::</span><span class="kw">str_which</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb33-2" data-line-number="2">                          <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>))</a></code></pre></div>
<pre><code>[1] 400</code></pre>
<p>Note that <code>str_which()</code> is case sensitive, so it would not work to use “women” as the pattern, and using “men” would return the lines that contain “Wo<strong>men</strong>” or “Ye<strong>men</strong>” etc. Try this out with <code>pattern = &quot;women&quot;</code> and <code>pattern = &quot;men&quot;</code> to see the result!</p>
<p>OK, so this looks correct. This includes most lines but there are gaps where the header is located. It looks like out of the original 461 lines, there are 400 lines in our table that aren’t headers.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">rural_urban &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb35-2" data-line-number="2">                          <span class="dt">pattern =</span> <span class="st">&quot;Women|Men&quot;</span>)</a></code></pre></div>
<p>We can check our data now using either <code>head()</code> from base R or <code>glimpse()</code> from the <code>tibble</code> and <code>dplyr</code> package. (Yup, the same function is available from both packages!) The <code>head()</code> function shows us the first rows or lines of the data, while the <code>glimpse()</code> function provides us information about the total size of the object and shows us the first line or row.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">dplyr<span class="op">::</span><span class="kw">glimpse</span>(rural_urban)</a></code></pre></div>
<pre><code> chr [1:400] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot; ...</code></pre>
<p>Now our <code>rural_urban</code> object 400 lines instead of 461, like it did before when it contained the redundant header information.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[2] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;              
[4] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;    
[5] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;              
[6] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;    </code></pre>
<p>Great! So now our data looks much better but we need to add back our header and we would like this to only be a single line to make it easy to transform our data into a table or table-like object.</p>
<p>As a reminder, here is what our header used to look like:</p>
<p><img src="img/last_page.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We will add a new header after first dealing with some additional spacing and missing data issues.</p>
</div>
</div>
<div id="dealing-with-spacing" class="section level3">
<h3>Dealing with spacing</h3>
<p>First let’s try splitting our header-less data into columns based on spaces using the <code>str_split()</code> function, where we specify that we are splitting the data based on the pattern of a space (the space is included in quotes):</p>
<p>Here, we will take a look at just the first 10 lines using the <code>[1:10,]</code> syntax:</p>
<div id="section-10" class="section level4 scrollable">
<h4></h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co">#scroll through the output!</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">str_split</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb40-3" data-line-number="3">          <span class="dt">pattern =</span> <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb40-4" data-line-number="4">          <span class="dt">simplify =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,] </a></code></pre></div>
<pre><code>      [,1]          [,2]    [,3]          [,4]          [,5]         
 [1,] &quot;Men&quot;         &quot;20.2&quot;  &quot;(17.8-22.7)&quot; &quot;19.7&quot;        &quot;(17.2-22.2)&quot;
 [2,] &quot;Afghanistan&quot; &quot;Women&quot; &quot;20.6&quot;        &quot;(18.4-22.8)&quot; &quot;20.1&quot;       
 [3,] &quot;Men&quot;         &quot;25.2&quot;  &quot;(23.9-26.5)&quot; &quot;25.0&quot;        &quot;(23.7-26.4)&quot;
 [4,] &quot;Albania&quot;     &quot;Women&quot; &quot;26.0&quot;        &quot;(24.1-27.9)&quot; &quot;26.1&quot;       
 [5,] &quot;Men&quot;         &quot;22.1&quot;  &quot;(20.8-23.3)&quot; &quot;21.8&quot;        &quot;(20.5-23.1)&quot;
 [6,] &quot;Algeria&quot;     &quot;Women&quot; &quot;24.0&quot;        &quot;(22.2-25.7)&quot; &quot;23.3&quot;       
 [7,] &quot;Men&quot;         &quot;33.7&quot;  &quot;(32.7-34.7)&quot; &quot;32.6&quot;        &quot;(31.7-33.5)&quot;
 [8,] &quot;American&quot;    &quot;Samoa&quot; &quot;Women&quot;       &quot;34.3&quot;        &quot;(33.1-35.6)&quot;
 [9,] &quot;Men&quot;         &quot;25.0&quot;  &quot;(22.5-27.4)&quot; &quot;25.3&quot;        &quot;(22.8-27.7)&quot;
[10,] &quot;Andorra&quot;     &quot;Women&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.4&quot;       
      [,6]          [,7]          [,8]          [,9]         
 [1,] &quot;22.4&quot;        &quot;(20.0-25.0)&quot; &quot;22.8&quot;        &quot;(20.3-25.3)&quot;
 [2,] &quot;(17.8-22.4)&quot; &quot;23.2&quot;        &quot;(20.9-25.4)&quot; &quot;24.4&quot;       
 [3,] &quot;25.4&quot;        &quot;(24.0-26.7)&quot; &quot;27.0&quot;        &quot;(26.0-27.9)&quot;
 [4,] &quot;(24.1-28.1)&quot; &quot;25.9&quot;        &quot;(23.9-27.8)&quot; &quot;26.0&quot;       
 [5,] &quot;22.3&quot;        &quot;(21.0-23.6)&quot; &quot;25.1&quot;        &quot;(24.5-25.7)&quot;
 [6,] &quot;(21.4-25.1)&quot; &quot;24.8&quot;        &quot;(22.9-26.6)&quot; &quot;27.4&quot;       
 [7,] &quot;34.0&quot;        &quot;(32.9-35.1)&quot; &quot;34.3&quot;        &quot;(33.0-35.6)&quot;
 [8,] &quot;34.1&quot;        &quot;(33.0-35.2)&quot; &quot;34.4&quot;        &quot;(33.0-35.8)&quot;
 [9,] &quot;25.0&quot;        &quot;(22.5-27.4)&quot; &quot;26.8&quot;        &quot;(24.4-29.2)&quot;
[10,] &quot;(22.2-28.7)&quot; &quot;25.2&quot;        &quot;(22.0-28.4)&quot; &quot;25.3&quot;       
      [,10]         [,11]         [,12]         [,13]        
 [1,] &quot;22.5&quot;        &quot;(20.0-25.0)&quot; &quot;23.6&quot;        &quot;(21.0-26.1)&quot;
 [2,] &quot;(23.3-25.4)&quot; &quot;23.6&quot;        &quot;(22.5-24.8)&quot; &quot;26.3&quot;       
 [3,] &quot;26.9&quot;        &quot;(25.9-27.9)&quot; &quot;27.0&quot;        &quot;(26.0-28.0)&quot;
 [4,] &quot;(24.8-27.2)&quot; &quot;26.2&quot;        &quot;(24.8-27.5)&quot; &quot;25.9&quot;       
 [5,] &quot;24.8&quot;        &quot;(24.1-25.4)&quot; &quot;25.2&quot;        &quot;(24.6-25.9)&quot;
 [6,] &quot;(26.7-28.0)&quot; &quot;27.0&quot;        &quot;(26.3-27.8)&quot; &quot;27.5&quot;       
 [7,] &quot;34.6&quot;        &quot;(33.1-35.9)&quot; &quot;34.2&quot;        &quot;(32.9-35.6)&quot;
 [8,] &quot;35.3&quot;        &quot;(33.7-36.9)&quot; &quot;35.0&quot;        &quot;(33.1-36.9)&quot;
 [9,] &quot;26.8&quot;        &quot;(24.3-29.2)&quot; &quot;26.8&quot;        &quot;(24.3-29.3)&quot;
[10,] &quot;(22.1-28.6)&quot; &quot;25.2&quot;        &quot;(21.9-28.5)&quot; &quot;25.3&quot;       
      [,14]         [,15]         [,16] [,17] [,18]
 [1,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [2,] &quot;(25.1-27.4)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [3,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [4,] &quot;(24.6-27.2)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [5,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [6,] &quot;(26.7-28.2)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [7,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [8,] &quot;35.4&quot;        &quot;(33.7-37.1)&quot; &quot;&quot;    &quot;&quot;    &quot;&quot;   
 [9,] &quot;&quot;            &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   
[10,] &quot;(22.1-28.6)&quot; &quot;&quot;            &quot;&quot;    &quot;&quot;    &quot;&quot;   </code></pre>
</div>
<div id="section-11" class="section level4">
<h4></h4>
<p>This almost worked, but unfortunately country names that have spaces will be a problem. For example, we can see that “American Samoa” has been divided into two columns and all subsequent columns are shifted.</p>
<p>Let’s try this another way.</p>
<p>As we can see by looking at our <code>rural_ubran</code> data, the country information is only present when the sex is Women. Let’s try to extract the country information from the rows that contain data about Women.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">head</span>(rural_urban)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;              
[2] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;              
[4] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;    
[5] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;              
[6] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;    </code></pre>
<p>To do this, we start by noticing that the sex always starts with either a capital “W” if the sex is female. Note, we need to use a space before the “W” otherwise we will split some of the country names if the names starts with “W”.</p>
<p>Here, we will also introduce the concept of piping, which uses the <code>%&gt;%</code> from the <code>magrittr</code> package, which allows us to pipe the output from one function to the input for another function. This is really useful when we have multiple steps, which we will show soon.</p>
<p>First, we will select just the data for Women and Men separately:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">Women &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb44-2" data-line-number="2">                    <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) </a>
<a class="sourceLine" id="cb44-3" data-line-number="3">Men &lt;-<span class="st"> </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban, </a>
<a class="sourceLine" id="cb44-4" data-line-number="4">                    <span class="dt">pattern =</span> <span class="st">&quot;Men&quot;</span>)</a>
<a class="sourceLine" id="cb44-5" data-line-number="5"></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"></a>
<a class="sourceLine" id="cb44-7" data-line-number="7"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;   
[2] &quot;Albania Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;       
[3] &quot;Algeria Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;       
[4] &quot;American Samoa Women 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (33.1-36.9) 35.4 (33.7-37.1)&quot;
[5] &quot;Andorra Women 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (21.9-28.5) 25.3 (22.1-28.6)&quot;       
[6] &quot;Angola Women 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (20.0-26.7) 25.7 (22.4-29.1)&quot;        </code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<p>And then split the <code>Women</code> data based on the pattern <code>pattern = &quot; Women&quot;</code> (Note that the space before the word “Women” is included - so that it is not within the country data). Here we take our <code>Women</code> dataset and pipe it into the first argument of the <code>str_split()</code> function, where then we can split on the pattern <code>&quot; Women&quot;</code>. We then pipe through thr <code>unlist()</code> function so that the results is a vector instead of a list. We assign this new result to the <code>country_split</code> object.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">country_split &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="st">  </span>Women <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern =</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span><span class="kw">unlist</span>() </a>
<a class="sourceLine" id="cb48-5" data-line-number="5"></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="kw">head</span>(country_split)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan&quot;                                                                                           
[2] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Albania&quot;                                                                                               
[4] &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;
[5] &quot;Algeria&quot;                                                                                               
[6] &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;</code></pre>
<p>However, we can also do the same thing in a single step, where we replace the <code>Women</code> dataset with the code we used to create that dataset. So first, we select the “Women” and then we split the data by &quot; Women&quot; to create a new dataset all within the same chunk of code.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">country_split &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="st">  </span><span class="kw">str_subset</span>(<span class="dt">string =</span> rural_urban,</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">             <span class="dt">pattern =</span> <span class="st">&quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_split</span>(<span class="dt">pattern=</span> <span class="st">&quot; Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="st">  </span><span class="kw">unlist</span>()</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="kw">head</span>(country_split)</a></code></pre></div>
<pre><code>[1] &quot;Afghanistan&quot;                                                                                           
[2] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;
[3] &quot;Albania&quot;                                                                                               
[4] &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)&quot;
[5] &quot;Algeria&quot;                                                                                               
[6] &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)&quot;</code></pre>
<p>Now, we can see that <code>Country</code> is always the odd rows and the BMI data for Women is the even rows. We can select the odd rows using the <b> Modulus (Remainder from division) operator</b>. This operator looks like this <code>%%</code>. All odd values such as 3, 7, or 15 when divided by 2 would leave a remainder of 1. We will select just these rows using the <code>filter()</code> function of <code>dplyr</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">country &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </a></code></pre></div>
<p>We can take a look to make sure that all the country names look as expected. You can scroll through the country names if you hover over the data.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">country</a></code></pre></div>
</div>
<div id="section-12" class="section level4 scrollable">
<h4></h4>
<pre><code>                       country_split
1                        Afghanistan
2                            Albania
3                            Algeria
4                     American Samoa
5                            Andorra
6                             Angola
7                Antigua and Barbuda
8                          Argentina
9                            Armenia
10                         Australia
11                           Austria
12                        Azerbaijan
13                           Bahamas
14                           Bahrain
15                        Bangladesh
16                          Barbados
17                           Belarus
18                           Belgium
19                            Belize
20                             Benin
21                           Bermuda
22                            Bhutan
23                           Bolivia
24            Bosnia and Herzegovina
25                          Botswana
26                            Brazil
27                 Brunei Darussalam
28                          Bulgaria
29                      Burkina Faso
30                           Burundi
31                        Cabo Verde
32                          Cambodia
33                          Cameroon
34                            Canada
35          Central African Republic
36                              Chad
37                             Chile
38                             China
39             China (Hong Kong SAR)
40                          Colombia
41                           Comoros
42                             Congo
43                      Cook Islands
44                        Costa Rica
45                     Cote d&#39;Ivoire
46                           Croatia
47                              Cuba
48                            Cyprus
49                    Czech Republic
50                           Denmark
51                          Djibouti
52                          Dominica
53                Dominican Republic
54                          DR Congo
55                           Ecuador
56                             Egypt
57                       El Salvador
58                 Equatorial Guinea
59                           Eritrea
60                           Estonia
61                          Ethiopia
62                              Fiji
63                           Finland
64                            France
65                  French Polynesia
66                             Gabon
67                            Gambia
68                           Georgia
69                           Germany
70                             Ghana
71                            Greece
72                         Greenland
73                           Grenada
74                         Guatemala
75                            Guinea
76                     Guinea Bissau
77                            Guyana
78                             Haiti
79                          Honduras
80                           Hungary
81                           Iceland
82                             India
83                         Indonesia
84                              Iran
85                              Iraq
86                           Ireland
87                            Israel
88                             Italy
89                           Jamaica
90                             Japan
91                            Jordan
92                        Kazakhstan
93                             Kenya
94                          Kiribati
95                            Kuwait
96                        Kyrgyzstan
97                           Lao PDR
98                            Latvia
99                           Lebanon
100                          Lesotho
101                          Liberia
102                            Libya
103                        Lithuania
104                       Luxembourg
105                 Macedonia (TFYR)
106                       Madagascar
107                           Malawi
108                         Malaysia
109                         Maldives
110                             Mali
111                            Malta
112                 Marshall Islands
113                       Mauritania
114                        Mauritius
115                           Mexico
116 Micronesia (Federated States of)
117                          Moldova
118                         Mongolia
119                       Montenegro
120                          Morocco
121                       Mozambique
122                          Myanmar
123                          Namibia
124                            Nauru
125                            Nepal
126                      Netherlands
127                      New Zealand
128                        Nicaragua
129                            Niger
130                          Nigeria
131                             Niue
132                      North Korea
133                           Norway
134   Occupied Palestinian Territory
135                             Oman
136                         Pakistan
137                            Palau
138                           Panama
139                 Papua New Guinea
140                         Paraguay
141                             Peru
142                      Philippines
143                           Poland
144                         Portugal
145                      Puerto Rico
146                            Qatar
147                          Romania
148               Russian Federation
149                           Rwanda
150            Saint Kitts and Nevis
151                      Saint Lucia
152 Saint Vincent and the Grenadines
153                            Samoa
154            Sao Tome and Principe
155                     Saudi Arabia
156                          Senegal
157                           Serbia
158                       Seychelles
159                     Sierra Leone
160                        Singapore
161                         Slovakia
162                         Slovenia
163                  Solomon Islands
164                          Somalia
165                     South Africa
166                      South Korea
167                            Spain
168                        Sri Lanka
169                   Sudan (former)
170                         Suriname
171                        Swaziland
172                           Sweden
173                      Switzerland
174             Syrian Arab Republic
175                           Taiwan
176                       Tajikistan
177                         Tanzania
178                         Thailand
179                      Timor-Leste
180                             Togo
181                          Tokelau
182                            Tonga
183              Trinidad and Tobago
184                          Tunisia
185                           Turkey
186                     Turkmenistan
187                           Tuvalu
188                           Uganda
189                          Ukraine
190             United Arab Emirates
191                   United Kingdom
192         United States of America
193                          Uruguay
194                       Uzbekistan
195                          Vanuatu
196                        Venezuela
197                         Viet Nam
198                            Yemen
199                           Zambia
200                         Zimbabwe</code></pre>
</div>
<div id="section-13" class="section level4">
<h4></h4>
<p>Looks good! We have 200 countries represented in our dataset.</p>
<p>Great! Now we have a list of the countries that can be used for both the male and female data.</p>
<p>Remeber the even rows are the rows with the BMI data for women. These row values have a remainder of 0 when divided by 2. Let’s select that data too.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">Women_BMI &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(country_split) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="kw">head</span>(Women_BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  country_split                                                            
  &lt;chr&gt;                                                                    
1 &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23…
2 &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26…
3 &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27…
4 &quot; 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35…
5 &quot; 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25…
6 &quot; 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23…</code></pre>
<p>This looks similar to our <code>Men</code> data (although slightly different):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<p>Notice how the data in each row is in quotes. This is because these are character strings. We can check this by using the base <code>class()</code> function.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw">class</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>Whereas the <code>Women_BMI</code> data is a tibble.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">class</span>(Women_BMI)</a></code></pre></div>
<pre><code>[1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Let’s make the <code>Men</code> data into a tibble as well:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">Men &lt;-<span class="kw">tibble</span>(Men)</a></code></pre></div>
<p>It’s always a good idea to check that your data objects are the size you expect when wrangling. We can do so with the <code>dim()</code> function, which shows us the dimensions of data objects.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">dim</span>(Women_BMI)</a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">dim</span>(Men)</a></code></pre></div>
<pre><code>[1] 200   1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">head</span>(Women_BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  country_split                                                            
  &lt;chr&gt;                                                                    
1 &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23…
2 &quot; 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26…
3 &quot; 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27…
4 &quot; 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35…
5 &quot; 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25…
6 &quot; 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23…</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  Men                                                                      
  &lt;chr&gt;                                                                    
1 Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) …
2 Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) …
3 Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) …
4 Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) …
5 Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) …
6 Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) …</code></pre>
<p>Great! There are 200 rows of character strings with the BMI data like we expected to match the 200 countries in our data.</p>
<p>We do however need to add the word <code>&quot; Women&quot;</code> back to the <code>Women_BMI</code> data. To do this we will use the <code>glue()</code> function of the <code>glue</code> package.</p>
<p>Here is a simple example of how this function glues two things together.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">where &lt;-<span class="st">&quot;the moon&quot;</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"></a>
<a class="sourceLine" id="cb72-3" data-line-number="3">glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;the cow jumped over {where}&quot;</span>)</a></code></pre></div>
<pre><code>the cow jumped over the moon</code></pre>
<p>Now let’s add the word “Women” to each row of the <code>Women_BMI</code> data using <code>glue</code>.</p>
<p>First let’s pull the <code>country_split</code> data out as a vector to make this simpler when we <code>glue</code>. To do this we will use the <code>pull()</code> function of the <code>dplyr</code> package. This function will allow us to extract or pull out the single variable called <code>country_split</code> which contains the BMI values for women from within the tibble called <code>Women_BMI</code> which we just created by grabbing only the even rows of our original <code>country_split</code> tibble.</p>
<p>Then, let’s use the <code>first()</code> function of the <code>dplyr</code> package to get a reminder of what just the first row of the <code>country_split</code> column of the <code>Women_BMI</code> data looks like.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">women_data &lt;-<span class="st"> </span>Women_BMI <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">  </span><span class="kw">pull</span>(country_split)</a>
<a class="sourceLine" id="cb74-3" data-line-number="3"></a>
<a class="sourceLine" id="cb74-4" data-line-number="4">dplyr<span class="op">::</span><span class="kw">first</span>(women_data)</a></code></pre></div>
<pre><code>[1] &quot; 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)&quot;</code></pre>
<p>Now we will paste the word <code>&quot;Women&quot;</code> in the beginning of each value in the vector using the <code>glue()</code> function.</p>
<p>Note that there will be a space in between. This is because the space is already in front of the first BMI value.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">Women &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;Women{women_data}&quot;</span>)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code>Women 20.6 (18.4-22.8) 20.1 (17.8-22.4) 23.2 (20.9-25.4) 24.4 (23.3-25.4) 23.6 (22.5-24.8) 26.3 (25.1-27.4)
Women 26.0 (24.1-27.9) 26.1 (24.1-28.1) 25.9 (23.9-27.8) 26.0 (24.8-27.2) 26.2 (24.8-27.5) 25.9 (24.6-27.2)
Women 24.0 (22.2-25.7) 23.3 (21.4-25.1) 24.8 (22.9-26.6) 27.4 (26.7-28.0) 27.0 (26.3-27.8) 27.5 (26.7-28.2)
Women 34.3 (33.1-35.6) 34.1 (33.0-35.2) 34.4 (33.0-35.8) 35.3 (33.7-36.9) 35.0 (33.1-36.9) 35.4 (33.7-37.1)
Women 25.2 (22.0-28.4) 25.4 (22.2-28.7) 25.2 (22.0-28.4) 25.3 (22.1-28.6) 25.2 (21.9-28.5) 25.3 (22.1-28.6)
Women 21.3 (18.0-24.6) 20.9 (17.6-24.3) 22.7 (19.3-26.0) 24.4 (21.2-27.7) 23.3 (20.0-26.7) 25.7 (22.4-29.1)</code></pre>
<p>You could also do all of this in one step but its less obvious what is happening.</p>
<p>Here we can pull the <code>country_split</code> data out of the <code>Women_BMI</code> object and then paste <code>&quot;Women&quot;</code> in front of each string in one command.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">Women &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;Women{pull(Women_BMI,country_split)}&quot;</span>)</a></code></pre></div>
<p>If we try splitting our data by space again, will it have the expected number of columns? What about the rows that contain <code>na*</code> values?</p>
<p>Let’s just take the <code>Men</code> data that contains <code>na*</code> values. This column is called <code>rural_urban</code>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">unknown &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="st">  </span>Men<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(<span class="dt">pattern =</span><span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb79-4" data-line-number="4">                    <span class="dt">string =</span> Men)) </a>
<a class="sourceLine" id="cb79-5" data-line-number="5"></a>
<a class="sourceLine" id="cb79-6" data-line-number="6"><span class="kw">head</span>(unknown)</a></code></pre></div>
<pre><code># A tibble: 5 x 1
  Men                                                                      
  &lt;chr&gt;                                                                    
1 Men 24.3 (21.8-26.8) na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* 26.7 (24.…
2 Men 22.4 (21.4-23.3) 21.5 (20.2-22.8) 22.4 (21.5-23.4) 24.8 (23.6-26.1) …
3 Men 32.6 (32.0-33.2) na* 32.6 (32.0-33.2) 32.9 (31.7-34.1) na* 32.9 (31.…
4 Men 22.8 (22.2-23.3) na* 22.8 (22.2-23.3) 24.4 (23.6-25.1) na* 24.4 (23.…
5 Men 29.6 (28.1-31.1) 29.6 (28.1-31.1) na* 32.3 (31.4-33.2) 32.3 (31.4-33…</code></pre>
<p>Now we can try splitting by a space</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(<span class="kw">pull</span>(unknown, Men), <span class="st">&quot; &quot;</span>,</a>
<a class="sourceLine" id="cb81-2" data-line-number="2">                            <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code># A tibble: 5 x 12
  V1    V2    V3     V4    V5     V6    V7    V8    V9    V10   V11   V12  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Men   24.3  (21.8… na*   24.3   (21.… 26.7  (24.… na*   26.7  (24.… &quot;&quot;   
2 Men   22.4  (21.4… 21.5  (20.2… 22.4  (21.… 24.8  (23.… na*   24.8  (23.…
3 Men   32.6  (32.0… na*   32.6   (32.… 32.9  (31.… na*   32.9  (31.… &quot;&quot;   
4 Men   22.8  (22.2… na*   22.8   (22.… 24.4  (23.… na*   24.4  (23.… &quot;&quot;   
5 Men   29.6  (28.1… 29.6  (28.1… na*   32.3  (31.… 32.3  (31.… na*   &quot;&quot;   </code></pre>
<p>So close! Notice that the <code>&quot;na*&quot;</code> values have shifted the subsequent values within the columns because typically there is a space between the BMI and the credible intervals. Here we can see this data in our original pdf:</p>
<p><img src="img/missing_pdf.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="dealing-with-na-values" class="section level3">
<h3>Dealing with NA values</h3>
<p>We need to replace our <code>na*</code> values with something that includes a space so that when we separate our data by space we will have two values instead of one when we have an <code>na*</code>. Therefore, <code>na* na*</code> should work.</p>
<p>So, in order to use the functions within the <code>stringr</code> package, our <code>Men</code> data needs to be of <code>character</code> class, so let’s check that now.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">class</span>(<span class="kw">pull</span>(Men, Men))</a></code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>The <code>as.character()</code> function allows us to change factor data within to the character class. We could use this if we needed it, but it looks like our data is already <code>character</code>.</p>
<p>We are also changing the structure so that the data is not within a column called <code>Men</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 1
  Men                                                                      
  &lt;chr&gt;                                                                    
1 Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) …
2 Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) …
3 Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) …
4 Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) …
5 Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) …
6 Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) …</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">Men &lt;-<span class="st"> </span><span class="kw">pull</span>(Men, Men)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code>[1] &quot;Men 20.2 (17.8-22.7) 19.7 (17.2-22.2) 22.4 (20.0-25.0) 22.8 (20.3-25.3) 22.5 (20.0-25.0) 23.6 (21.0-26.1)&quot;
[2] &quot;Men 25.2 (23.9-26.5) 25.0 (23.7-26.4) 25.4 (24.0-26.7) 27.0 (26.0-27.9) 26.9 (25.9-27.9) 27.0 (26.0-28.0)&quot;
[3] &quot;Men 22.1 (20.8-23.3) 21.8 (20.5-23.1) 22.3 (21.0-23.6) 25.1 (24.5-25.7) 24.8 (24.1-25.4) 25.2 (24.6-25.9)&quot;
[4] &quot;Men 33.7 (32.7-34.7) 32.6 (31.7-33.5) 34.0 (32.9-35.1) 34.3 (33.0-35.6) 34.6 (33.1-35.9) 34.2 (32.9-35.6)&quot;
[5] &quot;Men 25.0 (22.5-27.4) 25.3 (22.8-27.7) 25.0 (22.5-27.4) 26.8 (24.4-29.2) 26.8 (24.3-29.2) 26.8 (24.3-29.3)&quot;
[6] &quot;Men 20.5 (17.9-23.1) 20.2 (17.6-22.9) 21.4 (18.8-24.0) 22.6 (20.0-25.1) 22.0 (19.4-24.6) 23.2 (20.6-25.9)&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">Men &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Men, </a>
<a class="sourceLine" id="cb89-3" data-line-number="3">                           <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb89-4" data-line-number="4">                           <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb89-5" data-line-number="5"></a>
<a class="sourceLine" id="cb89-6" data-line-number="6"><span class="co"># The \\ are necessary because the * is a special character </span></a>
<a class="sourceLine" id="cb89-7" data-line-number="7"><span class="co"># The * would typically indicate any possible value, </span></a>
<a class="sourceLine" id="cb89-8" data-line-number="8"><span class="co"># but here we actually want a &quot;*&quot; instead</span></a>
<a class="sourceLine" id="cb89-9" data-line-number="9"><span class="co"># Thus the double backslash does that for us</span></a>
<a class="sourceLine" id="cb89-10" data-line-number="10"><span class="co"># Here we are replacing all occurences of the na* values </span></a>
<a class="sourceLine" id="cb89-11" data-line-number="11"><span class="co">#(thus str_replace_all instead of str_replace) with na* na*. </span></a></code></pre></div>
<p>Let’s check that it worked…</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">Men[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Men 20.7 (19.4-22.1) 20.3 (18.9-21.7) 21.7 (20.3-23.1) 22.7 (22.0-23.3) 22.1 (21.3-22.8) 23.4 (22.7-24.1)&quot;
 [2] &quot;Men 24.3 (21.8-26.8) na* na* 24.3 (21.8-26.8) 26.7 (24.3-29.2) na* na* 26.7 (24.3-29.2)&quot;                  
 [3] &quot;Men 20.6 (19.1-22.1) 20.3 (18.7-21.8) 23.1 (21.5-24.6) 23.5 (22.8-24.3) 23.1 (22.2-23.9) 24.2 (23.3-25.2)&quot;
 [4] &quot;Men 23.3 (21.0-25.5) 22.9 (20.6-25.2) 23.6 (21.3-25.9) 26.1 (23.9-28.4) 25.3 (23.1-27.5) 26.5 (24.2-28.8)&quot;
 [5] &quot;Men 24.9 (23.5-26.2) 24.8 (23.4-26.2) 25.0 (23.6-26.4) 26.8 (25.7-27.8) 26.7 (25.7-27.8) 26.8 (25.7-27.9)&quot;
 [6] &quot;Men 20.6 (19.2-22.0) 20.3 (18.8-21.7) 21.4 (20.0-22.9) 22.6 (21.9-23.4) 21.9 (20.9-22.8) 23.2 (22.3-24.0)&quot;
 [7] &quot;Men 23.3 (22.5-24.0) 22.2 (21.4-23.0) 23.7 (22.9-24.5) 26.2 (25.7-26.7) 25.0 (24.3-25.6) 26.4 (25.9-26.9)&quot;
 [8] &quot;Men 24.0 (22.5-25.4) 23.7 (22.1-25.1) 24.2 (22.7-25.7) 27.1 (26.4-27.7) 26.6 (26.0-27.3) 27.2 (26.5-27.9)&quot;
 [9] &quot;Men 25.0 (23.8-26.4) 24.9 (23.5-26.4) 25.1 (23.8-26.5) 27.0 (25.8-28.1) 27.0 (25.7-28.3) 27.0 (25.7-28.2)&quot;
[10] &quot;Men 20.2 (18.8-21.5) 20.0 (18.6-21.4) 21.4 (19.9-22.9) 22.2 (21.4-23.0) 21.8 (21.0-22.6) 23.1 (22.1-24.1)&quot;
[11] &quot;Men 20.2 (17.7-22.6) 20.1 (17.6-22.5) 21.2 (18.7-23.6) 22.1 (19.8-24.5) 22.0 (19.6-24.3) 23.2 (20.8-25.6)&quot;</code></pre>
<p>Great!</p>
<p>Now for the Women data object</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="kw">class</span>(Women)</a></code></pre></div>
<pre><code>[1] &quot;glue&quot;      &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="co"># the female data is already character type</span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2">Women &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3"><span class="st">  </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="dt">string =</span> Women, </a>
<a class="sourceLine" id="cb94-4" data-line-number="4">                           <span class="dt">pattern =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">*&quot;</span>, </a>
<a class="sourceLine" id="cb94-5" data-line-number="5">                           <span class="dt">replacement =</span> <span class="st">&quot;na</span><span class="ch">\\</span><span class="st">* na</span><span class="ch">\\</span><span class="st">*&quot;</span>) </a>
<a class="sourceLine" id="cb94-6" data-line-number="6">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>]</a></code></pre></div>
<pre><code> [1] &quot;Women 20.6 (19.1-22.0) 20.1 (18.5-21.6) 21.8 (20.3-23.3) 24.3 (23.5-25.0) 23.2 (22.5-24.0) 25.5 (24.7-26.3)&quot;
 [2] &quot;Women 25.4 (22.2-28.6) na* na* 25.4 (22.2-28.6) 28.5 (25.3-31.6) na* na* 28.5 (25.3-31.6)&quot;                  
 [3] &quot;Women 20.7 (18.4-22.9) 20.3 (18.0-22.6) 23.0 (20.8-25.3) 24.6 (23.7-25.5) 23.8 (22.7-24.9) 25.9 (24.7-27.0)&quot;
 [4] &quot;Women 23.8 (22.3-25.3) 23.0 (21.4-24.5) 24.6 (23.1-26.1) 27.9 (26.5-29.3) 27.0 (25.6-28.5) 28.3 (26.8-29.7)&quot;
 [5] &quot;Women 25.5 (23.5-27.4) 25.7 (23.7-27.7) 25.1 (23.1-27.0) 25.7 (24.4-27.1) 26.0 (24.6-27.5) 25.3 (23.9-26.8)&quot;
 [6] &quot;Women 24.2 (22.2-26.2) 23.7 (21.5-25.8) 25.6 (23.5-27.7) 26.2 (25.3-27.1) 25.0 (23.8-26.2) 27.0 (26.0-28.2)&quot;
 [7] &quot;Women 24.0 (23.2-25.0) 23.1 (22.1-24.1) 24.4 (23.5-25.4) 26.9 (26.2-27.5) 26.4 (25.7-27.2) 26.9 (26.3-27.6)&quot;
 [8] &quot;Women 23.6 (21.4-25.6) 22.9 (20.7-25.0) 24.0 (21.8-26.1) 27.4 (26.6-28.1) 27.0 (26.1-27.8) 27.5 (26.7-28.2)&quot;
 [9] &quot;Women 25.2 (23.4-27.1) 25.5 (23.4-27.6) 25.0 (23.1-26.9) 25.6 (24.1-27.1) 26.0 (24.2-27.8) 25.5 (23.9-27.1)&quot;
[10] &quot;Women 19.9 (18.7-21.2) 19.6 (18.4-20.9) 22.0 (20.7-23.3) 22.2 (21.4-23.1) 21.1 (20.2-22.0) 24.7 (23.7-25.7)&quot;
[11] &quot;Women 19.6 (17.5-21.7) 19.5 (17.4-21.6) 21.7 (19.5-23.8) 21.1 (20.3-22.0) 20.7 (19.8-21.6) 24.0 (23.0-24.9)&quot;</code></pre>
<p>Great, now we can split our data by spaces.</p>
</div>
<div id="splitting-the-data" class="section level3">
<h3>Splitting the data</h3>
<p>We will split our data finally by spaces using the <code>str_split()</code> function of the <code>stringr</code> package. We can check the rows with NA values by looking at rows 20-30.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">Men &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Men, <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb96-2" data-line-number="2">                                   <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb96-3" data-line-number="3">Men[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>,]</a></code></pre></div>
<pre><code># A tibble: 11 x 13
   V1    V2    V3     V4    V5    V6    V7    V8    V9    V10   V11   V12  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Men   20.7  (19.4… 20.3  (18.… 21.7  (20.… 22.7  (22.… 22.1  (21.… 23.4 
 2 Men   24.3  (21.8… na*   na*   24.3  (21.… 26.7  (24.… na*   na*   26.7 
 3 Men   20.6  (19.1… 20.3  (18.… 23.1  (21.… 23.5  (22.… 23.1  (22.… 24.2 
 4 Men   23.3  (21.0… 22.9  (20.… 23.6  (21.… 26.1  (23.… 25.3  (23.… 26.5 
 5 Men   24.9  (23.5… 24.8  (23.… 25.0  (23.… 26.8  (25.… 26.7  (25.… 26.8 
 6 Men   20.6  (19.2… 20.3  (18.… 21.4  (20.… 22.6  (21.… 21.9  (20.… 23.2 
 7 Men   23.3  (22.5… 22.2  (21.… 23.7  (22.… 26.2  (25.… 25.0  (24.… 26.4 
 8 Men   24.0  (22.5… 23.7  (22.… 24.2  (22.… 27.1  (26.… 26.6  (26.… 27.2 
 9 Men   25.0  (23.8… 24.9  (23.… 25.1  (23.… 27.0  (25.… 27.0  (25.… 27.0 
10 Men   20.2  (18.8… 20.0  (18.… 21.4  (19.… 22.2  (21.… 21.8  (21.… 23.1 
11 Men   20.2  (17.7… 20.1  (17.… 21.2  (18.… 22.1  (19.… 22.0  (19.… 23.2 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<p>Great! It looks good!</p>
<p>Now for the <code>Women</code> data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">Women &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">str_split</span>(Women, <span class="st">&quot; &quot;</span>, </a>
<a class="sourceLine" id="cb98-2" data-line-number="2">                             <span class="dt">simplify =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb98-3" data-line-number="3"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  V1    V2    V3     V4    V5     V6    V7    V8    V9    V10   V11   V12  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 Women 20.6  (18.4… 20.1  (17.8… 23.2  (20.… 24.4  (23.… 23.6  (22.… 26.3 
2 Women 26.0  (24.1… 26.1  (24.1… 25.9  (23.… 26.0  (24.… 26.2  (24.… 25.9 
3 Women 24.0  (22.2… 23.3  (21.4… 24.8  (22.… 27.4  (26.… 27.0  (26.… 27.5 
4 Women 34.3  (33.1… 34.1  (33.0… 34.4  (33.… 35.3  (33.… 35.0  (33.… 35.4 
5 Women 25.2  (22.0… 25.4  (22.2… 25.2  (22.… 25.3  (22.… 25.2  (21.… 25.3 
6 Women 21.3  (18.0… 20.9  (17.6… 22.7  (19.… 24.4  (21.… 23.3  (20.… 25.7 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">Women[<span class="dv">20</span><span class="op">:</span><span class="dv">30</span>,] </a></code></pre></div>
<pre><code># A tibble: 11 x 13
   V1    V2    V3     V4    V5    V6    V7    V8    V9    V10   V11   V12  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 Women 20.6  (19.1… 20.1  (18.… 21.8  (20.… 24.3  (23.… 23.2  (22.… 25.5 
 2 Women 25.4  (22.2… na*   na*   25.4  (22.… 28.5  (25.… na*   na*   28.5 
 3 Women 20.7  (18.4… 20.3  (18.… 23.0  (20.… 24.6  (23.… 23.8  (22.… 25.9 
 4 Women 23.8  (22.3… 23.0  (21.… 24.6  (23.… 27.9  (26.… 27.0  (25.… 28.3 
 5 Women 25.5  (23.5… 25.7  (23.… 25.1  (23.… 25.7  (24.… 26.0  (24.… 25.3 
 6 Women 24.2  (22.2… 23.7  (21.… 25.6  (23.… 26.2  (25.… 25.0  (23.… 27.0 
 7 Women 24.0  (23.2… 23.1  (22.… 24.4  (23.… 26.9  (26.… 26.4  (25.… 26.9 
 8 Women 23.6  (21.4… 22.9  (20.… 24.0  (21.… 27.4  (26.… 27.0  (26.… 27.5 
 9 Women 25.2  (23.4… 25.5  (23.… 25.0  (23.… 25.6  (24.… 26.0  (24.… 25.5 
10 Women 19.9  (18.7… 19.6  (18.… 22.0  (20.… 22.2  (21.… 21.1  (20.… 24.7 
11 Women 19.6  (17.5… 19.5  (17.… 21.7  (19.… 21.1  (20.… 20.7  (19.… 24.0 
# … with 1 more variable: V13 &lt;chr&gt;</code></pre>
<p>We can see that our <code>na</code> values look correct.</p>
<p>Looks good!</p>
</div>
<div id="adding-new-header" class="section level3">
<h3>Adding new header</h3>
<p>We can see from our pdf and our object called <code>header</code> what the header was like in the original pdf document. We need to add column names to our data based on the original data.</p>
<p>We’ll wait to add <code>Country</code> to the header untill we add the country information to our data.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">new_header &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sex&quot;</span>,<span class="st">&quot;National_BMI_1985&quot;</span>, </a>
<a class="sourceLine" id="cb102-2" data-line-number="2">                <span class="st">&quot;National_BMI_1985_CI&quot;</span>, <span class="st">&quot;Rural_BMI_1985&quot;</span>, </a>
<a class="sourceLine" id="cb102-3" data-line-number="3">                <span class="st">&quot;Rural_BMI_1985_CI&quot;</span>, <span class="st">&quot;Urban_BMI_1985&quot;</span>,</a>
<a class="sourceLine" id="cb102-4" data-line-number="4">                <span class="st">&quot;Urban_BMI_1985_CI&quot;</span>, <span class="st">&quot;National_BMI_2017&quot;</span>,</a>
<a class="sourceLine" id="cb102-5" data-line-number="5">                <span class="st">&quot;National_BMI_2017_CI&quot;</span>,<span class="st">&quot;Rural_BMI_2017&quot;</span>,</a>
<a class="sourceLine" id="cb102-6" data-line-number="6">                <span class="st">&quot;Rural_BMI_2017_CI&quot;</span>, <span class="st">&quot;Urban_BMI_2017&quot;</span>, </a>
<a class="sourceLine" id="cb102-7" data-line-number="7">                <span class="st">&quot;Urban_BMI_2017_CI&quot;</span>)</a></code></pre></div>
<p>Let’s change the names of our columns of our tibbles to this new header for our <code>Men</code> and <code>Women</code> data</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">names</span>(Women) &lt;-<span class="st"> </span>new_header</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">names</span>(Men) &lt;-<span class="st"> </span>new_header</a>
<a class="sourceLine" id="cb103-3" data-line-number="3"></a>
<a class="sourceLine" id="cb103-4" data-line-number="4"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985 Rural_BMI_1985_…
  &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;           
1 Women 20.6             (18.4-22.8)      20.1           (17.8-22.4)     
2 Women 26.0             (24.1-27.9)      26.1           (24.1-28.1)     
3 Women 24.0             (22.2-25.7)      23.3           (21.4-25.1)     
4 Women 34.3             (33.1-35.6)      34.1           (33.0-35.2)     
5 Women 25.2             (22.0-28.4)      25.4           (22.2-28.7)     
6 Women 21.3             (18.0-24.6)      20.9           (17.6-24.3)     
# … with 8 more variables: Urban_BMI_1985 &lt;chr&gt;, Urban_BMI_1985_CI &lt;chr&gt;,
#   National_BMI_2017 &lt;chr&gt;, National_BMI_2017_CI &lt;chr&gt;,
#   Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;,
#   Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
  Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985 Rural_BMI_1985_…
  &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;           
1 Men   20.2             (17.8-22.7)      19.7           (17.2-22.2)     
2 Men   25.2             (23.9-26.5)      25.0           (23.7-26.4)     
3 Men   22.1             (20.8-23.3)      21.8           (20.5-23.1)     
4 Men   33.7             (32.7-34.7)      32.6           (31.7-33.5)     
5 Men   25.0             (22.5-27.4)      25.3           (22.8-27.7)     
6 Men   20.5             (17.9-23.1)      20.2           (17.6-22.9)     
# … with 8 more variables: Urban_BMI_1985 &lt;chr&gt;, Urban_BMI_1985_CI &lt;chr&gt;,
#   National_BMI_2017 &lt;chr&gt;, National_BMI_2017_CI &lt;chr&gt;,
#   Rural_BMI_2017 &lt;chr&gt;, Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;,
#   Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Now we will add our country data to both our <code>Men</code> and <code>Women</code> tibbles using the <code>bind_cols()</code> function. This will add the <code>country</code> as a new column to the <code>Women</code> data object on the left.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1">Women &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Women)</a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  country_split Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghanistan   Women 20.6             (18.4-22.8)      20.1          
2 Albania       Women 26.0             (24.1-27.9)      26.1          
3 Algeria       Women 24.0             (22.2-25.7)      23.3          
4 American Sam… Women 34.3             (33.1-35.6)      34.1          
5 Andorra       Women 25.2             (22.0-28.4)      25.4          
6 Angola        Women 21.3             (18.0-24.6)      20.9          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Similarly, for the data about Men, this will add the <code>country</code> as a new column to the <code>Men</code> data object on the left.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">Men &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_cols</span>(country, Men) </a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  country_split Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghanistan   Men   20.2             (17.8-22.7)      19.7          
2 Albania       Men   25.2             (23.9-26.5)      25.0          
3 Algeria       Men   22.1             (20.8-23.3)      21.8          
4 American Sam… Men   33.7             (32.7-34.7)      32.6          
5 Andorra       Men   25.0             (22.5-27.4)      25.3          
6 Angola        Men   20.5             (17.9-23.1)      20.2          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="changing-variable-names" class="section level3">
<h3>Changing variable names</h3>
<p>Here, we will change the variable name in the <code>country</code> dataset to <code>country</code> (currently it is called <code>country_split</code>). We will also introduce the concept of the assignment pipe. In this case our pipe operator looks like this <code>%&lt;&gt;%</code>. Using this additional pipe requires another package, called <code>magrittr</code>. The other simpler pipe options from this package are loaded with <code>tidyverse</code> (if you used <code>library(tidyverse)</code> which loads most tidyverse packages), but not this version.</p>
<p>The <code>&gt;</code> portion of the pipe still behaves like a normal pipe, while the <code>&lt;</code> portion of the pipe makes an assignment to whatever the <code>&lt;</code>is pointing to, just like when we use the typical assignment operator <code>&lt;-</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1"><span class="co"># library(magrittr) </span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="co"># We can&#39;t use the `%&lt;&gt;%` unless we load the magrittr package</span></a>
<a class="sourceLine" id="cb111-3" data-line-number="3"><span class="co"># We have already done this but we include this for illustrative purposes.</span></a>
<a class="sourceLine" id="cb111-4" data-line-number="4"><span class="co"># Here we will just use the traditional assignment strategy</span></a>
<a class="sourceLine" id="cb111-5" data-line-number="5"></a>
<a class="sourceLine" id="cb111-6" data-line-number="6">Women &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">rename</span>(Women, <span class="dt">Country =</span> country_split) </a></code></pre></div>
<p>Here, we have renamed the <code>country_split</code> variable to be called <code>Country</code>.</p>
<p>Here, we reassign <code>Men</code> using the pipe strategy.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">Men <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">Country =</span> country_split) </a></code></pre></div>
<p>We have renamed the <code>country_split</code> variable to to be called <code>Country</code>. We have also reassigned <code>Men</code> to the same data object. which has the <code>Country</code> variable renamed.</p>
<p>Let’s take a look at our data for <code>Men</code> and <code>Women</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">head</span>(Women)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Women 20.6             (18.4-22.8)      20.1          
2 Albania Women 26.0             (24.1-27.9)      26.1          
3 Algeria Women 24.0             (22.2-25.7)      23.3          
4 Americ… Women 34.3             (33.1-35.6)      34.1          
5 Andorra Women 25.2             (22.0-28.4)      25.4          
6 Angola  Women 21.3             (18.0-24.6)      20.9          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">head</span>(Men)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Men   20.2             (17.8-22.7)      19.7          
2 Albania Men   25.2             (23.9-26.5)      25.0          
3 Algeria Men   22.1             (20.8-23.3)      21.8          
4 Americ… Men   33.7             (32.7-34.7)      32.6          
5 Andorra Men   25.0             (22.5-27.4)      25.3          
6 Angola  Men   20.5             (17.9-23.1)      20.2          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="joining-the-data" class="section level3">
<h3>Joining the data</h3>
<p>Now that both of these tibbles have the same structure, we can combine our <code>Men</code> and <code>Women</code> data using the <code>bind_rows()</code> function of <code>dplyr</code>. This will combine all of the rows based on their similar column structure. All of the male data will be first and all the female data will be second.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">BMI &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(Men, Women)</a></code></pre></div>
<p>Let’s check the size of our BMI data… it should have 400 rows (obs). We can see the end of the <code>BMI</code> data using the <code>tail()</code> function:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Algeria&quot; &quot;American Samoa&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; &quot;Men&quot; ...
 $ National_BMI_1985   : chr  &quot;20.2&quot; &quot;25.2&quot; &quot;22.1&quot; &quot;33.7&quot; ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(23.9-26.5)&quot; &quot;(20.8-23.3)&quot; &quot;(32.7-34.7)&quot; ...
 $ Rural_BMI_1985      : chr  &quot;19.7&quot; &quot;25.0&quot; &quot;21.8&quot; &quot;32.6&quot; ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(23.7-26.4)&quot; &quot;(20.5-23.1)&quot; &quot;(31.7-33.5)&quot; ...
 $ Urban_BMI_1985      : chr  &quot;22.4&quot; &quot;25.4&quot; &quot;22.3&quot; &quot;34.0&quot; ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(24.0-26.7)&quot; &quot;(21.0-23.6)&quot; &quot;(32.9-35.1)&quot; ...
 $ National_BMI_2017   : chr  &quot;22.8&quot; &quot;27.0&quot; &quot;25.1&quot; &quot;34.3&quot; ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(26.0-27.9)&quot; &quot;(24.5-25.7)&quot; &quot;(33.0-35.6)&quot; ...
 $ Rural_BMI_2017      : chr  &quot;22.5&quot; &quot;26.9&quot; &quot;24.8&quot; &quot;34.6&quot; ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(25.9-27.9)&quot; &quot;(24.1-25.4)&quot; &quot;(33.1-35.9)&quot; ...
 $ Urban_BMI_2017      : chr  &quot;23.6&quot; &quot;27.0&quot; &quot;25.2&quot; &quot;34.2&quot; ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-25.9)&quot; &quot;(32.9-35.6)&quot; ...</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="kw">tail</span>(BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Vanuatu Women 24.4             (22.7-26.1)      24.2          
2 Venezu… Women 24.0             (22.2-25.9)      22.6          
3 Viet N… Women 18.5             (17.7-19.4)      18.2          
4 Yemen   Women 20.5             (18.9-22.0)      20.0          
5 Zambia  Women 21.4             (20.3-22.6)      20.7          
6 Zimbab… Women 24.6             (23.5-25.9)      24.0          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
</div>
<div id="sorting-the-data" class="section level3">
<h3>Sorting the data</h3>
<p>Now, let’s sort the data alphabetically by <code>Country</code> using the <code>arrange()</code> function from the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">BMI &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(BMI, Country)</a>
<a class="sourceLine" id="cb122-2" data-line-number="2"><span class="kw">head</span>(BMI)</a></code></pre></div>
<pre><code># A tibble: 6 x 14
  Country Sex   National_BMI_19… National_BMI_19… Rural_BMI_1985
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;         
1 Afghan… Men   20.2             (17.8-22.7)      19.7          
2 Afghan… Women 20.6             (18.4-22.8)      20.1          
3 Albania Men   25.2             (23.9-26.5)      25.0          
4 Albania Women 26.0             (24.1-27.9)      26.1          
5 Algeria Men   22.1             (20.8-23.3)      21.8          
6 Algeria Women 24.0             (22.2-25.7)      23.3          
# … with 9 more variables: Rural_BMI_1985_CI &lt;chr&gt;, Urban_BMI_1985 &lt;chr&gt;,
#   Urban_BMI_1985_CI &lt;chr&gt;, National_BMI_2017 &lt;chr&gt;,
#   National_BMI_2017_CI &lt;chr&gt;, Rural_BMI_2017 &lt;chr&gt;,
#   Rural_BMI_2017_CI &lt;chr&gt;, Urban_BMI_2017 &lt;chr&gt;, Urban_BMI_2017_CI &lt;chr&gt;</code></pre>
<p>Our data is looking great!</p>
<p>Now, we might want to make sure that our observations for each variable look the way we want. In other words, if we want to make plots about National BMI in 1985 then we would need our values to be numeric. Looking at our BMI data using <code>str()</code>, we can see the type of data for each of our variables listed just after variable name and the <code>&quot;:&quot;</code> colon.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : chr  &quot;20.2&quot; &quot;20.6&quot; &quot;25.2&quot; &quot;26.0&quot; ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : chr  &quot;19.7&quot; &quot;20.1&quot; &quot;25.0&quot; &quot;26.1&quot; ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : chr  &quot;22.4&quot; &quot;23.2&quot; &quot;25.4&quot; &quot;25.9&quot; ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : chr  &quot;22.8&quot; &quot;24.4&quot; &quot;27.0&quot; &quot;26.0&quot; ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : chr  &quot;22.5&quot; &quot;23.6&quot; &quot;26.9&quot; &quot;26.2&quot; ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : chr  &quot;23.6&quot; &quot;26.3&quot; &quot;27.0&quot; &quot;25.9&quot; ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>Looks like none of our BMI data is actually <code>numeric</code> (or <code>num</code>), but of the class <code>character</code> (or <code>chr</code>). Let’s change that now.</p>
<p>To start, we could change these values to be numeric with 6 lines of code like this:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1">BMI<span class="op">$</span>National_BMI_<span class="dv">1985</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-2" data-line-number="2">BMI<span class="op">$</span>Rural_BMI_<span class="dv">1985</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-3" data-line-number="3">BMI<span class="op">$</span>Urban_BMI_<span class="dv">1985</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-4" data-line-number="4"></a>
<a class="sourceLine" id="cb126-5" data-line-number="5">BMI<span class="op">$</span>National_BMI_<span class="dv">2017</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-6" data-line-number="6">BMI<span class="op">$</span>Rural_BMI_<span class="dv">2017</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a>
<a class="sourceLine" id="cb126-7" data-line-number="7">BMI<span class="op">$</span>Urban_BMI_<span class="dv">2017</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span>as.numeric</a></code></pre></div>
<p>And if we did this we would see these variables show as <code>&quot;num&quot;</code> which stands for a numeric type of variable.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">str</span>(BMI)</a></code></pre></div>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   400 obs. of  14 variables:
 $ Country             : chr  &quot;Afghanistan&quot; &quot;Afghanistan&quot; &quot;Albania&quot; &quot;Albania&quot; ...
 $ Sex                 : chr  &quot;Men&quot; &quot;Women&quot; &quot;Men&quot; &quot;Women&quot; ...
 $ National_BMI_1985   : num  20.2 20.6 25.2 26 22.1 24 33.7 34.3 25 25.2 ...
 $ National_BMI_1985_CI: chr  &quot;(17.8-22.7)&quot; &quot;(18.4-22.8)&quot; &quot;(23.9-26.5)&quot; &quot;(24.1-27.9)&quot; ...
 $ Rural_BMI_1985      : num  19.7 20.1 25 26.1 21.8 23.3 32.6 34.1 25.3 25.4 ...
 $ Rural_BMI_1985_CI   : chr  &quot;(17.2-22.2)&quot; &quot;(17.8-22.4)&quot; &quot;(23.7-26.4)&quot; &quot;(24.1-28.1)&quot; ...
 $ Urban_BMI_1985      : num  22.4 23.2 25.4 25.9 22.3 24.8 34 34.4 25 25.2 ...
 $ Urban_BMI_1985_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(20.9-25.4)&quot; &quot;(24.0-26.7)&quot; &quot;(23.9-27.8)&quot; ...
 $ National_BMI_2017   : num  22.8 24.4 27 26 25.1 27.4 34.3 35.3 26.8 25.3 ...
 $ National_BMI_2017_CI: chr  &quot;(20.3-25.3)&quot; &quot;(23.3-25.4)&quot; &quot;(26.0-27.9)&quot; &quot;(24.8-27.2)&quot; ...
 $ Rural_BMI_2017      : num  22.5 23.6 26.9 26.2 24.8 27 34.6 35 26.8 25.2 ...
 $ Rural_BMI_2017_CI   : chr  &quot;(20.0-25.0)&quot; &quot;(22.5-24.8)&quot; &quot;(25.9-27.9)&quot; &quot;(24.8-27.5)&quot; ...
 $ Urban_BMI_2017      : num  23.6 26.3 27 25.9 25.2 27.5 34.2 35.4 26.8 25.3 ...
 $ Urban_BMI_2017_CI   : chr  &quot;(21.0-26.1)&quot; &quot;(25.1-27.4)&quot; &quot;(26.0-28.0)&quot; &quot;(24.6-27.2)&quot; ...</code></pre>
<p>Or we can use a more automated way with the <code>map()</code> function of the <code>purrr</code> package:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">BMI_numeric &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>((BMI <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="st">                </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">matches</span>(<span class="st">&quot;CI|Sex|Country&quot;</span>))),</a>
<a class="sourceLine" id="cb129-4" data-line-number="4">             as.numeric) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-5" data-line-number="5"><span class="st">  </span><span class="kw">as_tibble</span>()</a></code></pre></div>
<p>The <code>map()</code> function of the <code>purrr</code> package allows us to apply the <code>as.numeric()</code> function to all the selected columns of <code>BMI</code> dataset. Above, we have selected those that don’t contain <code>CI</code>, <code>Sex</code>, or <code>Country</code> in the column name. If you are familiar with <code>apply()</code>, this function is very similar.</p>
<p>Now we need to add the <code>Country</code> and <code>Sex</code> variables back to our new numeric dataset.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1">BMI_numeric <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Country =</span> <span class="kw">pull</span>(BMI, Country), </a>
<a class="sourceLine" id="cb130-3" data-line-number="3">         <span class="dt">Sex =</span> <span class="kw">pull</span>(BMI, Sex))</a>
<a class="sourceLine" id="cb130-4" data-line-number="4"><span class="kw">head</span>(BMI_numeric)</a></code></pre></div>
<pre><code># A tibble: 6 x 8
  National_BMI_19… Rural_BMI_1985 Urban_BMI_1985 National_BMI_20…
             &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
1             20.2           19.7           22.4             22.8
2             20.6           20.1           23.2             24.4
3             25.2           25             25.4             27  
4             26             26.1           25.9             26  
5             22.1           21.8           22.3             25.1
6             24             23.3           24.8             27.4
# … with 4 more variables: Rural_BMI_2017 &lt;dbl&gt;, Urban_BMI_2017 &lt;dbl&gt;,
#   Country &lt;chr&gt;, Sex &lt;chr&gt;</code></pre>
<p>In this case our numeric data is of a class <code>dbl</code>. This means double-precision floating point numbers (with decimals). The alternative numeric option is the integer class.</p>
</div>
<div id="transforming-to-long-format" class="section level3">
<h3>Transforming to long format</h3>
<p>It is generally useful to get the data in what is called <b>long</b> format for other analyses, and particularly for plotting.</p>
<p>For a more detailed description about this, please see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">case study</a>.</p>
<p>Basically, the long format will have more rows and fewer columns. Thus, we can combine or <code>&quot;gather&quot;</code> some columns together. In our case, we can put all the different BMI data together in one long column. We will create a new column that tells us what each row of the new BMI column represents. In other words, it will tell us what the original column was.</p>
<p>To do this we will use the <code>gather()</code> function of the <code>tidyr</code> package:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">BMI_long &lt;-</a>
<a class="sourceLine" id="cb132-2" data-line-number="2"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">data =</span> BMI_numeric, </a>
<a class="sourceLine" id="cb132-3" data-line-number="3">                <span class="dt">key =</span> class_BMI, </a>
<a class="sourceLine" id="cb132-4" data-line-number="4">                <span class="dt">value =</span> BMI, </a>
<a class="sourceLine" id="cb132-5" data-line-number="5">                National_BMI_<span class="dv">1985</span><span class="op">:</span>Urban_BMI_<span class="dv">2017</span>, </a>
<a class="sourceLine" id="cb132-6" data-line-number="6">                <span class="dt">factor_key =</span> <span class="ot">FALSE</span>) </a></code></pre></div>
<p>The <code>data</code> value indicates what data you start with, the <code>key</code> indicates the new name of the column that will now contain information about the values of the columns we will put together. The <code>value</code> is the name of the column for the values for all the columns that are being put together. The <code>&quot;:&quot;</code> can be used to identify the start and end of the column names that you are putting together. The <code>factor_key</code> argument determines if the newly created key column should be evaluated as a factor or not.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   class_BMI           BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;
1 Afghanistan Men   National_BMI_1985  20.2
2 Afghanistan Women National_BMI_1985  20.6
3 Albania     Men   National_BMI_1985  25.2
4 Albania     Women National_BMI_1985  26  
5 Algeria     Men   National_BMI_1985  22.1
6 Algeria     Women National_BMI_1985  24  </code></pre>
<p>It would be useful to parse the 1985 and the 2017 data. We can do so by separating the parts of the <code>class_BMI</code> column using the <code>separate()</code> function of the <code>tidyr</code> package. In our case we will replace the <code>class_BMI</code> column with two new columns.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">BMI_long <span class="op">%&lt;&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">separate</span>(class_BMI, </a>
<a class="sourceLine" id="cb135-3" data-line-number="3">                  <span class="kw">c</span>(<span class="st">&quot;Region&quot;</span>, <span class="ot">NA</span>, <span class="st">&quot;Year&quot;</span>)) </a></code></pre></div>
<p>Here, we separate the <code>class_BMI</code> column of the <code>BMI_long</code> tibble. This is based on the underscores and create two new columns. The first column will be called <code>Region</code>. It will contain the 1st part of the <code>class_BMI</code> data before the 1st underscore. The 2nd column will be called <code>Year</code>. It will contain the 3rd part of the data based on underscores. The middle part of the column will not be used to create any new columns.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1"><span class="kw">head</span>(BMI_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Afghanistan Men   National 1985   20.2
2 Afghanistan Women National 1985   20.6
3 Albania     Men   National 1985   25.2
4 Albania     Women National 1985   26  
5 Algeria     Men   National 1985   22.1
6 Algeria     Women National 1985   24  </code></pre>
<p>Let’s see how the dimensions of the <code>BMI</code> data have changed in long format:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1"><span class="kw">dim</span>(BMI_numeric)</a></code></pre></div>
<pre><code>[1] 400   8</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw">dim</span>(BMI_long)</a></code></pre></div>
<pre><code>[1] 2400    5</code></pre>
<div id="section-14" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Why exactly are there 2,400 rows now?</p>
</div>
<div id="section-15" class="section level4">
<h4></h4>
<p>Great! our data is very usable now in this format!</p>
</div>
</div>
</div>
<div id="data-exploration" class="section level2">
<h2>Data Exploration</h2>
<p>Now that our data is clean and in a format that we can work with, we can start to take a look at the data and how different groups might compare.</p>
<p>Going back to one of our original questions,</p>
<blockquote>
<p>Is there a difference between rural and urban BMI estimates around the world?</p>
</blockquote>
<p>We want to use a statistical test to identify if there are differences in the average BMI estimates between e.g. rural and urban groups. First, let’s explore our data a bit.</p>
<div id="general-summary" class="section level3">
<h3>General summary</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="kw">summary</span>(BMI_numeric)</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985 Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.7   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.50     1st Qu.:20.9   1st Qu.:22.43   1st Qu.:24.07    
 Median :24.00     Median :23.4   Median :24.30   Median :26.15    
 Mean   :23.68     Mean   :23.3   Mean   :24.24   Mean   :26.00    
 3rd Qu.:25.23     3rd Qu.:25.1   3rd Qu.:25.40   3rd Qu.:27.43    
 Max.   :34.30     Max.   :34.1   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :6      NA&#39;s   :2                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :19.80   Min.   :21.50   Length:400         Length:400        
 1st Qu.:23.30   1st Qu.:24.80   Class :character   Class :character  
 Median :26.00   Median :26.30   Mode  :character   Mode  :character  
 Mean   :25.61   Mean   :26.37                                        
 3rd Qu.:27.30   3rd Qu.:27.60                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :8       NA&#39;s   :2                                            </code></pre>
<p>We can see that the mean BMI estimates are larger in 2017. However, is this a meaningful increase? This is difficult to determine without a statistical test.</p>
<p>Lets look at the data stratified by <code>Sex</code>:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-2" data-line-number="2"><span class="st">  </span><span class="kw">subset</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-3" data-line-number="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.20     Min.   :17.70   Min.   :19.70   Min.   :21.00    
 1st Qu.:22.00     1st Qu.:21.20   1st Qu.:22.85   1st Qu.:24.40    
 Median :24.25     Median :23.90   Median :24.60   Median :26.10    
 Mean   :24.00     Mean   :23.59   Mean   :24.63   Mean   :26.38    
 3rd Qu.:25.50     3rd Qu.:25.40   3rd Qu.:25.60   3rd Qu.:28.00    
 Max.   :34.30     Max.   :34.10   Max.   :34.40   Max.   :35.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017    Country              Sex           
 Min.   :20.40   Min.   :21.60   Length:200         Length:200        
 1st Qu.:23.70   1st Qu.:25.30   Class :character   Class :character  
 Median :26.20   Median :26.40   Mode  :character   Mode  :character  
 Mean   :25.98   Mean   :26.84                                        
 3rd Qu.:27.60   3rd Qu.:28.25                                        
 Max.   :35.00   Max.   :35.40                                        
 NA&#39;s   :4       NA&#39;s   :1                                            </code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1">BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb146-2" data-line-number="2"><span class="st">  </span><span class="kw">subset</span>(Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb146-3" data-line-number="3"><span class="st">  </span><span class="kw">summary</span>()</a></code></pre></div>
<pre><code> National_BMI_1985 Rural_BMI_1985  Urban_BMI_1985  National_BMI_2017
 Min.   :18.50     Min.   :18.40   Min.   :19.30   Min.   :20.20    
 1st Qu.:21.10     1st Qu.:20.80   1st Qu.:22.10   1st Qu.:23.30    
 Median :23.60     Median :23.20   Median :24.10   Median :26.20    
 Mean   :23.36     Mean   :23.01   Mean   :23.84   Mean   :25.61    
 3rd Qu.:25.00     3rd Qu.:24.90   3rd Qu.:25.10   3rd Qu.:27.10    
 Max.   :33.70     Max.   :32.60   Max.   :34.00   Max.   :34.30    
                   NA&#39;s   :3       NA&#39;s   :1                        
 Rural_BMI_2017  Urban_BMI_2017   Country              Sex           
 Min.   :19.80   Min.   :21.5   Length:200         Length:200        
 1st Qu.:22.60   1st Qu.:23.8   Class :character   Class :character  
 Median :25.75   Median :26.3   Mode  :character   Mode  :character  
 Mean   :25.24   Mean   :25.9                                        
 3rd Qu.:27.00   3rd Qu.:27.2                                        
 Max.   :34.60   Max.   :34.2                                        
 NA&#39;s   :4       NA&#39;s   :1                                           </code></pre>
<p>It looks like mean BMIs have increased in all regions for both men and women. It is unclear though if this change is statistically significant.</p>
</div>
<div id="distributions" class="section level3">
<h3>Distributions</h3>
<p>In order to apply a statistical test to compare the means, one of the first things to do is to explore the frequency of the different observed values. One way to summarize the frequency of different observed values is the <b>frequency distribution</b>, which can be shown in a table or a plot. See <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">here</a> for more information about distributions.</p>
<p>There are other types of distributions too, such as <b>probability distributions</b>, which describe the probability the occurrence of different possible outcomes. Probability distributions can be defined for discrete data (e.g. flipping a coin as heads or tails) and continuous data (e.g. BMI estimates). If we are talking about discrete data, the relative frequency of the different categories (heads or tails) can be used to define a <b>discrete probability distribution</b>. We can simply assign a probability to each category, e.g. <span class="math inline">\(P(heads) = 0.5\)</span> and <span class="math inline">\(P(tails) = 0.5\)</span>.</p>
<p><b>Continuous probability distributions</b> work in a similar way, except instead of assigning a probability to each category or type of observation (e.g. heads or tails), we assign a probability to an interval of continuous values (e.g. BMI between 22 and 26). This is because it’s not useful to construct a distribution that assigns a probability to each possible outcome (e.g. a BMI of 22.11, 22.12, etc) with such high precision. In this case, we would have to assign a very small probability to every possible BMI outcome.</p>
<p>The <b>normal (or Gaussian) distribution</b> is a type of <b>theoretical continuous probability distribution</b> that is frequently used to approximate the distribution of many naturally occurring measurements, such as that of BMI. We say that a random quantity <span class="math inline">\(X\)</span> (e.g. BMI) is normally distributed with mean <span class="math inline">\(m\)</span> and standard deviation <span class="math inline">\(s\)</span> if the proportion of values in a given interval <span class="math inline">\((a,b)\)</span> (e.g. BMI between 22 and 26) can be computed using this mathematical formula:</p>
<p><span class="math display">\[P(a &lt; x &lt; b) = \int_a^b \frac{1}{\sqrt{2\pi} s} e^{-\frac{1}{2}\big(\frac{x-m}{s}\big)^2}  \]</span></p>
<p>Translating this to our case study, if our BMI data follow a normal distribution with mean of <span class="math inline">\(m = 24\)</span> and standard deviation of <span class="math inline">\(s = 1\)</span>, then the distribution of different BMI outcomes should be centered around that mean value of 24 and would look something like this:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">norm_BMI_ex_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">norm_data =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb148-3" data-line-number="3"><span class="kw">hist</span>(<span class="kw">pull</span>(norm_BMI_ex_data, norm_data))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here we are simulating 200 observations from a normal distribution with a mean of <span class="math inline">\(m = 24\)</span> and standard deviation of <span class="math inline">\(s = 1\)</span> using the <code>rnorm()</code> function.</p>
<p>Alternatively to using base R, we can plot the frequency of simulated observations using the <code>geom_hist()</code> function of the <code>ggplot2</code> R package. The <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a> package creates plots by using layers. Notice in the following code how there is a plus sign between the <code>ggplot()</code> function and the <code>geom_histogram()</code> function. With <code>ggplot2</code> we select what data we would like to plot using the first function (<code>ggplot()</code>) and then we add on additional layers of complexity (these layers can even involve different data).</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">  ggplot2<span class="op">::</span><span class="kw">ggplot</span>(norm_BMI_ex_data, <span class="kw">aes</span>(<span class="dt">x =</span> norm_data)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Here, we are using the column called <code>norm_data</code> within <code>norm_BMI_ex_data</code>. As we noted, with <code>ggplot2</code> we must first specify the data to plot with the <code>ggplot()</code> function. Then, the <code>geom_*</code> function specifies what type of plot to create (e.g. <code>geom_histogram()</code> create a histogram).</p>
<p>We could also make this same plot by piping the <code>norm_BMI_ex_data</code> data into the <code>ggplot()</code> function:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">norm_BMI_ex_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-2" data-line-number="2"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> norm_data)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We will see later how we can add many layers to plots with <code>ggplot2</code>. For additional information on using <code>ggplot2</code>, see this <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">case study</a>.</p>
<p>Now instead of using simulated data from a normal distribution, let’s make a histogram of our BMI data:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Interesting! The data looks like it has one mode, but like it is what we call <b>right-skewed</b> because the tail of the distribution is longer on the right side (in other words, it is a bit wider on that side). See <a href="http://onlinestatbook.com/2/glossary/skew.html" target="_blank">here</a> for more information about skewed distributions.</p>
<p>If we split (or “facet”) our data by <code>Sex</code>, what do the frequency distributions look like? The easiest way to do this is to use some other functions of the <code>ggplot2</code> package, particularly the <code>facet_wrap()</code> function, which will allow us to look at differences in the distribution of the BMI estimates stratified by <code>Year</code>, <code>Sex</code>, and <code>Region</code>. We can sequentially divide our plots by deeper levels using multiple variables and the <code>+</code> plus sign within <code>facet_wrap()</code>.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb152-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb153-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb153-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb154-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb154-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb154-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-3.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Some of these plots look pretty similar to a normal distribution, like the <code>Women 2017 Urban</code> plot (although it is right-skewed). However some of the other plots, like the <code>Men 2017 Urban</code> plot, look very different. These plots show what is called a <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">bimodal distribution</a>, meaning that there appear to be two peaks (or modes), or in other words two different values (and values near each of these) that are the most frequent.</p>
</div>
<div id="quantile-quantile-plots" class="section level3">
<h3>Quantile-Quantile Plots</h3>
<p>Another useful plot to create when exploring distributions is something called a “quantile-quantile” plot (or <b>Q-Q plot</b> for short). When we talk about a <b>quantile</b>, we are talking about dividing up the distribution of the data into roughly equal portions where roughly the same number of observations fall into each portion. For example, if you divide your data into 100 quantiles, you can think about this as percentiles, but you could also divide your data into 10 quantiles and these would be called deciles.</p>
<p><b>Why Q-Q plots?</b> This plot allows us to compare the quantiles of two distributions together: (1) quantiles of a known theoretical distribution (like the normal distribution) compared to (2) quantiles of the distribution of our data. If the quantiles from these two distributions line up in the plot, then that is a visual piece of evidence that our data follow that theoretical distribution (like the normal distribution).</p>
<p><b>How does this work?</b> To do this we will plot the quantiles of our data on the y-axis and the quantiles of the theoretical normal distribution on the x-axis. If the quantiles line up then we can say that our data is fairly normal. See <a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html" target="_blank">here</a> for more information about Q-Q plots.</p>
<p>Using the <code>stat_qq()</code> function of the <code>ggplot2</code> package, we can easily create a Q-Q plot for our data randomly sampled from a normal distribution (“sample”) and compare it to the quantiles from a normal distribution (“theoretical”). The default comparison distribution for these functions is the normal distribution, so we don’t need to specify it in our code.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1">norm_BMI_ex_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> norm_data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb155-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The <code>stat_qq_line()</code> function is used to add a line (computes the slope an intercept) on the plot. Not surprisingly, we see that the points mostly fall on the line, indicating that the quantiles are fairly similar between the observed and theoretical data. There are some points that are a bit further from the line as we get to the extreme quantiles. Notice that the sample quantiles (y-axis are in a fairly similar range to our real BMI data quantiles. So values that are below 22, for example, are represented as the points below 22 on the y-axis. As expected we see that about half the points are below our mean of 24. Note that this plot is comparing our data which was randomly sampled from a normal distribution with mean 24 and standard deviation 1 to a <em>standard normal distribution</em> with mean 0 and standard deviation 1, which is why the values on the x-axis are -3 to 3 instead of 21 to 27. If the points lie on a straight line, this is evidence that the data have a normal distribution, not that the data have a particular normal distribution.</p>
<p>We can specify a specific mean and standard deviation for our theoretical distribution in our Q-Q plot; here we specify a normal distribution with mean 24 and standard deviation 1:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1">norm_BMI_ex_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb156-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> norm_data)) <span class="op">+</span></a>
<a class="sourceLine" id="cb156-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">dparams =</span> <span class="kw">c</span>(<span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb156-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">dparams =</span> <span class="kw">c</span>(<span class="dt">mean =</span> <span class="dv">24</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.png" width="90%" style="display: block; margin: auto;" /> Notice that the plot looks the same except for the values on the x-axis have changed, meaning our interpretation will be the same – it looks like the values are consistent with a normal distribution.</p>
<p>If we were to use different data that had a range of different values our y-axis would shift according to the range of values. For example, the <code>Orange</code> data (within the installation of R) includes data about the circumference of orange trees in millimeters. Here, we can see that the quantiles are quite different but reflect the range of orange tree circumferences.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="kw">range</span>(<span class="kw">pull</span>(Orange, circumference))</a></code></pre></div>
<pre><code>[1]  30 214</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">Orange <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> circumference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb159-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>()</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-90-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Now, let’s take a look at our actual BMI data:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb160-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" width="90%" style="display: block; margin: auto;" /> This is a little hard to see, some plots suggest those subsets of the data are similar to a normal distribution, but others seem to be skewed. Let’s take a closer look.</p>
<p>For the sake of simplicity, we are going to focus on the subset of data for the women. This is because women were identified in the paper to have fastest increases in BMI over time. If we want to compare two subsets of women (e.g. 1985 versus 2017 or rural versus urban), then we need to look at the distribution of each of these subsets.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb161-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb161-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb161-4" data-line-number="4"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb161-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb161-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-92-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We can see that at the extremes of our quantiles, for most of our data, our tails are not very similar to the theoretical distribution. We can can also see that our data is right- or positive-skewed, because the extreme values are above the line that indicates a perfect match between the theoretical and observed data.</p>
<p>The rural data looks more normal than the urban data. You might be asking, why do we care if the data look more normal or not? It turns out if you want to ask questions like “Is there a difference in the average BMI estimates from women in 1985 compared to women in 2017?”, we will need to use some of type of statistical test. The most commonly used statistical tests that can answer that question rely on an assumption about the data you have, namely that your data have a similar shape as a theoretical normal distribution. So, if we want to use those powerful statistical tests that rely on this assumption of “normality”, then we need to check that assumption before using those tests.</p>
<p>One way to do that is to use Q-Q plots. Another way to do that is to use the <a href="http://www.statistics4u.info/fundstat_eng/ee_shapiro_wilk_test.html" target="_blank">Shapiro-Wilk test for normality</a> when the Q-Q plot is a bit unclear. Many statisticians however would conclude from the Q-Q plots that normality appears to be violated in our data.</p>
</div>
<div id="shapiro-wilk-test" class="section level3">
<h3>Shapiro-Wilk test</h3>
<p>Here, we are using the <code>summarize()</code> and <code>group_by()</code> functions from <code>dplyr</code> to perform the Shapiro-Wilk test for all the subsets we are interested in. In this case the <code>$</code> is used to grab the <code>p.value</code> from the <code>shapirotest()</code> output.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb162-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb162-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb162-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National  0.0000478  
2 1985  Rural     0.000679   
3 1985  Urban     0.000000332
4 2017  National  0.00363    
5 2017  Rural     0.0108     
6 2017  Urban     0.0000130  </code></pre>
<p>We can see that all of the subsets of our data do not appear to be normally distributed because the <span class="math inline">\(p\)</span>-value is less than 0.05 for all subsets. This is not suprising as the Q-Q plots suggested the same thing.</p>
</div>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<p>In the previous section, we hinted at the existance of statistical tests to be able to assess if there is a difference in the average BMI estimates between two groups (e.g. women in 1985 and women in 2017). One such test is the <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test" target="_blank">Student’s <span class="math inline">\(t\)</span>-test</a>, which can be used to determine if <a href="http://onlinestatbook.com/2/estimation/difference_means.html" target="_blank">two group means are different</a>. However, as mentioned before, this test depends on certain assumption of our data.</p>
<p>In this section, we are going to talk about this test and other tests that do not require assumptions about our data.</p>
<div id="hypothesis-testing" class="section level3">
<h3>Hypothesis testing</h3>
<p>Let’s remind ourselves of one of our original questions,</p>
<blockquote>
<p>Is there a difference between rural and urban BMI estimates around the world?</p>
</blockquote>
<p>In hypothesis testing, we are interested in comparing two different hypotheses: a “null” hypothesis (can be thought of like a baseline e.g. the means between two groups are the same) compared to an “alternative” hypothesis (e.g. the means between two groups are different). We are going to ask if there is enough evidence in our data to reject the null hypothesis.<br />
Let’s try to formalize this a bit.</p>
<p>In our case, we want to perform what is called a <b>two means hypothesis test</b> using a statistical test (e.g. a Student’s <span class="math inline">\(t\)</span>-test). Suppose we call the true unknown means of the two groups <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span>, for group 1 and group 2, respectively. Then we can define the <b>null hypothesis</b> that there is no difference in the two means:</p>
<p><span class="math display">\[ H_0: \mu_1 = \mu_2 \]</span> In contrast, we also define an <b>alternative hypothesis</b> that there is a difference between the two means:</p>
<p><span class="math display">\[ H_a: \mu_1 \neq \mu_2 \]</span></p>
<p>The idea behind a hypothesis test is that we assume the null hypothesis is true and we use our data to help us identify if there is enough evidence to <em>reject the null hypothesis</em>. This is similar to the idea of assuming that individuals are not guilty until proven otherwise. If there is not enough evidence in the data, then we say we “fail to reject the null hypothesis”.</p>
<p>You might be asking, “But we do not know what the true group means are?” That is correct. Instead, we must estimate these means based on the data that we have. For example, in our data, we can estimate differences in the average BMI estimates for women in rural and urban regions in the two different years.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb164-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb164-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Region, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb164-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">avg_bmi =</span> <span class="kw">mean</span>(BMI, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </a></code></pre></div>
<pre><code># A tibble: 4 x 3
# Groups:   Region [2]
  Region Year  avg_bmi
  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;
1 Rural  1985     23.6
2 Rural  2017     26.0
3 Urban  1985     24.6
4 Urban  2017     26.8</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb166-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb166-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Region, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb166-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">avg_bmi =</span> <span class="kw">mean</span>(BMI, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb166-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> avg_bmi <span class="op">-</span><span class="st"> </span><span class="kw">lag</span>(avg_bmi)) </a></code></pre></div>
<pre><code># A tibble: 4 x 4
# Groups:   Region [2]
  Region Year  avg_bmi  diff
  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Rural  1985     23.6 NA   
2 Rural  2017     26.0  2.39
3 Urban  1985     24.6 NA   
4 Urban  2017     26.8  2.21</code></pre>
<p>Here we see that that BMI estimates increased by 2.39 points within rural regions and increased by 2.21 points within urban regions.<br />
Next, we can use a statistical test (e.g. a Student’s <span class="math inline">\(t\)</span>-test) to assess if these differences are statistically meaningful or if these differences could be found due to random chance.</p>
<p>There are two possible classes of statistical tests that we could run to compare the means of these two groups:</p>
<ol style="list-style-type: decimal">
<li>Parametric</li>
<li>Nonparametric</li>
</ol>
<p><b>Parametric tests</b> are based on assumptions about the distribution of the underlying data, while <b>nonparametric tests</b> do not rely on these distributional assumptions. It is called “parametric” because aspects about the distribution of the data, like the mean, are called <b>parameters</b> of a mathematical function when we describe a population. In parametric tests, we estimate the parameters of the true population of interest using a sample of that population. These estimates are called <b>statistics</b>. See <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960" target="_blank">here</a> for more information about the difference between these two classes of tests.</p>
</div>
<div id="parametric-two-sample-t-test" class="section level3">
<h3>Parametric two-sample <span class="math inline">\(t\)</span>-test</h3>
<p>The two-sample <span class="math inline">\(t\)</span>-test is a common way to determine if the means of two groups are different. The two-sample <span class="math inline">\(t\)</span>-test however, relies on several <u><b>assumptions</b></u>:</p>
<ol style="list-style-type: decimal">
<li>The data for each group is <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">normally distributed</a></li>
<li>The <a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance" target="_blank">variance</a> of both groups is similar</li>
<li>The number of observations is similar for both groups - thus they are <a href="https://www.statisticshowto.datasciencecentral.com/balanced-and-unbalanced-designs/" target="_blank">balanced</a></li>
<li>The observations are <a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">independent</a> (meaning that observations do not influence each other)</li>
</ol>
<p>A <span class="math inline">\(t\)</span>-test is most commonly applied when the test statistic would follow a normal distribution if the value of a scaling term in the test statistic were known. When the scaling term is unknown and is replaced by an estimate based on the data, the test statistics (under certain conditions) follow a Student’s t distribution. The <span class="math inline">\(t\)</span>-test can be used, for example, to determine if the means of two sets of data are significantly different from each other.</p>
<p>If these assumptions are violated, this doesn’t necessarily mean we can’t perform a <span class="math inline">\(t\)</span>-test. It just means we may need to consider the following options:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/" target="_blank">Transformation</a> of the data to make it more normally distributed</li>
<li><a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/" target="_blank">Welch’s <span class="math inline">\(t\)</span>-test</a> also call the unequal variance <span class="math inline">\(t\)</span>-test we may need to modify the way we perform the <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test" target="_blank"><span class="math inline">\(t\)</span>-test</a> to account for the difference in the variance in the two groups</li>
<li><a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html" target="_blank">Permutation/resampling methods</a> to deal with violations of normality or imbalance.</li>
</ol>
<p>Alternatively, we can use a nonparametric test which does not rely on assumptions about the parameters of the data. These tests are often a good option when multiple assumptions are violated are when sample sizes are small. We will explore these options.</p>
<p>Our data has a balance of observations for both groups - in fact they are equal, thus that assumption is not violated. If it were violated, we would want to consider using permutation methods which are also a good option for violations of normality. To learn more about these methods see <a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html" target="_blank">here</a>.</p>
<p>If we needed to check if our samples were imbalanced, we could use the <code>count()</code> function of <code>dplyr</code>:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1">dplyr<span class="op">::</span><span class="kw">count</span>(BMI_long, Sex, Year, Region)</a></code></pre></div>
<pre><code># A tibble: 12 x 4
   Sex   Year  Region       n
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;int&gt;
 1 Men   1985  National   200
 2 Men   1985  Rural      200
 3 Men   1985  Urban      200
 4 Men   2017  National   200
 5 Men   2017  Rural      200
 6 Men   2017  Urban      200
 7 Women 1985  National   200
 8 Women 1985  Rural      200
 9 Women 1985  Urban      200
10 Women 2017  National   200
11 Women 2017  Rural      200
12 Women 2017  Urban      200</code></pre>
<p>We can see that the number of observations for each possible group of interest is the same.</p>
<p>The <span class="math inline">\(t\)</span>-test is also fairly robust to non-normality if the data is relatively large, due to what is called the <a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/" target="_blank">central limit theorem</a>, which states that as samples get larger, they approximate a normal distribution.</p>
<p>We have an n of 200, which should be sufficient but let’s investigate the nonparametric tests further.</p>
<p>Often we would check if the variance of the rural and urban data is equal using the <code>var.test()</code> function. However this is an F test and assumes that the data is normally distributed. Instead we will use the <code>mood.test()</code> function which performs the <a href="https://files.eric.ed.gov/fulltext/ED065559.pdf" target="_blank">Mood’s two-sample test for a difference in scale parameters</a> and does not assume that the data is normally distributed. We will also introduce the <code>pull()</code> function of the <code>dplyr</code> package.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="co">#pull() will allow us to take the BMI column after we filter BMI_long</span></a>
<a class="sourceLine" id="cb170-2" data-line-number="2"></a>
<a class="sourceLine" id="cb170-3" data-line-number="3"><span class="kw">mood.test</span>(dplyr<span class="op">::</span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb170-4" data-line-number="4">                             Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb170-5" data-line-number="5">                             Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb170-6" data-line-number="6">                             Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb170-7" data-line-number="7">          dplyr<span class="op">::</span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long,</a>
<a class="sourceLine" id="cb170-8" data-line-number="8">                             Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb170-9" data-line-number="9">                             Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb170-10" data-line-number="10">                             Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  dplyr::pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;,  and dplyr::pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;,     Region == &quot;Rural&quot;), BMI) and     Region == &quot;Urban&quot;), BMI)
Z = 2.9189, p-value = 0.003513
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="co"># p value &lt;.05, conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb172-2" data-line-number="2"><span class="co"># reject the null: no difference in the spread of the distributions</span></a>
<a class="sourceLine" id="cb172-3" data-line-number="3"></a>
<a class="sourceLine" id="cb172-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb172-5" data-line-number="5">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb172-6" data-line-number="6">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb172-7" data-line-number="7">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb172-8" data-line-number="8">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb172-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb172-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
Z = 3.1305, p-value = 0.001745
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="co"># p value &lt;.05, conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb174-2" data-line-number="2"><span class="co"># reject the null: no difference in the variance of the distributions</span></a>
<a class="sourceLine" id="cb174-3" data-line-number="3"></a>
<a class="sourceLine" id="cb174-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb174-5" data-line-number="5">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb174-6" data-line-number="6">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb174-7" data-line-number="7">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb174-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb174-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb174-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
Z = -0.24228, p-value = 0.8086
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="co"># p value &gt;.05, conclude that variance is equal</span></a>
<a class="sourceLine" id="cb176-2" data-line-number="2"><span class="co"># fail to reject the null the null: no difference in the variance of the distributions</span></a>
<a class="sourceLine" id="cb176-3" data-line-number="3"></a>
<a class="sourceLine" id="cb176-4" data-line-number="4"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, </a>
<a class="sourceLine" id="cb176-5" data-line-number="5">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb176-6" data-line-number="6">                      Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb176-7" data-line-number="7">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb176-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb176-9" data-line-number="9">                      Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb176-10" data-line-number="10">                      Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
Z = 1.5317, p-value = 0.1256
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="co"># p value &gt;.05, conclude that variance is equal</span></a>
<a class="sourceLine" id="cb178-2" data-line-number="2"><span class="co"># fail to reject the null the null: no difference in the variance of the distributions</span></a></code></pre></div>
<p>Our p value is less than .05 for both tests, thus we reject our null hypothesis that there is no difference in the variance. Therefore, we conclude that the variance is not equal and that our data also violates this assumption.</p>
<p>We will perform a special t.test where we account for the fact that our variance is not equal.</p>
<p>Another important consideration is that the data is what we call <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/" target="_blank">paired</a>, meaning that the measurements from the rural and urban areas are not independent. That is because we have a rural and urban measurement mean for nearly every country. Thus these values may be more similar to one another if they come from the same country. This is also true for the male and female measurements from the same country or the values in the same countries from 1985 and later in 2017. However, we are assuming that measurements between different countries are independent, thus this assumption is not violated, making it reasonable to perform the Welch’s or paired <span class="math inline">\(t\)</span>-test.</p>
<p>When we perform a paired <span class="math inline">\(t\)</span>-test our hypothesis is slightly different from the typical student’s <span class="math inline">\(t\)</span>-test. In this case we are testing the differences among the pairs of observations and how close these differences are to zero. Our null hypothesis is that the mean of the differences is equal to zero:</p>
<pre><code>                                    Ho: μd = 0
                                    
                           μd is the true mean differences 
                           between paired observations of the two groups</code></pre>
<p>The alternative hypothesis is that the mean of the differences is not equal to zero</p>
<pre><code>                                    Ha: μd ≠ 0
                                    
                           μd is the true mean differences 
                           between paired observations of the two groups</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb181-2" data-line-number="2">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb181-3" data-line-number="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb181-4" data-line-number="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb181-5" data-line-number="5">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb181-6" data-line-number="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb181-7" data-line-number="7">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -10.356, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.0573625 -0.7190478
sample estimates:
mean of the differences 
             -0.8882051 </code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb183-2" data-line-number="2"></a>
<a class="sourceLine" id="cb183-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb183-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>,</a>
<a class="sourceLine" id="cb183-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb183-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb183-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb183-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb183-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -14.095, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.1870263 -0.8956268
sample estimates:
mean of the differences 
              -1.041327 </code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb185-2" data-line-number="2"></a>
<a class="sourceLine" id="cb185-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb185-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb185-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb185-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb185-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb185-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb185-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
t = -22.119, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.591762 -2.167422
sample estimates:
mean of the differences 
              -2.379592 </code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb187-2" data-line-number="2"></a>
<a class="sourceLine" id="cb187-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb187-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb187-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb187-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb187-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb187-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb187-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
t = -24.378, df = 198, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.383938 -2.027118
sample estimates:
mean of the differences 
              -2.205528 </code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="co"># the t value shows us that the directionality of the difference</span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3"><span class="co"># the t value was negative thus BMI was lower in 1985 (1st group) </span></a>
<a class="sourceLine" id="cb189-4" data-line-number="4"><span class="co"># compared to 2017 (2nd group)</span></a></code></pre></div>
<div id="section-16" class="section level4 question_block">
<h4></h4>
<p><u>Question opportunity:</u> Looking at the t value, was global BMI lower in Rural or Urban areas in 1985?</p>
</div>
<div id="section-17" class="section level4">
<h4></h4>
<p>Now we will try transform our data to make it more normally distributed. One way to do this is to take the logarithm of the data values. Then we will see how this influences the results. Again we will focus on the data for women.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co"># create a new column with the log version of the BMI variable using mutate()</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2"></a>
<a class="sourceLine" id="cb190-3" data-line-number="3">BMI_long_log &lt;-<span class="st"> </span><span class="kw">mutate</span>(BMI_long, <span class="dt">log_BMI=</span><span class="kw">log</span>(<span class="kw">pull</span>(BMI_long,BMI)))</a>
<a class="sourceLine" id="cb190-4" data-line-number="4"></a>
<a class="sourceLine" id="cb190-5" data-line-number="5">BMI_long_log <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb190-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb190-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>log_BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb190-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb190-9" data-line-number="9"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb190-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Year <span class="op">+</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-98-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">BMI_long_log <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(log_BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National     0.00315 
2 1985  Rural        0.0105  
3 1985  Urban        0.000334
4 2017  National     0.293   
5 2017  Rural        0.0784  
6 2017  Urban        0.00416 </code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="co"># recall what it was before</span></a>
<a class="sourceLine" id="cb193-2" data-line-number="2">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb193-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb193-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Year, Region) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb193-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">shapiro_test =</span> <span class="kw">shapiro.test</span>(BMI)<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code># A tibble: 6 x 3
# Groups:   Year [2]
  Year  Region   shapiro_test
  &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;
1 1985  National  0.0000478  
2 1985  Rural     0.000679   
3 1985  Urban     0.000000332
4 2017  National  0.00363    
5 2017  Rural     0.0108     
6 2017  Urban     0.0000130  </code></pre>
<p>The data appears to be more similar to the normal distribution, although not quite. Again, our sample size of 200 is quite large and the <span class="math inline">\(t\)</span>-test is generally quite robust to violations of normality with large n, thus the modified <span class="math inline">\(t\)</span>-test to account for unequal variance might be a good option using the log normalized data, as it is at least more normally distributed.</p>
<p>Let’s see the results of the <span class="math inline">\(t\)</span>-test with the transformed data:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb195-2" data-line-number="2">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb195-3" data-line-number="3">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb195-4" data-line-number="4">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb195-5" data-line-number="5">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb195-6" data-line-number="6">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb195-7" data-line-number="7">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -10.058, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.04242774 -0.02851589
sample estimates:
mean of the differences 
            -0.03547182 </code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2"></a>
<a class="sourceLine" id="cb197-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb197-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb197-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb197-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb197-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb197-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb197-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -13.962, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.05214677 -0.03923811
sample estimates:
mean of the differences 
            -0.04569244 </code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb199-2" data-line-number="2"></a>
<a class="sourceLine" id="cb199-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb199-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb199-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb199-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb199-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb199-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb199-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), log_BMI) and     &quot;Rural&quot;), log_BMI)
t = -22.369, df = 195, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.10617051 -0.08896626
sample estimates:
mean of the differences 
            -0.09756839 </code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a>
<a class="sourceLine" id="cb201-2" data-line-number="2"></a>
<a class="sourceLine" id="cb201-3" data-line-number="3"><span class="kw">t.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb201-4" data-line-number="4">                   Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb201-5" data-line-number="5">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI), </a>
<a class="sourceLine" id="cb201-6" data-line-number="6">       <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long_log, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb201-7" data-line-number="7">                   Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb201-8" data-line-number="8">                   Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), log_BMI),</a>
<a class="sourceLine" id="cb201-9" data-line-number="9">       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Paired t-test

data:  pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long_log, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), log_BMI) and     &quot;Urban&quot;), log_BMI)
t = -23.977, df = 198, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.09377834 -0.07952498
sample estimates:
mean of the differences 
            -0.08665166 </code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="co"># means are different - p value &lt;.05 reject the null: no difference in the means</span></a></code></pre></div>
<p>We can see that our results are quite similar to that of the original data, however the t values are slightly smaller. In other cases we may see a much more dramatic influence of transforming our data.</p>
<p>Now, let’s take a look at nonparametric tests, which are also a great option when the assumptions of the <span class="math inline">\(t\)</span>-test are violated.</p>
</div>
</div>
<div id="nonparametric-two-sample-tests" class="section level3">
<h3>Nonparametric two sample tests</h3>
<p>There are multiple nonparametric options to consider when the assumptions of the [<span class="math inline">\(t\)</span>-test] are violated. The <a href="http://www.biostathandbook.com/wilcoxonsignedrank.html" target="_blank">Wilcoxon signed rank test</a> (for paired data - the alternative is <a href="http://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/BS704_Nonparametric4.html" target="_blank">Wilcoxon rank sum test</a> (also called the Mann-Whitney U test) for independent samples) and the <a href="https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/ks2samp.htm" target="_blank">two-sample Kolmogorov-Smirnov test</a> (KS) both do not assume normality (has both paired and unpaired methods). Thus these tests should be considered when the data of either groups does not appear to be normally distributed and particularly when the number of samples is low.</p>
<p>Importantly the KS test does not assume normality or equal variance, while the Wilcoxon signed rank test does assume equal variance. Here is how you would perform these tests. However in our case, because the variance is not equal between some of our groups of interest, the KS test would be more appropriate. Both the <span class="math inline">\(t\)</span>-test and the KS test evaluate if the distributions of the two groups are identical, however the KS test does not particularly test any aspect of the distribution like the mean, therefore there are no confidence intervals in the output using this test.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb204-2" data-line-number="2">                    Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb204-3" data-line-number="3">                    Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb204-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb204-5" data-line-number="5">                    Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb204-6" data-line-number="6">                    Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb204-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
D = 0.20006, p-value = 0.0007385
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb206-2" data-line-number="2">                    Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb206-3" data-line-number="3">                    Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI), </a>
<a class="sourceLine" id="cb206-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb206-5" data-line-number="5">                    Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb206-6" data-line-number="6">                    Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb206-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Urban&quot;), BMI)
D = 0.19914, p-value = 0.0007779
alternative hypothesis: two-sided</code></pre>
<p>What about the difference in female BMI from 1985 to 2017 for both regions? Recall that the variance was equal for these comparisons.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb208-2" data-line-number="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb208-3" data-line-number="3">                        Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb208-4" data-line-number="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb208-5" data-line-number="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb208-6" data-line-number="6">                       Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb208-7" data-line-number="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Rural&quot;), BMI) and     &quot;Rural&quot;), BMI)
V = 273, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1"><span class="kw">wilcox.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb210-2" data-line-number="2">                        Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb210-3" data-line-number="3">                        Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb210-4" data-line-number="4">           <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_long, Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb210-5" data-line-number="5">                       Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb210-6" data-line-number="6">                       Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>), BMI),</a>
<a class="sourceLine" id="cb210-7" data-line-number="7">           <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;1985&quot;, Region ==  and pull(filter(BMI_long, Sex == &quot;Women&quot;, Year == &quot;2017&quot;, Region ==     &quot;Urban&quot;), BMI) and     &quot;Urban&quot;), BMI)
V = 189, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>There is a significant difference across time for both regions, as we saw with the <span class="math inline">\(t\)</span>-test. There is also a significant difference by region for each year. However, the p-values are a bit larger for the KS test results than we saw with the <span class="math inline">\(t\)</span>-test.</p>
</div>
<div id="multiple-testing-correction" class="section level3">
<h3>Multiple Testing Correction</h3>
<p>Let’s take a look back at the questions we wanted to answer: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
<p>It’s important to note that ultimately we wanted to test 4 different tests to answer question 1 and 2:</p>
<ol style="list-style-type: decimal">
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 1985?</li>
<li>Is there a difference in mean BMI for women between Rural and Urban areas in 2017?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Rural areas?</li>
<li>Is there a difference in mean BMI for women between 1985 and 2017 in Urban areas?</li>
</ol>
<p>When we test multiple questions like this, we need to correct for the multiple tests that we are performing.</p>
<p>The more we test data, the more likely we are to see a significant finding just by <a href="https://www.stat.berkeley.edu/~mgoldman/Section0402.pdf" target="_blank">random chance</a> even when the finding is in fact not real. It all comes down to probability.</p>
<div id="probability" class="section level4">
<h4>Probability</h4>
<p>You may recall that probability is the chance that an event will happen and it ranges from 0 to 1. You can also think of it as a percentage of 0% (probability =0) to 100% (probability = 1) of chance that an event will happen.</p>
<p><img src="https://www.mathsisfun.com/data/images/probability-line.svg" /> <a href="https://www.mathsisfun.com/data/images/probability-line.svg" class="uri">https://www.mathsisfun.com/data/images/probability-line.svg</a></p>
<p>If we consider flipping a coin, the probability of an event happening (heads) is always equal to 1 ( or 100% chance) minus the probability of the event not happening (tails instead of heads) because the total probability can not exceed 100%.</p>
<pre><code>    probability of 1 (100% chance) = the probabilty of heads (50% chance)
                                     + the probability of tails (50% chance)
                                   
                                 1 = P(heads) + P(tails)
        probability of one outcome = 1 - the probability of the other outcome
                          P(heads) = 1 - P(tails) 
                                    or
                          P(tails) = 1 - P(heads)</code></pre>
<p>If we think about the probability of getting significant or nonsignificant results we can think of it like this:</p>
<pre><code>                                 1 = P(signifiant results) 
                                      + P(no significant results)
            P(significant results) = 1 - P(no significant results)</code></pre>
</div>
</div>
<div id="alpha" class="section level3">
<h3>Alpha</h3>
<p>Alpha is the amount of risk that you are willing to accept that a statistical test result is actually a false positive, in other words we reject the null hypothesis when the null hypothesis is true. This is also called <a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html" target="_blank">type 1 error</a>. A significance threshold of .05 is customary and it means that we are accepting a 5% chance that our result is actually a false positive.</p>
<pre><code>                             alpha = probability of false significant results 
                                       or
                                 α = P(Making a type 1 error)
                                        </code></pre>
<p>Remember that in our statistical tests if the p-value &lt; alpha it is considered significant and if p-value &gt; alpha it is considered not significant</p>
<p>But what really is the <a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8" target="_blank">p-value</a>?</p>
</div>
<div id="p-values" class="section level3">
<h3>p-values</h3>
<p>The p in p-value stands for <b>probability</b> - the probability that we would obtain the statistics (for example the t in our student <span class="math inline">\(t\)</span>-tests based on the means of our groups of comparison) just by random chance alone. Therefore a p-value of 0.02 means that there is a 2 percent chance that out data may look the way it does just because of random chance and not because there is really a difference in the means of the groups of interest.</p>
<p>So then if alpha is the threshold for the p-value for obtaining false significant results then the probability of not making incorrect conclusions is 1 - alpha:</p>
<pre><code>             P(Not making an error) = 1 - α</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="co">#P(Not making an error) = 1 - α</span></a>
<a class="sourceLine" id="cb216-2" data-line-number="2"><span class="dv">1</span><span class="fl">-.05</span> </a></code></pre></div>
<pre><code>[1] 0.95</code></pre>
<p>OK so if we use an alpha of .05 we are accepting that 95% of the time we will not make a Type 1 error and 5 % of the time we will just by random chance.<br />
Taking this one step further:</p>
<pre><code>                 P(Making an error) = 1 - P(Not making an error)
                 P(Making an error) = 1 - (1 - α)
                              </code></pre>
<p>Here we can see that this checks out:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1"><span class="co">#P(Making an error) = 1 - (1 - α)</span></a>
<a class="sourceLine" id="cb219-2" data-line-number="2"><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="fl">-.05</span>)</a></code></pre></div>
<pre><code>[1] 0.05</code></pre>
<p>So what happens if we perform multiple tests?</p>
<p>The probability of not making a type 1 error would remain the same for each test. Therefore we need to multiply the probabilities together each time to determine the over all probability of making an error across multiple tests. See <a href="http://mathforum.org/library/drmath/view/74065.html" target="_blank">here</a> about why we multiply probabilities together.</p>
<pre><code>    P(Not making an error in m tests) = (1 - α)^m
P(Making at least 1 error in m tests) = 1 - (1 - α)^m</code></pre>
<p>Let’s consider if we performed 10 different statistical tests and if we as usual considered the significance threshold alpha of .05:</p>
<p>So the probability of getting 1 significant result with 10 tests is:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - ((1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α)(1 - α))</span></a>
<a class="sourceLine" id="cb222-2" data-line-number="2"><span class="co">#this is the same as:</span></a>
<a class="sourceLine" id="cb222-3" data-line-number="3"><span class="co">#P(Making at least 1 error in 10 tests) = 1 - (1 - α)^10</span></a>
<a class="sourceLine" id="cb222-4" data-line-number="4"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">10</span></a></code></pre></div>
<pre><code>[1] 0.4012631</code></pre>
<p>So there is a 40% chance that that there will be a significant finding simply due to random chance alone.</p>
<p>What about 100 tests?</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="co">#P(Making at least 1 error in 100 tests) = 1 - (1 - α)^100</span></a>
<a class="sourceLine" id="cb224-2" data-line-number="2"> <span class="dv">1</span><span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="fl">-.05</span>)<span class="op">^</span><span class="dv">100</span></a></code></pre></div>
<pre><code>[1] 0.9940795</code></pre>
<p>Yikes!! That is almost a 100% chance that there will be a significant finding simply due to chance alone!</p>
<p>Much of this explanation is described in this <a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf" target="_blank">lecture</a>.</p>
<p>One way to correct for this is multiple testing issue is using the <a href="http://mathworld.wolfram.com/BonferroniCorrection.html" target="_blank">Bonferroni method</a>.</p>
<p>In this method we would divide our significance threshold (generally 0.05) by the number of tests.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">4</span> <span class="co"># 4 tests</span></a></code></pre></div>
<pre><code>[1] 0.0125</code></pre>
<p>Our new significance threshold is now 0.0125. Thus our p-values should be less than this value for us to reject the null that there is no difference in means. In all cases, our p-values were less than 0.0125. So we see a significant difference in the means of the groups after multiple testing correction for our different tests.</p>
<p>Again, it would be reasonable to use the <span class="math inline">\(t\)</span>-test because it is robust to deviations in normality when samples are relatively large. We can see that we obtained the same results regardless of the test that we used. However, if sample sizes are small (generally speaking n&lt;15 for each group), then these nonparametric options are useful to know.</p>
<p>The D values in the output of our KS tests, show the magnitude of distance in the difference between the distributions of the groups tested. You may notice that the D value is larger for the tests of BMI across time rather then across region. In these tests the p-value was also smaller.</p>
</div>
</div>
<div id="data-visualization" class="section level2">
<h2>Data Visualization</h2>
<p>Again we will utilize <code>ggplot2</code> to create plots to look at the directional and magnitude of the differences in BMI we are interested in. If you need additional information please see <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">here</a>. The top two lines of the code for the following plots, filter the data to only specific values of interest. Then we layer what is called a jitter on top of a box plot. A jitter is essentially a dot plot but with some variation on the location of the points so that they do not line up vertically which can make the individual points difficult to see.</p>
<p>Our first main question was: Is there a difference between rural and urban BMI estimates around the world? Let’s look at the national mean BMI estimates for each of the years:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb228-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb228-3" data-line-number="3">         Year <span class="op">==</span><span class="st"> &quot;1985&quot;</span>, </a>
<a class="sourceLine" id="cb228-4" data-line-number="4">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb228-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb228-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb228-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="co"># the width determines how wide the points are plotted</span></a>
<a class="sourceLine" id="cb229-2" data-line-number="2"></a>
<a class="sourceLine" id="cb229-3" data-line-number="3">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb229-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb229-5" data-line-number="5">         Year <span class="op">==</span><span class="st"> &quot;2017&quot;</span>, </a>
<a class="sourceLine" id="cb229-6" data-line-number="6">         Region <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb229-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb229-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb229-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Our 2nd main question was: How have BMI estimates changed from 1985 to 2017? Let’s look at the change in rural and urban mean BMI estimates over time:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1"><span class="co">#this time we will add titles for Rural and Urban using ggtitle()</span></a>
<a class="sourceLine" id="cb230-2" data-line-number="2">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb230-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb230-4" data-line-number="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb230-5" data-line-number="5">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb230-6" data-line-number="6"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb230-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb230-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb230-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Rural&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb231-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb231-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb231-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Urban&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb231-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb231-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Urban&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Let’s put the plots together to see how the change over the years differs between the regions. We will use again use <code>facet_wrap()</code> to do this:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb232-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb232-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb232-4" data-line-number="4">         Region <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Urban&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb232-5" data-line-number="5"><span class="st">  </span><span class="co"># filtering this way allows us to keep data from both years</span></a>
<a class="sourceLine" id="cb232-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb232-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Region)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-109-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" data-line-number="1"><span class="co"># we would also get national data without `Region %in% c(&quot;Rural&quot;, &quot;Urban&quot;))`</span></a></code></pre></div>
<p>Indeed the change in BMI over time looks bigger in the rural areas!</p>
<p>One third main questions was: How do the different countries compare? Or in other words what do the individual dots represent in our box plots? We will take a look using <code>geom_label()</code>:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb234-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb234-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb234-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb234-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_label</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If we include all country names this is a bit too much… so perhaps we should focus on just the extreme BMI values using <code>filter()</code> function of the<code>dplyr</code> package. We will also use the <code>ggrepel</code> package to have our labels not overlap each other.</p>
<p>Part of the third question was: How does the United States of America compare? So let’s label the data points for the United states.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb235-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb235-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb235-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb235-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb235-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-8" data-line-number="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb235-9" data-line-number="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb235-10" data-line-number="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb235-11" data-line-number="11"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb235-12" data-line-number="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb235-13" data-line-number="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb235-14" data-line-number="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb235-15" data-line-number="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb235-16" data-line-number="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb235-17" data-line-number="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb235-18" data-line-number="18"><span class="st">              </span><span class="kw">filter</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb235-19" data-line-number="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-111-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>And let’s fill the box plots with color and outline in black:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb236-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb236-3" data-line-number="3">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb236-4" data-line-number="4">         Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI)) <span class="op">+</span></a>
<a class="sourceLine" id="cb236-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill =</span> Year)) <span class="op">+</span></a>
<a class="sourceLine" id="cb236-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb236-8" data-line-number="8"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb236-9" data-line-number="9">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb236-10" data-line-number="10">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-11" data-line-number="11"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb236-12" data-line-number="12">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI),</a>
<a class="sourceLine" id="cb236-13" data-line-number="13">              <span class="dt">width =</span> <span class="fl">.02</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb236-14" data-line-number="14"><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb236-15" data-line-number="15"><span class="st">              </span><span class="kw">filter</span>(Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb236-16" data-line-number="16">                     Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb236-17" data-line-number="17">                     Region <span class="op">==</span><span class="st"> &quot;Rural&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-18" data-line-number="18"><span class="st">              </span><span class="kw">subset</span>(BMI<span class="op">&gt;</span><span class="dv">31</span> <span class="op">|</span><span class="st"> </span>BMI<span class="op">&lt;</span><span class="dv">19</span> <span class="op">|</span><span class="st"> </span>Country <span class="op">==</span><span class="st"> &quot;United States of America&quot;</span>), </a>
<a class="sourceLine" id="cb236-19" data-line-number="19">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI, <span class="dt">label =</span> Country))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-112-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div id="overall-differences" class="section level3">
<h3>Overall differences</h3>
<p>Let’s take a look at all the data together, including the data for men:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Region)) <span class="op">+</span></a>
<a class="sourceLine" id="cb237-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Region)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb237-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex)   </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>That’s useful, but let’s look at the individual points and include our country labels, to do so lets change our United States of America label to USA:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1">BMI_long[[<span class="st">&quot;Country&quot;</span>]] &lt;-BMI_long[[<span class="st">&quot;Country&quot;</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb238-2" data-line-number="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb238-3" data-line-number="3"></a>
<a class="sourceLine" id="cb238-4" data-line-number="4"></a>
<a class="sourceLine" id="cb238-5" data-line-number="5"><span class="kw">ggplot</span>(BMI_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> BMI, <span class="dt">col =</span> Year)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Year)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Region) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-9" data-line-number="9"><span class="st">  </span><span class="co"># This will add a horizontal dashed line to indicate the obesity BMI threshold</span></a>
<a class="sourceLine" id="cb238-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long), </a>
<a class="sourceLine" id="cb238-11" data-line-number="11">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb238-12" data-line-number="12">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-13" data-line-number="13"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb238-14" data-line-number="14"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb238-15" data-line-number="15"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb238-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb238-17" data-line-number="17">              <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb238-18" data-line-number="18">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-19" data-line-number="19"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb238-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb238-21" data-line-number="21">            <span class="kw">aes</span>(<span class="dt">x =</span>Year, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb238-22" data-line-number="22">            <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb238-23" data-line-number="23"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb238-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb238-25" data-line-number="25">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb238-26" data-line-number="26">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb238-27" data-line-number="27">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb238-28" data-line-number="28">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb238-29" data-line-number="29">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb238-30" data-line-number="30">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb238-31" data-line-number="31">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb238-32" data-line-number="32"><span class="st">  </span><span class="co"># This changes the size of x axis labels for the facet </span></a>
<a class="sourceLine" id="cb238-33" data-line-number="33"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Differences in BMI Over Time and Across Region Type and Gender&quot;</span>) </a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-114-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1">  <span class="co"># Add a  plot title</span></a></code></pre></div>
<p>Here we can see that overall BMI appears to be increasing globally over time. Additionally we can see that this is occurring not just in urban areas, but also in rural areas. The US is consistently above the median in all strata of the data. In general, the female data shows higher BMI values than the male data. The rural USA BMI appears to be higher than the urban BMI for both men and women. Many countries have average BMI estimates above the obesity threshold of 30. Thus it appears that education and outreach programs for weight management should focus on both rural and urban areas and both genders. Education and assistance for women may be especially helpful.</p>
</div>
<div id="differences-in-rate-of-change" class="section level3">
<h3>Differences in rate of change</h3>
<p>How does the rate of change in BMI differ between groups? Which group might especially need attention?</p>
<p>First let’s calculate the differences in BMI from 2017 and 1985 and add this to our BMI_long data object:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1">BMI_numeric[[<span class="st">&quot;Rural_difference&quot;</span>]] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb240-2" data-line-number="2"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;Rural_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;Rural_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb240-3" data-line-number="3"></a>
<a class="sourceLine" id="cb240-4" data-line-number="4">BMI_numeric[[<span class="st">&quot;Urban_difference&quot;</span>]] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb240-5" data-line-number="5"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;Urban_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;Urban_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb240-6" data-line-number="6"></a>
<a class="sourceLine" id="cb240-7" data-line-number="7">BMI_numeric<span class="op">$</span>National_difference &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb240-8" data-line-number="8"><span class="st">     </span>BMI_numeric[[<span class="st">&quot;National_BMI_2017&quot;</span>]] <span class="op">-</span><span class="st"> </span>BMI_numeric[[<span class="st">&quot;National_BMI_1985&quot;</span>]]</a>
<a class="sourceLine" id="cb240-9" data-line-number="9"></a>
<a class="sourceLine" id="cb240-10" data-line-number="10">BMI_diff_long &lt;-<span class="st"> </span>BMI_numeric <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-11" data-line-number="11"><span class="st">  </span><span class="kw">select</span>(Country<span class="op">:</span><span class="st"> </span>National_difference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb240-12" data-line-number="12"><span class="kw">gather</span>(<span class="dt">key =</span> Type, <span class="dt">value =</span> Difference , Rural_difference<span class="op">:</span>National_difference)</a>
<a class="sourceLine" id="cb240-13" data-line-number="13"></a>
<a class="sourceLine" id="cb240-14" data-line-number="14"><span class="kw">head</span>(BMI_diff_long)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Type             Difference
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;
1 Afghanistan Men   Rural_difference     2.8   
2 Afghanistan Women Rural_difference     3.5   
3 Albania     Men   Rural_difference     1.90  
4 Albania     Women Rural_difference     0.1000
5 Algeria     Men   Rural_difference     3     
6 Algeria     Women Rural_difference     3.70  </code></pre>
<p>Let’s replace “United states of America” with “USA” and make a plot with this data to compare the change in BMI:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" data-line-number="1">BMI_diff_long[[<span class="st">&quot;Country&quot;</span>]] &lt;-BMI_diff_long[[<span class="st">&quot;Country&quot;</span>]] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb242-2" data-line-number="2"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;United States of America&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;USA&quot;</span>)</a>
<a class="sourceLine" id="cb242-3" data-line-number="3"></a>
<a class="sourceLine" id="cb242-4" data-line-number="4"></a>
<a class="sourceLine" id="cb242-5" data-line-number="5"><span class="kw">ggplot</span>(BMI_diff_long, <span class="kw">aes</span>(<span class="dt">x =</span> Type, <span class="dt">y =</span> Difference, <span class="dt">col =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long), </a>
<a class="sourceLine" id="cb242-9" data-line-number="9">              <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb242-10" data-line-number="10">              <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-11" data-line-number="11"><span class="st">  </span><span class="co"># This will add the individual country data points</span></a>
<a class="sourceLine" id="cb242-12" data-line-number="12"><span class="st">  </span><span class="co"># The shape 21 allows for a different fill and outline color</span></a>
<a class="sourceLine" id="cb242-13" data-line-number="13"><span class="st">  </span><span class="co"># The width determines how wide the jitter points are plotted</span></a>
<a class="sourceLine" id="cb242-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb242-15" data-line-number="15">              <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb242-16" data-line-number="16">              <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-17" data-line-number="17"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb242-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long,  Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>), </a>
<a class="sourceLine" id="cb242-19" data-line-number="19">            <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference,<span class="dt">label=</span>Country), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb242-20" data-line-number="20"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb242-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb242-22" data-line-number="22">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb242-23" data-line-number="23">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb242-24" data-line-number="24">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb242-25" data-line-number="25">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb242-26" data-line-number="26">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb242-27" data-line-number="27">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb242-28" data-line-number="28">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb242-29" data-line-number="29"><span class="st">        </span><span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb242-30" data-line-number="30"><span class="st">        </span><span class="kw">ggtitle</span>( <span class="st">&quot;Change in BMI Over Time and Across Region Type and Gender&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-116-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" data-line-number="1">        <span class="co"># Add a plot title  </span></a></code></pre></div>
<p>We can now see that the rate of change from 1985 to 2017 appears to be larger in the women compared to the men in all regions. The group with the largest increase in the USA is the women living in rural areas.</p>
<p>Let’s check the difference with some statistical tests:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" data-line-number="1"><span class="co">#first lets look at the normality of the difference in BMI</span></a>
<a class="sourceLine" id="cb244-2" data-line-number="2">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb244-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb244-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb244-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Type)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-117-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" data-line-number="1"><span class="co"># interesting...the spread of difference is much broader for women than for men </span></a>
<a class="sourceLine" id="cb245-2" data-line-number="2"><span class="co"># some women in some countries especially need help with obesity</span></a>
<a class="sourceLine" id="cb245-3" data-line-number="3"><span class="co"># while other countries are actually showing a loss of BMI</span></a>
<a class="sourceLine" id="cb245-4" data-line-number="4"><span class="co"># these countries are the points on our previous plot with a difference below 0</span></a>
<a class="sourceLine" id="cb245-5" data-line-number="5"></a>
<a class="sourceLine" id="cb245-6" data-line-number="6"><span class="co">#Let&#39;s see who:</span></a>
<a class="sourceLine" id="cb245-7" data-line-number="7">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb245-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(Difference)</a></code></pre></div>
<pre><code># A tibble: 1,200 x 4
   Country        Sex   Type                Difference
   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
 1 Greece         Women Rural_difference        -1.5  
 2 Greece         Women National_difference     -1.3  
 3 Greece         Women Urban_difference        -1.20 
 4 Italy          Women Rural_difference        -1.10 
 5 Czech Republic Women Rural_difference        -0.8  
 6 Spain          Women Rural_difference        -0.800
 7 Lithuania      Women Urban_difference        -0.700
 8 Spain          Women Urban_difference        -0.700
 9 Lithuania      Women National_difference     -0.700
10 Spain          Women National_difference     -0.700
# … with 1,190 more rows</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" data-line-number="1"><span class="co"># In general, people appear to have lost weight in Greece</span></a>
<a class="sourceLine" id="cb247-2" data-line-number="2"></a>
<a class="sourceLine" id="cb247-3" data-line-number="3"><span class="co"># Let&#39;s look at Q-Q plots:</span></a>
<a class="sourceLine" id="cb247-4" data-line-number="4">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb247-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span>Difference)) <span class="op">+</span></a>
<a class="sourceLine" id="cb247-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="co"># to add the line we need to also include stat_qq_line()</span></a>
<a class="sourceLine" id="cb247-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_qq_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb247-8" data-line-number="8"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Type)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-117-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1"><span class="co"># ok so some of the data for Men looks fairly normal but not as much for Women</span></a>
<a class="sourceLine" id="cb248-2" data-line-number="2"></a>
<a class="sourceLine" id="cb248-3" data-line-number="3"><span class="co"># Now we will check the variance</span></a>
<a class="sourceLine" id="cb248-4" data-line-number="4"></a>
<a class="sourceLine" id="cb248-5" data-line-number="5"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb248-6" data-line-number="6">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb248-7" data-line-number="7">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb248-8" data-line-number="8">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb248-9" data-line-number="9">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb248-10" data-line-number="10">                      Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
Z = 3.5379, p-value = 0.0004033
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" data-line-number="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb250-2" data-line-number="2"></a>
<a class="sourceLine" id="cb250-3" data-line-number="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb250-4" data-line-number="4">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb250-5" data-line-number="5">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb250-6" data-line-number="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb250-7" data-line-number="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb250-8" data-line-number="8">                      Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
Z = 0.59121, p-value = 0.5544
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1"><span class="co">#fail to reject the null the null - conclude that variance is equal</span></a>
<a class="sourceLine" id="cb252-2" data-line-number="2"></a>
<a class="sourceLine" id="cb252-3" data-line-number="3"><span class="kw">mood.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb252-4" data-line-number="4">                      Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>, </a>
<a class="sourceLine" id="cb252-5" data-line-number="5">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb252-6" data-line-number="6">          <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb252-7" data-line-number="7">                      Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb252-8" data-line-number="8">                      Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference))</a></code></pre></div>
<pre><code>
    Mood two-sample test of scale

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),     Difference) and     Difference)
Z = 10.843, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" data-line-number="1"><span class="co">#reject the null - conclude that variance is not equal</span></a>
<a class="sourceLine" id="cb254-2" data-line-number="2"></a>
<a class="sourceLine" id="cb254-3" data-line-number="3"></a>
<a class="sourceLine" id="cb254-4" data-line-number="4"><span class="co"># let&#39;s compare the groups</span></a>
<a class="sourceLine" id="cb254-5" data-line-number="5"><span class="co"># this is again still paired data</span></a>
<a class="sourceLine" id="cb254-6" data-line-number="6"><span class="co"># this is because each value of &quot;Rural_difference&quot; and &quot;Urban_difference&quot; correspond to the same country</span></a>
<a class="sourceLine" id="cb254-7" data-line-number="7"></a>
<a class="sourceLine" id="cb254-8" data-line-number="8"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb254-9" data-line-number="9">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb254-10" data-line-number="10">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb254-11" data-line-number="11">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb254-12" data-line-number="12">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb254-13" data-line-number="13">                    Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb254-14" data-line-number="14">        <span class="dt">paired =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
D = 0.16534, p-value = 0.009043
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb256-2" data-line-number="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>,</a>
<a class="sourceLine" id="cb256-3" data-line-number="3">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb256-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb256-5" data-line-number="5">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb256-6" data-line-number="6">                    Type <span class="op">==</span><span class="st"> &quot;Urban_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb256-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Urban_difference&quot;),     Difference) and     Difference)
D = 0.14586, p-value = 0.02995
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="kw">ks.test</span>(<span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long,</a>
<a class="sourceLine" id="cb258-2" data-line-number="2">                    Sex <span class="op">==</span><span class="st"> &quot;Men&quot;</span>, </a>
<a class="sourceLine" id="cb258-3" data-line-number="3">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference), </a>
<a class="sourceLine" id="cb258-4" data-line-number="4">        <span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, </a>
<a class="sourceLine" id="cb258-5" data-line-number="5">                    Sex <span class="op">==</span><span class="st"> &quot;Women&quot;</span>,  </a>
<a class="sourceLine" id="cb258-6" data-line-number="6">                    Type <span class="op">==</span><span class="st"> &quot;Rural_difference&quot;</span>), Difference),</a>
<a class="sourceLine" id="cb258-7" data-line-number="7">        <span class="dt">paired =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  pull(filter(BMI_diff_long, Sex == &quot;Men&quot;, Type == &quot;Rural_difference&quot;),  and pull(filter(BMI_diff_long, Sex == &quot;Women&quot;, Type == &quot;Rural_difference&quot;),     Difference) and     Difference)
D = 0.35204, p-value = 5.645e-11
alternative hypothesis: two-sided</code></pre>
<p>Now we have performed seven comparisons (4 earlier) so we should apply our multiple testing correction</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1"><span class="fl">.05</span><span class="op">/</span><span class="dv">7</span></a></code></pre></div>
<pre><code>[1] 0.007142857</code></pre>
<p>We see that there is a significant difference in the change in BMI Rural communities between men and women. This change is larger for women.</p>
<p>Importantly- we noticed that it appears to be specific countries where BMI shows a particular increase especially for women. Which countries are those? how does that compare with the US? Clearly the US is among the countries with the highest differences.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" data-line-number="1">BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb262-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Type                Difference
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 USA     Men   Rural_difference          3.10
2 USA     Women Rural_difference          3.5 
3 USA     Men   Urban_difference          3.1 
4 USA     Women Urban_difference          3.40
5 USA     Men   National_difference       3.10
6 USA     Women National_difference       3.4 </code></pre>
<p>In the US, focus should be placed on <b> both urban and rural </b> women to improve this public health issue.</p>
<p>Here we can see the countries have the largest differences in BMI from 1985-2017:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1">BMI_diff_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb264-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Difference<span class="op">&gt;</span><span class="fl">4.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb264-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>Difference)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country     Sex   Type                Difference
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Egypt       Women Rural_difference          5.9 
2 Honduras    Women National_difference       5.60
3 Honduras    Women Rural_difference          5.5 
4 Egypt       Women National_difference       5.10
5 Saint Lucia Women Rural_difference          5   
6 Honduras    Women Urban_difference          4.9 </code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1"><span class="co">#here we sorted by the highest to lowest values of BMI Difference</span></a></code></pre></div>
<p>However it is important to see what the mean BMI values are were for these countries in 2017. It could be that the average was underweight in 1985… let’s take a look.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1">BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb267-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, Difference<span class="op">&gt;</span><span class="fl">4.9</span>), Country), </a>
<a class="sourceLine" id="cb267-3" data-line-number="3">                    Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">pull</span>(<span class="kw">filter</span>(BMI_diff_long, Difference<span class="op">&gt;</span><span class="fl">4.9</span>), Sex),</a>
<a class="sourceLine" id="cb267-4" data-line-number="4">                    Year <span class="op">==</span><span class="st">&quot;2017&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb267-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>BMI)</a></code></pre></div>
<pre><code># A tibble: 9 x 5
  Country     Sex   Region   Year    BMI
  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
1 Egypt       Women Urban    2017   32.3
2 Egypt       Women National 2017   31.7
3 Egypt       Women Rural    2017   31.3
4 Saint Lucia Women National 2017   30.5
5 Saint Lucia Women Rural    2017   30.5
6 Saint Lucia Women Urban    2017   30.5
7 Honduras    Women Urban    2017   28.3
8 Honduras    Women National 2017   27.7
9 Honduras    Women Rural    2017   26.9</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" data-line-number="1"><span class="co">#Here is the data just for the changes in BMI in Egypt</span></a>
<a class="sourceLine" id="cb269-2" data-line-number="2"><span class="kw">filter</span>(BMI_diff_long, Country <span class="op">==</span><span class="st"> &quot;Egypt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb269-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>Difference)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Country Sex   Type                Difference
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Egypt   Women Rural_difference          5.9 
2 Egypt   Women National_difference       5.10
3 Egypt   Women Urban_difference          4.20
4 Egypt   Men   Urban_difference          2.60
5 Egypt   Men   Rural_difference          2.5 
6 Egypt   Men   National_difference       2.5 </code></pre>
<p>Thus rural women in Egypt had the greatest increase in BMI from 1985 to 2017 in this data (5.9) and the average BMI is now over the obesity threshold of 30.</p>
<p>The data suggests that rural women in Egypt and other countries may especially benefit from dietary resources and our interventions and programs to assist with weight management.</p>
<p>Now let’s make a plot that summarizes our findings. To do this we will simplify the other plots we made and then combine them together.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1"><span class="co"># simplified national means plot</span></a>
<a class="sourceLine" id="cb271-2" data-line-number="2">Means_plot&lt;-BMI_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-4" data-line-number="4">         Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb271-5" data-line-number="5">         Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sex, <span class="dt">y =</span> BMI)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-8" data-line-number="8"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-9" data-line-number="9"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Year) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">30</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-12" data-line-number="12"><span class="st">                </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-13" data-line-number="13">                       Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb271-14" data-line-number="14">                       Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>),</a>
<a class="sourceLine" id="cb271-15" data-line-number="15">                <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb271-16" data-line-number="16">                <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb271-17" data-line-number="17">                <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-19" data-line-number="19"><span class="st">                            </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-20" data-line-number="20">                                   Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb271-21" data-line-number="21">                                   Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb271-22" data-line-number="22">                                   Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb271-23" data-line-number="23">                             <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI), </a>
<a class="sourceLine" id="cb271-24" data-line-number="24">                             <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb271-25" data-line-number="25">                             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-26" data-line-number="26"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb271-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_long<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-28" data-line-number="28"><span class="st">                          </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-29" data-line-number="29">                                 Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1985&quot;</span>, <span class="st">&quot;2017&quot;</span>), </a>
<a class="sourceLine" id="cb271-30" data-line-number="30">                                 Region <span class="op">==</span><span class="st"> &quot;National&quot;</span>, Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)),</a>
<a class="sourceLine" id="cb271-31" data-line-number="31">                          <span class="kw">aes</span>(<span class="dt">x =</span>Sex, <span class="dt">y =</span>BMI,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb271-32" data-line-number="32">                          <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-33" data-line-number="33"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb271-34" data-line-number="34"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb271-35" data-line-number="35"><span class="st">  </span><span class="co"># This will make thebackground of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb271-36" data-line-number="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb271-37" data-line-number="37">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb271-38" data-line-number="38">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb271-39" data-line-number="39">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb271-40" data-line-number="40">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb271-41" data-line-number="41">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb271-42" data-line-number="42">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb271-43" data-line-number="43">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb271-44" data-line-number="44">   </a>
<a class="sourceLine" id="cb271-45" data-line-number="45"><span class="co">#Simplified difference plot </span></a>
<a class="sourceLine" id="cb271-46" data-line-number="46">BMI_diff_long<span class="op">$</span>Type &lt;-BMI_diff_long<span class="op">$</span>Type <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-47" data-line-number="47"><span class="st">  </span><span class="kw">str_replace</span>( <span class="dt">pattern =</span> <span class="st">&quot;_difference&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb271-48" data-line-number="48"></a>
<a class="sourceLine" id="cb271-49" data-line-number="49">Diff_plot&lt;-BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-50" data-line-number="50"><span class="st">  </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-51" data-line-number="51">         Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb271-52" data-line-number="52"><span class="kw">ggplot</span>( <span class="kw">aes</span>(<span class="dt">x =</span> Type, <span class="dt">y =</span> Difference, <span class="dt">col =</span> Type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-53" data-line-number="53"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span> , <span class="kw">aes</span>(<span class="dt">fill =</span> Sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-54" data-line-number="54"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;orchid2&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-55" data-line-number="55"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-56" data-line-number="56"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span>BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-57" data-line-number="57"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-58" data-line-number="58">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb271-59" data-line-number="59">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb271-60" data-line-number="60">    <span class="dt">width =</span> <span class="fl">.2</span>, <span class="dt">size =</span><span class="dv">2</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb271-61" data-line-number="61">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-62" data-line-number="62"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-63" data-line-number="63"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>), </a>
<a class="sourceLine" id="cb271-64" data-line-number="64">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>, </a>
<a class="sourceLine" id="cb271-65" data-line-number="65">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>)), </a>
<a class="sourceLine" id="cb271-66" data-line-number="66">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference), </a>
<a class="sourceLine" id="cb271-67" data-line-number="67">    <span class="dt">width =</span> <span class="fl">.02</span>, <span class="dt">size =</span><span class="dv">12</span>, <span class="dt">shape =</span><span class="dv">21</span>, </a>
<a class="sourceLine" id="cb271-68" data-line-number="68">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-69" data-line-number="69"><span class="st">  </span><span class="co"># This will add points that are larger for the USA data</span></a>
<a class="sourceLine" id="cb271-70" data-line-number="70"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data=</span><span class="kw">subset</span>(BMI_diff_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-71" data-line-number="71"><span class="st">    </span><span class="kw">filter</span>(Sex <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>, <span class="st">&quot;Women&quot;</span>),</a>
<a class="sourceLine" id="cb271-72" data-line-number="72">           Type <span class="op">!=</span><span class="st"> &quot;National&quot;</span>), </a>
<a class="sourceLine" id="cb271-73" data-line-number="73">           Country <span class="op">==</span><span class="st"> &quot;USA&quot;</span>),</a>
<a class="sourceLine" id="cb271-74" data-line-number="74">    <span class="kw">aes</span>(<span class="dt">x =</span>Type, <span class="dt">y =</span>Difference,<span class="dt">label=</span>Country), </a>
<a class="sourceLine" id="cb271-75" data-line-number="75">    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-76" data-line-number="76"><span class="st">  </span><span class="co"># This will add USA labels to the USA points</span></a>
<a class="sourceLine" id="cb271-77" data-line-number="77"><span class="st">  </span><span class="kw">theme_linedraw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb271-78" data-line-number="78"><span class="st">    </span><span class="co"># This will make the background of the plot white and the facet labels black</span></a>
<a class="sourceLine" id="cb271-79" data-line-number="79"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb271-80" data-line-number="80">  <span class="co"># This is useful for removing the legend</span></a>
<a class="sourceLine" id="cb271-81" data-line-number="81">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>,<span class="dt">angle =</span> <span class="dv">30</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>), </a>
<a class="sourceLine" id="cb271-82" data-line-number="82">        <span class="co"># this changes the size and angle of the x axis point labels </span></a>
<a class="sourceLine" id="cb271-83" data-line-number="83">        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb271-84" data-line-number="84">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb271-85" data-line-number="85">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">15</span>), </a>
<a class="sourceLine" id="cb271-86" data-line-number="86">        <span class="dt">strip.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>))</a>
<a class="sourceLine" id="cb271-87" data-line-number="87">  <span class="co"># this changes the size of x axis labels for the facet</span></a>
<a class="sourceLine" id="cb271-88" data-line-number="88"></a>
<a class="sourceLine" id="cb271-89" data-line-number="89"><span class="co">#add labels</span></a>
<a class="sourceLine" id="cb271-90" data-line-number="90">Diff_plot&lt;-Diff_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-91" data-line-number="91"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Change in BMI by region&quot;</span>, </a>
<a class="sourceLine" id="cb271-92" data-line-number="92">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb271-93" data-line-number="93">             <span class="dt">y =</span> <span class="st">&quot;Change in BMI </span><span class="ch">\n</span><span class="st"> (1985 to 2017)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-94" data-line-number="94"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb271-95" data-line-number="95"></a>
<a class="sourceLine" id="cb271-96" data-line-number="96">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-97" data-line-number="97"><span class="st">        </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mean BMI over time&quot;</span>, </a>
<a class="sourceLine" id="cb271-98" data-line-number="98">             <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb271-99" data-line-number="99">             <span class="dt">y =</span> <span class="st">&quot;Mean BMI&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-100" data-line-number="100"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span> (<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb271-101" data-line-number="101"></a>
<a class="sourceLine" id="cb271-102" data-line-number="102"></a>
<a class="sourceLine" id="cb271-103" data-line-number="103"></a>
<a class="sourceLine" id="cb271-104" data-line-number="104">obesity_text&lt;-<span class="kw">tibble</span>(<span class="dt">Year=</span><span class="kw">c</span>(<span class="dv">1985</span>),<span class="dt">BMI=</span><span class="kw">c</span>(<span class="dv">31</span>),<span class="dt">Sex=</span><span class="kw">c</span>(<span class="st">&quot;Men&quot;</span>),<span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;Obesity&quot;</span>))</a>
<a class="sourceLine" id="cb271-105" data-line-number="105"></a>
<a class="sourceLine" id="cb271-106" data-line-number="106">Means_plot &lt;-Means_plot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb271-107" data-line-number="107"><span class="st">             </span><span class="kw">geom_text</span>(<span class="dt">data =</span> obesity_text,</a>
<a class="sourceLine" id="cb271-108" data-line-number="108">                       <span class="dt">label=</span><span class="kw">pull</span>(obesity_text,label), </a>
<a class="sourceLine" id="cb271-109" data-line-number="109">                       <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, </a>
<a class="sourceLine" id="cb271-110" data-line-number="110">                       <span class="kw">aes</span>( <span class="dt">fontface =</span><span class="st">&quot;bold.italic&quot;</span>, <span class="dt">size =</span> <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb271-111" data-line-number="111"></a>
<a class="sourceLine" id="cb271-112" data-line-number="112">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(Means_plot, Diff_plot, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-122-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We could make a similar plot with the <code>patchwork</code> package:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">Means_plot <span class="op">+</span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;A&#39;</span>) <span class="op">+</span><span class="st"> </span>Diff_plot<span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;B&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb272-2" data-line-number="2"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&#39;collect&#39;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-123-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Great, now we have put two plots together using the <code>plot_grid()</code> function of the <code>cowplot</code> package. This way we can clearly communicate two messages. The first being that BMI has increased over time globally and that many countries including the United States of America are approaching a mean BMI that is above the obesity threshold of 30. We can also see that women on average have larger BMI values than males, but that both genders show increased levels over time. In the second plot we can see that the increase in BMI is not just happening in urban communities, but in both rural and urban communities and particularly in women.</p>
<p>Our plot visually explores all of our main questions: 1) Is there a difference between rural and urban BMI estimates around the world? In particular, how does this look for females? 2) How have BMI estimates changed from 1985 to 2017? Again, In particular, how does this look for females? 3) How do different countries compare for BMI estimates? In particular, how does the United States compare to the rest of the world?</p>
<p>Now let’s save our plotas a png using the <code>png()</code> function:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="kw">png</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;img&quot;</span>, <span class="st">&quot;main_plot.png&quot;</span>), <span class="dt">height =</span> <span class="dv">1500</span>, <span class="dt">width =</span> <span class="dv">2000</span>, <span class="dt">res =</span> <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb273-2" data-line-number="2">Means_plot <span class="op">+</span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;A&#39;</span>) <span class="op">+</span><span class="st"> </span>Diff_plot<span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">tag =</span> <span class="st">&#39;B&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb273-3" data-line-number="3"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&#39;collect&#39;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb273-4" data-line-number="4"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>quartz_off_screen 
                2 </code></pre>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have evaluated BMI average estimates from 200 different countries around the world. To do so we imported data from a pdf using the <code>pdftools</code> package. We used <code>tidyverse</code> packages such as <code>dplyr</code>, <code>stringr</code>, and <code>tidy</code> to clean the data and get it in a workable format. Our statistical analysis focused on evaluating differences in BMI in females around the world across time and between rural and urban areas. We found a significant difference both between years and between the type of community among women globally using <a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test" target="_blank"><span class="math inline">\(t\)</span>-tests</a> and <a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960" target="_blank">nonparametric</a> tests. Thus BMI has increased in women since 1985. Although BMI estimates are significantly higher in Urban areas compared to rural areas, BMI estimates have increased in both regions. We learned that there are assumptions and considerations to keep in mind when performing tests that compare two groups.</p>
<p><u> We learned that the <span class="math inline">\(t\)</span>-test relies on:</u></p>
<ol style="list-style-type: decimal">
<li>normality of the data for both groups (this is not as much of an issue if the number of observations is relatively large total n&gt;30)</li>
<li>equal variance between the two groups (make sure you do the correct test if the data is not normal)</li>
<li>balanced sample sizes of the two groups</li>
<li>independent observations (or independent paired observations)</li>
</ol>
<p>We learned that we can evaluate if our data is <a href="https://www.physiology.org/doi/full/10.1152/advan.00064.2017" target="_blank">normally distributed</a> by plotting the distribution and by creating Q-Q plots.</p>
<p><u>We learned that if our data is not normally distributed, we can consider these options:</u></p>
<ol style="list-style-type: decimal">
<li>We can still perform a <span class="math inline">\(t\)</span>-test if our n is large</li>
<li>We can transform the data before performing a <span class="math inline">\(t\)</span>-test</li>
<li>We can use a nonparametric test (Wilcoxon signed rank test, the Wilcoxon rank sum test, and the Two-sample Kolmogorov-Smirnov (KS) test)</li>
<li>We can perform a <span class="math inline">\(t\)</span>-test with resampling methods (which should be especially considered when the groups are imbalanced)</li>
</ol>
<p>We learned that if our groups do not have equal variance, that we need to use a modified <span class="math inline">\(t\)</span>-test to account for this or the correct nonparametric test that does not rely on this assumption (Two-sample Kolmogorov-Smirnov test).</p>
<p>We also learned that if our groups are not well balanced, that we can consider resampling methods.</p>
<p>Finally its also important to remember that when we have <a href="https://www.statisticshowto.datasciencecentral.com/paired-data/" target="_blank">paired data</a> and intend to compare means, we should perform a paired test (<a href="https://stattrek.com/hypothesis-test/paired-means.aspx#example1" target="_blank">paired <span class="math inline">\(t\)</span>-test</a>, Wilcoxon signed rank test, or paired KS test). Our data used in this case study was paired because observations were taken for the same countries for different categories of populations - thus, we wanted to compare these populations within the same country (male vs female, rural vs urban etc.). Other examples would be in a case-control study (if samples are matched for various demographics) or a study with repeated measures (for example, symptom measures from the same individual before and after a treatment).</p>
<p>Using the <code>ggplot2</code> package we were able to visualize trends in the data. Importantly, the largest increase appears to be in the rural areas particularly for women. We were also able to identify how the US compared to other countries and which countries showed the largest increase in BMI over time. Analyses like this are important for defining which groups could benefit the most from interventions, education, and policy changes when attempting to mitigate public health challenges. You can see in the <a href="https://www.nature.com/articles/s41586-019-1171-x.pdf" target="_blank">article</a> that this data came from that many additional considerations would be involved to perform such an analysis.</p>
<div id="suggested-homework" class="section level3">
<h3>Suggested Homework</h3>
<p>Students can evaluate the change in BMI over time using the global data available for each year between 2015 and 2017. The data can be found <a href="http://www.ncdrisc.org/downloads/bmi/NCD_RisC_Lancet_2017_BMI_age_standardised_world.csv" target="_blank">here</a>.</p>
</div>
<div id="helpful-links" class="section level3">
<h3>Helpful Links</h3>
<p><a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html" target="_blank">BMI</a><br />
<a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">Long and Wide Data Formats</a><br />
<a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Distributions</a> <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Normal Distribution</a> <a href="http://onlinestatbook.com/2/glossary/skew.html" target="_blank">Skewed Distributions</a> <a href="http://onlinestatbook.com/2/introduction/distributions.html" target="_blank">Bimodal Distribution</a> <a href="https://opencasestudies.github.io/ocs-healthexpenditure/ocs-healthexpenditure.html" target="_blank">ggplot2</a><br />
<a href="http://onlinestatbook.com/2/advanced_graphs/q-q_plots.html" target="_blank">Q-Q Plots</a><br />
<a href="http://www.statistics4u.info/fundstat_eng/ee_shapiro_wilk_test.html">Shapiro-Wilk Test</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=two-sample%20t-test">Student <span class="math inline">\(t\)</span>-test</a><br />
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5579465/" target="_blank">Paired Data</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/welchs-test-for-unequal-variances/" target="_blank">Welch’s <span class="math inline">\(t\)</span>-test</a><br />
<a href="https://www.mayo.edu/research/documents/parametric-and-nonparametric-demystifying-the-terms/doc-20408960">Parametric and Nonparametric Methods</a><br />
<a href="https://stattrek.com/statistics/dictionary.aspx?definition=variance" target="_blank">Variance</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/balanced-and-unbalanced-designs/" target="_blank">Balanced Study Design</a><br />
<a href="https://www.stat.cmu.edu/~cshalizi/36-220/lecture-5.pdf" target="_blank">Independent Observations</a><br />
<a href="https://www.statisticshowto.datasciencecentral.com/transformation-statistics/" target="_blank">Transformation</a><br />
<a href="https://jhu-advdatasci.github.io/2019/lectures/21-resampling-techniques.html" target="_blank">Permutation/Resampling Methods</a><br />
<a href="https://www.analyticsvidhya.com/blog/2019/05/statistics-101-introduction-central-limit-theorem/" target="_blank">Central Limit Theorem</a><br />
<a href="https://files.eric.ed.gov/fulltext/ED065559.pdf" target="_blank">Mood’s Two-Sample Scale Test</a><br />
<a href="http://www.biostathandbook.com/wilcoxonsignedrank.html">Wilcoxon Signed Rank Test</a><br />
<a href="http://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_nonparametric/BS704_Nonparametric4.html" target="_blank">Wilcoxon Rank Sum Test</a><br />
<a href="https://www.itl.nist.gov/div898/software/dataplot/refman1/auxillar/ks2samp.htm" target="_blank">Two-sample Kolmogorov-Smirnov Test</a><br />
<a href="https://web.ma.utexas.edu/users/mks/statmistakes/errortypes.html" target="_blank">Type 1 Error</a><br />
<a href="https://towardsdatascience.com/p-values-explained-by-data-scientist-f40a746cfc8" target="_blank">p-value</a><br />
<a href="https://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture10.pdf" target="_blank">Multiple Testing</a><br />
<a href="http://mathworld.wolfram.com/BonferroniCorrection.html" target="_blank">Bonferroni Method of Multiple Testing Correction</a></p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiT3BlbiBDYXNlIFN0dWRpZXM6IEV4cGxvcmluZyBnbG9iYWwgcGF0dGVybnMgb2Ygb2Jlc2l0eSBhY3Jvc3MgcnVyYWwgYW5kIHVyYmFuIHJlZ2lvbnMiCmNzczogc3R5bGUuY3NzCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgc2VsZl9jb250YWluZWQ6IHllcwogICAgY29kZV9kb3dubG9hZDogeWVzCiAgICBoaWdobGlnaHQ6IHRhbmdvCiAgICBudW1iZXJfc2VjdGlvbnM6IG5vCiAgICB0aGVtZTogY29zbW8KICAgIHRvYzogeWVzCiAgICB0b2NfZmxvYXQ6IHllcwogIHBkZl9kb2N1bWVudDoKICAgIHRvYzogeWVzCiAgd29yZF9kb2N1bWVudDoKICAgIHRvYzogeWVzCi0tLQoKPHN0eWxlPgojVE9DIHsKICBiYWNrZ3JvdW5kOiB1cmwoImh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9pbWcvbG9nby5qcGciKTsKICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47CiAgcGFkZGluZy10b3A6IDI0MHB4ICFpbXBvcnRhbnQ7CiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKfQo8L3N0eWxlPgoKYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9CmtuaXRyOjpvcHRzX2NodW5rJHNldChpbmNsdWRlID0gVFJVRSwgY29tbWVudCA9IE5BLCBlY2hvID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgd2FybmluZyA9IEZBTFNFLCBjYWNoZSA9IEZBTFNFLAogICAgICAgICAgICAgICAgICAgICAgZmlnLmFsaWduID0gImNlbnRlciIsIG91dC53aWR0aCA9ICc5MCUnKQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkoa25pdHIpCmBgYAoKIAojIyMjIHsub3V0bGluZSB9CmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsICJtYWluX3Bsb3QucG5nIikpCmBgYAoKIyMgey5kaXNjbGFpbWVyX2Jsb2NrfQoKKipEaXNjbGFpbWVyKio6IFRoZSBwdXJwb3NlIG9mIHRoZSBbT3BlbiBDYXNlIFN0dWRpZXNdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pbyl7dGFyZ2V0PSJfYmxhbmsifSBwcm9qZWN0IGlzICoqdG8gZGVtb25zdHJhdGUgdGhlIHVzZSBvZiB2YXJpb3VzIGRhdGEgc2NpZW5jZSBtZXRob2RzLCB0b29scywgYW5kIHNvZnR3YXJlIGluIHRoZSBjb250ZXh0IG9mIG1lc3N5LCByZWFsLXdvcmxkIGRhdGEqKi4gQSBnaXZlbiBjYXNlIHN0dWR5IGRvZXMgbm90IGNvdmVyIGFsbCBhc3BlY3RzIG9mIHRoZSByZXNlYXJjaCBwcm9jZXNzLCBpcyBub3QgY2xhaW1pbmcgdG8gYmUgdGhlIG1vc3QgYXBwcm9wcmlhdGUgd2F5IHRvIGFuYWx5emUgYSBnaXZlbiBkYXRhc2V0LCBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGluIHRoZSBjb250ZXh0IG9mIG1ha2luZyBwb2xpY3kgZGVjaXNpb25zIHdpdGhvdXQgZXh0ZXJuYWwgY29uc3VsdGF0aW9uIGZyb20gc2NpZW50aWZpYyBleHBlcnRzLiAKCiMjIE1vdGl2YXRpb24KCkJvZHkgbWFzcyBpbmRleCAoW0JNSV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9oZWFsdGh5d2VpZ2h0L2Fzc2Vzc2luZy9ibWkvYWR1bHRfYm1pL2luZGV4Lmh0bWwpKXt0YXJnZXQ9Il9ibGFuayJ9IGlzIG9mdGVuIHVzZWQgYXMgYSBwcm94eSBmb3IgKiphZGlwb3NpdHkqKiAodGhlIGNvbmRpdGlvbiBvZiBoYXZpbmcgZXhjZXNzIGJvZHkgZmF0KSBhbmQgaXMgbWVhc3VyZWQgYXMgYW4gaW5kaXZpZHVhbCdzIHdlaWdodCBpbiBraWxvZ3JhbXMgKGtnKSBvciBwb3VuZHMgKGxicykgZGl2aWRlZCBieSB0aGUgaW5kaXZpZHVhbCdzIGhlaWdodCBpbiBtZXRlcnMgKCRtXjIkKSBzcXVhcmVkLgoKVGhlcmUgYXJlIGRpZmZlcmVudCBjYXRlZ29yaWVzIG9mIHdlaWdodCBkZWZpbmVkIHVzaW5nIGRpZmZlcmVudCBCTUkgdGhyZXNob2xkcyBhcyBkZWZpbmVkIGJ5IHRoZSBbV29ybGQgSGVhbHRoIE9yZ2FuaXphdGlvbl0oaHR0cDovL3d3dy5ldXJvLndoby5pbnQvZW4vaGVhbHRoLXRvcGljcy9kaXNlYXNlLXByZXZlbnRpb24vbnV0cml0aW9uL2EtaGVhbHRoeS1saWZlc3R5bGUvYm9keS1tYXNzLWluZGV4LWJtaSl7dGFyZ2V0PSJfYmxhbmsifSAoV0hPKSwgdGhlIFtDZW50ZXJzIGZvciBEaXNlYXNlIENvbnRyb2wgYW5kIFByZXZlbnRpb25dKGh0dHBzOi8vd3d3LmNkYy5nb3Yvb2Jlc2l0eS9hZHVsdC9kZWZpbmluZy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LCBhbmQgdGhlIFtOYXRpb25hbCBJbnN0aXR1dGVzIG9mIEhlYWx0aF0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9LiAKRm9yIGV4YW1wbGUsIHRoZXNlIGFyZSB0aGUgY2F0ZWdvcmllcyBkZWZpbmVkIGJ5IHRoZSBXSE86IAoKYGBge3IsIGVjaG89RkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L2Jvb2tzL05CSzUzNTQ1Ni9iaW4vYm1pX1dITy5qcGciKQpgYGAKCiMjIyMjIyBbW3NvdXJjZV0oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9ib29rcy9OQks1MzU0NTYvYmluL2JtaV9XSE8uanBnKXt0YXJnZXQ9Il9ibGFuayJ9XQoKVGhlIGZvbGxvd2luZyBjaGFydCBjYW4gaGVscCB5b3UgaWRlbnRpZnkgeW91ciBlc3RpbWF0ZSBvZiBCTUk6CmBgYHtyLCBlY2hvPUZBTFNFfQprbml0cjo6aW5jbHVkZV9ncmFwaGljcygiaHR0cDovL2NvbnRlbnQuZXZlcnlkYXloZWFsdGguY29tL21heW9kaWV0L2ltYWdlcy9CTUktY2hhcnQuanBnIikKYGBgCgojIyMjIyMgW1tzb3VyY2VdKGh0dHA6Ly9kaWV0Lm1heW9jbGluaWMub3JnL2RpZXQvZWF0L3doYXQtaXMteW91ci1ibWk/eGlkPW5sX01heW9DbGluaWNEaWV0XzIwMTYwNDI2KXt0YXJnZXQ9Il9ibGFuayJ9XQoKUHJldmlvdXMgd29yayBoYXMgc2hvd24gaGlnaGVyIEJNSSAoPjMwKSBpcyBhc3NvY2lhdGVkIHdpdGggW2hpZ2hlciByYXRlcyBvZiBhbGwtY2F1c2VzIG9mIG1vcnRhbGl0eV0oaHR0cHM6Ly93d3cubmhsYmkubmloLmdvdi9zaXRlcy9kZWZhdWx0L2ZpbGVzL21lZGlhL2RvY3Mvb2Jlc2l0eS1ldmlkZW5jZS1yZXZpZXcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9LCBhcyB3ZWxsIGFzIGluY3JlYXNlZCByYXRlcyBvZiB0eXBlIDIgZGlhYmV0ZXMsIGNhbmNlciwgaGVhcnQgZGlzZWFzZSwgYW5kIHN0cm9rZS4gCgpSZWNlbnRseSwgYW4gW2FydGljbGVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg2LTAxOS0xMTcxLXgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHB1Ymxpc2hlZCBpbiBbKk5hdHVyZSpdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20pe3RhcmdldD0iX2JsYW5rIn0gZXZhbHVhdGVkIGFuZCBjb21wYXJlZCB0aGUgQm9keS1NYXNzIEluZGV4IChCTUkpIG9mIHBvcHVsYXRpb25zIGluIHJ1cmFsIGFuZCB1cmJhbiBjb21tdW5pdGllcyBhcm91bmQgdGhlIHdvcmxkOiAKCmBgYHtyLCAgZWNobz1GQUxTRSwgb3V0LndpZHRoPScxMDAlJ30Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwgInBhcGVyLnBuZyIpKQpgYGAKCiMjIyMgey5yZWZlcmVuY2VfYmxvY2t9Ck5DRCBSaXNrIEZhY3RvciBDb2xsYWJvcmF0aW9uIChOQ0QtUmlzQykuIFJpc2luZyBydXJhbCBib2R5LW1hc3MgaW5kZXggaXMgdGhlIG1haW4gZHJpdmVyIG9mIHRoZSBnbG9iYWwgb2Jlc2l0eSBlcGlkZW1pYyBpbiBhZHVsdHMuICpOYXR1cmUqICoqNTY5KiosIDI2MOKAkzI2NCAoMjAxOSkuIAoKIyMjIwoKVGhlIGFydGljbGUgY2hhbGxlbmdlZCB0aGUgd2lkZWx5LWhlbGQgdmlldyB0aGF0IGluY3JlYXNlZCB1cmJhbml6YXRpb24gd2FzIG9uZSBvZiB0aGUgbWFqb3IgcmVhc29ucyBmb3IgaW5jcmVhc2VkIGdsb2JhbCBvYmVzaXR5IHJhdGVzLiAKVGhpcyB2aWV3IGNhbWUgYWJvdXQgYmVjYXVzZSBtYW55IGNvdW50cmllcyBhcm91bmQgdGhlIHdvcmxkIGhhdmUgc2hvd24gaW5jcmVhc2VkIHVyYmFuaXphdGlvbiBsZXZlbHMgaW4gcGFyYWxsZWwgd2l0aCBpbmNyZWFzZWQgb2Jlc2l0eSByYXRlcy4gCkluIHRoaXMgYXJ0aWNsZSwgaG93ZXZlciwgdGhlIE5DRC1SaXNDIGFyZ3VlZCB0aGF0IHRoaXMgbWlnaHQgbm90IGJlIHRoZSBjYXNlIGFuZCB0aGF0IGluIGZhY3QgZm9yIG1vc3QgcmVnaW9ucyBhcm91bmQgdGhlIHdvcmxkLCBCTUkgbWVhc3VyZW1lbnRzIGFyZSBpbmNyZWFzaW5nIGluIHJ1cmFsIHBvcHVsYXRpb25zIGp1c3QgYXMgbXVjaCwgaWYgbm90IG1vcmUgc28sIHRoYW4gdXJiYW4gcG9wdWxhdGlvbnMuIApGdXJ0aGVybW9yZSwgdGhpcyBzdHVkeSBzdWdnZXN0ZWQgdGhhdCBvYmVzaXR5IGhhcyBwYXJ0aWN1bGFybHkgaW5jcmVhc2VkIGluIGZlbWFsZSBwb3B1bGF0aW9ucyBpbiBydXJhbCByZWdpb25zOiAKCj4gIldlIG5vdGVkIGEgcGVyc2lzdGVudGx5IGhpZ2hlciBydXJhbCBCTUksIGVzcGVjaWFsbHkgZm9yIHdvbWVuLiIKCkluIHRoaXMgY2FzZSBzdHVkeSwgd2Ugd2lsbCBldmFsdWF0ZSB0aGUgZGF0YSByZXBvcnRlZCBpbiB0aGlzIGFydGljbGUgdG8gZXhwbG9yZSByZWdpb25hbCBhbmQgZ2VuZGVyIHNwZWNpZmljIGRpZmZlcmVuY2VzIGluIHRoZSBvYmVzaXR5IHJhdGVzIGFyb3VuZCB0aGUgd29ybGQgaW4gMTk4NSBhbmQgMjAxNy4gCk1vc3QgaW1wb3J0YW50bHkgd2Ugd2lsbCB0ZXN0IGlmIHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBpbiBvYmVzaXR5IHJhdGVzIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIGNvbW11bml0aWVzIGFuZCBpZiB0aGVyZSBoYXMgYmVlbiBhIGNoYW5nZSBpbiBvYmVzaXR5IG92ZXIgdGltZSBmb3IgdGhlc2UgcmVnaW9ucywgcGFydGljdWxhcmx5IGZvciB3b21lbi4gClRvIGRvIHRoaXMgd2Ugd2lsbCB0ZXN0IGlmIHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBhdmVyYWdlIEJNSSBmb3IgZWFjaCBncm91cC4KCldoaWxlIFtnZW5kZXJdKGh0dHBzOi8vd3d3LmdlbmRlcnNwZWN0cnVtLm9yZy9xdWljay1saW5rcy91bmRlcnN0YW5kaW5nLWdlbmRlci8pe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtzZXhdKGh0dHBzOi8vd3d3Lndoby5pbnQvZ2Vub21pY3MvZ2VuZGVyL2VuL2luZGV4MS5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGFyZSBub3QgYWN0dWFsbHkgYmluYXJ5LCB0aGUgZGF0YSBwcmVzZW50ZWQgdGhhdCBpcyB1c2VkIGluIHRoaXMgYW5hbHlzaXMgb25seSBjb250YWluIGRhdGEgZm9yIGdyb3VwcyBvZiBpbmRpdmlkdWFscyBkZXNjcmliZWQgYXMgbWVuIG9yIHdvbWVuLiAKCiMjIyBNYWluIFF1ZXN0aW9ucwojIyMjIHsubWFpbl9xdWVzdGlvbl9ibG9ja30KCjxiPjx1PiBPdXIgbWFpbiBxdWVzdGlvbnMgYXJlOiA8L3U+PC9iPgoKMSkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8gSW4gcGFydGljdWxhciwgd2hhdCBkb2VzIHRoaXMgZGlmZmVyZW5jZSBsb29rIGxpa2UgZm9yIHdvbWVuPwoyKSBIb3cgaGF2ZSBCTUkgZXN0aW1hdGVzIGNoYW5nZWQgZnJvbSAxOTg1IHRvIDIwMTc/IEluIHBhcnRpY3VsYXIsIHdoYXQgZG9lcyB0aGlzIGNoYW5nZSBvdmVyIHRpbWUgbG9vayBsaWtlIGZvciB3b21lbj8KMykgSG93IGRvIGRpZmZlcmVudCBjb3VudHJpZXMgdmFyeSBpbiB0ZXJtcyBvZiBlc3RpbWF0ZXMgb2YgQk1JPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCiMjIyMKCiMjIyBMZWFybmluZyBPYmplY3RpdmVzIAoKSW4gdGhpcyBjYXNlIHN0dWR5LCB3ZSB3aWxsIHdhbGsgeW91IHRocm91Z2ggaW1wb3J0aW5nIGRhdGEgZnJvbSBhIHBkZiwgY2xlYW5pbmcsIHdyYW5nbGluZyBhbmQgdmlzdWFsaXppbmcgdGhlIGRhdGEsIGFuZCA8Yj4gY29tcGFyaW5nIHR3byBncm91cHMgPC9iPi4gIAoKV2Ugd2lsbCB1c2Ugd2VsbC1lc3RhYmxpc2hlZCBhbmQgY29tbW9ubHkgdXNlZCBwYWNrYWdlcywgaW5jbHVkaW5nIGBzdHJpbmdyYCwgYHRpZHlyYCwgYGRwbHlyYCwgYHB1cnJyYCwgYW5kIGBnZ3Bsb3QyYCBmcm9tIHRoZSBbYHRpZHl2ZXJzZWBdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9LiAKU3BlY2lmaWNhbGx5LCB0aGUgdGlkeXZlcnNlIGlzCgo+ICJhbiBvcGluaW9uYXRlZCBjb2xsZWN0aW9uIG9mIFIgcGFja2FnZXMgZGVzaWduZWQgZm9yIGRhdGEgc2NpZW5jZS4gQWxsIHBhY2thZ2VzIHNoYXJlIGFuIHVuZGVybHlpbmcgcGhpbG9zb3BoeSBhbmQgY29tbW9uIEFQSXMiLgoKQW5vdGhlciB3YXkgb2YgcHV0dGluZyBpdCBpcyB0aGF0IGl0J3MgYSBzZXQgb2YgcGFja2FnZXMgdGhhdCBhcmUgdXNlZnVsIHNwZWNpZmljYWxseSBmb3IgZGF0YSBtYW5pcHVsYXRpb24sIGV4cGxvcmF0aW9uIGFuZCB2aXN1YWxpemF0aW9uIHdpdGggYSBjb21tb24gcGhpbG9zb3BoeS4KV2hpbGUgc29tZSBzdHVkZW50cyBtYXkgYmUgZmFtaWxpYXIgd2l0aCBwcmV2aW91cyBwYWNrYWdlcyBmcm9tIHRoZSBSIHByb2dyYW1taW5nIGxhbmd1YWdlLCB0aGVzZSBwYWNrYWdlcyBtYWtlIGRhdGEgc2NpZW5jZSBpbiBSIGVzcGVjaWFsbHkgZWZmaWNpZW50LgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgb3V0LndpZHRoID0gIjIwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKCJodHRwczovL3RpZHl2ZXJzZS50aWR5dmVyc2Uub3JnL2xvZ28ucG5nIikKYGBgCgpXZSB3aWxsIGJlZ2luIGJ5IGxvYWRpbmcgdGhlIHBhY2thZ2VzIHRoYXQgd2Ugd2lsbCBuZWVkIHdpdGggYSBicmllZiBleHBsYW5hdGlvbjoKCmBgYHtyfQpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkocGRmdG9vbHMpCmxpYnJhcnkoc3RyaW5ncikKbGlicmFyeShyZWFkcikKbGlicmFyeShkcGx5cikKbGlicmFyeSh0aWJibGUpCmxpYnJhcnkobWFncml0dHIpCmxpYnJhcnkoZ2x1ZSkKbGlicmFyeShwdXJycikKbGlicmFyeSh0aWR5cikKbGlicmFyeShnZ3Bsb3QyKQpsaWJyYXJ5KGdncmVwZWwpCmxpYnJhcnkoY293cGxvdCkKbGlicmFyeShwYXRjaHdvcmspCmBgYAoKCiBQYWNrYWdlICAgfCBVc2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCi0tLS0tLS0tLS0gfC0tLS0tLS0tLS0tLS0KW2hlcmVdKGh0dHBzOi8vZ2l0aHViLmNvbS9qZW5ueWJjL2hlcmVfaGVyZSl7dGFyZ2V0PSJfYmxhbmsifSAgICAgICB8IHRvIGVhc2lseSBsb2FkIGFuZCBzYXZlIGRhdGEgd2l0aCByZWxhdGl2ZSBwYXRocwpbcGRmdG9vbHNdKGh0dHBzOi8vY3Jhbi5yLXByb2plY3Qub3JnL3dlYi9wYWNrYWdlcy9wZGZ0b29scy9wZGZ0b29scy5wZGYpe3RhcmdldD0iX2JsYW5rIn0gICB8IHRvIHJlYWQgYSB0ZXh0IGZyb20gcGRmIGludG8gUiAgIApbc3RyaW5ncl0oaHR0cHM6Ly9zdHJpbmdyLnRpZHl2ZXJzZS5vcmcvYXJ0aWNsZXMvc3RyaW5nci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgdGV4dCBkYXRhCltyZWFkcl0oaHR0cHM6Ly9yZWFkci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gbWFuaXB1bGF0ZSB0aGUgdGV4dCBkYXRhIHdpdGhpbiB0aGUgcGRmIGludG8gaW5kaXZpZHVhbCBsaW5lcyAgCltkcGx5cl0oaHR0cHM6Ly9kcGx5ci50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSAgICAgIHwgdG8gYXJyYW5nZS9maWx0ZXIvc2VsZWN0IHN1YnNldHMgb2YgdGhlIGRhdGEgClt0aWJibGVdKGh0dHBzOi8vdGliYmxlLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICB8IHRvIGNyZWF0ZSBkYXRhIG9iamVjdHMgdGhhdCB3ZSBjYW4gbWFuaXB1bGF0ZSB3aXRoIGBkcGx5cmAvYHN0cmluZ3JgL2B0aWR5cmAvYHB1cnJyYApbbWFncml0dHJdKGh0dHBzOi8vbWFncml0dHIudGlkeXZlcnNlLm9yZy9hcnRpY2xlcy9tYWdyaXR0ci5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAgfCB0byB1c2UgdGhlIGAlPD4lYCBwaXBpbmcgb3BlcmF0b3IKW2dsdWVdKGh0dHBzOi8vd3d3LnRpZHl2ZXJzZS5vcmcvYmxvZy8yMDE3LzEwL2dsdWUtMS4yLjAvKXt0YXJnZXQ9Il9ibGFuayJ9ICB8IHRvIHBhc3RlIG9yIGNvbWJpbmUgY2hhcmFjdGVyIHN0cmluZ3MgYW5kIGRhdGEgdG9nZXRoZXIKW3B1cnJyXShodHRwczovL3B1cnJyLnRpZHl2ZXJzZS5vcmcvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgICAgfCB0byBwZXJmb3JtIGZ1bmN0aW9ucyBvbiBhbGwgY29sdW1ucyBvZiBhIHRpYmJsZQpbdGlkeXJdKGh0dHBzOi8vdGlkeXIudGlkeXZlcnNlLm9yZy8pe3RhcmdldD0iX2JsYW5rIn0gICAgICB8IHRvIGNvbnZlcnQgZGF0YSBmcm9tICd3aWRlJyB0byAnbG9uZycgZm9ybWF0CltnZ3Bsb3QyXShodHRwczovL2dncGxvdDIudGlkeXZlcnNlLm9yZy8pICAgIHwgdG8gbWFrZSB2aXN1YWxpemF0aW9ucyB3aXRoIG11bHRpcGxlIGxheWVycwpbZ2dyZXBlbF0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL2dncmVwZWwvdmlnbmV0dGVzL2dncmVwZWwuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgICB8IHRvIGFsbG93IGxhYmVscyBpbiBmaWd1cmVzIG5vdCB0byBvdmVybGFwCltjb3dwbG90XShodHRwczovL2NyYW4uci1wcm9qZWN0Lm9yZy93ZWIvcGFja2FnZXMvY293cGxvdC92aWduZXR0ZXMvaW50cm9kdWN0aW9uLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gYW5kIFtwYXRjaHdvcmtdKGh0dHBzOi8vZ2l0aHViLmNvbS90aG9tYXNwODUvcGF0Y2h3b3JrKXt0YXJnZXQ9Il9ibGFuayJ9IHwgdG8gYWxsb3cgcGxvdHMgdG8gYmUgY29tYmluZWQgCgoKX19fCgpUaGUgZmlyc3QgdGltZSB3ZSB1c2UgYSBmdW5jdGlvbiwgd2Ugd2lsbCB1c2UgdGhlIGA6OmAgdG8gaW5kaWNhdGUgd2hpY2ggcGFja2FnZSB3ZSBhcmUgdXNpbmcgKGUuZy4gYHN0cmluZ3I6OnN0cl9kZXRlY3QoKWApLiAKVW5sZXNzIHdlIGhhdmUgb3ZlcmxhcHBpbmcgZnVuY3Rpb24gbmFtZXMsIHRoaXMgaXMgbm90IG5lY2Vzc2FyeSwgYnV0IHdlIHdpbGwgaW5jbHVkZSBpdCBoZXJlIHRvIGJlIGluZm9ybWF0aXZlIGFib3V0IHdoZXJlIHRoZSBmdW5jdGlvbnMgd2Ugd2lsbCB1c2UgY29tZSBmcm9tLgoKIyMjIENvbnRleHQKClRoZSBtZWFzdXJlbWVudCBvZiBCTUkgaGFzIHNvbWUgW2xpbWl0YXRpb25zXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM0ODkwODQxL3BkZi9udC01MC0xMTcucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHRoYXQgYXJlIHdlbGwgcmVjb2duaXplZCwgYXMgaXQgZG9lcyBub3QgYWNjb3VudCBmb3IgdGhlIGNvbXBvc2l0aW9uIG9mIGJvZHkgbWFzcywgdGhlIGxvY2F0aW9uIG9mIGJvZHkgZmF0LCBvciB0aGUgY29udHJpYnV0aW9uIG9mIGJvZHkgZnJhbWUgc2l6ZS4gCkhvd2V2ZXIsIFtCTUkgaGFzIGJlZW4gYSB1c2VmdWwgaGVhbHRoIGluZGljYXRvcl0oaHR0cHM6Ly9qb3VybmFscy5sd3cuY29tL2Fjc20taGVhbHRoZml0bmVzcy9GdWxsdGV4dC8yMDE2LzA3MDAwL1RIRV9CRU5FRklUU19PRl9CT0RZX01BU1NfSU5ERVhfQU5EX1dBSVNULjguYXNweCNwZGYtbGluayl7dGFyZ2V0PSJfYmxhbmsifSBmb3IgcmlzayBmb3IgbWFueSBkaXNlYXNlcyBhbmQgY29uZGl0aW9ucyBwYXJ0aWN1bGFybHkgd2hlbiBjb21iaW5lZCB3aXRoIG90aGVyIHJpc2sgZmFjdG9yIGluZm9ybWF0aW9uLgoKIyMgV2hhdCBhcmUgdGhlIGRhdGE/CgpXZSB3aWxsIGJlIHVzaW5nIGRhdGEgbG9jYXRlZCB3aXRoaW4gYSB0YWJsZSBvZiB0aGUgW3N1cHBsZW1lbnRhcnkgbWF0ZXJpYWxdKGh0dHBzOi8vc3RhdGljLWNvbnRlbnQuc3ByaW5nZXIuY29tL2VzbS9hcnQlM0ExMC4xMDM4JTJGczQxNTg2LTAxOS0xMTcxLXgvTWVkaWFPYmplY3RzLzQxNTg2XzIwMTlfMTE3MV9NT0VTTTFfRVNNLnBkZil7dGFyZ2V0PSJfYmxhbmsifSBmb3IgdGhlIE5DRC1SaXNDIHBhcGVyIHJlZmVyZW5jZWQgYWJvdmUuIAoKVGhpcyBpcyBhIHBkZiB0aGF0IGNhbiBiZSBmb3VuZCBmcmVlbHkgYXZhaWxhYmxlIG9ubGluZS4gSGVyZSBpcyBhIHNjcmVlbnNob3Qgb2YgdGhlIGZpcnN0IGZldyByb3dzIG9mIHRoaXMgdGFibGU6IAoKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImZpcnN0X3BhZ2UucG5nIikpCmBgYAoKWW91IGNhbiBzZWUgdGhhdCB0aGUgZGF0YSBjb250YWluIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmb3IgYm90aCBtZW4gYW5kIHdvbWVuIGluIGNvdW50cmllcyBhdCB0aGUgbmF0aW9uYWwgbGV2ZWwsIGFzIHdlbGwgYXMgdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmb3IgdGhlIHJ1cmFsIGFuZCB1cmJhbiBhcmVhcyBvZiB0aGVzZSBjb3VudHJpZXMgaW4gYm90aCAxOTg1IGFuZCAyMDE3LgoKVGhlIGRhdGEgd2l0aGluIHRoZSBwYXJlbnRoZXNlcyBhcmUgdGhlIDk1JSBbY3JlZGlibGUgaW50ZXJ2YWxzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DcmVkaWJsZV9pbnRlcnZhbCl7dGFyZ2V0PSJfYmxhbmsifSAoQ0lzKSBmb3IgdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcy4gVGhlIGF1dGhvcnMgcHJvdmlkZSB0aGVzZSBDSXMgYXMgYSBndWlkZSB0byB1bmRlcnN0YW5kIGhvdyBsaWtlbHkgdGhlIGVzdGltYXRlIGlzIGZvciB0aGUgdHJ1ZSBwb3B1bGF0aW9uIG1lYW4gQk1JLiBBIHdpZGVyIHJhbmdlIHN1Z2dlc3RzIHRoYXQgdGhlIGVzdGltYXRlIGlzIGxlc3MgYWNjdXJhdGUsIGFzIHRoZXJlIGFyZSBtb3JlIHBvc3NpYmxlIHZhbHVlcyBmb3IgdGhlIHRydWUgbWVhbiB3aXRoIGNyZWRpYmxlIGV2aWRlbmNlLiBOb3RpY2UgdGhhdCB0aGUgbWVhbiBCTUkgdmFsdWVzIGFyZSAiYWdlLXN0YW5kYXJkaXplZCwiIHRoaXMgbWVhbnMgdGhhdCB0aGUgbWVhbiB2YWx1ZXMgd2VyZSBhZGp1c3RlZCBmb3IgdGhlIGRpZmZlcmVudCBhZ2UgZGlzdHJpYnV0aW9ucyBvZiB0aGUgdmFyaW91cyBjb3VudHJpZXMgc28gdGhhdCB0aGUgY291bnRyaWVzIGNhbiBiZSBtb3JlIGZhaXJseSBjb21wYXJlZC4gRm9yIGV4YW1wbGUsIGlmIG9uZSBjb3VudHJ5IGhhcyBhIHBvcHVsYXRpb24gdGhhdCBpcyBjb25zaWRlcmFibHkgeW91bmdlciwgdGhlIG1lYW4gQk1JIG1pZ2h0IGJlIHF1aXRlIGxvdyAoYXMgeW91bmdlciBpbmRpdmlkdWFscyB0ZW5kIHRvIGhhdmUgbG93ZXIgQk1JIHZhbHVlcyBkdWUgdG8gZmFzdGVyIG1ldGFib2xpYyByYXRlcykuIE9uZSBtaWdodCBmYWxzZWx5IGNvbmNsdWRlIHRoYXQgcGVvcGxlIGluIHRoYXQgY291bnRyeSBnZW5lcmFsbHkgaGF2ZSBsb3dlciBCTUkgdmFsdWVzIHRoYW4gcGVvcGxlIGluIG1vc3Qgb3RoZXIgY291bnRyaWVzLCBob3dldmVyIHRoZSBsb3dlciBvdmVyYWxsIEJNSSBtZWFuIG1pZ2h0IHNpbXBseSBiZSBkdWUgdG8gdGhlIGZhY3QgdGhhdCB0aGUgY291bnRyeSBoYXMgYSB5b3VuZ2VyIHBvcHVsYXRpb24gdGhhbiB0aG9zZSBvdGhlciBjb3VudHJpZXMuCgoKIyMgRGF0YSBJbXBvcnQKCkZpcnN0IGxldCdzIGRvd25sb2FkIHRoZSBkYXRhIGZyb20gdGhlIFBERiBmaWxlLiAKV2UgdXNlIGBmaWxlLmV4aXN0cygpYCBmcm9tIGJhc2UgUiB0byBjaGVjayBpZiB0aGUgZmlsZSB3ZSB3YW50IHRvIGRvd25sb2FkIGFscmVhZHkgZXhpc3RzLiAKSWYgbm90LCB0aGVuIHdlIGRvd25sb2FkIGl0IHVzaW5nIHRoZSBmdW5jdGlvbiBgdXRpbHM6OmRvd25sb2FkLmZpbGUoKWAuIFdlIGFsc28gdXNlIHRoZSBgaGVyZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGhlcmVgIHBhY2thZ2UgdG8gbG9vayBzcGVjaWZpY2FsbHkgaW4gdGhlIGBkb2NzYCBkaXJlY3RvcnlgIG9mIHRoZSBkaXJlY3Rvcnkgd2hlcmUgb3VyIG9wZW4gUnN0dWRpbyBwcm9qZWN0IGZpbGUgaXMgbG9jYXRlZC4gVGhpcyBoZWxwcyB1cywgYXMgd2UgZG8gbm90IG5lZWQgdG8gd3JpdGUgdGhlIGZ1bGwgcGF0aCB0byB0aGUgZG9jdW1lbnQuIFRoaXMgbWFrZXMgb3VyIGNvZGUgbW9yZSByZXByb2R1Y2libGUgZm9yIHNvbWVvbmUgZWxzZSwgd2hvIG1heSBoYXZlIGEgZGlmZmVyZW50IG92ZXJhbGwgZmlsZSBzdHJ1Y3R1cmUgb24gdGhlaXIgY29tcHV0ZXIgYnV0IGRvd25sb2FkcyBvdXIgY2FzZSBzdHVkeSBmaWxlcyBmcm9tIEdpdEh1YiBhbmQgdGhlcmVmb3JlIGhhcyB0aGUgc2FtZSBmaWxlIHN0cnVjdHVyZSBzcGVjaWZpY2FsbHkgZm9yIHRoZSBmaWxlcyBpbmNsdWRlZCBpbiBvdXIgR2l0SHViIHJlcG9zaXRvcnkuIFRodXMgb3VyIGNvbW1hbmRzIGFib3V0IGZpbGUgbG9jYXRpb25zIHN0aWxsIHdvcmsgb24gdGhlaXIgbG9jYWwgbWFjaGluZS4KCmBgYHtyfQppZighZmlsZS5leGlzdHMoaGVyZSgiZG9jcyIsICJwYXBlcl9zdXBwbGVtZW50LnBkZiIpKSl7CiAgdXJsIDwtICJodHRwczovL3N0YXRpYy1jb250ZW50LnNwcmluZ2VyLmNvbS9lc20vYXJ0JTNBMTAuMTAzOCUyRnM0MTU4Ni0wMTktMTE3MS14L01lZGlhT2JqZWN0cy80MTU4Nl8yMDE5XzExNzFfTU9FU00xX0VTTS5wZGYiCiAgdXRpbHM6OmRvd25sb2FkLmZpbGUodXJsLCBoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCn0KYGBgCgpOb3cgdGhhdCB3ZSBoYXZlIGRvd25sb2FkZWQgdGhlIFBERiBmaWxlLCB3ZSB3aWxsIHJlYWQgaXQgaW4gdG8gUiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlOgoKYGBge3J9CnBkZl9vYmVzaXR5IDwtIHBkZnRvb2xzOjpwZGZfdGV4dChoZXJlKCJkb2NzIiwgInBhcGVyX3N1cHBsZW1lbnQucGRmIikpCmBgYAoKCkxldCdzIHRha2UgYSBsb29rIGF0IHRoZSBkYXRhIC0tIHRoZSBgc3VtbWFyeSgpYCBmdW5jdGlvbiBmcm9tIGJhc2UgUiBoZWxwcyB1cyB0byBsb29rIGF0IHRoZSBzdHJ1Y3R1cmUgb2YgUiBvYmplY3RzLgoKYGBge3J9CnN1bW1hcnkocGRmX29iZXNpdHkpCmBgYAoKV2UgY2FuIHNlZSB0aGF0IHdlIGhhdmUgNjMgZWxlbWVudHMgdGhhdCBhcmUgY2hhcmFjdGVyIHN0cmluZ3MuIApZb3UgbWF5IGFsc28gbm90aWNlIHRoYXQgdGhlIG9yaWdpbmFsIFBERiBoYXMgNjMgcGFnZXMuIExldCdzIHRha2UgYSBsb29rIGF0IHNvbWUgb2YgdGhlc2UgZWxlbWVudHMgYW5kIGNvbXBhcmUgdGhlbSB0byB0aGUgcGFnZXMgaW4gdGhlIG9yaWdpbmFsIGRvY3VtZW50LgoKYGBge3J9CnBkZl9vYmVzaXR5WzFdICMgdGhpcyBsb29rcyBsaWtlIHRoZSBmaXJzdCBwYWdlCnBkZl9vYmVzaXR5WzJdICMgdGhpcyBsb29rcyBsaWtlIHRoZSBzZWNvbmQgcGFnZQpgYGAKCmBgYHtyLCBldmFsID0gVFJVRX0Kc3RyKHBkZl9vYmVzaXR5WzUyXSwgbmNoYXIubWF4ID0gMTYwMCkKYGBgClllcywgdGhpcyBsb29rcyBsaWtlIGRhdGEgaW4gYSB0aGUgdGFibGUgd2Ugd2FudC4gCldlIGFyZSB1c2luZyB0aGUgYHN0cigpYCBmdW5jdGlvbiB0byBwcmludCBqdXN0IGEgcG9ydGlvbiBvZiB0aGUgZGF0YS4gVGhlIGBzdHIoKWAgZnVuY3Rpb24gY29tcGFjdGx5IGRpc3BsYXlzIHRoZSBzdHJ1Y3R1cmUgb2YgYXJiaXRyYXJ5IFIgb2JqZWN0cy4gClRoZSBgbmNoYXIubWF4YCBhcmd1bWVudCBsZXQncyB1cyBkZWZpbmUgdGhlIG1heGltYWwgbnVtYmVyIG9mIGNoYXJhY3RlcnMgdG8gc2hvdy4gCk5vdGUgYHByaW50KHBkZl9vYmVzaXR5WzUyXSlgIHdvdWxkIHNob3cgdGhlIGVudGlyZSBjb250ZW50cyBvZiB0aGUgdGhpcyBwYWdlIG9mIHRoZSB0YWJsZS4gCgpIZXJlIGlzIHRoZSBQREYgdmVyc2lvbiBhZ2FpbjoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwiZmlyc3RfcGFnZS5wbmciKSkKYGBgCgpXZSBjYW4gc2VlIHRoYXQgdGhlIG91dHB1dCBsb29rcyBwcmV0dHkgc2ltaWxhciB0byB0aGUgcGFnZXMgb2YgdGhlIHBkZiwgYnV0IHRoZSBzcGFjaW5nIGlzIGEgYml0IGF3a3dhcmQuIApOb3RlIHRoYXQgdGhlIHdheSB0aGUgZGF0YSBpcyBkaXNwbGF5ZWQgaXMgcGFydGlhbGx5IGluZmx1ZW5jZWQgYnkgdGhlIHdpZHRoIHNldHRpbmcgb2YgdGhlIFJTdHVkaW8gd2luZG93LiAgCgpOb3csIHdlIGFyZSBpbnRlcmVzdGVkIGluIGEgc3VwcGxlbWVudGFyeSBUYWJsZSAzLCB3aGljaCBoYXMgbXVsdGlwbGUgcGFnZXMgYW5kIGluY2x1ZGVzIHRoZSBzYW1lIGhlYWRlciBvbiBlYWNoIHBhZ2UuIApXZSBjYW4gdXNlIHRoYXQgdG8gZGV0ZXJtaW5lIHdoYXQgZWxlbWVudHMgb2Ygb3VyIGBwZGZfb2Jlc2l0eWAgY2hhcmFjdGVyIHN0cmluZ3MgaW5jbHVkZSBvdXIgdGFibGUuIApXZSB3aWxsIHVzZSB0aGUgYHN0cl9kZXRlY3QoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYHN0cmluZ3JgIHBhY2thZ2UgdG8gc2VhcmNoIGZvciB0aGUgZWxlbWVudHMgdGhhdCBjb250YWluIHRleHQgdGhhdCBpcyBjb25zaXN0ZW50bHkgaW4gdGhlIGhlYWRlci4gClRoZSBvdXRwdXQgb2Ygb2YgdGhpcyBmdW5jdGlvbiB3aWxsIHNob3cgd2hpY2ggZWxlbWVudHMgb2YgdGhlIG9iamVjdCAoaW4gdGhpcyBjYXNlIHBhZ2VzIG9mIHRoZSBwZGYpIGluY2x1ZGUgdGhpcyBwYXR0ZXJuIGluZGljYXRlZCBhcyBhIGBUUlVFYCBvciBgRkFMU0VgLgoKYGBge3J9CnN0cmluZ3I6OnN0cl9kZXRlY3QocGF0dGVybiA9ICJBZ2Utc3RhbmRhcmRpc2VkIG1lYW4gQk1JIiwgCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gcGRmX29iZXNpdHkpCmBgYApXZSBub3RlLCB0aGUgIkFnZS1zdGFuZGFyZGlzZWQgbWVhbiBCTUkiIGlzIHBhcnQgb2YgdGhlIGhlYWRlciBpbiB0aGUgdGFibGUgb24gZXZlcnkgcGFnZS4KVGhlIGNvZGUgYWJvdmUgc2hvd3MgdGhlIHBhZ2VzIHRoYXQgY29udGFpbiBvdXIgdGFibGUgb2YgaW50ZXJlc3QgKGFzIGBUUlVFYCB2YWx1ZXMpLgoKTm93IHdlIHdpbGwgZXh0cmFjdCBqdXN0IHRoZSBkYXRhIGZvciB0aGUgdGFibGUgbm93IGFuZCBjYWxsIGl0IGBydXJhbF91cmJhbmAuIApUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBgc3RyX3N1YnNldCgpYCBmdW5jdGlvbiBvZiB0aGUgYHN0cmluZ3JgIHBhY2thZ2UuCgpgYGB7cn0KcnVyYWxfdXJiYW4gPC0gc3RyaW5ncjo6c3RyX3N1YnNldChwYXR0ZXJuID0gIkFnZS1zdGFuZGFyZGlzZWQgbWVhbiBCTUkiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSBwZGZfb2Jlc2l0eSkKCnN1bW1hcnkocnVyYWxfdXJiYW4pIApgYGAKCkhlcmUsIHdlIHNlZSB0aGVyZSBhcmUgMTAgcGFnZXMgd29ydGggb2YgZWxlbWVudHMgaW4gb3VyIGBydXJhbF91cmJhbmAgb2JqZWN0LiAKCkxldCdzIGNoZWNrIHRoZSBmaXJzdCBhbmQgbGFzdCBwYWdlOgoKYGBge3IsIGV2YWw9VFJVRX0Kc3RyKHJ1cmFsX3VyYmFuWzFdLCBuY2hhci5tYXggPSAxNjAwKQpgYGAKVXNpbmcgYFsxXWAgc2hvd3MganVzdCB0aGUgZmlyc3QgcGFnZSBvZiB0aGUgMTAgcGFnZXMgdGhhdCBjb250YWluIHRoZSB0YWJsZS4gCkFsc28sIG5vdGljZSB0aGUgbmV3IGxpbmUgYCJcbiJgIHZhbHVlcyB0aGF0IGluZGljYXRlIG5ldyBsaW5lcy4gCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBldmFsID0gRkFMU0V9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsImZpcnN0X3BhZ2VfaW5fUi5wbmciKSkKYGBgCgoKYGBge3IsIGVjaG8gPSBGQUxTRX0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwiZmlyc3RfcGFnZS5wbmciKSkKYGBgCgpUaGlzIGxvb2tzIHRoZSBzYW1lIGFzIHRoZSBiZWdpbm5pbmcuLi4gaG93IGFib3V0IHRoZSBlbmQ/CgpgYGB7cn0Kc3RyKHJ1cmFsX3VyYmFuWzEwXSwgbmNoYXIubWF4ID0gMTgwMCkKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFIH0Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwibGFzdF9wYWdlLnBuZyIpKQpgYGAKCgpHcmVhdCEgT3VyIGBydXJhbF91cmJhbmAgb2JqZWN0IGxvb2tzIGxpa2UgaXQgY29udGFpbnMgdGhlIGVudGlyZSBTdXBwbGVtZW50YXJ5IDMgdGFibGUsIGFzIGJvdGggdGhlIGJlZ2lubmluZyBhbmQgdGhlIGVuZCBpbmNsdWRlIHRoZSBkYXRhIHdlIGV4cGVjdGVkLgoKIyMgRGF0YSBXcmFuZ2xpbmcKCkF0IHRoaXMgcG9pbnQgd2UgaGF2ZSBsYXJnZSBzdHJpbmdzIG5vdyBmb3IgZWFjaCBwYWdlIG9mIHRoZSB0YWJsZSwgYnV0IHRoaXMgaXMgbm90IHZlcnkgY29udmVuaWVudCB0byB3b3JrIHdpdGguIApOb3csIHdlIHdpbGwgd3JhbmdsZSB0aGUgZGF0YSBpbnRvIGEgbW9yZSB1c2FibGUgZm9ybS4gCklkZWFsbHksIHdlIHdvdWxkIGxpa2Ugb3VyIGRhdGEgdG8gYmUgaW4gc29tZSBzb3J0IG9mIHRhYnVsYXIgZm9ybS4KCiMjIyBTZXBhcmF0ZSB0aGUgZGF0YSBpbnRvIGxpbmVzCgpGaXJzdCwgaXQgd291bGQgYmUgdXNlZnVsIHRvIHNlcGFyYXRlIHRoZSBkYXRhIHRoYXQgaXMgY3VycmVudGx5IGluIDEwIGdpYW50IHN0cmluZyBjaHVua3MgaW50byBpbmRpdmlkdWFsIGxpbmVzIG9yIHJvd3Mgb2YgdGhlIHRhYmxlLiBUbyBkbyB0aGlzIHdlIGNhbiB1c2UgdGhlIGByZWFkX2xpbmVzKClgIGZ1bmN0aW9uIG9mIHRoZSBgcmVhZHJgIHBhY2thZ2Ugd2hpY2ggd2lsbCBzZXBhcmF0ZSB0aGUgbGluZXMgYmFzZWQgb24gdGhlIGAiXG4iYCBuZXcgbGluZSBjaGFyYWN0ZXJzLgpgYGB7cn0Kc3VtbWFyeShydXJhbF91cmJhbikKcnVyYWxfdXJiYW4gPC0gcmVhZHI6OnJlYWRfbGluZXMocnVyYWxfdXJiYW4pCnN1bW1hcnkocnVyYWxfdXJiYW4pIAojIG5vdyB3ZSBoYXZlIDQ2MSBsaW5lcwpgYGAKV2UgY2FuIHNlZSB0aGF0IGVhY2ggc3RyaW5nIGluIHRoZSBgcnVyYWxfdXJiYW5gIG9iamVjdCBpcyBub3cgYSBzaW5nbGUgbGluZSBmcm9tIHRoZSB0YWJsZS4KCkZvciBleGFtcGxlLCBsaW5lIDYgc2hvd3MgdGhlIGRhdGEgZm9yIHdvbWVuIGluIEFmZ2hhbmlzdGFuLgpgYGB7cn0KcnVyYWxfdXJiYW5bNl0gCmBgYAoKCiMjIyBSZW1vdmluZyBleGNlc3Mgd2hpdGUtc3BhY2UKCldlIGFsc28gaGF2ZSBhIGxvdCBvZiB3aGl0ZS1zcGFjZS4gTGV0J3MgZ2V0IHJpZCBvZiB0aGUgZXhjZXNzIHdoaXRlIHNwYWNlcyB1c2luZyBgc3RyX3NxdWlzaCgpYCBhbHNvIGZyb20gdGhlIGBzdHJpbmdyYCBwYWNrYWdlLgoKYGBge3J9CnJ1cmFsX3VyYmFuIDwtIHN0cmluZ3I6OnN0cl9zcXVpc2gocnVyYWxfdXJiYW4pIApoZWFkKHJ1cmFsX3VyYmFuKQpgYGAKCk5vdyBpdCBpcyBtdWNoIGVhc2llciB0byBzZWUgdGhlIGRhdGEuCgpJZiB3ZSBsb29rIGF0IHRoZSBwYXJ0IG9mIG91ciBkYXRhIHRoYXQgY29udGFpbnMgdGhlIGVuZCBvZiB0aGUgZmlyc3QgcGFnZSBvZiB0aGUgdGFibGUgYW5kIHRoZSBzdGFydCBvZiB0aGUgc2Vjb25kIHdlIGNhbiBzZWUgdGhhdCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uIGlzIHJlcGVhdGVkLCBhcyB3ZWxsIGFzIGEgbGluZSB3aXRoIHRoZSBwYWdlIG51bWJlciBhbmQgYW4gZW1wdHkgbGluZSwgYW5kIGEgbGluZSB0aGF0IHNheXMgIjIgMiIuCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyfQpydXJhbF91cmJhbls0NDo1Nl0gIyBzY3JvbGwgdGhyb3VnaCEKYGBgCiMjIyMKCkFsdGhvdWdoIHRoZSBoZWFkZXIgd2FzIG5lY2Vzc2FyeSBvbiBhbGwgb2YgdGhlIHBhZ2VzIG9mIHRoZSBwZGYgdmVyc2lvbiBvZiB0aGUgdGFibGUsIHdlIG9ubHkgbmVlZCB0aGF0IGluZm9ybWF0aW9uIG9uY2UgaW4gb3VyIGRhdGEuCgojIyMgUmVtb3ZpbmcgdW5uZWNlc3NhcnkgcmVwZWF0ZWQgaGVhZGVyIGluZm9ybWF0aW9uCgpTbywgbGV0J3MgcmVtb3ZlIGFsbCB0aGUgaGVhZGVyIGluZm9ybWF0aW9uIGFuZCB0aGUgcGFnZSBudW1iZXIgbGluZXMgZnJvbSB0aGUgYHJ1cmFsX3VyYmFuYCBvYmplY3QsIHRoZW4gd2Ugd2lsbCBtYWtlIGEgc2luZ2xlIGxpbmUgaGVhZGVyIGZvciB0aGUgYmVnaW5uaW5nLgpPbmUgd2F5IHRvIGRvIHRoaXMgaXMgdG8gZmluZCBhbGwgbGluZXMgdGhhdCBpbmNsdWRlIGVpdGhlciAiV29tZW4iIG9yICJNZW4iIGFuZCBvbmx5IGtlZXAgdGhpcyBkYXRhLgoKRmlyc3QsIGxldCdzIHNlZSBob3cgbWFueSBsaW5lcyBpbmNsdWRlICJXb21lbiIgb3IgIk1lbiIuIApXZSBjYW4gZG8gdGhpcyBieSBmaXJzdCBpZGVudGlmeWluZyB0aGUgbGluZXMgdGhhdCBjb250YWluIHRoZXNlIHBhdHRlcm5zIGFuZCB0aGVuIGNoZWNrIHRoZSBsZW5ndGggb2YgdGhlIHJlc3VsdGluZyB2ZWN0b3IgZm9yIHRoZSBsaW5lIG51bWJlcnMgdGhhdCBjb250YWluIHRoZXNlIHBhdHRlcm5zLiAKTm90ZSwgdGhlIGAifCJgIGluZGljYXRlcyB0aGF0IHdlIGFyZSBsb29raW5nIGZvciBlaXRoZXIgIldvbWVuIiBvciAiTWVuIi4KCiMjIyMgey5zY3JvbGxhYmxlIH0KYGBge3J9CiNzY3JvbGwgdGhyb3VnaCB0aGUgb3V0cHV0IQpzdHJpbmdyOjpzdHJfd2hpY2goc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJXb21lbnxNZW4iKQpgYGAKIyMjIwoKYGBge3J9Cmxlbmd0aChzdHJpbmdyOjpzdHJfd2hpY2goc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW58TWVuIikpCgpgYGAKCk5vdGUgdGhhdCBgc3RyX3doaWNoKClgIGlzIGNhc2Ugc2Vuc2l0aXZlLCBzbyBpdCB3b3VsZCBub3Qgd29yayB0byB1c2UgIndvbWVuIiBhcyB0aGUgcGF0dGVybiwgYW5kIHVzaW5nICJtZW4iIHdvdWxkIHJldHVybiB0aGUgbGluZXMgdGhhdCBjb250YWluICJXbyoqbWVuKioiIG9yICJZZSoqbWVuKioiIGV0Yy4gIFRyeSB0aGlzIG91dCB3aXRoIGBwYXR0ZXJuID0gIndvbWVuImAgYW5kIGBwYXR0ZXJuID0gIm1lbiJgIHRvIHNlZSB0aGUgcmVzdWx0IQoKT0ssIHNvIHRoaXMgbG9va3MgY29ycmVjdC4gClRoaXMgaW5jbHVkZXMgbW9zdCBsaW5lcyBidXQgdGhlcmUgYXJlIGdhcHMgd2hlcmUgdGhlIGhlYWRlciBpcyBsb2NhdGVkLiBJdCBsb29rcyBsaWtlIG91dCBvZiB0aGUgb3JpZ2luYWwgNDYxIGxpbmVzLCB0aGVyZSBhcmUgNDAwIGxpbmVzIGluIG91ciB0YWJsZSB0aGF0IGFyZW4ndCBoZWFkZXJzLgoKYGBge3J9CnJ1cmFsX3VyYmFuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW58TWVuIikKYGBgCgpXZSBjYW4gY2hlY2sgb3VyIGRhdGEgbm93IHVzaW5nIGVpdGhlciBgaGVhZCgpYCBmcm9tIGJhc2UgUiBvciBgZ2xpbXBzZSgpYCBmcm9tIHRoZSBgdGliYmxlYCAgYW5kIGBkcGx5cmAgcGFja2FnZS4gKFl1cCwgdGhlIHNhbWUgZnVuY3Rpb24gaXMgYXZhaWxhYmxlIGZyb20gYm90aCBwYWNrYWdlcyEpICBUaGUgYGhlYWQoKWAgZnVuY3Rpb24gc2hvd3MgdXMgdGhlIGZpcnN0IHJvd3Mgb3IgbGluZXMgb2YgdGhlIGRhdGEsIHdoaWxlIHRoZSBgZ2xpbXBzZSgpYCBmdW5jdGlvbiBwcm92aWRlcyB1cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdG90YWwgc2l6ZSBvZiB0aGUgb2JqZWN0IGFuZCBzaG93cyB1cyB0aGUgZmlyc3QgbGluZSBvciByb3cuCgpgYGB7cn0KZHBseXI6OmdsaW1wc2UocnVyYWxfdXJiYW4pCmBgYAoKTm93IG91ciBgcnVyYWxfdXJiYW5gIG9iamVjdCA0MDAgbGluZXMgaW5zdGVhZCBvZiA0NjEsIGxpa2UgaXQgZGlkIGJlZm9yZSB3aGVuIGl0IGNvbnRhaW5lZCB0aGUgcmVkdW5kYW50IGhlYWRlciBpbmZvcm1hdGlvbi4KCmBgYHtyfQpoZWFkKHJ1cmFsX3VyYmFuKQpgYGAKCkdyZWF0ISBTbyBub3cgb3VyIGRhdGEgbG9va3MgbXVjaCBiZXR0ZXIgYnV0IHdlIG5lZWQgdG8gYWRkIGJhY2sgb3VyIGhlYWRlciBhbmQgd2Ugd291bGQgbGlrZSB0aGlzIHRvIG9ubHkgYmUgYSBzaW5nbGUgbGluZSB0byBtYWtlIGl0IGVhc3kgdG8gdHJhbnNmb3JtIG91ciBkYXRhIGludG8gYSB0YWJsZSBvciB0YWJsZS1saWtlIG9iamVjdC4KCkFzIGEgcmVtaW5kZXIsIGhlcmUgaXMgd2hhdCBvdXIgaGVhZGVyIHVzZWQgdG8gbG9vayBsaWtlOgoKYGBge3IsIGVjaG8gPSBGQUxTRSwgIG91dC53aWR0aCA9ICcxMDAlJ30Ka25pdHI6OmluY2x1ZGVfZ3JhcGhpY3MoaGVyZTo6aGVyZSgiaW1nIiwibGFzdF9wYWdlLnBuZyIpKQpgYGAKCldlIHdpbGwgYWRkIGEgbmV3IGhlYWRlciBhZnRlciBmaXJzdCBkZWFsaW5nIHdpdGggc29tZSBhZGRpdGlvbmFsIHNwYWNpbmcgYW5kIG1pc3NpbmcgZGF0YSBpc3N1ZXMuCgojIyMgRGVhbGluZyB3aXRoIHNwYWNpbmcKCkZpcnN0IGxldCdzIHRyeSBzcGxpdHRpbmcgb3VyIGhlYWRlci1sZXNzIGRhdGEgaW50byBjb2x1bW5zIGJhc2VkIG9uIHNwYWNlcyB1c2luZyB0aGUgYHN0cl9zcGxpdCgpYCBmdW5jdGlvbiwgd2hlcmUgd2Ugc3BlY2lmeSB0aGF0IHdlIGFyZSBzcGxpdHRpbmcgdGhlIGRhdGEgYmFzZWQgb24gdGhlIHBhdHRlcm4gb2YgYSBzcGFjZSAodGhlIHNwYWNlIGlzIGluY2x1ZGVkIGluIHF1b3Rlcyk6CgpIZXJlLCB3ZSB3aWxsIHRha2UgYSBsb29rIGF0IGp1c3QgdGhlIGZpcnN0IDEwIGxpbmVzIHVzaW5nIHRoZSBgWzE6MTAsXWAgc3ludGF4OiAKCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyfQojc2Nyb2xsIHRocm91Z2ggdGhlIG91dHB1dCEKc3RyX3NwbGl0KHN0cmluZyA9IHJ1cmFsX3VyYmFuLCAKICAgICAgICAgIHBhdHRlcm4gPSAiICIsIAogICAgICAgICAgc2ltcGxpZnkgPSBUUlVFKVsxOjEwLF0gCmBgYAojIyMjCgpUaGlzIGFsbW9zdCB3b3JrZWQsIGJ1dCB1bmZvcnR1bmF0ZWx5IGNvdW50cnkgbmFtZXMgdGhhdCBoYXZlIHNwYWNlcyB3aWxsIGJlIGEgcHJvYmxlbS4gCkZvciBleGFtcGxlLCB3ZSBjYW4gc2VlIHRoYXQgIkFtZXJpY2FuIFNhbW9hIiBoYXMgYmVlbiBkaXZpZGVkIGludG8gdHdvIGNvbHVtbnMgYW5kIGFsbCBzdWJzZXF1ZW50IGNvbHVtbnMgYXJlIHNoaWZ0ZWQuCgpMZXQncyB0cnkgdGhpcyBhbm90aGVyIHdheS4gIAoKQXMgd2UgY2FuIHNlZSBieSBsb29raW5nIGF0IG91ciBgcnVyYWxfdWJyYW5gIGRhdGEsIHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIGlzIG9ubHkgcHJlc2VudCB3aGVuIHRoZSBzZXggaXMgV29tZW4uIExldCdzIHRyeSB0byBleHRyYWN0IHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIGZyb20gdGhlIHJvd3MgdGhhdCBjb250YWluIGRhdGEgYWJvdXQgV29tZW4uCgpgYGB7cn0KaGVhZChydXJhbF91cmJhbikKYGBgClRvIGRvIHRoaXMsIHdlIHN0YXJ0IGJ5IG5vdGljaW5nIHRoYXQgdGhlIHNleCBhbHdheXMgc3RhcnRzIHdpdGggZWl0aGVyIGEgY2FwaXRhbCAiVyIgaWYgdGhlIHNleCBpcyBmZW1hbGUuIE5vdGUsIHdlIG5lZWQgdG8gdXNlIGEgc3BhY2UgYmVmb3JlIHRoZSAiVyIgb3RoZXJ3aXNlIHdlIHdpbGwgc3BsaXQgc29tZSBvZiB0aGUgY291bnRyeSBuYW1lcyBpZiB0aGUgbmFtZXMgc3RhcnRzIHdpdGggIlciLiAKCkhlcmUsIHdlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGNvbmNlcHQgb2YgcGlwaW5nLCB3aGljaCB1c2VzIHRoZSBgJT4lYCBmcm9tIHRoZSBgbWFncml0dHJgIHBhY2thZ2UsIHdoaWNoIGFsbG93cyB1cyB0byBwaXBlIHRoZSBvdXRwdXQgZnJvbSBvbmUgZnVuY3Rpb24gdG8gdGhlIGlucHV0IGZvciBhbm90aGVyIGZ1bmN0aW9uLgpUaGlzIGlzIHJlYWxseSB1c2VmdWwgd2hlbiB3ZSBoYXZlIG11bHRpcGxlIHN0ZXBzLCB3aGljaCB3ZSB3aWxsIHNob3cgc29vbi4KCkZpcnN0LCB3ZSB3aWxsIHNlbGVjdCBqdXN0IHRoZSBkYXRhIGZvciBXb21lbiBhbmQgTWVuIHNlcGFyYXRlbHk6CgpgYGB7cn0KCldvbWVuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiV29tZW4iKSAKTWVuIDwtIHN0cl9zdWJzZXQoc3RyaW5nID0gcnVyYWxfdXJiYW4sIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAiTWVuIikKCgpoZWFkKFdvbWVuKQpoZWFkKE1lbikKYGBgCgoKQW5kIHRoZW4gc3BsaXQgdGhlIGBXb21lbmAgZGF0YSBiYXNlZCBvbiB0aGUgcGF0dGVybiBgcGF0dGVybiA9ICIgV29tZW4iYCAoTm90ZSB0aGF0IHRoZSBzcGFjZSBiZWZvcmUgdGhlIHdvcmQgIldvbWVuIiBpcyBpbmNsdWRlZCAtIHNvIHRoYXQgaXQgaXMgbm90IHdpdGhpbiB0aGUgY291bnRyeSBkYXRhKS4KSGVyZSB3ZSB0YWtlIG91ciBgV29tZW5gIGRhdGFzZXQgYW5kIHBpcGUgaXQgaW50byB0aGUgZmlyc3QgYXJndW1lbnQgb2YgdGhlIGBzdHJfc3BsaXQoKWAgZnVuY3Rpb24sIHdoZXJlIHRoZW4gd2UgY2FuIHNwbGl0IG9uIHRoZSBwYXR0ZXJuIGAiIFdvbWVuImAuICBXZSB0aGVuIHBpcGUgdGhyb3VnaCB0aHIgYHVubGlzdCgpYCBmdW5jdGlvbiBzbyB0aGF0IHRoZSByZXN1bHRzIGlzIGEgdmVjdG9yIGluc3RlYWQgb2YgYSBsaXN0LiAgV2UgYXNzaWduIHRoaXMgbmV3IHJlc3VsdCB0byB0aGUgYGNvdW50cnlfc3BsaXRgIG9iamVjdC4KCmBgYHtyfQpjb3VudHJ5X3NwbGl0IDwtIAogIFdvbWVuICU+JQogIHN0cmluZ3I6OnN0cl9zcGxpdChwYXR0ZXJuID0gIiBXb21lbiIpICU+JQogIHVubGlzdCgpIAoKaGVhZChjb3VudHJ5X3NwbGl0KQpgYGAKCkhvd2V2ZXIsIHdlIGNhbiBhbHNvIGRvIHRoZSBzYW1lIHRoaW5nIGluIGEgc2luZ2xlIHN0ZXAsIHdoZXJlIHdlIHJlcGxhY2UgdGhlIGBXb21lbmAgZGF0YXNldCB3aXRoIHRoZSBjb2RlIHdlIHVzZWQgdG8gY3JlYXRlIHRoYXQgZGF0YXNldC4gIFNvIGZpcnN0LCB3ZSBzZWxlY3QgdGhlICJXb21lbiIgYW5kIHRoZW4gd2Ugc3BsaXQgdGhlIGRhdGEgYnkgIiBXb21lbiIgdG8gY3JlYXRlIGEgbmV3IGRhdGFzZXQgYWxsIHdpdGhpbiB0aGUgc2FtZSBjaHVuayBvZiBjb2RlLgpgYGB7cn0KY291bnRyeV9zcGxpdCA8LSAKICBzdHJfc3Vic2V0KHN0cmluZyA9IHJ1cmFsX3VyYmFuLAogICAgICAgICAgICAgcGF0dGVybiA9ICJXb21lbiIpICU+JQogIHN0cmluZ3I6OnN0cl9zcGxpdChwYXR0ZXJuPSAiIFdvbWVuIikgJT4lCiAgdW5saXN0KCkKCmhlYWQoY291bnRyeV9zcGxpdCkKYGBgCgpOb3csIHdlIGNhbiBzZWUgdGhhdCBgQ291bnRyeWAgaXMgYWx3YXlzIHRoZSBvZGQgcm93cyBhbmQgdGhlICBCTUkgZGF0YSBmb3IgV29tZW4gaXMgdGhlIGV2ZW4gcm93cy4gCldlIGNhbiBzZWxlY3QgdGhlIG9kZCByb3dzIHVzaW5nIHRoZSA8Yj4gTW9kdWx1cyAoUmVtYWluZGVyIGZyb20gZGl2aXNpb24pIG9wZXJhdG9yPC9iPi4gClRoaXMgb3BlcmF0b3IgbG9va3MgbGlrZSB0aGlzIGAlJWAuIApBbGwgb2RkIHZhbHVlcyBzdWNoIGFzIDMsIDcsIG9yIDE1IHdoZW4gZGl2aWRlZCBieSAyIHdvdWxkIGxlYXZlIGEgcmVtYWluZGVyIG9mIDEuIApXZSB3aWxsIHNlbGVjdCBqdXN0IHRoZXNlIHJvd3MgdXNpbmcgdGhlIGBmaWx0ZXIoKWAgZnVuY3Rpb24gb2YgYGRwbHlyYC4KCmBgYHtyfQpjb3VudHJ5IDwtIAogIHRpYmJsZShjb3VudHJ5X3NwbGl0KSAlPiUgCiAgZHBseXI6OmZpbHRlcihyb3dfbnVtYmVyKCkgJSUgMiA9PSAxKSAKYGBgCgpXZSBjYW4gdGFrZSBhIGxvb2sgdG8gbWFrZSBzdXJlIHRoYXQgYWxsIHRoZSBjb3VudHJ5IG5hbWVzIGxvb2sgYXMgZXhwZWN0ZWQuIFlvdSBjYW4gc2Nyb2xsIHRocm91Z2ggdGhlIGNvdW50cnkgbmFtZXMgaWYgeW91IGhvdmVyIG92ZXIgdGhlIGRhdGEuCgpgYGB7ciwgZXZhbD0gRkFMU0V9CmNvdW50cnkKYGBgCgojIyMjIHsuc2Nyb2xsYWJsZSB9CmBgYHtyLCBlY2hvID0gRkFMU0V9CmFzLmRhdGEuZnJhbWUoY291bnRyeSkKYGBgCiMjIyMKCkxvb2tzIGdvb2QhICBXZSBoYXZlIDIwMCBjb3VudHJpZXMgcmVwcmVzZW50ZWQgaW4gb3VyIGRhdGFzZXQuCgpHcmVhdCEgTm93IHdlIGhhdmUgYSBsaXN0IG9mIHRoZSBjb3VudHJpZXMgdGhhdCBjYW4gYmUgdXNlZCBmb3IgYm90aCB0aGUgbWFsZSBhbmQgZmVtYWxlIGRhdGEuIAoKClJlbWViZXIgdGhlIGV2ZW4gcm93cyBhcmUgdGhlIHJvd3Mgd2l0aCB0aGUgQk1JIGRhdGEgZm9yIHdvbWVuLgpUaGVzZSByb3cgdmFsdWVzIGhhdmUgYSByZW1haW5kZXIgb2YgMCB3aGVuIGRpdmlkZWQgYnkgMi4KTGV0J3Mgc2VsZWN0IHRoYXQgZGF0YSB0b28uCgpgYGB7cn0KV29tZW5fQk1JIDwtIAogIHRpYmJsZShjb3VudHJ5X3NwbGl0KSAlPiUgCiAgZHBseXI6OmZpbHRlcihyb3dfbnVtYmVyKCkgJSUgMiA9PSAwKQoKaGVhZChXb21lbl9CTUkpCmBgYApUaGlzIGxvb2tzIHNpbWlsYXIgdG8gb3VyIGBNZW5gIGRhdGEgKGFsdGhvdWdoIHNsaWdodGx5IGRpZmZlcmVudCk6CgpgYGB7cn0KaGVhZChNZW4pCmBgYAoKTm90aWNlIGhvdyB0aGUgZGF0YSBpbiBlYWNoIHJvdyBpcyBpbiBxdW90ZXMuIFRoaXMgaXMgYmVjYXVzZSB0aGVzZSBhcmUgY2hhcmFjdGVyIHN0cmluZ3MuIFdlIGNhbiBjaGVjayB0aGlzIGJ5IHVzaW5nIHRoZSBiYXNlIGBjbGFzcygpYCBmdW5jdGlvbi4KCmBgYHtyfQpjbGFzcyhNZW4pCmBgYAoKV2hlcmVhcyB0aGUgYFdvbWVuX0JNSWAgZGF0YSBpcyBhIHRpYmJsZS4KYGBge3J9CmNsYXNzKFdvbWVuX0JNSSkKYGBgCgpMZXQncyBtYWtlIHRoZSBgTWVuYCBkYXRhIGludG8gYSB0aWJibGUgYXMgd2VsbDoKYGBge3J9Ck1lbiA8LXRpYmJsZShNZW4pCgpgYGAKCkl0J3MgYWx3YXlzIGEgZ29vZCBpZGVhIHRvIGNoZWNrIHRoYXQgeW91ciBkYXRhIG9iamVjdHMgYXJlIHRoZSBzaXplIHlvdSBleHBlY3Qgd2hlbiB3cmFuZ2xpbmcuIApXZSBjYW4gZG8gc28gd2l0aCB0aGUgYGRpbSgpYCBmdW5jdGlvbiwgd2hpY2ggc2hvd3MgdXMgdGhlIGRpbWVuc2lvbnMgb2YgZGF0YSBvYmplY3RzLgoKYGBge3J9CmRpbShXb21lbl9CTUkpCmRpbShNZW4pCmhlYWQoV29tZW5fQk1JKQpoZWFkKE1lbikKYGBgCkdyZWF0ISBUaGVyZSBhcmUgMjAwIHJvd3Mgb2YgY2hhcmFjdGVyIHN0cmluZ3Mgd2l0aCB0aGUgQk1JIGRhdGEgbGlrZSB3ZSBleHBlY3RlZCB0byBtYXRjaCB0aGUgMjAwIGNvdW50cmllcyBpbiBvdXIgZGF0YS4KCldlIGRvIGhvd2V2ZXIgbmVlZCB0byBhZGQgdGhlIHdvcmQgYCIgV29tZW4iYCBiYWNrIHRvIHRoZSBgV29tZW5fQk1JYCBkYXRhLgpUbyBkbyB0aGlzIHdlIHdpbGwgdXNlIHRoZSBgZ2x1ZSgpYCBmdW5jdGlvbiBvZiB0aGUgYGdsdWVgIHBhY2thZ2UuIAoKSGVyZSBpcyBhIHNpbXBsZSBleGFtcGxlIG9mIGhvdyB0aGlzIGZ1bmN0aW9uIGdsdWVzIHR3byB0aGluZ3MgdG9nZXRoZXIuCgpgYGB7cn0Kd2hlcmUgPC0idGhlIG1vb24iCgpnbHVlOjpnbHVlKCJ0aGUgY293IGp1bXBlZCBvdmVyIHt3aGVyZX0iKQoKYGBgCgpOb3cgbGV0J3MgYWRkICB0aGUgd29yZCAiV29tZW4iIHRvIGVhY2ggcm93IG9mIHRoZSBgV29tZW5fQk1JYCBkYXRhIHVzaW5nIGBnbHVlYC4KCkZpcnN0IGxldCdzIHB1bGwgdGhlIGBjb3VudHJ5X3NwbGl0YCBkYXRhIG91dCBhcyBhIHZlY3RvciB0byBtYWtlIHRoaXMgc2ltcGxlciB3aGVuIHdlIGBnbHVlYC4gVG8gZG8gdGhpcyB3ZSB3aWxsIHVzZSB0aGUgYHB1bGwoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4gVGhpcyBmdW5jdGlvbiB3aWxsIGFsbG93IHVzIHRvIGV4dHJhY3Qgb3IgcHVsbCBvdXQgdGhlIHNpbmdsZSB2YXJpYWJsZSBjYWxsZWQgYGNvdW50cnlfc3BsaXRgIHdoaWNoIGNvbnRhaW5zIHRoZSBCTUkgdmFsdWVzIGZvciB3b21lbiBmcm9tIHdpdGhpbiB0aGUgdGliYmxlIGNhbGxlZCBgV29tZW5fQk1JYCB3aGljaCB3ZSBqdXN0IGNyZWF0ZWQgYnkgZ3JhYmJpbmcgb25seSB0aGUgZXZlbiByb3dzIG9mIG91ciBvcmlnaW5hbCBgY291bnRyeV9zcGxpdGAgdGliYmxlLgoKVGhlbiwgbGV0J3MgdXNlIHRoZSBgZmlyc3QoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZSB0byBnZXQgYSByZW1pbmRlciBvZiB3aGF0IGp1c3QgdGhlIGZpcnN0IHJvdyBvZiB0aGUgYGNvdW50cnlfc3BsaXRgIGNvbHVtbiBvZiB0aGUgYFdvbWVuX0JNSWAgZGF0YSBsb29rcyBsaWtlLgoKCmBgYHtyfQp3b21lbl9kYXRhIDwtIFdvbWVuX0JNSSAlPiUKICBwdWxsKGNvdW50cnlfc3BsaXQpCgpkcGx5cjo6Zmlyc3Qod29tZW5fZGF0YSkKYGBgCgpOb3cgd2Ugd2lsbCBwYXN0ZSB0aGUgd29yZCBgIldvbWVuImAgaW4gdGhlIGJlZ2lubmluZyBvZiBlYWNoIHZhbHVlIGluIHRoZSB2ZWN0b3IgdXNpbmcgdGhlIGBnbHVlKClgIGZ1bmN0aW9uLgoKTm90ZSB0aGF0IHRoZXJlIHdpbGwgYmUgYSBzcGFjZSBpbiBiZXR3ZWVuLgpUaGlzIGlzIGJlY2F1c2UgdGhlIHNwYWNlIGlzIGFscmVhZHkgaW4gZnJvbnQgb2YgdGhlIGZpcnN0IEJNSSB2YWx1ZS4KCmBgYHtyfQpXb21lbiA8LSBnbHVlKCJXb21lbnt3b21lbl9kYXRhfSIpCmhlYWQoV29tZW4pCmBgYAoKWW91IGNvdWxkIGFsc28gZG8gYWxsIG9mIHRoaXMgaW4gb25lIHN0ZXAgYnV0IGl0cyBsZXNzIG9idmlvdXMgd2hhdCBpcyBoYXBwZW5pbmcuCgpIZXJlIHdlIGNhbiBwdWxsIHRoZSBgY291bnRyeV9zcGxpdGAgZGF0YSBvdXQgb2YgdGhlIGBXb21lbl9CTUlgIG9iamVjdCBhbmQgdGhlbiBwYXN0ZSBgIldvbWVuImAgaW4gZnJvbnQgb2YgZWFjaCBzdHJpbmcgaW4gb25lIGNvbW1hbmQuCmBgYHtyLCBldmFsID0gRkFMU0V9CldvbWVuIDwtIGdsdWUoIldvbWVue3B1bGwoV29tZW5fQk1JLGNvdW50cnlfc3BsaXQpfSIpCmBgYAoKCgpJZiB3ZSB0cnkgc3BsaXR0aW5nIG91ciBkYXRhIGJ5IHNwYWNlIGFnYWluLCB3aWxsIGl0IGhhdmUgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBjb2x1bW5zPyBXaGF0IGFib3V0IHRoZSByb3dzIHRoYXQgY29udGFpbiBgbmEqYCB2YWx1ZXM/CgpMZXQncyBqdXN0IHRha2UgdGhlIGBNZW5gIGRhdGEgdGhhdCBjb250YWlucyBgbmEqYCB2YWx1ZXMuIApUaGlzIGNvbHVtbiBpcyBjYWxsZWQgYHJ1cmFsX3VyYmFuYC4gCgpgYGB7cn0KdW5rbm93biA8LSAKICBNZW4lPiUgCiAgZmlsdGVyKHN0cl9kZXRlY3QocGF0dGVybiA9Im5hXFwqIiwgCiAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gTWVuKSkgCgpoZWFkKHVua25vd24pCmBgYAoKTm93IHdlIGNhbiB0cnkgc3BsaXR0aW5nIGJ5IGEgc3BhY2UKYGBge3J9CnRpYmJsZTo6YXNfdGliYmxlKHN0cl9zcGxpdChwdWxsKHVua25vd24sIE1lbiksICIgIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsaWZ5ID0gVFJVRSkpCgpgYGAKClNvIGNsb3NlISBOb3RpY2UgdGhhdCB0aGUgYCJuYSoiYCB2YWx1ZXMgaGF2ZSBzaGlmdGVkIHRoZSBzdWJzZXF1ZW50IHZhbHVlcyB3aXRoaW4gdGhlIGNvbHVtbnMgYmVjYXVzZSB0eXBpY2FsbHkgdGhlcmUgaXMgYSBzcGFjZSBiZXR3ZWVuIHRoZSBCTUkgYW5kIHRoZSBjcmVkaWJsZSBpbnRlcnZhbHMuCkhlcmUgd2UgY2FuIHNlZSB0aGlzIGRhdGEgaW4gb3VyIG9yaWdpbmFsIHBkZjoKCmBgYHtyLCBlY2hvID0gRkFMU0UsIG91dC53aWR0aD0iMTAwJSJ9CmtuaXRyOjppbmNsdWRlX2dyYXBoaWNzKGhlcmU6OmhlcmUoImltZyIsIm1pc3NpbmdfcGRmLnBuZyIpKQpgYGAKCgojIyMgRGVhbGluZyB3aXRoIE5BIHZhbHVlcwoKV2UgbmVlZCB0byByZXBsYWNlIG91ciBgbmEqYCB2YWx1ZXMgd2l0aCBzb21ldGhpbmcgdGhhdCBpbmNsdWRlcyBhIHNwYWNlIHNvIHRoYXQgd2hlbiB3ZSBzZXBhcmF0ZSBvdXIgZGF0YSBieSBzcGFjZSB3ZSB3aWxsIGhhdmUgdHdvIHZhbHVlcyBpbnN0ZWFkIG9mIG9uZSB3aGVuIHdlIGhhdmUgYW4gYG5hKmAuIApUaGVyZWZvcmUsIGBuYSogbmEqYCBzaG91bGQgd29yay4KClNvLCBpbiBvcmRlciB0byB1c2UgdGhlIGZ1bmN0aW9ucyB3aXRoaW4gdGhlIGBzdHJpbmdyYCBwYWNrYWdlLCBvdXIgYE1lbmAgZGF0YSBuZWVkcyB0byBiZSBvZiBgY2hhcmFjdGVyYCBjbGFzcywgc28gbGV0J3MgY2hlY2sgdGhhdCBub3cuCgpgYGB7cn0KY2xhc3MocHVsbChNZW4sIE1lbikpCmBgYApUaGUgYCBhcy5jaGFyYWN0ZXIoKWAgZnVuY3Rpb24gYWxsb3dzIHVzIHRvIGNoYW5nZSBmYWN0b3IgZGF0YSB3aXRoaW4gdG8gdGhlIGNoYXJhY3RlciBjbGFzcy4gIFdlIGNvdWxkIHVzZSB0aGlzIGlmIHdlIG5lZWRlZCBpdCwgYnV0IGl0IGxvb2tzIGxpa2Ugb3VyIGRhdGEgaXMgYWxyZWFkeSBgY2hhcmFjdGVyYC4KCldlIGFyZSBhbHNvIGNoYW5naW5nIHRoZSBzdHJ1Y3R1cmUgc28gdGhhdCB0aGUgZGF0YSBpcyBub3Qgd2l0aGluIGEgY29sdW1uIGNhbGxlZCBgTWVuYC4gCmBgYHtyfQpoZWFkKE1lbikKTWVuIDwtIHB1bGwoTWVuLCBNZW4pCmhlYWQoTWVuKQpgYGAKCmBgYHtyfQpNZW4gPC0gCiAgc3RyaW5ncjo6c3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9IE1lbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSAibmFcXCoiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQgPSAibmFcXCogbmFcXCoiKSAKCiMgVGhlIFxcIGFyZSBuZWNlc3NhcnkgYmVjYXVzZSB0aGUgKiBpcyBhIHNwZWNpYWwgY2hhcmFjdGVyIAojIFRoZSAqIHdvdWxkIHR5cGljYWxseSBpbmRpY2F0ZSBhbnkgcG9zc2libGUgdmFsdWUsIAojIGJ1dCBoZXJlIHdlIGFjdHVhbGx5IHdhbnQgYSAiKiIgaW5zdGVhZAojIFRodXMgdGhlIGRvdWJsZSBiYWNrc2xhc2ggZG9lcyB0aGF0IGZvciB1cwojIEhlcmUgd2UgYXJlIHJlcGxhY2luZyBhbGwgb2NjdXJlbmNlcyBvZiB0aGUgbmEqIHZhbHVlcyAKIyh0aHVzIHN0cl9yZXBsYWNlX2FsbCBpbnN0ZWFkIG9mIHN0cl9yZXBsYWNlKSB3aXRoIG5hKiBuYSouIApgYGAKCkxldCdzIGNoZWNrIHRoYXQgaXQgd29ya2VkLi4uCmBgYHtyfQpNZW5bMjA6MzBdCmBgYAoKR3JlYXQhCgpOb3cgZm9yIHRoZSBXb21lbiBkYXRhIG9iamVjdApgYGB7cn0KY2xhc3MoV29tZW4pCiMgdGhlIGZlbWFsZSBkYXRhIGlzIGFscmVhZHkgY2hhcmFjdGVyIHR5cGUKV29tZW4gPC0gCiAgc3RyaW5ncjo6c3RyX3JlcGxhY2VfYWxsKHN0cmluZyA9IFdvbWVuLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9ICJuYVxcKiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudCA9ICJuYVxcKiBuYVxcKiIpIApXb21lblsyMDozMF0KYGBgCgpHcmVhdCwgbm93IHdlIGNhbiBzcGxpdCBvdXIgZGF0YSBieSBzcGFjZXMuCgojIyMgU3BsaXR0aW5nIHRoZSBkYXRhCgpXZSB3aWxsIHNwbGl0IG91ciBkYXRhIGZpbmFsbHkgYnkgc3BhY2VzIHVzaW5nIHRoZSBgc3RyX3NwbGl0KClgIGZ1bmN0aW9uIG9mIHRoZSBgc3RyaW5ncmAgcGFja2FnZS4gV2UgY2FuIGNoZWNrIHRoZSByb3dzIHdpdGggTkEgdmFsdWVzIGJ5IGxvb2tpbmcgYXQgcm93cyAyMC0zMC4KYGBge3J9Ck1lbiA8LSB0aWJibGU6OmFzX3RpYmJsZShzdHJfc3BsaXQoTWVuLCAiICIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsaWZ5ID0gVFJVRSkpCk1lblsyMDozMCxdCmBgYApHcmVhdCEgSXQgbG9va3MgZ29vZCEKCk5vdyBmb3IgdGhlIGBXb21lbmAgZGF0YS4KCmBgYHtyfQpXb21lbiA8LSBhc190aWJibGUoc3RyX3NwbGl0KFdvbWVuLCAiICIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXBsaWZ5ID0gVFJVRSkpCmhlYWQoV29tZW4pCldvbWVuWzIwOjMwLF0gCmBgYAoKV2UgY2FuIHNlZSB0aGF0IG91ciBgbmFgIHZhbHVlcyBsb29rIGNvcnJlY3QuIAoKTG9va3MgZ29vZCEKIAogCiMjIyBBZGRpbmcgbmV3IGhlYWRlcgoKV2UgY2FuIHNlZSBmcm9tIG91ciBwZGYgYW5kIG91ciBvYmplY3QgY2FsbGVkIGBoZWFkZXJgIHdoYXQgdGhlIGhlYWRlciB3YXMgbGlrZSBpbiB0aGUgb3JpZ2luYWwgcGRmIGRvY3VtZW50LiBXZSBuZWVkIHRvIGFkZCBjb2x1bW4gbmFtZXMgdG8gb3VyIGRhdGEgYmFzZWQgb24gdGhlIG9yaWdpbmFsIGRhdGEuCgpXZSdsbCB3YWl0IHRvIGFkZCBgQ291bnRyeWAgdG8gdGhlIGhlYWRlciB1bnRpbGwgd2UgYWRkIHRoZSBjb3VudHJ5IGluZm9ybWF0aW9uIHRvIG91ciBkYXRhLgoKYGBge3J9Cm5ld19oZWFkZXIgPC0gYygiU2V4IiwiTmF0aW9uYWxfQk1JXzE5ODUiLCAKICAgICAgICAgICAgICAgICJOYXRpb25hbF9CTUlfMTk4NV9DSSIsICJSdXJhbF9CTUlfMTk4NSIsIAogICAgICAgICAgICAgICAgIlJ1cmFsX0JNSV8xOTg1X0NJIiwgIlVyYmFuX0JNSV8xOTg1IiwKICAgICAgICAgICAgICAgICJVcmJhbl9CTUlfMTk4NV9DSSIsICJOYXRpb25hbF9CTUlfMjAxNyIsCiAgICAgICAgICAgICAgICAiTmF0aW9uYWxfQk1JXzIwMTdfQ0kiLCJSdXJhbF9CTUlfMjAxNyIsCiAgICAgICAgICAgICAgICAiUnVyYWxfQk1JXzIwMTdfQ0kiLCAiVXJiYW5fQk1JXzIwMTciLCAKICAgICAgICAgICAgICAgICJVcmJhbl9CTUlfMjAxN19DSSIpCmBgYAoKTGV0J3MgY2hhbmdlIHRoZSBuYW1lcyBvZiBvdXIgY29sdW1ucyBvZiBvdXIgdGliYmxlcyB0byB0aGlzIG5ldyBoZWFkZXIgZm9yIG91ciBgTWVuYCBhbmQgYFdvbWVuYCBkYXRhCgpgYGB7cn0KbmFtZXMoV29tZW4pIDwtIG5ld19oZWFkZXIKbmFtZXMoTWVuKSA8LSBuZXdfaGVhZGVyCgpoZWFkKFdvbWVuKQpoZWFkKE1lbikKYGBgCgpOb3cgd2Ugd2lsbCBhZGQgb3VyIGNvdW50cnkgZGF0YSB0byBib3RoIG91ciBgTWVuYCBhbmQgYFdvbWVuYCB0aWJibGVzIHVzaW5nIHRoZSBgYmluZF9jb2xzKClgIGZ1bmN0aW9uLiBUaGlzIHdpbGwgYWRkIHRoZSBgY291bnRyeWAgYXMgYSBuZXcgY29sdW1uIHRvIHRoZSBgV29tZW5gIGRhdGEgb2JqZWN0IG9uIHRoZSBsZWZ0LiAKCmBgYHtyfQpXb21lbiA8LSBkcGx5cjo6YmluZF9jb2xzKGNvdW50cnksIFdvbWVuKQpoZWFkKFdvbWVuKQpgYGAKCgpTaW1pbGFybHksIGZvciB0aGUgZGF0YSBhYm91dCBNZW4sIHRoaXMgd2lsbCBhZGQgdGhlIGBjb3VudHJ5YCBhcyBhIG5ldyBjb2x1bW4gdG8gdGhlIGBNZW5gIGRhdGEgb2JqZWN0IG9uIHRoZSBsZWZ0LiAKYGBge3J9Ck1lbiA8LSBkcGx5cjo6YmluZF9jb2xzKGNvdW50cnksIE1lbikgCmhlYWQoTWVuKQpgYGAKCgojIyMgQ2hhbmdpbmcgdmFyaWFibGUgbmFtZXMKCkhlcmUsIHdlIHdpbGwgY2hhbmdlIHRoZSB2YXJpYWJsZSBuYW1lIGluIHRoZSBgY291bnRyeWAgZGF0YXNldCB0byBgY291bnRyeWAgKGN1cnJlbnRseSBpdCBpcyBjYWxsZWQgYGNvdW50cnlfc3BsaXRgKS4gCldlIHdpbGwgYWxzbyBpbnRyb2R1Y2UgdGhlIGNvbmNlcHQgb2YgdGhlIGFzc2lnbm1lbnQgcGlwZS4gCkluIHRoaXMgY2FzZSBvdXIgcGlwZSBvcGVyYXRvciBsb29rcyBsaWtlIHRoaXMgYCU8PiVgLiAKVXNpbmcgdGhpcyBhZGRpdGlvbmFsIHBpcGUgcmVxdWlyZXMgYW5vdGhlciBwYWNrYWdlLCBjYWxsZWQgYG1hZ3JpdHRyYC4gClRoZSBvdGhlciBzaW1wbGVyIHBpcGUgb3B0aW9ucyBmcm9tIHRoaXMgcGFja2FnZSBhcmUgbG9hZGVkIHdpdGggYHRpZHl2ZXJzZWAgKGlmIHlvdSB1c2VkIGBsaWJyYXJ5KHRpZHl2ZXJzZSlgIHdoaWNoIGxvYWRzIG1vc3QgdGlkeXZlcnNlIHBhY2thZ2VzKSwgYnV0IG5vdCB0aGlzIHZlcnNpb24uIAoKVGhlIGA+YCBwb3J0aW9uIG9mIHRoZSBwaXBlIHN0aWxsIGJlaGF2ZXMgbGlrZSBhIG5vcm1hbCBwaXBlLCB3aGlsZSB0aGUgYDxgIHBvcnRpb24gb2YgdGhlIHBpcGUgbWFrZXMgYW4gYXNzaWdubWVudCB0byB3aGF0ZXZlciB0aGUgYDxgaXMgcG9pbnRpbmcgdG8sIGp1c3QgbGlrZSB3aGVuIHdlIHVzZSB0aGUgdHlwaWNhbCBhc3NpZ25tZW50IG9wZXJhdG9yIGA8LWAuIAoKYGBge3J9CiMgbGlicmFyeShtYWdyaXR0cikgCiMgV2UgY2FuJ3QgdXNlIHRoZSBgJTw+JWAgdW5sZXNzIHdlIGxvYWQgdGhlIG1hZ3JpdHRyIHBhY2thZ2UKIyBXZSBoYXZlIGFscmVhZHkgZG9uZSB0aGlzIGJ1dCB3ZSBpbmNsdWRlIHRoaXMgZm9yIGlsbHVzdHJhdGl2ZSBwdXJwb3Nlcy4KIyBIZXJlIHdlIHdpbGwganVzdCB1c2UgdGhlIHRyYWRpdGlvbmFsIGFzc2lnbm1lbnQgc3RyYXRlZ3kKCldvbWVuIDwtIGRwbHlyOjpyZW5hbWUoV29tZW4sIENvdW50cnkgPSBjb3VudHJ5X3NwbGl0KSAKYGBgCkhlcmUsIHdlIGhhdmUgcmVuYW1lZCB0aGUgYGNvdW50cnlfc3BsaXRgIHZhcmlhYmxlIHRvIGJlIGNhbGxlZCBgQ291bnRyeWAuIAoKSGVyZSwgd2UgcmVhc3NpZ24gYE1lbmAgdXNpbmcgdGhlIHBpcGUgc3RyYXRlZ3kuIApgYGB7cn0KTWVuICU8PiUgcmVuYW1lKENvdW50cnkgPSBjb3VudHJ5X3NwbGl0KSAKYGBgCldlIGhhdmUgcmVuYW1lZCB0aGUgYGNvdW50cnlfc3BsaXRgIHZhcmlhYmxlIHRvIHRvIGJlIGNhbGxlZCBgQ291bnRyeWAuIApXZSBoYXZlIGFsc28gcmVhc3NpZ25lZCBgTWVuYCB0byB0aGUgc2FtZSBkYXRhIG9iamVjdC4gd2hpY2ggaGFzIHRoZSBgQ291bnRyeWAgdmFyaWFibGUgcmVuYW1lZC4gCgpMZXQncyB0YWtlIGEgbG9vayBhdCBvdXIgZGF0YSBmb3IgYE1lbmAgYW5kIGBXb21lbmA6CgpgYGB7cn0KaGVhZChXb21lbikKaGVhZChNZW4pCmBgYAojIyMgSm9pbmluZyB0aGUgZGF0YQoKTm93IHRoYXQgYm90aCBvZiB0aGVzZSB0aWJibGVzIGhhdmUgdGhlIHNhbWUgc3RydWN0dXJlLCB3ZSBjYW4gY29tYmluZSBvdXIgYE1lbmAgYW5kIGBXb21lbmAgZGF0YSB1c2luZyB0aGUgYGJpbmRfcm93cygpYCBmdW5jdGlvbiBvZiBgZHBseXJgLiBUaGlzIHdpbGwgY29tYmluZSBhbGwgb2YgdGhlIHJvd3MgYmFzZWQgb24gdGhlaXIgc2ltaWxhciBjb2x1bW4gc3RydWN0dXJlLgpBbGwgb2YgdGhlIG1hbGUgZGF0YSAgd2lsbCBiZSBmaXJzdCBhbmQgYWxsIHRoZSBmZW1hbGUgZGF0YSB3aWxsIGJlIHNlY29uZC4KCmBgYHtyfQpCTUkgPC0gZHBseXI6OmJpbmRfcm93cyhNZW4sIFdvbWVuKQpgYGAKCkxldCdzIGNoZWNrIHRoZSBzaXplIG9mIG91ciBCTUkgZGF0YS4uLiBpdCBzaG91bGQgaGF2ZSA0MDAgcm93cyAob2JzKS4gV2UgY2FuIHNlZSB0aGUgZW5kIG9mIHRoZSBgQk1JYCBkYXRhIHVzaW5nIHRoZSAgYHRhaWwoKWAgZnVuY3Rpb246CmBgYHtyfQpzdHIoQk1JKQp0YWlsKEJNSSkKYGBgCgojIyMgU29ydGluZyB0aGUgZGF0YQoKTm93LCBsZXQncyBzb3J0IHRoZSBkYXRhIGFscGhhYmV0aWNhbGx5IGJ5IGBDb3VudHJ5YCB1c2luZyB0aGUgYGFycmFuZ2UoKWAgZnVuY3Rpb24gZnJvbSB0aGUgYGRwbHlyYCBwYWNrYWdlOgoKYGBge3J9CkJNSSA8LSBkcGx5cjo6YXJyYW5nZShCTUksIENvdW50cnkpCmhlYWQoQk1JKQpgYGAKCk91ciBkYXRhIGlzIGxvb2tpbmcgZ3JlYXQhIAoKTm93LCB3ZSBtaWdodCB3YW50IHRvIG1ha2Ugc3VyZSB0aGF0IG91ciBvYnNlcnZhdGlvbnMgZm9yIGVhY2ggdmFyaWFibGUgbG9vayB0aGUgd2F5IHdlIHdhbnQuIApJbiBvdGhlciB3b3JkcywgaWYgd2Ugd2FudCB0byBtYWtlIHBsb3RzIGFib3V0IE5hdGlvbmFsIEJNSSBpbiAxOTg1IHRoZW4gd2Ugd291bGQgbmVlZCBvdXIgdmFsdWVzIHRvIGJlIG51bWVyaWMuIApMb29raW5nIGF0IG91ciBCTUkgZGF0YSB1c2luZyBgc3RyKClgLCB3ZSBjYW4gc2VlIHRoZSB0eXBlIG9mIGRhdGEgZm9yIGVhY2ggb2Ygb3VyIHZhcmlhYmxlcyBsaXN0ZWQganVzdCBhZnRlciB2YXJpYWJsZSBuYW1lIGFuZCB0aGUgYCI6ImAgY29sb24uIAoKYGBge3IsIHdhcm5pbmc9RkFMU0UsIGV2YWx9CnN0cihCTUkpCmBgYAoKTG9va3MgbGlrZSBub25lIG9mIG91ciBCTUkgZGF0YSBpcyBhY3R1YWxseSBgbnVtZXJpY2AgKG9yIGBudW1gKSwgYnV0IG9mIHRoZSBjbGFzcyBgY2hhcmFjdGVyYCAob3IgYGNocmApLiAKTGV0J3MgY2hhbmdlIHRoYXQgbm93LgoKVG8gc3RhcnQsIHdlIGNvdWxkIGNoYW5nZSB0aGVzZSB2YWx1ZXMgdG8gYmUgbnVtZXJpYyB3aXRoIDYgbGluZXMgb2YgY29kZSBsaWtlIHRoaXM6CgpgYGB7ciwgZXZhbCA9IFRSVUV9CkJNSSROYXRpb25hbF9CTUlfMTk4NSAlPD4lIGFzLm51bWVyaWMKQk1JJFJ1cmFsX0JNSV8xOTg1ICU8PiUgYXMubnVtZXJpYwpCTUkkVXJiYW5fQk1JXzE5ODUgJTw+JSBhcy5udW1lcmljCgpCTUkkTmF0aW9uYWxfQk1JXzIwMTcgJTw+JSBhcy5udW1lcmljCkJNSSRSdXJhbF9CTUlfMjAxNyAlPD4lIGFzLm51bWVyaWMKQk1JJFVyYmFuX0JNSV8yMDE3ICU8PiUgYXMubnVtZXJpYwpgYGAKCkFuZCBpZiB3ZSBkaWQgdGhpcyB3ZSB3b3VsZCBzZWUgdGhlc2UgdmFyaWFibGVzIHNob3cgYXMgYCJudW0iYCB3aGljaCBzdGFuZHMgZm9yIGEgbnVtZXJpYyB0eXBlIG9mIHZhcmlhYmxlLgpgYGB7cn0Kc3RyKEJNSSkKYGBgCgpPciB3ZSBjYW4gdXNlIGEgbW9yZSBhdXRvbWF0ZWQgd2F5IHdpdGggdGhlIGBtYXAoKWAgZnVuY3Rpb24gb2YgdGhlIGBwdXJycmAgcGFja2FnZToKYGBge3J9CkJNSV9udW1lcmljIDwtIAogIHB1cnJyOjptYXAoKEJNSSAlPiUgCiAgICAgICAgICAgICAgICBzZWxlY3QoLW1hdGNoZXMoIkNJfFNleHxDb3VudHJ5IikpKSwKICAgICAgICAgICAgIGFzLm51bWVyaWMpICU+JSAKICBhc190aWJibGUoKQpgYGAKClRoZSBgbWFwKClgIGZ1bmN0aW9uIG9mIHRoZSBgcHVycnJgIHBhY2thZ2UgYWxsb3dzIHVzIHRvIGFwcGx5IHRoZSBgYXMubnVtZXJpYygpYCBmdW5jdGlvbiB0byBhbGwgdGhlIHNlbGVjdGVkIGNvbHVtbnMgb2YgYEJNSWAgZGF0YXNldC4KQWJvdmUsIHdlIGhhdmUgc2VsZWN0ZWQgdGhvc2UgdGhhdCBkb24ndCBjb250YWluIGBDSWAsIGBTZXhgLCBvciBgQ291bnRyeWAgaW4gdGhlIGNvbHVtbiBuYW1lLiAKSWYgeW91IGFyZSBmYW1pbGlhciB3aXRoIGBhcHBseSgpYCwgdGhpcyBmdW5jdGlvbiBpcyB2ZXJ5IHNpbWlsYXIuCgpOb3cgd2UgbmVlZCB0byBhZGQgdGhlIGBDb3VudHJ5YCBhbmQgYFNleGAgdmFyaWFibGVzIGJhY2sgdG8gb3VyIG5ldyBudW1lcmljIGRhdGFzZXQuCgpgYGB7cn0KQk1JX251bWVyaWMgJTw+JSAKICBtdXRhdGUoQ291bnRyeSA9IHB1bGwoQk1JLCBDb3VudHJ5KSwgCiAgICAgICAgIFNleCA9IHB1bGwoQk1JLCBTZXgpKQpoZWFkKEJNSV9udW1lcmljKQpgYGAKCkluIHRoaXMgY2FzZSBvdXIgbnVtZXJpYyBkYXRhIGlzIG9mIGEgY2xhc3MgYGRibGAuIApUaGlzIG1lYW5zIGRvdWJsZS1wcmVjaXNpb24gZmxvYXRpbmcgcG9pbnQgbnVtYmVycyAod2l0aCBkZWNpbWFscykuClRoZSBhbHRlcm5hdGl2ZSBudW1lcmljIG9wdGlvbiBpcyB0aGUgaW50ZWdlciBjbGFzcy4gCgojIyMgVHJhbnNmb3JtaW5nIHRvIGxvbmcgZm9ybWF0CgpJdCBpcyBnZW5lcmFsbHkgdXNlZnVsIHRvIGdldCB0aGUgZGF0YSBpbiB3aGF0IGlzIGNhbGxlZCA8Yj5sb25nPC9iPiBmb3JtYXQgZm9yIG90aGVyIGFuYWx5c2VzLCBhbmQgcGFydGljdWxhcmx5IGZvciBwbG90dGluZy4gCgpGb3IgYSBtb3JlIGRldGFpbGVkIGRlc2NyaXB0aW9uIGFib3V0IHRoaXMsIHBsZWFzZSBzZWUgdGhpcyBbY2FzZSBzdHVkeV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1oZWFsdGhleHBlbmRpdHVyZS9vY3MtaGVhbHRoZXhwZW5kaXR1cmUuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifS4KCkJhc2ljYWxseSwgdGhlIGxvbmcgZm9ybWF0IHdpbGwgaGF2ZSBtb3JlIHJvd3MgYW5kIGZld2VyIGNvbHVtbnMuClRodXMsIHdlIGNhbiBjb21iaW5lIG9yIGAiZ2F0aGVyImAgc29tZSBjb2x1bW5zIHRvZ2V0aGVyLgpJbiBvdXIgY2FzZSwgd2UgY2FuIHB1dCBhbGwgdGhlIGRpZmZlcmVudCBCTUkgZGF0YSB0b2dldGhlciBpbiBvbmUgbG9uZyBjb2x1bW4uCldlIHdpbGwgY3JlYXRlIGEgbmV3IGNvbHVtbiB0aGF0IHRlbGxzIHVzIHdoYXQgZWFjaCByb3cgb2YgdGhlIG5ldyBCTUkgY29sdW1uIHJlcHJlc2VudHMuCkluIG90aGVyIHdvcmRzLCBpdCB3aWxsIHRlbGwgdXMgd2hhdCB0aGUgb3JpZ2luYWwgY29sdW1uIHdhcy4KClRvIGRvIHRoaXMgd2Ugd2lsbCB1c2UgdGhlIGBnYXRoZXIoKWAgZnVuY3Rpb24gb2YgdGhlIGB0aWR5cmAgcGFja2FnZToKCmBgYHtyfQpCTUlfbG9uZyA8LQogIHRpZHlyOjpnYXRoZXIoZGF0YSA9IEJNSV9udW1lcmljLCAKICAgICAgICAgICAgICAgIGtleSA9IGNsYXNzX0JNSSwgCiAgICAgICAgICAgICAgICB2YWx1ZSA9IEJNSSwgCiAgICAgICAgICAgICAgICBOYXRpb25hbF9CTUlfMTk4NTpVcmJhbl9CTUlfMjAxNywgCiAgICAgICAgICAgICAgICBmYWN0b3Jfa2V5ID0gRkFMU0UpIApgYGAKVGhlIGBkYXRhYCB2YWx1ZSBpbmRpY2F0ZXMgd2hhdCBkYXRhIHlvdSBzdGFydCB3aXRoLCB0aGUgYGtleWAgaW5kaWNhdGVzIHRoZSBuZXcgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgd2lsbCBub3cgY29udGFpbiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdmFsdWVzIG9mIHRoZSBjb2x1bW5zIHdlIHdpbGwgcHV0IHRvZ2V0aGVyLiAKVGhlIGB2YWx1ZWAgaXMgdGhlIG5hbWUgb2YgdGhlIGNvbHVtbiBmb3IgdGhlIHZhbHVlcyBmb3IgYWxsIHRoZSBjb2x1bW5zIHRoYXQgYXJlIGJlaW5nIHB1dCB0b2dldGhlci4gClRoZSBgIjoiYCBjYW4gYmUgdXNlZCB0byBpZGVudGlmeSB0aGUgc3RhcnQgYW5kIGVuZCBvZiB0aGUgY29sdW1uIG5hbWVzIHRoYXQgeW91IGFyZSBwdXR0aW5nIHRvZ2V0aGVyLiAKVGhlIGBmYWN0b3Jfa2V5YCBhcmd1bWVudCBkZXRlcm1pbmVzIGlmIHRoZSBuZXdseSBjcmVhdGVkIGtleSBjb2x1bW4gc2hvdWxkIGJlIGV2YWx1YXRlZCBhcyBhIGZhY3RvciBvciBub3QuIAoKYGBge3J9CmhlYWQoQk1JX2xvbmcpCmBgYAoKSXQgd291bGQgYmUgdXNlZnVsIHRvIHBhcnNlIHRoZSAxOTg1IGFuZCB0aGUgMjAxNyBkYXRhLiBXZSBjYW4gZG8gc28gYnkgc2VwYXJhdGluZyB0aGUgcGFydHMgb2YgdGhlIGBjbGFzc19CTUlgIGNvbHVtbiB1c2luZyB0aGUgYHNlcGFyYXRlKClgIGZ1bmN0aW9uIG9mIHRoZSBgdGlkeXJgIHBhY2thZ2UuIApJbiBvdXIgY2FzZSB3ZSB3aWxsIHJlcGxhY2UgdGhlIGBjbGFzc19CTUlgIGNvbHVtbiB3aXRoIHR3byBuZXcgY29sdW1ucy4KCmBgYHtyfQpCTUlfbG9uZyAlPD4lIAogIHRpZHlyOjpzZXBhcmF0ZShjbGFzc19CTUksIAogICAgICAgICAgICAgICAgICBjKCJSZWdpb24iLCBOQSwgIlllYXIiKSkgCmBgYApIZXJlLCB3ZSBzZXBhcmF0ZSB0aGUgYGNsYXNzX0JNSWAgY29sdW1uIG9mIHRoZSBgQk1JX2xvbmdgIHRpYmJsZS4gClRoaXMgaXMgYmFzZWQgb24gdGhlIHVuZGVyc2NvcmVzIGFuZCBjcmVhdGUgdHdvIG5ldyBjb2x1bW5zLiAKVGhlIGZpcnN0IGNvbHVtbiB3aWxsIGJlIGNhbGxlZCBgUmVnaW9uYC4gCkl0IHdpbGwgY29udGFpbiB0aGUgMXN0IHBhcnQgb2YgdGhlIGBjbGFzc19CTUlgIGRhdGEgYmVmb3JlIHRoZSAxc3QgdW5kZXJzY29yZS4gClRoZSAybmQgY29sdW1uIHdpbGwgYmUgY2FsbGVkIGBZZWFyYC4KSXQgd2lsbCBjb250YWluIHRoZSAzcmQgcGFydCBvZiB0aGUgZGF0YSBiYXNlZCBvbiB1bmRlcnNjb3Jlcy4KVGhlIG1pZGRsZSBwYXJ0IG9mIHRoZSBjb2x1bW4gd2lsbCBub3QgYmUgdXNlZCB0byBjcmVhdGUgYW55IG5ldyBjb2x1bW5zLiAKCmBgYHtyfQpoZWFkKEJNSV9sb25nKQpgYGAKCkxldCdzIHNlZSBob3cgdGhlIGRpbWVuc2lvbnMgb2YgdGhlIGBCTUlgIGRhdGEgaGF2ZSBjaGFuZ2VkIGluIGxvbmcgZm9ybWF0OgpgYGB7cn0KZGltKEJNSV9udW1lcmljKQpkaW0oQk1JX2xvbmcpCmBgYAoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8dT5RdWVzdGlvbiBvcHBvcnR1bml0eTo8L3U+IFdoeSBleGFjdGx5IGFyZSB0aGVyZSAyLDQwMCByb3dzIG5vdz8KCiMjIyMKCkdyZWF0ISBvdXIgZGF0YSBpcyB2ZXJ5IHVzYWJsZSBub3cgaW4gdGhpcyBmb3JtYXQhCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpzYXZlKEJNSV9udW1lcmljLCAKICAgICBCTUlfbG9uZywgCiAgICAgZmlsZSA9IGhlcmUoImRhdGEiLCAiV3JhbmdsZWRfZGF0YS5yZGEiKSkKCmBgYAoKIyMgRGF0YSBFeHBsb3JhdGlvbgoKTm93IHRoYXQgb3VyIGRhdGEgaXMgY2xlYW4gYW5kIGluIGEgZm9ybWF0IHRoYXQgd2UgY2FuIHdvcmsgd2l0aCwgd2UgY2FuIHN0YXJ0IHRvIHRha2UgYSBsb29rIGF0IHRoZSBkYXRhIGFuZCBob3cgZGlmZmVyZW50IGdyb3VwcyBtaWdodCBjb21wYXJlLgoKR29pbmcgYmFjayB0byBvbmUgb2Ygb3VyIG9yaWdpbmFsIHF1ZXN0aW9ucywgCgo+IElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/CgpXZSB3YW50IHRvIHVzZSBhIHN0YXRpc3RpY2FsIHRlc3QgdG8gaWRlbnRpZnkgaWYgdGhlcmUgYXJlIGRpZmZlcmVuY2VzIGluIHRoZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZXMgYmV0d2VlbiBlLmcuIHJ1cmFsIGFuZCB1cmJhbiBncm91cHMuIApGaXJzdCwgbGV0J3MgZXhwbG9yZSBvdXIgZGF0YSBhIGJpdC4gCgojIyMgR2VuZXJhbCBzdW1tYXJ5CgpgYGB7ciwgZWNobyA9IEZBTFNFfQojIFN0YXJ0IGhlcmUgaWYgbm90IHdvcmtpbmcgdGhyb3VnaCBkYXRhIGltcG9ydCBhbmQgd3JhbmdsaW5nCmxvYWQoaGVyZSgiZGF0YSIsICJXcmFuZ2xlZF9kYXRhLnJkYSIpKQpgYGAKCmBgYHtyfQpzdW1tYXJ5KEJNSV9udW1lcmljKQpgYGAKV2UgY2FuIHNlZSB0aGF0IHRoZSBtZWFuIEJNSSBlc3RpbWF0ZXMgYXJlIGxhcmdlciBpbiAyMDE3LgpIb3dldmVyLCBpcyB0aGlzIGEgbWVhbmluZ2Z1bCBpbmNyZWFzZT8KVGhpcyBpcyBkaWZmaWN1bHQgdG8gZGV0ZXJtaW5lIHdpdGhvdXQgYSBzdGF0aXN0aWNhbCB0ZXN0LgoKTGV0cyBsb29rIGF0IHRoZSBkYXRhIHN0cmF0aWZpZWQgYnkgYFNleGA6CgpgYGB7cn0KQk1JX251bWVyaWMgJT4lIAogIHN1YnNldChTZXggPT0gIldvbWVuIikgJT4lIAogIHN1bW1hcnkoKQpgYGAKCmBgYHtyfQpCTUlfbnVtZXJpYyAlPiUgCiAgc3Vic2V0KFNleCA9PSAiTWVuIikgJT4lIAogIHN1bW1hcnkoKQpgYGAKCkl0IGxvb2tzIGxpa2UgbWVhbiBCTUlzIGhhdmUgaW5jcmVhc2VkIGluIGFsbCByZWdpb25zIGZvciBib3RoIG1lbiBhbmQgd29tZW4uIEl0IGlzIHVuY2xlYXIgdGhvdWdoIGlmIHRoaXMgY2hhbmdlIGlzIHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQuCgojIyMgRGlzdHJpYnV0aW9ucwoKSW4gb3JkZXIgdG8gYXBwbHkgYSBzdGF0aXN0aWNhbCB0ZXN0IHRvIGNvbXBhcmUgdGhlIG1lYW5zLCBvbmUgb2YgdGhlIGZpcnN0IHRoaW5ncyB0byBkbyBpcyB0byBleHBsb3JlIHRoZSBmcmVxdWVuY3kgb2YgdGhlIGRpZmZlcmVudCBvYnNlcnZlZCB2YWx1ZXMuIApPbmUgd2F5IHRvIHN1bW1hcml6ZSB0aGUgZnJlcXVlbmN5IG9mIGRpZmZlcmVudCBvYnNlcnZlZCB2YWx1ZXMgaXMgdGhlIDxiPmZyZXF1ZW5jeSBkaXN0cmlidXRpb248L2I+LCB3aGljaCBjYW4gYmUgc2hvd24gaW4gYSB0YWJsZSBvciBhIHBsb3QuIApTZWUgW2hlcmVdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9pbnRyb2R1Y3Rpb24vZGlzdHJpYnV0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGRpc3RyaWJ1dGlvbnMuIAoKVGhlcmUgYXJlIG90aGVyIHR5cGVzIG9mIGRpc3RyaWJ1dGlvbnMgdG9vLCBzdWNoIGFzIDxiPnByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbnM8L2I+LCB3aGljaCBkZXNjcmliZSB0aGUgcHJvYmFiaWxpdHkgdGhlIG9jY3VycmVuY2Ugb2YgZGlmZmVyZW50IHBvc3NpYmxlIG91dGNvbWVzLiAKUHJvYmFiaWxpdHkgZGlzdHJpYnV0aW9ucyBjYW4gYmUgZGVmaW5lZCBmb3IgZGlzY3JldGUgZGF0YSAoZS5nLiBmbGlwcGluZyBhIGNvaW4gYXMgaGVhZHMgb3IgdGFpbHMpIGFuZCBjb250aW51b3VzIGRhdGEgKGUuZy4gQk1JIGVzdGltYXRlcykuIApJZiB3ZSBhcmUgdGFsa2luZyBhYm91dCBkaXNjcmV0ZSBkYXRhLCB0aGUgcmVsYXRpdmUgZnJlcXVlbmN5IG9mIHRoZSBkaWZmZXJlbnQgY2F0ZWdvcmllcyAoaGVhZHMgb3IgdGFpbHMpIGNhbiBiZSB1c2VkIHRvIGRlZmluZSBhIDxiPmRpc2NyZXRlIHByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbjwvYj4uIApXZSBjYW4gc2ltcGx5IGFzc2lnbiBhIHByb2JhYmlsaXR5IHRvIGVhY2ggY2F0ZWdvcnksIGUuZy4gJFAoaGVhZHMpID0gMC41JCBhbmQgJFAodGFpbHMpID0gMC41JC4gCgo8Yj5Db250aW51b3VzIHByb2JhYmlsaXR5IGRpc3RyaWJ1dGlvbnM8L2I+IHdvcmsgaW4gYSBzaW1pbGFyIHdheSwgZXhjZXB0IGluc3RlYWQgb2YgYXNzaWduaW5nIGEgcHJvYmFiaWxpdHkgdG8gZWFjaCBjYXRlZ29yeSBvciB0eXBlIG9mIG9ic2VydmF0aW9uIChlLmcuIGhlYWRzIG9yIHRhaWxzKSwgd2UgYXNzaWduIGEgcHJvYmFiaWxpdHkgdG8gYW4gaW50ZXJ2YWwgb2YgY29udGludW91cyB2YWx1ZXMgKGUuZy4gQk1JIGJldHdlZW4gMjIgYW5kIDI2KS4gClRoaXMgaXMgYmVjYXVzZSBpdCdzIG5vdCB1c2VmdWwgdG8gY29uc3RydWN0IGEgZGlzdHJpYnV0aW9uIHRoYXQgYXNzaWducyBhIHByb2JhYmlsaXR5IHRvIGVhY2ggcG9zc2libGUgb3V0Y29tZSAoZS5nLiBhIEJNSSBvZiAyMi4xMSwgMjIuMTIsIGV0Yykgd2l0aCBzdWNoIGhpZ2ggcHJlY2lzaW9uLiBJbiB0aGlzIGNhc2UsIHdlIHdvdWxkIGhhdmUgdG8gYXNzaWduIGEgdmVyeSBzbWFsbCBwcm9iYWJpbGl0eSB0byBldmVyeSBwb3NzaWJsZSBCTUkgb3V0Y29tZS4gCgpUaGUgPGI+bm9ybWFsIChvciBHYXVzc2lhbikgZGlzdHJpYnV0aW9uPC9iPiBpcyBhIHR5cGUgb2YgPGI+dGhlb3JldGljYWwgY29udGludW91cyBwcm9iYWJpbGl0eSBkaXN0cmlidXRpb248L2I+IHRoYXQgaXMgZnJlcXVlbnRseSB1c2VkIHRvIGFwcHJveGltYXRlIHRoZSBkaXN0cmlidXRpb24gb2YgbWFueSBuYXR1cmFsbHkgb2NjdXJyaW5nIG1lYXN1cmVtZW50cywgc3VjaCBhcyB0aGF0IG9mIEJNSS4gCldlIHNheSB0aGF0IGEgcmFuZG9tIHF1YW50aXR5ICRYJCAoZS5nLiBCTUkpIGlzIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIHdpdGggbWVhbiAkbSQgYW5kIHN0YW5kYXJkIGRldmlhdGlvbiAkcyQgaWYgdGhlIHByb3BvcnRpb24gb2YgdmFsdWVzIGluIGEgZ2l2ZW4gaW50ZXJ2YWwgJChhLGIpJCAoZS5nLiBCTUkgYmV0d2VlbiAyMiBhbmQgMjYpIGNhbiBiZSBjb21wdXRlZCB1c2luZyB0aGlzIG1hdGhlbWF0aWNhbCBmb3JtdWxhOiAKCiQkUChhIDwgeCA8IGIpID0gXGludF9hXmIgXGZyYWN7MX17XHNxcnR7MlxwaX0gc30gZV57LVxmcmFjezF9ezJ9XGJpZyhcZnJhY3t4LW19e3N9XGJpZyleMn0gICQkCgpUcmFuc2xhdGluZyB0aGlzIHRvIG91ciBjYXNlIHN0dWR5LCBpZiBvdXIgQk1JIGRhdGEgZm9sbG93IGEgbm9ybWFsIGRpc3RyaWJ1dGlvbiB3aXRoIG1lYW4gb2YgJG0gPSAyNCQgYW5kIHN0YW5kYXJkIGRldmlhdGlvbiBvZiAkcyA9IDEkLCB0aGVuIHRoZSBkaXN0cmlidXRpb24gb2YgZGlmZmVyZW50IEJNSSBvdXRjb21lcyBzaG91bGQgYmUgY2VudGVyZWQgYXJvdW5kIHRoYXQgbWVhbiB2YWx1ZSBvZiAyNCBhbmQgd291bGQgbG9vayBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBge3J9Cm5vcm1fQk1JX2V4X2RhdGEgPC0gCiAgdGliYmxlKG5vcm1fZGF0YSA9IHJub3JtKG4gPSAyMDAsIG1lYW4gPSAyNCwgc2QgPSAxKSkKaGlzdChwdWxsKG5vcm1fQk1JX2V4X2RhdGEsIG5vcm1fZGF0YSkpCmBgYAoKSGVyZSB3ZSBhcmUgc2ltdWxhdGluZyAyMDAgb2JzZXJ2YXRpb25zIGZyb20gYSBub3JtYWwgZGlzdHJpYnV0aW9uIHdpdGggYSBtZWFuIG9mICRtID0gMjQkIGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gb2YgJHMgPSAxJCB1c2luZyB0aGUgYHJub3JtKClgIGZ1bmN0aW9uLiAKCkFsdGVybmF0aXZlbHkgdG8gdXNpbmcgYmFzZSBSLCB3ZSBjYW4gcGxvdCB0aGUgZnJlcXVlbmN5IG9mIHNpbXVsYXRlZCBvYnNlcnZhdGlvbnMgdXNpbmcgdGhlIGBnZW9tX2hpc3QoKWAgZnVuY3Rpb24gb2YgdGhlIGBnZ3Bsb3QyYCBSIHBhY2thZ2UuIApUaGUgW2dncGxvdDJdKGh0dHBzOi8vZ2dwbG90Mi50aWR5dmVyc2Uub3JnLyl7dGFyZ2V0PSJfYmxhbmsifSBwYWNrYWdlIGNyZWF0ZXMgcGxvdHMgYnkgdXNpbmcgbGF5ZXJzLgpOb3RpY2UgaW4gdGhlIGZvbGxvd2luZyBjb2RlIGhvdyB0aGVyZSBpcyBhIHBsdXMgc2lnbiBiZXR3ZWVuIHRoZSBgZ2dwbG90KClgIGZ1bmN0aW9uIGFuZCB0aGUgYGdlb21faGlzdG9ncmFtKClgIGZ1bmN0aW9uLiAKV2l0aCBgZ2dwbG90MmAgd2Ugc2VsZWN0IHdoYXQgZGF0YSB3ZSB3b3VsZCBsaWtlIHRvIHBsb3QgdXNpbmcgdGhlIGZpcnN0IGZ1bmN0aW9uIChgZ2dwbG90KClgKSBhbmQgdGhlbiB3ZSBhZGQgb24gYWRkaXRpb25hbCBsYXllcnMgb2YgY29tcGxleGl0eSAodGhlc2UgbGF5ZXJzIGNhbiBldmVuIGludm9sdmUgZGlmZmVyZW50IGRhdGEpLiAKYGBge3J9CiAgZ2dwbG90Mjo6Z2dwbG90KG5vcm1fQk1JX2V4X2RhdGEsIGFlcyh4ID0gbm9ybV9kYXRhKSkgKyAKICBnZ3Bsb3QyOjpnZW9tX2hpc3RvZ3JhbSgpIApgYGAKCkhlcmUsIHdlIGFyZSB1c2luZyB0aGUgY29sdW1uIGNhbGxlZCBgbm9ybV9kYXRhYCB3aXRoaW4gYG5vcm1fQk1JX2V4X2RhdGFgLgpBcyB3ZSBub3RlZCwgd2l0aCBgZ2dwbG90MmAgd2UgbXVzdCBmaXJzdCBzcGVjaWZ5IHRoZSBkYXRhIHRvIHBsb3Qgd2l0aCB0aGUgYGdncGxvdCgpYCBmdW5jdGlvbi4gClRoZW4sIHRoZSBgZ2VvbV8qYCBmdW5jdGlvbiBzcGVjaWZpZXMgd2hhdCB0eXBlIG9mIHBsb3QgdG8gY3JlYXRlIChlLmcuIGBnZW9tX2hpc3RvZ3JhbSgpYCBjcmVhdGUgYSBoaXN0b2dyYW0pLiAKCldlIGNvdWxkIGFsc28gbWFrZSB0aGlzIHNhbWUgcGxvdCBieSBwaXBpbmcgdGhlIGBub3JtX0JNSV9leF9kYXRhYCBkYXRhIGludG8gdGhlIGBnZ3Bsb3QoKWAgZnVuY3Rpb246CmBgYHtyfQpub3JtX0JNSV9leF9kYXRhICU+JSAKICBnZ3Bsb3QyOjpnZ3Bsb3QoYWVzKHggPSBub3JtX2RhdGEpKSArIAogIGdncGxvdDI6Omdlb21faGlzdG9ncmFtKCkgCmBgYAoKV2Ugd2lsbCBzZWUgbGF0ZXIgaG93IHdlIGNhbiBhZGQgbWFueSBsYXllcnMgdG8gcGxvdHMgd2l0aCBgZ2dwbG90MmAuIEZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIG9uIHVzaW5nIGBnZ3Bsb3QyYCwgc2VlIHRoaXMgW2Nhc2Ugc3R1ZHldKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uCgoKTm93IGluc3RlYWQgb2YgdXNpbmcgc2ltdWxhdGVkIGRhdGEgZnJvbSBhIG5vcm1hbCBkaXN0cmlidXRpb24sIGxldCdzIG1ha2UgYSBoaXN0b2dyYW0gb2Ygb3VyIEJNSSBkYXRhOgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGdncGxvdChhZXMoeCA9IEJNSSkpICsgCiAgZ2VvbV9oaXN0b2dyYW0oKSAKYGBgCgpJbnRlcmVzdGluZyEgVGhlIGRhdGEgbG9va3MgbGlrZSBpdCBoYXMgb25lIG1vZGUsIGJ1dCBsaWtlIGl0IGlzIHdoYXQgd2UgY2FsbCA8Yj5yaWdodC1za2V3ZWQ8L2I+IGJlY2F1c2UgdGhlIHRhaWwgb2YgdGhlIGRpc3RyaWJ1dGlvbiBpcyBsb25nZXIgb24gdGhlIHJpZ2h0IHNpZGUgKGluIG90aGVyIHdvcmRzLCBpdCBpcyBhIGJpdCB3aWRlciBvbiB0aGF0IHNpZGUpLiAKU2VlIFtoZXJlXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvZ2xvc3Nhcnkvc2tldy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHNrZXdlZCBkaXN0cmlidXRpb25zLgoKSWYgd2Ugc3BsaXQgKG9yICJmYWNldCIpIG91ciBkYXRhIGJ5IGBTZXhgLCB3aGF0IGRvIHRoZSBmcmVxdWVuY3kgZGlzdHJpYnV0aW9ucyBsb29rIGxpa2U/IApUaGUgZWFzaWVzdCB3YXkgdG8gZG8gdGhpcyBpcyB0byB1c2Ugc29tZSBvdGhlciBmdW5jdGlvbnMgb2YgdGhlIGBnZ3Bsb3QyYCBwYWNrYWdlLCBwYXJ0aWN1bGFybHkgdGhlIGBmYWNldF93cmFwKClgIGZ1bmN0aW9uLCB3aGljaCB3aWxsIGFsbG93IHVzIHRvIGxvb2sgYXQgZGlmZmVyZW5jZXMgaW4gdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgQk1JIGVzdGltYXRlcyBzdHJhdGlmaWVkIGJ5IGBZZWFyYCwgYFNleGAsIGFuZCBgUmVnaW9uYC4KV2UgY2FuIHNlcXVlbnRpYWxseSBkaXZpZGUgb3VyIHBsb3RzIGJ5IGRlZXBlciBsZXZlbHMgdXNpbmcgbXVsdGlwbGUgdmFyaWFibGVzIGFuZCB0aGUgYCtgIHBsdXMgc2lnbiB3aXRoaW4gYGZhY2V0X3dyYXAoKWAuCgpgYGB7cn0KQk1JX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyh4PUJNSSkpICsKICBnZW9tX2hpc3RvZ3JhbSgpICsKICBmYWNldF93cmFwKH4gU2V4KQoKQk1JX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyh4PUJNSSkpICsKICBnZW9tX2hpc3RvZ3JhbSgpICsKICBmYWNldF93cmFwKH4gU2V4ICsgWWVhcikgCgpCTUlfbG9uZyAlPiUKICBnZ3Bsb3QoYWVzKHg9Qk1JKSkgKwogIGdlb21faGlzdG9ncmFtKCkgKwogIGZhY2V0X3dyYXAofiBTZXggKyBZZWFyICsgUmVnaW9uKSAKYGBgCgpTb21lIG9mIHRoZXNlIHBsb3RzIGxvb2sgcHJldHR5IHNpbWlsYXIgdG8gYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBsaWtlIHRoZSBgV29tZW4gMjAxNyBVcmJhbmAgcGxvdCAoYWx0aG91Z2ggaXQgaXMgcmlnaHQtc2tld2VkKS4KSG93ZXZlciBzb21lIG9mIHRoZSBvdGhlciBwbG90cywgbGlrZSB0aGUgYE1lbiAyMDE3IFVyYmFuYCBwbG90LCBsb29rIHZlcnkgZGlmZmVyZW50LiAKVGhlc2UgcGxvdHMgc2hvdyB3aGF0IGlzIGNhbGxlZCBhIFtiaW1vZGFsIGRpc3RyaWJ1dGlvbl0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0sIG1lYW5pbmcgdGhhdCB0aGVyZSBhcHBlYXIgdG8gYmUgdHdvIHBlYWtzIChvciBtb2RlcyksIG9yIGluIG90aGVyIHdvcmRzIHR3byBkaWZmZXJlbnQgdmFsdWVzIChhbmQgdmFsdWVzIG5lYXIgZWFjaCBvZiB0aGVzZSkgdGhhdCBhcmUgdGhlIG1vc3QgZnJlcXVlbnQuCgojIyMgUXVhbnRpbGUtUXVhbnRpbGUgUGxvdHMKCkFub3RoZXIgdXNlZnVsIHBsb3QgdG8gY3JlYXRlIHdoZW4gZXhwbG9yaW5nIGRpc3RyaWJ1dGlvbnMgaXMgc29tZXRoaW5nIGNhbGxlZCBhICJxdWFudGlsZS1xdWFudGlsZSIgcGxvdCAob3IgPGI+US1RIHBsb3Q8L2I+IGZvciBzaG9ydCkuIFdoZW4gd2UgdGFsayBhYm91dCBhIDxiPnF1YW50aWxlPC9iPiwgd2UgYXJlIHRhbGtpbmcgYWJvdXQgZGl2aWRpbmcgdXAgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgZGF0YSBpbnRvIHJvdWdobHkgZXF1YWwgcG9ydGlvbnMgd2hlcmUgcm91Z2hseSB0aGUgc2FtZSBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIGZhbGwgaW50byBlYWNoIHBvcnRpb24uIEZvciBleGFtcGxlLCBpZiB5b3UgZGl2aWRlIHlvdXIgZGF0YSBpbnRvIDEwMCBxdWFudGlsZXMsIHlvdSBjYW4gdGhpbmsgYWJvdXQgdGhpcyBhcyBwZXJjZW50aWxlcywgYnV0IHlvdSBjb3VsZCBhbHNvIGRpdmlkZSB5b3VyIGRhdGEgaW50byAxMCBxdWFudGlsZXMgYW5kIHRoZXNlIHdvdWxkIGJlIGNhbGxlZCBkZWNpbGVzLiAKCjxiPldoeSBRLVEgcGxvdHM/PC9iPiBUaGlzIHBsb3QgYWxsb3dzIHVzIHRvIGNvbXBhcmUgdGhlIHF1YW50aWxlcyBvZiB0d28gZGlzdHJpYnV0aW9ucyB0b2dldGhlcjogKDEpIHF1YW50aWxlcyBvZiBhIGtub3duIHRoZW9yZXRpY2FsIGRpc3RyaWJ1dGlvbiAobGlrZSB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbikgY29tcGFyZWQgdG8gKDIpIHF1YW50aWxlcyBvZiB0aGUgZGlzdHJpYnV0aW9uIG9mIG91ciBkYXRhLiAgSWYgdGhlIHF1YW50aWxlcyBmcm9tIHRoZXNlIHR3byBkaXN0cmlidXRpb25zIGxpbmUgdXAgaW4gdGhlIHBsb3QsIHRoZW4gdGhhdCBpcyBhIHZpc3VhbCBwaWVjZSBvZiBldmlkZW5jZSB0aGF0IG91ciBkYXRhIGZvbGxvdyB0aGF0IHRoZW9yZXRpY2FsIGRpc3RyaWJ1dGlvbiAobGlrZSB0aGUgbm9ybWFsIGRpc3RyaWJ1dGlvbikuICAKCjxiPkhvdyBkb2VzIHRoaXMgd29yaz88L2I+IFRvIGRvIHRoaXMgd2Ugd2lsbCBwbG90IHRoZSBxdWFudGlsZXMgb2Ygb3VyIGRhdGEgb24gdGhlIHktYXhpcyBhbmQgdGhlIHF1YW50aWxlcyBvZiB0aGUgdGhlb3JldGljYWwgbm9ybWFsIGRpc3RyaWJ1dGlvbiBvbiB0aGUgeC1heGlzLiBJZiB0aGUgcXVhbnRpbGVzIGxpbmUgdXAgdGhlbiB3ZSBjYW4gc2F5IHRoYXQgb3VyIGRhdGEgaXMgZmFpcmx5IG5vcm1hbC4gU2VlIFtoZXJlXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvYWR2YW5jZWRfZ3JhcGhzL3EtcV9wbG90cy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IFEtUSBwbG90cy4KClVzaW5nIHRoZSBgc3RhdF9xcSgpYCBmdW5jdGlvbiBvZiB0aGUgYGdncGxvdDJgIHBhY2thZ2UsIHdlIGNhbiBlYXNpbHkgY3JlYXRlIGEgUS1RIHBsb3QgZm9yIG91ciBkYXRhIHJhbmRvbWx5IHNhbXBsZWQgZnJvbSBhIG5vcm1hbCBkaXN0cmlidXRpb24gKCJzYW1wbGUiKSBhbmQgY29tcGFyZSBpdCB0byB0aGUgcXVhbnRpbGVzIGZyb20gYSBub3JtYWwgZGlzdHJpYnV0aW9uICgidGhlb3JldGljYWwiKS4gIFRoZSBkZWZhdWx0IGNvbXBhcmlzb24gZGlzdHJpYnV0aW9uIGZvciB0aGVzZSBmdW5jdGlvbnMgaXMgdGhlIG5vcm1hbCBkaXN0cmlidXRpb24sIHNvIHdlIGRvbid0IG5lZWQgdG8gc3BlY2lmeSBpdCBpbiBvdXIgY29kZS4KYGBge3J9Cm5vcm1fQk1JX2V4X2RhdGEgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBub3JtX2RhdGEpKSArCiAgc3RhdF9xcSgpICsgCiAgc3RhdF9xcV9saW5lKCkKYGBgCgpUaGUgYHN0YXRfcXFfbGluZSgpYCBmdW5jdGlvbiBpcyB1c2VkIHRvIGFkZCBhIGxpbmUgKGNvbXB1dGVzIHRoZSBzbG9wZSBhbiBpbnRlcmNlcHQpIG9uIHRoZSBwbG90LiAKTm90IHN1cnByaXNpbmdseSwgd2Ugc2VlIHRoYXQgdGhlIHBvaW50cyBtb3N0bHkgZmFsbCBvbiB0aGUgbGluZSwgaW5kaWNhdGluZyB0aGF0IHRoZSBxdWFudGlsZXMgYXJlIGZhaXJseSBzaW1pbGFyIGJldHdlZW4gdGhlIG9ic2VydmVkIGFuZCB0aGVvcmV0aWNhbCBkYXRhLgpUaGVyZSBhcmUgc29tZSBwb2ludHMgdGhhdCBhcmUgYSBiaXQgZnVydGhlciBmcm9tIHRoZSBsaW5lIGFzIHdlIGdldCB0byB0aGUgZXh0cmVtZSBxdWFudGlsZXMuIApOb3RpY2UgdGhhdCB0aGUgc2FtcGxlIHF1YW50aWxlcyAoeS1heGlzIGFyZSBpbiBhIGZhaXJseSBzaW1pbGFyIHJhbmdlIHRvIG91ciByZWFsIEJNSSBkYXRhIHF1YW50aWxlcy4gClNvIHZhbHVlcyB0aGF0IGFyZSBiZWxvdyAyMiwgZm9yIGV4YW1wbGUsIGFyZSByZXByZXNlbnRlZCBhcyB0aGUgcG9pbnRzIGJlbG93IDIyIG9uIHRoZSB5LWF4aXMuICBBcyBleHBlY3RlZCB3ZSBzZWUgdGhhdCBhYm91dCBoYWxmIHRoZSBwb2ludHMgYXJlIGJlbG93IG91ciBtZWFuIG9mIDI0LiAgTm90ZSB0aGF0IHRoaXMgcGxvdCBpcyBjb21wYXJpbmcgb3VyIGRhdGEgd2hpY2ggd2FzIHJhbmRvbWx5IHNhbXBsZWQgZnJvbSBhIG5vcm1hbCBkaXN0cmlidXRpb24gd2l0aCBtZWFuIDI0IGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gMSB0byBhICpzdGFuZGFyZCBub3JtYWwgZGlzdHJpYnV0aW9uKiB3aXRoIG1lYW4gMCBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIDEsIHdoaWNoIGlzIHdoeSB0aGUgdmFsdWVzIG9uIHRoZSB4LWF4aXMgYXJlIC0zIHRvIDMgaW5zdGVhZCBvZiAyMSB0byAyNy4gIElmIHRoZSBwb2ludHMgbGllIG9uIGEgc3RyYWlnaHQgbGluZSwgdGhpcyBpcyBldmlkZW5jZSB0aGF0IHRoZSBkYXRhIGhhdmUgYSBub3JtYWwgZGlzdHJpYnV0aW9uLCBub3QgdGhhdCB0aGUgZGF0YSBoYXZlIGEgcGFydGljdWxhciBub3JtYWwgZGlzdHJpYnV0aW9uLgoKV2UgY2FuIHNwZWNpZnkgYSBzcGVjaWZpYyBtZWFuIGFuZCBzdGFuZGFyZCBkZXZpYXRpb24gZm9yIG91ciB0aGVvcmV0aWNhbCBkaXN0cmlidXRpb24gaW4gb3VyIFEtUSBwbG90OyBoZXJlIHdlIHNwZWNpZnkgYSBub3JtYWwgZGlzdHJpYnV0aW9uIHdpdGggbWVhbiAyNCBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIDE6CmBgYHtyfQpub3JtX0JNSV9leF9kYXRhICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gbm9ybV9kYXRhKSkgKwogIHN0YXRfcXEoZGlzdHJpYnV0aW9uID0gcW5vcm0sIGRwYXJhbXMgPSBjKG1lYW4gPSAyNCwgc2QgPSAxKSkgKyAKICBzdGF0X3FxX2xpbmUoZGlzdHJpYnV0aW9uID0gcW5vcm0sIGRwYXJhbXMgPSBjKG1lYW4gPSAyNCwgc2QgPSAxKSkKYGBgCk5vdGljZSB0aGF0IHRoZSBwbG90IGxvb2tzIHRoZSBzYW1lIGV4Y2VwdCBmb3IgdGhlIHZhbHVlcyBvbiB0aGUgeC1heGlzIGhhdmUgY2hhbmdlZCwgbWVhbmluZyBvdXIgaW50ZXJwcmV0YXRpb24gd2lsbCBiZSB0aGUgc2FtZSAtLSBpdCBsb29rcyBsaWtlIHRoZSB2YWx1ZXMgYXJlIGNvbnNpc3RlbnQgd2l0aCBhIG5vcm1hbCBkaXN0cmlidXRpb24uCgpJZiB3ZSB3ZXJlIHRvIHVzZSBkaWZmZXJlbnQgZGF0YSB0aGF0IGhhZCBhIHJhbmdlIG9mIGRpZmZlcmVudCB2YWx1ZXMgb3VyIHktYXhpcyB3b3VsZCBzaGlmdCBhY2NvcmRpbmcgdG8gdGhlIHJhbmdlIG9mIHZhbHVlcy4gCkZvciBleGFtcGxlLCB0aGUgYE9yYW5nZWAgZGF0YSAod2l0aGluIHRoZSBpbnN0YWxsYXRpb24gb2YgUikgaW5jbHVkZXMgZGF0YSBhYm91dCB0aGUgY2lyY3VtZmVyZW5jZSBvZiBvcmFuZ2UgdHJlZXMgaW4gbWlsbGltZXRlcnMuIApIZXJlLCB3ZSBjYW4gc2VlIHRoYXQgdGhlIHF1YW50aWxlcyBhcmUgcXVpdGUgZGlmZmVyZW50IGJ1dCByZWZsZWN0IHRoZSByYW5nZSBvZiBvcmFuZ2UgdHJlZSBjaXJjdW1mZXJlbmNlcy4KYGBge3J9CnJhbmdlKHB1bGwoT3JhbmdlLCBjaXJjdW1mZXJlbmNlKSkKT3JhbmdlICU+JQogIGdncGxvdChhZXMoc2FtcGxlID0gY2lyY3VtZmVyZW5jZSkpICsKICBzdGF0X3FxKCkgKwogIHN0YXRfcXFfbGluZSgpCmBgYAoKTm93LCBsZXQncyB0YWtlIGEgbG9vayBhdCBvdXIgYWN0dWFsIEJNSSBkYXRhOgpgYGB7cn0KQk1JX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPUJNSSkpICsKICBzdGF0X3FxKCkgKyAKICBzdGF0X3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFllYXIgKyBSZWdpb24pCmBgYApUaGlzIGlzIGEgbGl0dGxlIGhhcmQgdG8gc2VlLCBzb21lIHBsb3RzIHN1Z2dlc3QgdGhvc2Ugc3Vic2V0cyBvZiB0aGUgZGF0YSBhcmUgc2ltaWxhciB0byBhIG5vcm1hbCBkaXN0cmlidXRpb24sIGJ1dCBvdGhlcnMgc2VlbSB0byBiZSBza2V3ZWQuIExldCdzIHRha2UgYSBjbG9zZXIgbG9vay4KCkZvciB0aGUgc2FrZSBvZiBzaW1wbGljaXR5LCB3ZSBhcmUgZ29pbmcgdG8gZm9jdXMgb24gdGhlIHN1YnNldCBvZiBkYXRhIGZvciB0aGUgd29tZW4uIApUaGlzIGlzIGJlY2F1c2Ugd29tZW4gd2VyZSBpZGVudGlmaWVkIGluIHRoZSBwYXBlciB0byBoYXZlIGZhc3Rlc3QgaW5jcmVhc2VzIGluIEJNSSBvdmVyIHRpbWUuCklmIHdlIHdhbnQgdG8gY29tcGFyZSB0d28gc3Vic2V0cyBvZiB3b21lbiAoZS5nLiAxOTg1IHZlcnN1cyAyMDE3IG9yIHJ1cmFsIHZlcnN1cyB1cmJhbiksIHRoZW4gd2UgbmVlZCB0byBsb29rIGF0IHRoZSBkaXN0cmlidXRpb24gb2YgZWFjaCBvZiB0aGVzZSBzdWJzZXRzLgoKYGBge3J9CkJNSV9sb25nICU+JQogIGZpbHRlcihTZXggPT0gIldvbWVuIikgJT4lCiAgZ2dwbG90KGFlcyhzYW1wbGUgPSBCTUkpKSArCiAgc3RhdF9xcSgpICsgCiAgc3RhdF9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofiBZZWFyICsgUmVnaW9uKQpgYGAKCldlIGNhbiBzZWUgdGhhdCBhdCB0aGUgZXh0cmVtZXMgb2Ygb3VyIHF1YW50aWxlcywgZm9yIG1vc3Qgb2Ygb3VyIGRhdGEsIG91ciB0YWlscyBhcmUgbm90IHZlcnkgc2ltaWxhciB0byB0aGUgdGhlb3JldGljYWwgZGlzdHJpYnV0aW9uLiAKV2UgY2FuIGNhbiBhbHNvIHNlZSB0aGF0IG91ciBkYXRhIGlzIHJpZ2h0LSBvciBwb3NpdGl2ZS1za2V3ZWQsIGJlY2F1c2UgdGhlIGV4dHJlbWUgdmFsdWVzIGFyZSBhYm92ZSB0aGUgbGluZSB0aGF0IGluZGljYXRlcyBhIHBlcmZlY3QgbWF0Y2ggYmV0d2VlbiB0aGUgdGhlb3JldGljYWwgYW5kIG9ic2VydmVkIGRhdGEuCgpUaGUgcnVyYWwgZGF0YSBsb29rcyBtb3JlIG5vcm1hbCB0aGFuIHRoZSB1cmJhbiBkYXRhLiAKWW91IG1pZ2h0IGJlIGFza2luZywgd2h5IGRvIHdlIGNhcmUgaWYgdGhlIGRhdGEgbG9vayBtb3JlIG5vcm1hbCBvciBub3Q/IApJdCB0dXJucyBvdXQgaWYgeW91IHdhbnQgdG8gYXNrIHF1ZXN0aW9ucyBsaWtlICJJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmcm9tIHdvbWVuIGluIDE5ODUgY29tcGFyZWQgdG8gd29tZW4gaW4gMjAxNz8iLCB3ZSB3aWxsIG5lZWQgdG8gdXNlIHNvbWUgb2YgdHlwZSBvZiBzdGF0aXN0aWNhbCB0ZXN0LiAKVGhlIG1vc3QgY29tbW9ubHkgdXNlZCBzdGF0aXN0aWNhbCB0ZXN0cyB0aGF0IGNhbiBhbnN3ZXIgdGhhdCBxdWVzdGlvbiByZWx5IG9uIGFuIGFzc3VtcHRpb24gYWJvdXQgdGhlIGRhdGEgeW91IGhhdmUsIG5hbWVseSB0aGF0IHlvdXIgZGF0YSBoYXZlIGEgc2ltaWxhciBzaGFwZSBhcyBhIHRoZW9yZXRpY2FsIG5vcm1hbCBkaXN0cmlidXRpb24uIApTbywgaWYgd2Ugd2FudCB0byB1c2UgdGhvc2UgcG93ZXJmdWwgc3RhdGlzdGljYWwgdGVzdHMgdGhhdCByZWx5IG9uIHRoaXMgYXNzdW1wdGlvbiBvZiAibm9ybWFsaXR5IiwgdGhlbiB3ZSBuZWVkIHRvIGNoZWNrIHRoYXQgYXNzdW1wdGlvbiBiZWZvcmUgdXNpbmcgdGhvc2UgdGVzdHMuIAoKT25lIHdheSB0byBkbyB0aGF0IGlzIHRvIHVzZSBRLVEgcGxvdHMuIApBbm90aGVyIHdheSB0byBkbyB0aGF0IGlzIHRvIHVzZSB0aGUgW1NoYXBpcm8tV2lsayB0ZXN0IGZvciBub3JtYWxpdHldKGh0dHA6Ly93d3cuc3RhdGlzdGljczR1LmluZm8vZnVuZHN0YXRfZW5nL2VlX3NoYXBpcm9fd2lsa190ZXN0Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gd2hlbiB0aGUgUS1RIHBsb3QgaXMgYSBiaXQgdW5jbGVhci4gTWFueSBzdGF0aXN0aWNpYW5zIGhvd2V2ZXIgd291bGQgY29uY2x1ZGUgZnJvbSB0aGUgUS1RIHBsb3RzIHRoYXQgbm9ybWFsaXR5IGFwcGVhcnMgdG8gYmUgdmlvbGF0ZWQgaW4gb3VyIGRhdGEuIAoKIyMjIFNoYXBpcm8tV2lsayB0ZXN0CgpIZXJlLCB3ZSBhcmUgdXNpbmcgdGhlIGBzdW1tYXJpemUoKWAgYW5kIGBncm91cF9ieSgpYCBmdW5jdGlvbnMgZnJvbSBgZHBseXJgIHRvIHBlcmZvcm0gdGhlIFNoYXBpcm8tV2lsayB0ZXN0IGZvciBhbGwgdGhlIHN1YnNldHMgd2UgYXJlIGludGVyZXN0ZWQgaW4uIEluIHRoaXMgY2FzZSB0aGUgYCRgIGlzIHVzZWQgdG8gZ3JhYiB0aGUgYHAudmFsdWVgIGZyb20gdGhlIGBzaGFwaXJvdGVzdCgpYCBvdXRwdXQuCgpgYGB7cn0KQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIikgJT4lIAogIGdyb3VwX2J5KFllYXIsIFJlZ2lvbikgJT4lIAogIHN1bW1hcml6ZShzaGFwaXJvX3Rlc3QgPSBzaGFwaXJvLnRlc3QoQk1JKSRwLnZhbHVlKQoKCmBgYAoKV2UgY2FuIHNlZSB0aGF0IGFsbCBvZiB0aGUgc3Vic2V0cyBvZiBvdXIgZGF0YSBkbyBub3QgYXBwZWFyIHRvIGJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGJlY2F1c2UgdGhlICRwJC12YWx1ZSBpcyBsZXNzIHRoYW4gMC4wNSBmb3IgYWxsIHN1YnNldHMuIApUaGlzIGlzIG5vdCBzdXByaXNpbmcgYXMgdGhlIFEtUSBwbG90cyBzdWdnZXN0ZWQgdGhlIHNhbWUgdGhpbmcuIAoKIyMgRGF0YSBBbmFseXNpcwoKSW4gdGhlIHByZXZpb3VzIHNlY3Rpb24sIHdlIGhpbnRlZCBhdCB0aGUgZXhpc3RhbmNlIG9mIHN0YXRpc3RpY2FsIHRlc3RzIHRvIGJlIGFibGUgdG8gYXNzZXNzIGlmIHRoZXJlIGlzIGEgZGlmZmVyZW5jZSBpbiB0aGUgYXZlcmFnZSBCTUkgZXN0aW1hdGVzIGJldHdlZW4gdHdvIGdyb3VwcyAoZS5nLiB3b21lbiBpbiAxOTg1IGFuZCB3b21lbiBpbiAyMDE3KS4gCk9uZSBzdWNoIHRlc3QgaXMgdGhlIFtTdHVkZW50J3MgJHQkLXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dHdvLXNhbXBsZSUyMHQtdGVzdCl7dGFyZ2V0PSJfYmxhbmsifSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gZGV0ZXJtaW5lIGlmIFt0d28gZ3JvdXAgbWVhbnMgYXJlIGRpZmZlcmVudF0oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2VzdGltYXRpb24vZGlmZmVyZW5jZV9tZWFucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LgpIb3dldmVyLCBhcyBtZW50aW9uZWQgYmVmb3JlLCB0aGlzIHRlc3QgZGVwZW5kcyBvbiBjZXJ0YWluIGFzc3VtcHRpb24gb2Ygb3VyIGRhdGEuIAoKSW4gdGhpcyBzZWN0aW9uLCB3ZSBhcmUgZ29pbmcgdG8gdGFsayBhYm91dCB0aGlzIHRlc3QgYW5kIG90aGVyIHRlc3RzIHRoYXQgZG8gbm90IHJlcXVpcmUgYXNzdW1wdGlvbnMgYWJvdXQgb3VyIGRhdGEuIAoKIyMjIEh5cG90aGVzaXMgdGVzdGluZwoKTGV0J3MgcmVtaW5kIG91cnNlbHZlcyBvZiBvbmUgb2Ygb3VyIG9yaWdpbmFsIHF1ZXN0aW9ucywgCgo+IElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/CgpJbiBoeXBvdGhlc2lzIHRlc3RpbmcsIHdlIGFyZSBpbnRlcmVzdGVkIGluIGNvbXBhcmluZyB0d28gZGlmZmVyZW50IGh5cG90aGVzZXM6IGEgIm51bGwiIGh5cG90aGVzaXMgKGNhbiBiZSB0aG91Z2h0IG9mIGxpa2UgYSBiYXNlbGluZSBlLmcuIHRoZSBtZWFucyBiZXR3ZWVuIHR3byBncm91cHMgYXJlIHRoZSBzYW1lKSBjb21wYXJlZCB0byBhbiAiYWx0ZXJuYXRpdmUiIGh5cG90aGVzaXMgKGUuZy4gdGhlIG1lYW5zIGJldHdlZW4gdHdvIGdyb3VwcyBhcmUgZGlmZmVyZW50KS4gV2UgYXJlIGdvaW5nIHRvIGFzayBpZiB0aGVyZSBpcyBlbm91Z2ggZXZpZGVuY2UgaW4gb3VyIGRhdGEgdG8gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMuICAKTGV0J3MgdHJ5IHRvIGZvcm1hbGl6ZSB0aGlzIGEgYml0LiAKCkluIG91ciBjYXNlLCB3ZSB3YW50IHRvIHBlcmZvcm0gd2hhdCBpcyBjYWxsZWQgYSA8Yj50d28gbWVhbnMgaHlwb3RoZXNpcyB0ZXN0PC9iPiB1c2luZyBhIHN0YXRpc3RpY2FsIHRlc3QgKGUuZy4gYSBTdHVkZW50J3MgJHQkLXRlc3QpLiBTdXBwb3NlIHdlIGNhbGwgdGhlIHRydWUgdW5rbm93biBtZWFucyBvZiB0aGUgdHdvIGdyb3VwcyAkXG11XzEkIGFuZCAkXG11XzIkLCBmb3IgZ3JvdXAgMSBhbmQgZ3JvdXAgMiwgcmVzcGVjdGl2ZWx5LgpUaGVuIHdlIGNhbiBkZWZpbmUgdGhlIDxiPm51bGwgaHlwb3RoZXNpczwvYj4gdGhhdCB0aGVyZSBpcyBubyBkaWZmZXJlbmNlIGluIHRoZSB0d28gbWVhbnM6CgokJCBIXzA6IFxtdV8xID0gXG11XzIgJCQKSW4gY29udHJhc3QsIHdlIGFsc28gZGVmaW5lIGFuIDxiPmFsdGVybmF0aXZlIGh5cG90aGVzaXM8L2I+IHRoYXQgdGhlcmUgaXMgYSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIHR3byBtZWFuczogCgokJCBIX2E6IFxtdV8xIFxuZXEgXG11XzIgJCQKClRoZSBpZGVhIGJlaGluZCBhIGh5cG90aGVzaXMgdGVzdCBpcyB0aGF0IHdlIGFzc3VtZSB0aGUgbnVsbCBoeXBvdGhlc2lzIGlzIHRydWUgYW5kIHdlIHVzZSBvdXIgZGF0YSB0byBoZWxwIHVzIGlkZW50aWZ5IGlmIHRoZXJlIGlzIGVub3VnaCBldmlkZW5jZSB0byBfcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXNfLiAKVGhpcyBpcyBzaW1pbGFyIHRvIHRoZSBpZGVhIG9mIGFzc3VtaW5nIHRoYXQgaW5kaXZpZHVhbHMgYXJlIG5vdCBndWlsdHkgdW50aWwgcHJvdmVuIG90aGVyd2lzZS4KSWYgdGhlcmUgaXMgbm90IGVub3VnaCBldmlkZW5jZSBpbiB0aGUgZGF0YSwgdGhlbiB3ZSBzYXkgd2UgImZhaWwgdG8gcmVqZWN0IHRoZSBudWxsIGh5cG90aGVzaXMiLgoKWW91IG1pZ2h0IGJlIGFza2luZywgIkJ1dCB3ZSBkbyBub3Qga25vdyB3aGF0IHRoZSB0cnVlIGdyb3VwIG1lYW5zIGFyZT8iIApUaGF0IGlzIGNvcnJlY3QuICBJbnN0ZWFkLCB3ZSBtdXN0IGVzdGltYXRlIHRoZXNlIG1lYW5zIGJhc2VkIG9uIHRoZSBkYXRhIHRoYXQgd2UgaGF2ZS4KRm9yIGV4YW1wbGUsIGluIG91ciBkYXRhLCB3ZSBjYW4gZXN0aW1hdGUgZGlmZmVyZW5jZXMgaW4gdGhlIGF2ZXJhZ2UgQk1JIGVzdGltYXRlcyBmb3Igd29tZW4gaW4gcnVyYWwgYW5kIHVyYmFuIHJlZ2lvbnMgaW4gdGhlIHR3byBkaWZmZXJlbnQgeWVhcnMuIAoKYGBge3J9CkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUgCiAgZ3JvdXBfYnkoUmVnaW9uLCBZZWFyKSAlPiUKICBzdW1tYXJpemUoYXZnX2JtaSA9IG1lYW4oQk1JLCBuYS5ybSA9IFRSVUUpKSAKCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUgCiAgZ3JvdXBfYnkoUmVnaW9uLCBZZWFyKSAlPiUKICBzdW1tYXJpemUoYXZnX2JtaSA9IG1lYW4oQk1JLCBuYS5ybSA9IFRSVUUpKSAlPiUgCiAgbXV0YXRlKGRpZmYgPSBhdmdfYm1pIC0gbGFnKGF2Z19ibWkpKSAKYGBgCgpIZXJlIHdlIHNlZSB0aGF0IHRoYXQgQk1JIGVzdGltYXRlcyBpbmNyZWFzZWQgYnkgMi4zOSBwb2ludHMgd2l0aGluIHJ1cmFsIHJlZ2lvbnMgYW5kIGluY3JlYXNlZCBieSAyLjIxIHBvaW50cyB3aXRoaW4gdXJiYW4gcmVnaW9ucy4gIApOZXh0LCB3ZSBjYW4gdXNlIGEgc3RhdGlzdGljYWwgdGVzdCAoZS5nLiBhIFN0dWRlbnQncyAkdCQtdGVzdCkgdG8gYXNzZXNzIGlmIHRoZXNlIGRpZmZlcmVuY2VzIGFyZSBzdGF0aXN0aWNhbGx5IG1lYW5pbmdmdWwgb3IgaWYgdGhlc2UgZGlmZmVyZW5jZXMgY291bGQgYmUgZm91bmQgZHVlIHRvIHJhbmRvbSBjaGFuY2UuIAoKVGhlcmUgYXJlIHR3byBwb3NzaWJsZSBjbGFzc2VzIG9mIHN0YXRpc3RpY2FsIHRlc3RzIHRoYXQgd2UgY291bGQgcnVuIHRvIGNvbXBhcmUgdGhlIG1lYW5zIG9mIHRoZXNlIHR3byBncm91cHM6CgoxLiBQYXJhbWV0cmljCjIuIE5vbnBhcmFtZXRyaWMKCjxiPlBhcmFtZXRyaWMgdGVzdHM8L2I+IGFyZSBiYXNlZCBvbiBhc3N1bXB0aW9ucyBhYm91dCB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHdoaWxlIDxiPm5vbnBhcmFtZXRyaWMgdGVzdHM8L2I+IGRvIG5vdCByZWx5IG9uIHRoZXNlIGRpc3RyaWJ1dGlvbmFsIGFzc3VtcHRpb25zLiAKSXQgaXMgY2FsbGVkICJwYXJhbWV0cmljIiBiZWNhdXNlIGFzcGVjdHMgYWJvdXQgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgZGF0YSwgbGlrZSB0aGUgbWVhbiwgYXJlIGNhbGxlZCA8Yj5wYXJhbWV0ZXJzPC9iPiBvZiBhIG1hdGhlbWF0aWNhbCBmdW5jdGlvbiB3aGVuIHdlIGRlc2NyaWJlIGEgcG9wdWxhdGlvbi4gCkluIHBhcmFtZXRyaWMgdGVzdHMsIHdlIGVzdGltYXRlIHRoZSBwYXJhbWV0ZXJzIG9mIHRoZSB0cnVlIHBvcHVsYXRpb24gb2YgaW50ZXJlc3QgdXNpbmcgYSBzYW1wbGUgb2YgdGhhdCBwb3B1bGF0aW9uLiAKVGhlc2UgZXN0aW1hdGVzIGFyZSBjYWxsZWQgPGI+c3RhdGlzdGljczwvYj4uIApTZWUgW2hlcmVdKGh0dHBzOi8vd3d3Lm1heW8uZWR1L3Jlc2VhcmNoL2RvY3VtZW50cy9wYXJhbWV0cmljLWFuZC1ub25wYXJhbWV0cmljLWRlbXlzdGlmeWluZy10aGUtdGVybXMvZG9jLTIwNDA4OTYwKXt0YXJnZXQ9Il9ibGFuayJ9IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlc2UgdHdvIGNsYXNzZXMgb2YgdGVzdHMuCgojIyMgUGFyYW1ldHJpYyB0d28tc2FtcGxlICR0JC10ZXN0CgpUaGUgdHdvLXNhbXBsZSAkdCQtdGVzdCBpcyBhIGNvbW1vbiB3YXkgdG8gZGV0ZXJtaW5lIGlmIHRoZSBtZWFucyBvZiB0d28gZ3JvdXBzIGFyZSBkaWZmZXJlbnQuIApUaGUgdHdvLXNhbXBsZSAkdCQtdGVzdCBob3dldmVyLCByZWxpZXMgb24gc2V2ZXJhbCA8dT48Yj5hc3N1bXB0aW9uczwvYj48L3U+OgoKMSkgVGhlIGRhdGEgZm9yIGVhY2ggZ3JvdXAgaXMgW25vcm1hbGx5IGRpc3RyaWJ1dGVkXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifQoyKSBUaGUgW3ZhcmlhbmNlXShodHRwczovL3N0YXR0cmVrLmNvbS9zdGF0aXN0aWNzL2RpY3Rpb25hcnkuYXNweD9kZWZpbml0aW9uPXZhcmlhbmNlKXt0YXJnZXQ9Il9ibGFuayJ9IG9mIGJvdGggZ3JvdXBzIGlzIHNpbWlsYXIKMykgVGhlIG51bWJlciBvZiBvYnNlcnZhdGlvbnMgaXMgc2ltaWxhciBmb3IgYm90aCBncm91cHMgLSB0aHVzIHRoZXkgYXJlIFtiYWxhbmNlZF0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vYmFsYW5jZWQtYW5kLXVuYmFsYW5jZWQtZGVzaWducy8pe3RhcmdldD0iX2JsYW5rIn0KNCkgVGhlIG9ic2VydmF0aW9ucyBhcmUgW2luZGVwZW5kZW50XShodHRwczovL3d3dy5zdGF0LmNtdS5lZHUvfmNzaGFsaXppLzM2LTIyMC9sZWN0dXJlLTUucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IChtZWFuaW5nIHRoYXQgb2JzZXJ2YXRpb25zIGRvIG5vdCBpbmZsdWVuY2UgZWFjaCBvdGhlcikKCkEgJHQkLXRlc3QgaXMgbW9zdCBjb21tb25seSBhcHBsaWVkIHdoZW4gdGhlIHRlc3Qgc3RhdGlzdGljIHdvdWxkIGZvbGxvdyBhIG5vcm1hbCBkaXN0cmlidXRpb24gaWYgdGhlIHZhbHVlIG9mIGEgc2NhbGluZyB0ZXJtIGluIHRoZSB0ZXN0IHN0YXRpc3RpYyB3ZXJlIGtub3duLiBXaGVuIHRoZSBzY2FsaW5nIHRlcm0gaXMgdW5rbm93biBhbmQgaXMgcmVwbGFjZWQgYnkgYW4gZXN0aW1hdGUgYmFzZWQgb24gdGhlIGRhdGEsIHRoZSB0ZXN0IHN0YXRpc3RpY3MgKHVuZGVyIGNlcnRhaW4gY29uZGl0aW9ucykgZm9sbG93IGEgU3R1ZGVudCdzIHQgZGlzdHJpYnV0aW9uLiBUaGUgJHQkLXRlc3QgY2FuIGJlIHVzZWQsIGZvciBleGFtcGxlLCB0byBkZXRlcm1pbmUgaWYgdGhlIG1lYW5zIG9mIHR3byBzZXRzIG9mIGRhdGEgYXJlIHNpZ25pZmljYW50bHkgZGlmZmVyZW50IGZyb20gZWFjaCBvdGhlci4KCgoKCklmIHRoZXNlIGFzc3VtcHRpb25zIGFyZSB2aW9sYXRlZCwgdGhpcyBkb2Vzbid0IG5lY2Vzc2FyaWx5IG1lYW4gd2UgY2FuJ3QgcGVyZm9ybSBhICR0JC10ZXN0LiBJdCBqdXN0IG1lYW5zIHdlIG1heSBuZWVkIHRvIGNvbnNpZGVyIHRoZSBmb2xsb3dpbmcgb3B0aW9uczoKCjEpIFtUcmFuc2Zvcm1hdGlvbl0oaHR0cHM6Ly93d3cuc3RhdGlzdGljc2hvd3RvLmRhdGFzY2llbmNlY2VudHJhbC5jb20vdHJhbnNmb3JtYXRpb24tc3RhdGlzdGljcy8pe3RhcmdldD0iX2JsYW5rIn0gb2YgdGhlIGRhdGEgdG8gbWFrZSBpdCBtb3JlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkCjIpIFtXZWxjaCdzICR0JC10ZXN0XShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS93ZWxjaHMtdGVzdC1mb3ItdW5lcXVhbC12YXJpYW5jZXMvKXt0YXJnZXQ9Il9ibGFuayJ9IGFsc28gY2FsbCB0aGUgdW5lcXVhbCB2YXJpYW5jZSAkdCQtdGVzdCB3ZSBtYXkgbmVlZCB0byBtb2RpZnkgdGhlIHdheSB3ZSBwZXJmb3JtIHRoZSBbJHQkLXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dHdvLXNhbXBsZSUyMHQtdGVzdCl7dGFyZ2V0PSJfYmxhbmsifSB0byBhY2NvdW50IGZvciB0aGUgZGlmZmVyZW5jZSBpbiB0aGUgdmFyaWFuY2UgaW4gdGhlIHR3byBncm91cHMKMykgW1Blcm11dGF0aW9uL3Jlc2FtcGxpbmcgbWV0aG9kc10oaHR0cHM6Ly9qaHUtYWR2ZGF0YXNjaS5naXRodWIuaW8vMjAxOS9sZWN0dXJlcy8yMS1yZXNhbXBsaW5nLXRlY2huaXF1ZXMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSB0byBkZWFsIHdpdGggdmlvbGF0aW9ucyBvZiBub3JtYWxpdHkgb3IgaW1iYWxhbmNlLgoKQWx0ZXJuYXRpdmVseSwgd2UgY2FuIHVzZSBhIG5vbnBhcmFtZXRyaWMgdGVzdCB3aGljaCBkb2VzIG5vdCByZWx5IG9uIGFzc3VtcHRpb25zIGFib3V0IHRoZSBwYXJhbWV0ZXJzIG9mIHRoZSBkYXRhLiBUaGVzZSB0ZXN0cyBhcmUgb2Z0ZW4gYSBnb29kIG9wdGlvbiB3aGVuIG11bHRpcGxlIGFzc3VtcHRpb25zIGFyZSB2aW9sYXRlZCBhcmUgd2hlbiBzYW1wbGUgc2l6ZXMgYXJlIHNtYWxsLiBXZSB3aWxsIGV4cGxvcmUgdGhlc2Ugb3B0aW9ucy4KCk91ciBkYXRhIGhhcyBhIGJhbGFuY2Ugb2Ygb2JzZXJ2YXRpb25zIGZvciBib3RoIGdyb3VwcyAtIGluIGZhY3QgdGhleSBhcmUgZXF1YWwsIHRodXMgdGhhdCBhc3N1bXB0aW9uIGlzIG5vdCB2aW9sYXRlZC4KSWYgaXQgd2VyZSB2aW9sYXRlZCwgd2Ugd291bGQgd2FudCB0byBjb25zaWRlciB1c2luZyBwZXJtdXRhdGlvbiBtZXRob2RzIHdoaWNoIGFyZSBhbHNvIGEgZ29vZCBvcHRpb24gZm9yIHZpb2xhdGlvbnMgb2Ygbm9ybWFsaXR5LiBUbyBsZWFybiBtb3JlIGFib3V0IHRoZXNlIG1ldGhvZHMgc2VlIFtoZXJlXShodHRwczovL2podS1hZHZkYXRhc2NpLmdpdGh1Yi5pby8yMDE5L2xlY3R1cmVzLzIxLXJlc2FtcGxpbmctdGVjaG5pcXVlcy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9LgoKSWYgd2UgbmVlZGVkIHRvIGNoZWNrIGlmIG91ciBzYW1wbGVzIHdlcmUgaW1iYWxhbmNlZCwgd2UgY291bGQgdXNlIHRoZSBgY291bnQoKWAgZnVuY3Rpb24gb2YgYGRwbHlyYDoKCmBgYHtyfQpkcGx5cjo6Y291bnQoQk1JX2xvbmcsIFNleCwgWWVhciwgUmVnaW9uKQpgYGAKCldlIGNhbiBzZWUgdGhhdCB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBmb3IgZWFjaCBwb3NzaWJsZSBncm91cCBvZiBpbnRlcmVzdCBpcyB0aGUgc2FtZS4KClRoZSAkdCQtdGVzdCBpcyBhbHNvIGZhaXJseSByb2J1c3QgdG8gbm9uLW5vcm1hbGl0eSBpZiB0aGUgZGF0YSBpcyByZWxhdGl2ZWx5IGxhcmdlLCBkdWUgdG8gd2hhdCBpcyBjYWxsZWQgdGhlIFtjZW50cmFsIGxpbWl0IHRoZW9yZW1dKGh0dHBzOi8vd3d3LmFuYWx5dGljc3ZpZGh5YS5jb20vYmxvZy8yMDE5LzA1L3N0YXRpc3RpY3MtMTAxLWludHJvZHVjdGlvbi1jZW50cmFsLWxpbWl0LXRoZW9yZW0vKXt0YXJnZXQ9Il9ibGFuayJ9LCB3aGljaCBzdGF0ZXMgdGhhdCBhcyBzYW1wbGVzIGdldCBsYXJnZXIsIHRoZXkgYXBwcm94aW1hdGUgYSBub3JtYWwgZGlzdHJpYnV0aW9uLgoKV2UgaGF2ZSBhbiBuIG9mIDIwMCwgd2hpY2ggc2hvdWxkIGJlIHN1ZmZpY2llbnQgYnV0IGxldCdzIGludmVzdGlnYXRlIHRoZSBub25wYXJhbWV0cmljIHRlc3RzIGZ1cnRoZXIuIAoKCk9mdGVuIHdlIHdvdWxkIGNoZWNrIGlmIHRoZSB2YXJpYW5jZSBvZiB0aGUgcnVyYWwgYW5kIHVyYmFuIGRhdGEgaXMgZXF1YWwgdXNpbmcgdGhlIGB2YXIudGVzdCgpYCBmdW5jdGlvbi4gSG93ZXZlciB0aGlzIGlzIGFuIEYgdGVzdCBhbmQgYXNzdW1lcyB0aGF0IHRoZSBkYXRhIGlzIG5vcm1hbGx5IGRpc3RyaWJ1dGVkLiBJbnN0ZWFkIHdlIHdpbGwgdXNlIHRoZSBgbW9vZC50ZXN0KClgIGZ1bmN0aW9uIHdoaWNoIHBlcmZvcm1zIHRoZSBbTW9vZCdzIHR3by1zYW1wbGUgdGVzdCBmb3IgYSBkaWZmZXJlbmNlIGluIHNjYWxlIHBhcmFtZXRlcnNdKGh0dHBzOi8vZmlsZXMuZXJpYy5lZC5nb3YvZnVsbHRleHQvRUQwNjU1NTkucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IGFuZCBkb2VzIG5vdCBhc3N1bWUgdGhhdCB0aGUgZGF0YSBpcyBub3JtYWxseSBkaXN0cmlidXRlZC4gV2Ugd2lsbCBhbHNvIGludHJvZHVjZSB0aGUgYHB1bGwoKWAgZnVuY3Rpb24gb2YgdGhlIGBkcGx5cmAgcGFja2FnZS4KCmBgYHtyfQoKI3B1bGwoKSB3aWxsIGFsbG93IHVzIHRvIHRha2UgdGhlIEJNSSBjb2x1bW4gYWZ0ZXIgd2UgZmlsdGVyIEJNSV9sb25nCgptb29kLnRlc3QoZHBseXI6OnB1bGwoZmlsdGVyKEJNSV9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwgCiAgICAgICAgICBkcGx5cjo6cHVsbChmaWx0ZXIoQk1JX2xvbmcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSkpCiMgcCB2YWx1ZSA8LjA1LCBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIG5vdCBlcXVhbAojIHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgc3ByZWFkIG9mIHRoZSBkaXN0cmlidXRpb25zCgptb29kLnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwgCiAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSkpCiMgcCB2YWx1ZSA8LjA1LCBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIG5vdCBlcXVhbAojIHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgdmFyaWFuY2Ugb2YgdGhlIGRpc3RyaWJ1dGlvbnMKCm1vb2QudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSkKIyBwIHZhbHVlID4uMDUsIGNvbmNsdWRlIHRoYXQgdmFyaWFuY2UgaXMgZXF1YWwKIyBmYWlsIHRvIHJlamVjdCB0aGUgbnVsbCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgdmFyaWFuY2Ugb2YgdGhlIGRpc3RyaWJ1dGlvbnMKCm1vb2QudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSkKIyBwIHZhbHVlID4uMDUsIGNvbmNsdWRlIHRoYXQgdmFyaWFuY2UgaXMgZXF1YWwKIyBmYWlsIHRvIHJlamVjdCB0aGUgbnVsbCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgdmFyaWFuY2Ugb2YgdGhlIGRpc3RyaWJ1dGlvbnMKCmBgYAoKT3VyIHAgdmFsdWUgaXMgbGVzcyB0aGFuIC4wNSBmb3IgYm90aCB0ZXN0cywgdGh1cyB3ZSByZWplY3Qgb3VyIG51bGwgaHlwb3RoZXNpcyB0aGF0IHRoZXJlIGlzIG5vIGRpZmZlcmVuY2UgaW4gdGhlIHZhcmlhbmNlLiBUaGVyZWZvcmUsIHdlIGNvbmNsdWRlIHRoYXQgdGhlIHZhcmlhbmNlIGlzIG5vdCBlcXVhbCBhbmQgdGhhdCBvdXIgZGF0YSBhbHNvIHZpb2xhdGVzIHRoaXMgYXNzdW1wdGlvbi4KCldlIHdpbGwgcGVyZm9ybSBhIHNwZWNpYWwgdC50ZXN0IHdoZXJlIHdlIGFjY291bnQgZm9yIHRoZSBmYWN0IHRoYXQgb3VyIHZhcmlhbmNlIGlzIG5vdCBlcXVhbC4gCgpBbm90aGVyIGltcG9ydGFudCBjb25zaWRlcmF0aW9uIGlzIHRoYXQgdGhlIGRhdGEgaXMgd2hhdCB3ZSBjYWxsIFtwYWlyZWRdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzU1Nzk0NjUvKXt0YXJnZXQ9Il9ibGFuayJ9LCBtZWFuaW5nIHRoYXQgdGhlIG1lYXN1cmVtZW50cyBmcm9tIHRoZSBydXJhbCBhbmQgdXJiYW4gYXJlYXMgYXJlIG5vdCBpbmRlcGVuZGVudC4gVGhhdCBpcyBiZWNhdXNlIHdlIGhhdmUgYSBydXJhbCBhbmQgdXJiYW4gbWVhc3VyZW1lbnQgbWVhbiBmb3IgbmVhcmx5IGV2ZXJ5IGNvdW50cnkuIFRodXMgdGhlc2UgdmFsdWVzIG1heSBiZSBtb3JlIHNpbWlsYXIgdG8gb25lIGFub3RoZXIgaWYgdGhleSBjb21lIGZyb20gdGhlIHNhbWUgY291bnRyeS4gVGhpcyBpcyBhbHNvIHRydWUgZm9yIHRoZSBtYWxlIGFuZCBmZW1hbGUgbWVhc3VyZW1lbnRzIGZyb20gdGhlIHNhbWUgY291bnRyeSBvciB0aGUgdmFsdWVzIGluIHRoZSBzYW1lIGNvdW50cmllcyBmcm9tIDE5ODUgYW5kIGxhdGVyIGluIDIwMTcuIEhvd2V2ZXIsIHdlIGFyZSBhc3N1bWluZyB0aGF0IG1lYXN1cmVtZW50cyBiZXR3ZWVuIGRpZmZlcmVudCBjb3VudHJpZXMgYXJlIGluZGVwZW5kZW50LCB0aHVzIHRoaXMgYXNzdW1wdGlvbiBpcyBub3QgdmlvbGF0ZWQsIG1ha2luZyBpdCByZWFzb25hYmxlIHRvIHBlcmZvcm0gdGhlIFdlbGNoJ3Mgb3IgcGFpcmVkICR0JC10ZXN0LgoKV2hlbiB3ZSBwZXJmb3JtIGEgcGFpcmVkICR0JC10ZXN0IG91ciBoeXBvdGhlc2lzIGlzIHNsaWdodGx5IGRpZmZlcmVudCBmcm9tIHRoZSB0eXBpY2FsIHN0dWRlbnQncyAkdCQtdGVzdC4gSW4gdGhpcyBjYXNlIHdlIGFyZSB0ZXN0aW5nIHRoZSBkaWZmZXJlbmNlcyBhbW9uZyB0aGUgcGFpcnMgb2Ygb2JzZXJ2YXRpb25zIGFuZCBob3cgY2xvc2UgdGhlc2UgZGlmZmVyZW5jZXMgYXJlIHRvIHplcm8uIE91ciBudWxsIGh5cG90aGVzaXMgaXMgdGhhdCB0aGUgbWVhbiBvZiB0aGUgZGlmZmVyZW5jZXMgaXMgZXF1YWwgdG8gemVybzoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIbzogzrxkID0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDOvGQgaXMgdGhlIHRydWUgbWVhbiBkaWZmZXJlbmNlcyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJldHdlZW4gcGFpcmVkIG9ic2VydmF0aW9ucyBvZiB0aGUgdHdvIGdyb3VwcwoKVGhlIGFsdGVybmF0aXZlIGh5cG90aGVzaXMgaXMgdGhhdCB0aGUgbWVhbiBvZiB0aGUgZGlmZmVyZW5jZXMgaXMgbm90IGVxdWFsIHRvIHplcm8KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIYTogzrxkIOKJoCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIM68ZCBpcyB0aGUgdHJ1ZSBtZWFuIGRpZmZlcmVuY2VzIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmV0d2VlbiBwYWlyZWQgb2JzZXJ2YXRpb25zIG9mIHRoZSB0d28gZ3JvdXBzCgpgYGB7cn0KCnQudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksIAogICAgICAgdmFyLmVxdWFsID0gRkFMU0UsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksCiAgICAgICB2YXIuZXF1YWwgPSBGQUxTRSwgcGFpcmVkID0gVFJVRSkKIyBtZWFucyBhcmUgZGlmZmVyZW50IC0gcCB2YWx1ZSA8LjA1IHJlamVjdCB0aGUgbnVsbDogbm8gZGlmZmVyZW5jZSBpbiB0aGUgbWVhbnMKCnQudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksCiAgICAgICB2YXIuZXF1YWwgPSBUUlVFLCBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksIAogICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IFRSVUUsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCiMgdGhlIHQgdmFsdWUgc2hvd3MgdXMgdGhhdCB0aGUgZGlyZWN0aW9uYWxpdHkgb2YgdGhlIGRpZmZlcmVuY2UKIyB0aGUgdCB2YWx1ZSB3YXMgbmVnYXRpdmUgdGh1cyBCTUkgd2FzIGxvd2VyIGluIDE5ODUgKDFzdCBncm91cCkgCiMgY29tcGFyZWQgdG8gMjAxNyAoMm5kIGdyb3VwKQoKCmBgYAoKIyMjIyB7LnF1ZXN0aW9uX2Jsb2NrfQo8dT5RdWVzdGlvbiBvcHBvcnR1bml0eTo8L3U+IApMb29raW5nIGF0IHRoZSB0IHZhbHVlLCB3YXMgZ2xvYmFsIEJNSSBsb3dlciBpbiBSdXJhbCBvciBVcmJhbiBhcmVhcyBpbiAxOTg1PwoKIyMjIwoKTm93IHdlIHdpbGwgdHJ5IHRyYW5zZm9ybSBvdXIgZGF0YSB0byBtYWtlIGl0IG1vcmUgbm9ybWFsbHkgZGlzdHJpYnV0ZWQuIE9uZSB3YXkgdG8gZG8gdGhpcyBpcyB0byB0YWtlIHRoZSBsb2dhcml0aG0gb2YgdGhlIGRhdGEgdmFsdWVzLiBUaGVuIHdlIHdpbGwgc2VlIGhvdyB0aGlzIGluZmx1ZW5jZXMgdGhlIHJlc3VsdHMuIEFnYWluIHdlIHdpbGwgZm9jdXMgb24gdGhlIGRhdGEgZm9yIHdvbWVuLgoKYGBge3J9CgojIGNyZWF0ZSBhIG5ldyBjb2x1bW4gd2l0aCB0aGUgbG9nIHZlcnNpb24gb2YgdGhlIEJNSSB2YXJpYWJsZSB1c2luZyBtdXRhdGUoKQoKQk1JX2xvbmdfbG9nIDwtIG11dGF0ZShCTUlfbG9uZywgbG9nX0JNST1sb2cocHVsbChCTUlfbG9uZyxCTUkpKSkKCkJNSV9sb25nX2xvZyAlPiUKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1sb2dfQk1JKSkgKwogIHN0YXRfcXEoKSArICMgdG8gYWRkIHRoZSBsaW5lIHdlIG5lZWQgdG8gYWxzbyBpbmNsdWRlIHN0YXRfcXFfbGluZSgpCiAgc3RhdF9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofiBZZWFyICsgUmVnaW9uKQoKQk1JX2xvbmdfbG9nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIpICU+JSAKICBncm91cF9ieShZZWFyLCBSZWdpb24pICU+JSAKICBzdW1tYXJpemUoc2hhcGlyb190ZXN0ID0gc2hhcGlyby50ZXN0KGxvZ19CTUkpJHAudmFsdWUpCgojIHJlY2FsbCB3aGF0IGl0IHdhcyBiZWZvcmUKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIikgJT4lIAogIGdyb3VwX2J5KFllYXIsIFJlZ2lvbikgJT4lIAogIHN1bW1hcml6ZShzaGFwaXJvX3Rlc3QgPSBzaGFwaXJvLnRlc3QoQk1JKSRwLnZhbHVlKQoKCgpgYGAKClRoZSBkYXRhIGFwcGVhcnMgdG8gYmUgbW9yZSBzaW1pbGFyIHRvIHRoZSBub3JtYWwgZGlzdHJpYnV0aW9uLCBhbHRob3VnaCBub3QgcXVpdGUuIEFnYWluLCBvdXIgc2FtcGxlIHNpemUgb2YgMjAwIGlzIHF1aXRlIGxhcmdlIGFuZCB0aGUgJHQkLXRlc3QgaXMgZ2VuZXJhbGx5IHF1aXRlIHJvYnVzdCB0byB2aW9sYXRpb25zIG9mIG5vcm1hbGl0eSB3aXRoIGxhcmdlIG4sIHRodXMgdGhlIG1vZGlmaWVkICR0JC10ZXN0IHRvIGFjY291bnQgZm9yIHVuZXF1YWwgdmFyaWFuY2UgbWlnaHQgYmUgYSBnb29kIG9wdGlvbiB1c2luZyB0aGUgbG9nIG5vcm1hbGl6ZWQgZGF0YSwgYXMgaXQgaXMgYXQgbGVhc3QgbW9yZSBub3JtYWxseSBkaXN0cmlidXRlZC4KCkxldCdzIHNlZSB0aGUgcmVzdWx0cyBvZiB0aGUgJHQkLXRlc3Qgd2l0aCB0aGUgdHJhbnNmb3JtZWQgZGF0YToKCmBgYHtyfQoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBsb2dfQk1JKSwgCiAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZ19sb2csIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgbG9nX0JNSSksIAogICAgICAgdmFyLmVxdWFsID0gRkFMU0UsIHBhaXJlZCA9IFRSVUUpCiMgbWVhbnMgYXJlIGRpZmZlcmVudCAtIHAgdmFsdWUgPC4wNSByZWplY3QgdGhlIG51bGw6IG5vIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zCgp0LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmdfbG9nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIGxvZ19CTUkpLCAKICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBsb2dfQk1JKSwKICAgICAgIHZhci5lcXVhbCA9IEZBTFNFLCBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBsb2dfQk1JKSwgCiAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZ19sb2csIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgbG9nX0JNSSksCiAgICAgICB2YXIuZXF1YWwgPSBUUlVFLCBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwoKdC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nX2xvZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBsb2dfQk1JKSwgCiAgICAgICBwdWxsKGZpbHRlcihCTUlfbG9uZ19sb2csIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgbG9nX0JNSSksCiAgICAgICB2YXIuZXF1YWwgPSBUUlVFLCBwYWlyZWQgPSBUUlVFKQojIG1lYW5zIGFyZSBkaWZmZXJlbnQgLSBwIHZhbHVlIDwuMDUgcmVqZWN0IHRoZSBudWxsOiBubyBkaWZmZXJlbmNlIGluIHRoZSBtZWFucwoKYGBgCgpXZSBjYW4gc2VlIHRoYXQgb3VyIHJlc3VsdHMgYXJlIHF1aXRlIHNpbWlsYXIgdG8gdGhhdCBvZiB0aGUgb3JpZ2luYWwgZGF0YSwgaG93ZXZlciB0aGUgdCB2YWx1ZXMgYXJlIHNsaWdodGx5IHNtYWxsZXIuIEluIG90aGVyIGNhc2VzIHdlIG1heSBzZWUgYSBtdWNoIG1vcmUgZHJhbWF0aWMgaW5mbHVlbmNlIG9mIHRyYW5zZm9ybWluZyBvdXIgZGF0YS4KCgpOb3csIGxldCdzIHRha2UgYSBsb29rIGF0IG5vbnBhcmFtZXRyaWMgdGVzdHMsIHdoaWNoIGFyZSBhbHNvIGEgZ3JlYXQgb3B0aW9uIHdoZW4gdGhlIGFzc3VtcHRpb25zIG9mIHRoZSAkdCQtdGVzdCBhcmUgdmlvbGF0ZWQuIAoKIyMjIE5vbnBhcmFtZXRyaWMgdHdvIHNhbXBsZSB0ZXN0cwoKVGhlcmUgYXJlIG11bHRpcGxlIG5vbnBhcmFtZXRyaWMgb3B0aW9ucyB0byBjb25zaWRlciB3aGVuIHRoZSBhc3N1bXB0aW9ucyBvZiB0aGUgWyR0JC10ZXN0XSBhcmUgdmlvbGF0ZWQuIFRoZSBbV2lsY294b24gc2lnbmVkIHJhbmsgdGVzdF0oaHR0cDovL3d3dy5iaW9zdGF0aGFuZGJvb2suY29tL3dpbGNveG9uc2lnbmVkcmFuay5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9IChmb3IgcGFpcmVkIGRhdGEgLSB0aGUgYWx0ZXJuYXRpdmUgaXMgW1dpbGNveG9uIHJhbmsgc3VtIHRlc3RdKGh0dHA6Ly9zcGh3ZWIuYnVtYy5idS5lZHUvb3RsdC9tcGgtbW9kdWxlcy9icy9iczcwNF9ub25wYXJhbWV0cmljL0JTNzA0X05vbnBhcmFtZXRyaWM0Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gKGFsc28gY2FsbGVkIHRoZSBNYW5uLVdoaXRuZXkgVSB0ZXN0KSBmb3IgaW5kZXBlbmRlbnQgc2FtcGxlcykgYW5kIHRoZSBbdHdvLXNhbXBsZSBLb2xtb2dvcm92LVNtaXJub3YgdGVzdF0oaHR0cHM6Ly93d3cuaXRsLm5pc3QuZ292L2Rpdjg5OC9zb2Z0d2FyZS9kYXRhcGxvdC9yZWZtYW4xL2F1eGlsbGFyL2tzMnNhbXAuaHRtKXt0YXJnZXQ9Il9ibGFuayJ9IChLUykgYm90aCBkbyBub3QgYXNzdW1lIG5vcm1hbGl0eSAoaGFzIGJvdGggcGFpcmVkIGFuZCB1bnBhaXJlZCBtZXRob2RzKS4gVGh1cyB0aGVzZSB0ZXN0cyBzaG91bGQgYmUgY29uc2lkZXJlZCB3aGVuIHRoZSBkYXRhIG9mIGVpdGhlciBncm91cHMgZG9lcyBub3QgYXBwZWFyIHRvIGJlIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIGFuZCBwYXJ0aWN1bGFybHkgd2hlbiB0aGUgbnVtYmVyIG9mIHNhbXBsZXMgaXMgbG93LgoKSW1wb3J0YW50bHkgdGhlIEtTIHRlc3QgZG9lcyBub3QgYXNzdW1lIG5vcm1hbGl0eSBvciBlcXVhbCB2YXJpYW5jZSwgd2hpbGUgdGhlIFdpbGNveG9uIHNpZ25lZCByYW5rIHRlc3QgZG9lcyBhc3N1bWUgZXF1YWwgdmFyaWFuY2UuIEhlcmUgaXMgaG93IHlvdSB3b3VsZCBwZXJmb3JtIHRoZXNlIHRlc3RzLiBIb3dldmVyIGluIG91ciBjYXNlLCBiZWNhdXNlIHRoZSB2YXJpYW5jZSBpcyBub3QgZXF1YWwgYmV0d2VlbiBzb21lIG9mIG91ciBncm91cHMgb2YgaW50ZXJlc3QsIHRoZSBLUyB0ZXN0IHdvdWxkIGJlIG1vcmUgYXBwcm9wcmlhdGUuIEJvdGggdGhlICR0JC10ZXN0IGFuZCB0aGUgS1MgdGVzdCBldmFsdWF0ZSBpZiB0aGUgZGlzdHJpYnV0aW9ucyBvZiB0aGUgdHdvIGdyb3VwcyBhcmUgaWRlbnRpY2FsLCBob3dldmVyIHRoZSBLUyB0ZXN0IGRvZXMgbm90IHBhcnRpY3VsYXJseSB0ZXN0IGFueSBhc3BlY3Qgb2YgdGhlIGRpc3RyaWJ1dGlvbiBsaWtlIHRoZSBtZWFuLCB0aGVyZWZvcmUgdGhlcmUgYXJlIG5vIGNvbmZpZGVuY2UgaW50ZXJ2YWxzIGluIHRoZSBvdXRwdXQgdXNpbmcgdGhpcyB0ZXN0LiAKCmBgYHtyfQoKa3MudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjIwMTciLCAKICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKQoKa3MudGVzdChwdWxsKGZpbHRlcihCTUlfbG9uZywgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIiksIEJNSSksIAogICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiVXJiYW4iKSwgQk1JKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKQpgYGAKCgpXaGF0IGFib3V0IHRoZSBkaWZmZXJlbmNlIGluIGZlbWFsZSBCTUkgZnJvbSAxOTg1IHRvIDIwMTcgZm9yIGJvdGggcmVnaW9ucz8KUmVjYWxsIHRoYXQgdGhlIHZhcmlhbmNlIHdhcyBlcXVhbCBmb3IgdGhlc2UgY29tcGFyaXNvbnMuCgpgYGB7cn0KCndpbGNveC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgPT0gIjE5ODUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpLCBCTUkpLAogICAgICAgICAgIHB1bGwoZmlsdGVyKEJNSV9sb25nLCBTZXggPT0gIldvbWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMjAxNyIsIAogICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSwgQk1JKSwKICAgICAgICAgICBwYWlyZWQgPSBUUlVFKQoKd2lsY294LnRlc3QocHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICAgWWVhciA9PSAiMTk4NSIsIAogICAgICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlVyYmFuIiksIEJNSSksCiAgICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2xvbmcsIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpLCBCTUkpLAogICAgICAgICAgIHBhaXJlZCA9IFRSVUUpCgpgYGAKVGhlcmUgaXMgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGFjcm9zcyB0aW1lIGZvciBib3RoIHJlZ2lvbnMsIGFzIHdlIHNhdyB3aXRoIHRoZSAkdCQtdGVzdC4gVGhlcmUgaXMgYWxzbyBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgYnkgcmVnaW9uIGZvciBlYWNoIHllYXIuIEhvd2V2ZXIsIHRoZSBwLXZhbHVlcyBhcmUgYSBiaXQgbGFyZ2VyIGZvciB0aGUgS1MgdGVzdCByZXN1bHRzIHRoYW4gd2Ugc2F3IHdpdGggdGhlICR0JC10ZXN0LgoKIyMjIE11bHRpcGxlIFRlc3RpbmcgQ29ycmVjdGlvbgoKTGV0J3MgdGFrZSBhIGxvb2sgYmFjayBhdCB0aGUgcXVlc3Rpb25zIHdlIHdhbnRlZCB0byBhbnN3ZXI6CjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMikgSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PyBBZ2FpbiwgSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwozKSBIb3cgZG8gZGlmZmVyZW50IGNvdW50cmllcyBjb21wYXJlIGZvciBCTUkgZXN0aW1hdGVzPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCkl0J3MgaW1wb3J0YW50IHRvIG5vdGUgdGhhdCB1bHRpbWF0ZWx5IHdlIHdhbnRlZCB0byB0ZXN0IDQgZGlmZmVyZW50IHRlc3RzIHRvIGFuc3dlciBxdWVzdGlvbiAxIGFuZCAyOgoKMSkgSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGluIG1lYW4gQk1JIGZvciB3b21lbiBiZXR3ZWVuIFJ1cmFsIGFuZCBVcmJhbiBhcmVhcyBpbiAxOTg1PwoyKSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gbWVhbiBCTUkgZm9yIHdvbWVuIGJldHdlZW4gUnVyYWwgYW5kIFVyYmFuIGFyZWFzIGluIDIwMTc/CjMpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBpbiBtZWFuIEJNSSBmb3Igd29tZW4gYmV0d2VlbiAxOTg1IGFuZCAyMDE3IGluIFJ1cmFsIGFyZWFzPwo0KSBJcyB0aGVyZSBhIGRpZmZlcmVuY2UgaW4gbWVhbiBCTUkgZm9yIHdvbWVuIGJldHdlZW4gMTk4NSBhbmQgMjAxNyBpbiBVcmJhbiBhcmVhcz8KCldoZW4gd2UgdGVzdCBtdWx0aXBsZSBxdWVzdGlvbnMgbGlrZSB0aGlzLCB3ZSBuZWVkIHRvIGNvcnJlY3QgZm9yIHRoZSBtdWx0aXBsZSB0ZXN0cyB0aGF0IHdlIGFyZSBwZXJmb3JtaW5nLgoKVGhlIG1vcmUgd2UgdGVzdCBkYXRhLCB0aGUgbW9yZSBsaWtlbHkgd2UgYXJlIHRvIHNlZSBhIHNpZ25pZmljYW50IGZpbmRpbmcganVzdCBieSBbcmFuZG9tIGNoYW5jZV0oaHR0cHM6Ly93d3cuc3RhdC5iZXJrZWxleS5lZHUvfm1nb2xkbWFuL1NlY3Rpb24wNDAyLnBkZil7dGFyZ2V0PSJfYmxhbmsifSBldmVuIHdoZW4gdGhlIGZpbmRpbmcgaXMgaW4gZmFjdCBub3QgcmVhbC4gSXQgYWxsIGNvbWVzIGRvd24gdG8gcHJvYmFiaWxpdHkuCgojIyMjIFByb2JhYmlsaXR5CgpZb3UgbWF5IHJlY2FsbCB0aGF0IHByb2JhYmlsaXR5IGlzIHRoZSBjaGFuY2UgdGhhdCBhbiBldmVudCB3aWxsIGhhcHBlbiBhbmQgaXQgcmFuZ2VzIGZyb20gMCB0byAxLiAKWW91IGNhbiBhbHNvIHRoaW5rIG9mIGl0IGFzIGEgcGVyY2VudGFnZSBvZiAwJSAocHJvYmFiaWxpdHkgPTApIHRvIDEwMCUgKHByb2JhYmlsaXR5ID0gMSkgb2YgY2hhbmNlIHRoYXQgYW4gZXZlbnQgd2lsbCBoYXBwZW4uCgohW10oaHR0cHM6Ly93d3cubWF0aHNpc2Z1bi5jb20vZGF0YS9pbWFnZXMvcHJvYmFiaWxpdHktbGluZS5zdmcpCmh0dHBzOi8vd3d3Lm1hdGhzaXNmdW4uY29tL2RhdGEvaW1hZ2VzL3Byb2JhYmlsaXR5LWxpbmUuc3ZnCgpJZiB3ZSBjb25zaWRlciBmbGlwcGluZyBhIGNvaW4sIHRoZSBwcm9iYWJpbGl0eSBvZiBhbiBldmVudCBoYXBwZW5pbmcgKGhlYWRzKSBpcyBhbHdheXMgZXF1YWwgdG8gIDEgKCBvciAxMDAlIGNoYW5jZSkgbWludXMgdGhlIHByb2JhYmlsaXR5IG9mIHRoZSBldmVudCBub3QgaGFwcGVuaW5nICh0YWlscyBpbnN0ZWFkIG9mIGhlYWRzKSBiZWNhdXNlIHRoZSB0b3RhbCBwcm9iYWJpbGl0eSBjYW4gbm90IGV4Y2VlZCAxMDAlLgoKICAgICAgICBwcm9iYWJpbGl0eSBvZiAxICgxMDAlIGNoYW5jZSkgPSB0aGUgcHJvYmFiaWx0eSBvZiBoZWFkcyAoNTAlIGNoYW5jZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIHRoZSBwcm9iYWJpbGl0eSBvZiB0YWlscyAoNTAlIGNoYW5jZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxID0gUChoZWFkcykgKyBQKHRhaWxzKQogICAgICAgICAgICBwcm9iYWJpbGl0eSBvZiBvbmUgb3V0Y29tZSA9IDEgLSB0aGUgcHJvYmFiaWxpdHkgb2YgdGhlIG90aGVyIG91dGNvbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUChoZWFkcykgPSAxIC0gUCh0YWlscykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQKHRhaWxzKSA9IDEgLSBQKGhlYWRzKQoKSWYgd2UgdGhpbmsgYWJvdXQgdGhlIHByb2JhYmlsaXR5IG9mIGdldHRpbmcgc2lnbmlmaWNhbnQgb3Igbm9uc2lnbmlmaWNhbnQgcmVzdWx0cyB3ZSBjYW4gdGhpbmsgb2YgaXQgbGlrZSB0aGlzOgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPSBQKHNpZ25pZmlhbnQgcmVzdWx0cykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgUChubyBzaWduaWZpY2FudCByZXN1bHRzKQogICAgICAgICAgICAgICAgUChzaWduaWZpY2FudCByZXN1bHRzKSA9IDEgLSBQKG5vIHNpZ25pZmljYW50IHJlc3VsdHMpCgojIyMgQWxwaGEKCkFscGhhIGlzIHRoZSBhbW91bnQgb2YgcmlzayB0aGF0IHlvdSBhcmUgd2lsbGluZyB0byBhY2NlcHQgdGhhdCBhIHN0YXRpc3RpY2FsIHRlc3QgcmVzdWx0IGlzIGFjdHVhbGx5IGEgZmFsc2UgcG9zaXRpdmUsIGluIG90aGVyIHdvcmRzIHdlIHJlamVjdCB0aGUgbnVsbCBoeXBvdGhlc2lzIHdoZW4gdGhlIG51bGwgaHlwb3RoZXNpcyBpcyB0cnVlLiBUaGlzIGlzIGFsc28gY2FsbGVkIFt0eXBlIDEgZXJyb3JdKGh0dHBzOi8vd2ViLm1hLnV0ZXhhcy5lZHUvdXNlcnMvbWtzL3N0YXRtaXN0YWtlcy9lcnJvcnR5cGVzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0uIEEgc2lnbmlmaWNhbmNlIHRocmVzaG9sZCBvZiAuMDUgaXMgY3VzdG9tYXJ5IGFuZCBpdCBtZWFucyB0aGF0IHdlIGFyZSBhY2NlcHRpbmcgYSA1JSBjaGFuY2UgdGhhdCBvdXIgcmVzdWx0IGlzIGFjdHVhbGx5IGEgZmFsc2UgcG9zaXRpdmUuCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IHByb2JhYmlsaXR5IG9mIGZhbHNlIHNpZ25pZmljYW50IHJlc3VsdHMgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgzrEgPSBQKE1ha2luZyBhIHR5cGUgMSBlcnJvcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKUmVtZW1iZXIgdGhhdCBpbiBvdXIgc3RhdGlzdGljYWwgdGVzdHMgaWYgdGhlIHAtdmFsdWUgPCBhbHBoYSBpdCBpcyBjb25zaWRlcmVkIHNpZ25pZmljYW50IGFuZCBpZiBwLXZhbHVlID4gYWxwaGEgaXQgaXMgY29uc2lkZXJlZCBub3Qgc2lnbmlmaWNhbnQKCgpCdXQgd2hhdCByZWFsbHkgaXMgdGhlIFtwLXZhbHVlXShodHRwczovL3Rvd2FyZHNkYXRhc2NpZW5jZS5jb20vcC12YWx1ZXMtZXhwbGFpbmVkLWJ5LWRhdGEtc2NpZW50aXN0LWY0MGE3NDZjZmM4KXt0YXJnZXQ9Il9ibGFuayJ9PwoKIyMjIHAtdmFsdWVzCgpUaGUgcCBpbiBwLXZhbHVlIHN0YW5kcyBmb3IgPGI+cHJvYmFiaWxpdHk8L2I+IC0gdGhlIHByb2JhYmlsaXR5IHRoYXQgd2Ugd291bGQgb2J0YWluIHRoZSBzdGF0aXN0aWNzIChmb3IgZXhhbXBsZSB0aGUgdCBpbiBvdXIgc3R1ZGVudCAkdCQtdGVzdHMgYmFzZWQgb24gdGhlIG1lYW5zIG9mIG91ciBncm91cHMgb2YgY29tcGFyaXNvbikganVzdCBieSByYW5kb20gY2hhbmNlIGFsb25lLiBUaGVyZWZvcmUgYSBwLXZhbHVlIG9mIDAuMDIgbWVhbnMgdGhhdCB0aGVyZSBpcyBhIDIgcGVyY2VudCBjaGFuY2UgdGhhdCBvdXQgZGF0YSBtYXkgbG9vayB0aGUgd2F5IGl0IGRvZXMganVzdCBiZWNhdXNlIG9mIHJhbmRvbSBjaGFuY2UgYW5kIG5vdCBiZWNhdXNlIHRoZXJlIGlzIHJlYWxseSBhIGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zIG9mIHRoZSBncm91cHMgb2YgaW50ZXJlc3QuCgpTbyB0aGVuIGlmIGFscGhhIGlzIHRoZSB0aHJlc2hvbGQgZm9yIHRoZSBwLXZhbHVlIGZvciBvYnRhaW5pbmcgZmFsc2Ugc2lnbmlmaWNhbnQgcmVzdWx0cyB0aGVuIHRoZSBwcm9iYWJpbGl0eSBvZiBub3QgbWFraW5nIGluY29ycmVjdCBjb25jbHVzaW9ucyBpcyAxIC0gYWxwaGE6CgogICAgICAgICAgICAgICAgIFAoTm90IG1ha2luZyBhbiBlcnJvcikgPSAxIC0gzrEKCmBgYHtyfQojUChOb3QgbWFraW5nIGFuIGVycm9yKSA9IDEgLSDOsQoxLS4wNSAKCmBgYAogIApPSyBzbyBpZiB3ZSB1c2UgYW4gYWxwaGEgb2YgLjA1IHdlIGFyZSBhY2NlcHRpbmcgdGhhdCA5NSUgb2YgdGhlIHRpbWUgd2Ugd2lsbCBub3QgbWFrZSBhIFR5cGUgMSBlcnJvciBhbmQgNSAlIG9mIHRoZSB0aW1lIHdlIHdpbGwganVzdCBieSByYW5kb20gY2hhbmNlLiAgICAgICAgICAgICAgClRha2luZyB0aGlzIG9uZSBzdGVwIGZ1cnRoZXI6CgogICAgICAgICAgICAgICAgICAgICBQKE1ha2luZyBhbiBlcnJvcikgPSAxIC0gUChOb3QgbWFraW5nIGFuIGVycm9yKQogICAgICAgICAgICAgICAgICAgICBQKE1ha2luZyBhbiBlcnJvcikgPSAxIC0gKDEgLSDOsSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIApIZXJlIHdlIGNhbiBzZWUgdGhhdCB0aGlzIGNoZWNrcyBvdXQ6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKYGBge3J9CiNQKE1ha2luZyBhbiBlcnJvcikgPSAxIC0gKDEgLSDOsSkKMS0oMS0uMDUpCmBgYAoKU28gd2hhdCBoYXBwZW5zIGlmIHdlIHBlcmZvcm0gbXVsdGlwbGUgdGVzdHM/CgpUaGUgcHJvYmFiaWxpdHkgb2Ygbm90IG1ha2luZyBhIHR5cGUgMSBlcnJvciB3b3VsZCByZW1haW4gdGhlIHNhbWUgZm9yIGVhY2ggdGVzdC4gVGhlcmVmb3JlIHdlIG5lZWQgdG8gbXVsdGlwbHkgdGhlIHByb2JhYmlsaXRpZXMgdG9nZXRoZXIgZWFjaCB0aW1lIHRvIGRldGVybWluZSB0aGUgb3ZlciBhbGwgcHJvYmFiaWxpdHkgb2YgbWFraW5nIGFuIGVycm9yIGFjcm9zcyBtdWx0aXBsZSB0ZXN0cy4gU2VlIFtoZXJlXShodHRwOi8vbWF0aGZvcnVtLm9yZy9saWJyYXJ5L2RybWF0aC92aWV3Lzc0MDY1Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gYWJvdXQgd2h5IHdlIG11bHRpcGx5IHByb2JhYmlsaXRpZXMgdG9nZXRoZXIuCgogICAgICAgIFAoTm90IG1ha2luZyBhbiBlcnJvciBpbiBtIHRlc3RzKSA9ICgxIC0gzrEpXm0KICAgIFAoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gbSB0ZXN0cykgPSAxIC0gKDEgLSDOsSlebQoKTGV0J3MgY29uc2lkZXIgaWYgd2UgcGVyZm9ybWVkIDEwIGRpZmZlcmVudCBzdGF0aXN0aWNhbCB0ZXN0cyBhbmQgaWYgd2UgYXMgdXN1YWwgY29uc2lkZXJlZCB0aGUgc2lnbmlmaWNhbmNlIHRocmVzaG9sZCBhbHBoYSBvZiAuMDU6CgpTbyB0aGUgcHJvYmFiaWxpdHkgb2YgZ2V0dGluZyAxIHNpZ25pZmljYW50IHJlc3VsdCB3aXRoIDEwIHRlc3RzIGlzOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCmBgYHtSfQojUChNYWtpbmcgYXQgbGVhc3QgMSBlcnJvciBpbiAxMCB0ZXN0cykgPSAxIC0gKCgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKDEgLSDOsSkoMSAtIM6xKSgxIC0gzrEpKQojdGhpcyBpcyB0aGUgc2FtZSBhczoKI1AoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gMTAgdGVzdHMpID0gMSAtICgxIC0gzrEpXjEwCiAxLSAoMS0uMDUpXjEwCmBgYAoKU28gdGhlcmUgaXMgYSA0MCUgY2hhbmNlIHRoYXQgdGhhdCB0aGVyZSB3aWxsIGJlIGEgc2lnbmlmaWNhbnQgZmluZGluZyBzaW1wbHkgZHVlIHRvIHJhbmRvbSBjaGFuY2UgYWxvbmUuCgpXaGF0IGFib3V0IDEwMCB0ZXN0cz8KCmBgYHtSfQoKI1AoTWFraW5nIGF0IGxlYXN0IDEgZXJyb3IgaW4gMTAwIHRlc3RzKSA9IDEgLSAoMSAtIM6xKV4xMDAKIDEtICgxLS4wNSleMTAwCmBgYAogICAgICAgICAgICAgICAgICAgICAgICAKWWlrZXMhISBUaGF0IGlzIGFsbW9zdCBhIDEwMCUgY2hhbmNlIHRoYXQgdGhlcmUgd2lsbCBiZSBhIHNpZ25pZmljYW50IGZpbmRpbmcgc2ltcGx5IGR1ZSB0byBjaGFuY2UgYWxvbmUhCgpNdWNoIG9mIHRoaXMgZXhwbGFuYXRpb24gaXMgZGVzY3JpYmVkIGluIHRoaXMgW2xlY3R1cmVdKGh0dHBzOi8vd3d3LmdzLndhc2hpbmd0b24uZWR1L2FjYWRlbWljcy9jb3Vyc2VzL2FrZXkvNTYwMDgvbGVjdHVyZS9sZWN0dXJlMTAucGRmKXt0YXJnZXQ9Il9ibGFuayJ9LgoKCk9uZSB3YXkgdG8gY29ycmVjdCBmb3IgdGhpcyBpcyBtdWx0aXBsZSB0ZXN0aW5nIGlzc3VlIGlzIHVzaW5nIHRoZSBbQm9uZmVycm9uaSBtZXRob2RdKGh0dHA6Ly9tYXRod29ybGQud29sZnJhbS5jb20vQm9uZmVycm9uaUNvcnJlY3Rpb24uaHRtbCl7dGFyZ2V0PSJfYmxhbmsifS4gCgpJbiB0aGlzIG1ldGhvZCB3ZSB3b3VsZCBkaXZpZGUgb3VyIHNpZ25pZmljYW5jZSB0aHJlc2hvbGQgKGdlbmVyYWxseSAwLjA1KSBieSB0aGUgbnVtYmVyIG9mIHRlc3RzLgoKYGBge3J9Ci4wNS80ICMgNCB0ZXN0cwpgYGAKCk91ciBuZXcgc2lnbmlmaWNhbmNlIHRocmVzaG9sZCBpcyBub3cgMC4wMTI1LiAKVGh1cyBvdXIgcC12YWx1ZXMgc2hvdWxkIGJlIGxlc3MgdGhhbiB0aGlzIHZhbHVlIGZvciB1cyB0byByZWplY3QgdGhlIG51bGwgdGhhdCB0aGVyZSBpcyBubyBkaWZmZXJlbmNlIGluIG1lYW5zLgpJbiBhbGwgY2FzZXMsIG91ciBwLXZhbHVlcyB3ZXJlIGxlc3MgdGhhbiAwLjAxMjUuClNvIHdlIHNlZSBhIHNpZ25pZmljYW50IGRpZmZlcmVuY2UgaW4gdGhlIG1lYW5zIG9mIHRoZSBncm91cHMgYWZ0ZXIgbXVsdGlwbGUgdGVzdGluZyBjb3JyZWN0aW9uIGZvciBvdXIgZGlmZmVyZW50IHRlc3RzLgoKQWdhaW4sIGl0IHdvdWxkIGJlIHJlYXNvbmFibGUgdG8gdXNlIHRoZSAkdCQtdGVzdCBiZWNhdXNlIGl0IGlzIHJvYnVzdCB0byBkZXZpYXRpb25zIGluIG5vcm1hbGl0eSB3aGVuIHNhbXBsZXMgYXJlIHJlbGF0aXZlbHkgbGFyZ2UuIApXZSBjYW4gc2VlIHRoYXQgd2Ugb2J0YWluZWQgdGhlIHNhbWUgcmVzdWx0cyByZWdhcmRsZXNzIG9mIHRoZSB0ZXN0IHRoYXQgd2UgdXNlZC4KSG93ZXZlciwgaWYgc2FtcGxlIHNpemVzIGFyZSBzbWFsbCAoZ2VuZXJhbGx5IHNwZWFraW5nIG48MTUgZm9yIGVhY2ggZ3JvdXApLCB0aGVuIHRoZXNlIG5vbnBhcmFtZXRyaWMgb3B0aW9ucyBhcmUgdXNlZnVsIHRvIGtub3cuCgpUaGUgRCB2YWx1ZXMgaW4gdGhlIG91dHB1dCBvZiBvdXIgS1MgdGVzdHMsIHNob3cgdGhlIG1hZ25pdHVkZSBvZiBkaXN0YW5jZSBpbiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBkaXN0cmlidXRpb25zIG9mIHRoZSBncm91cHMgdGVzdGVkLgpZb3UgbWF5IG5vdGljZSB0aGF0IHRoZSBEIHZhbHVlIGlzIGxhcmdlciBmb3IgdGhlIHRlc3RzIG9mIEJNSSBhY3Jvc3MgdGltZSByYXRoZXIgdGhlbiBhY3Jvc3MgcmVnaW9uLgpJbiB0aGVzZSB0ZXN0cyB0aGUgcC12YWx1ZSB3YXMgYWxzbyBzbWFsbGVyLgoKIyMgRGF0YSBWaXN1YWxpemF0aW9uCgpBZ2FpbiB3ZSB3aWxsIHV0aWxpemUgYGdncGxvdDJgIHRvIGNyZWF0ZSBwbG90cyB0byBsb29rIGF0IHRoZSBkaXJlY3Rpb25hbCBhbmQgbWFnbml0dWRlIG9mIHRoZSBkaWZmZXJlbmNlcyBpbiBCTUkgd2UgYXJlIGludGVyZXN0ZWQgaW4uIElmIHlvdSBuZWVkIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcGxlYXNlIHNlZSBbaGVyZV0oaHR0cHM6Ly9vcGVuY2FzZXN0dWRpZXMuZ2l0aHViLmlvL29jcy1oZWFsdGhleHBlbmRpdHVyZS9vY3MtaGVhbHRoZXhwZW5kaXR1cmUuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifS4gVGhlIHRvcCB0d28gbGluZXMgb2YgdGhlIGNvZGUgZm9yIHRoZSBmb2xsb3dpbmcgcGxvdHMsIGZpbHRlciB0aGUgZGF0YSB0byBvbmx5IHNwZWNpZmljIHZhbHVlcyBvZiBpbnRlcmVzdC4gVGhlbiB3ZSBsYXllciB3aGF0IGlzIGNhbGxlZCBhIGppdHRlciBvbiB0b3Agb2YgYSBib3ggcGxvdC4gQSBqaXR0ZXIgaXMgZXNzZW50aWFsbHkgYSBkb3QgcGxvdCBidXQgd2l0aCBzb21lIHZhcmlhdGlvbiBvbiB0aGUgbG9jYXRpb24gb2YgdGhlIHBvaW50cyBzbyB0aGF0IHRoZXkgZG8gbm90IGxpbmUgdXAgdmVydGljYWxseSB3aGljaCBjYW4gbWFrZSB0aGUgaW5kaXZpZHVhbCBwb2ludHMgZGlmZmljdWx0IHRvIHNlZS4KCk91ciBmaXJzdCBtYWluIHF1ZXN0aW9uIHdhczogSXMgdGhlcmUgYSBkaWZmZXJlbmNlIGJldHdlZW4gcnVyYWwgYW5kIHVyYmFuIEJNSSBlc3RpbWF0ZXMgYXJvdW5kIHRoZSB3b3JsZD8KTGV0J3MgbG9vayBhdCB0aGUgbmF0aW9uYWwgbWVhbiBCTUkgZXN0aW1hdGVzIGZvciBlYWNoIG9mIHRoZSB5ZWFyczoKYGBge3J9CkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyID09ICIxOTg1IiwgCiAgICAgICAgIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBSZWdpb24sIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpIAojIHRoZSB3aWR0aCBkZXRlcm1pbmVzIGhvdyB3aWRlIHRoZSBwb2ludHMgYXJlIHBsb3R0ZWQKCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyID09ICIyMDE3IiwgCiAgICAgICAgIFJlZ2lvbiAhPSAiTmF0aW9uYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBSZWdpb24sIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpCgpgYGAKCk91ciAybmQgbWFpbiBxdWVzdGlvbiB3YXM6IEhvdyBoYXZlIEJNSSBlc3RpbWF0ZXMgY2hhbmdlZCBmcm9tIDE5ODUgdG8gMjAxNz8KTGV0J3MgbG9vayBhdCB0aGUgY2hhbmdlIGluIHJ1cmFsIGFuZCB1cmJhbiBtZWFuIEJNSSBlc3RpbWF0ZXMgb3ZlciB0aW1lOgpgYGB7cn0KI3RoaXMgdGltZSB3ZSB3aWxsIGFkZCB0aXRsZXMgZm9yIFJ1cmFsIGFuZCBVcmJhbiB1c2luZyBnZ3RpdGxlKCkKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICAjIGZpbHRlcmluZyB0aGlzIHdheSBhbGxvd3MgdXMgdG8ga2VlcCBkYXRhIGZyb20gYm90aCB5ZWFycwogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBnZ3RpdGxlKCJSdXJhbCIpCgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJVcmJhbiIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBnZ3RpdGxlKCJVcmJhbiIpCgpgYGAKCkxldCdzIHB1dCB0aGUgcGxvdHMgdG9nZXRoZXIgdG8gc2VlIGhvdyB0aGUgY2hhbmdlIG92ZXIgdGhlIHllYXJzIGRpZmZlcnMgYmV0d2VlbiB0aGUgcmVnaW9ucy4KV2Ugd2lsbCB1c2UgYWdhaW4gdXNlIGBmYWNldF93cmFwKClgIHRvIGRvIHRoaXM6CgpgYGB7cn0KCkJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gJWluJSBjKCJSdXJhbCIsICJVcmJhbiIpKSAlPiUKICAjIGZpbHRlcmluZyB0aGlzIHdheSBhbGxvd3MgdXMgdG8ga2VlcCBkYXRhIGZyb20gYm90aCB5ZWFycwogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KCkgKwogIGdlb21faml0dGVyKHdpZHRoID0gLjMpICsKICBmYWNldF93cmFwKH4gUmVnaW9uKQoKIyB3ZSB3b3VsZCBhbHNvIGdldCBuYXRpb25hbCBkYXRhIHdpdGhvdXQgYFJlZ2lvbiAlaW4lIGMoIlJ1cmFsIiwgIlVyYmFuIikpYAoKYGBgCkluZGVlZCB0aGUgY2hhbmdlIGluIEJNSSBvdmVyIHRpbWUgbG9va3MgYmlnZ2VyIGluIHRoZSBydXJhbCBhcmVhcyEKCgpPbmUgdGhpcmQgbWFpbiBxdWVzdGlvbnMgd2FzOiBIb3cgZG8gdGhlIGRpZmZlcmVudCBjb3VudHJpZXMgY29tcGFyZT8gIE9yIGluIG90aGVyIHdvcmRzIHdoYXQgZG8gdGhlIGluZGl2aWR1YWwgZG90cyByZXByZXNlbnQgaW4gb3VyIGJveCBwbG90cz8KV2Ugd2lsbCB0YWtlIGEgbG9vayB1c2luZyBgZ2VvbV9sYWJlbCgpYDoKCmBgYHtyfQoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gQk1JKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBnZW9tX2ppdHRlcih3aWR0aCA9IC4zKSArCiAgZ2VvbV9sYWJlbChhZXMobGFiZWwgPSBDb3VudHJ5KSkKCmBgYAoKSWYgd2UgaW5jbHVkZSBhbGwgY291bnRyeSBuYW1lcyB0aGlzIGlzIGEgYml0IHRvbyBtdWNoLi4uIHNvIHBlcmhhcHMgd2Ugc2hvdWxkIGZvY3VzIG9uIGp1c3QgdGhlIGV4dHJlbWUgQk1JIHZhbHVlcyB1c2luZyBgZmlsdGVyKClgIGZ1bmN0aW9uIG9mIHRoZWBkcGx5cmAgcGFja2FnZS4gV2Ugd2lsbCBhbHNvIHVzZSB0aGUgYGdncmVwZWxgIHBhY2thZ2UgdG8gaGF2ZSBvdXIgbGFiZWxzIG5vdCBvdmVybGFwIGVhY2ggb3RoZXIuCgpQYXJ0IG9mIHRoZSB0aGlyZCBxdWVzdGlvbiB3YXM6IEhvdyBkb2VzIHRoZSBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EgY29tcGFyZT8gU28gbGV0J3MgbGFiZWwgdGhlIGRhdGEgcG9pbnRzIGZvciB0aGUgVW5pdGVkIHN0YXRlcy4KCmBgYHtyfQoKQk1JX2xvbmcgJT4lIAogIGZpbHRlcihTZXggPT0gIldvbWVuIiwgCiAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgIFJlZ2lvbiA9PSAiUnVyYWwiKSAlPiUKICBnZ3Bsb3QoYWVzKHggPSBZZWFyLCB5ID0gQk1JKSkgKwogIGdlb21fYm94cGxvdCgpICsKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgZmlsdGVyKEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JKSwKICAgICAgICAgICAgICB3aWR0aCA9IC4wMikgKwogIGdncmVwZWw6Omdlb21fdGV4dF9yZXBlbChkYXRhPUJNSV9sb25nICU+JSAKICAgICAgICAgICAgICBmaWx0ZXIoU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICBSZWdpb24gPT0gIlJ1cmFsIikgJT4lCiAgICAgICAgICAgICAgZmlsdGVyKEJNST4zMSB8IEJNSTwxOSB8IENvdW50cnkgPT0gIlVuaXRlZCBTdGF0ZXMgb2YgQW1lcmljYSIpLCAKICAgICAgICAgICAgICBhZXMoeCA9WWVhciwgeSA9Qk1JLCBsYWJlbCA9IENvdW50cnkpKQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIApgYGAKCkFuZCBsZXQncyBmaWxsIHRoZSBib3ggcGxvdHMgd2l0aCBjb2xvciBhbmQgb3V0bGluZSBpbiBibGFjazoKYGBge3J9CgpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogIGdncGxvdChhZXMoeCA9IFllYXIsIHkgPSBCTUkpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siLCBhZXMoZmlsbCA9IFllYXIpKSArCiAgZ2VvbV9qaXR0ZXIoZGF0YT1CTUlfbG9uZyAlPiUgCiAgICAgICAgICAgICAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogICAgICAgICAgICAgIHN1YnNldChCTUk+MzEgfCBCTUk8MTkgfCBDb3VudHJ5ID09ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSksCiAgICAgICAgICAgICAgd2lkdGggPSAuMDIpICsKICBnZ3JlcGVsOjpnZW9tX3RleHRfcmVwZWwoZGF0YT1CTUlfbG9uZyAlPiUgCiAgICAgICAgICAgICAgZmlsdGVyKFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgWWVhciAlaW4lIGMoIjE5ODUiLCAiMjAxNyIpLCAKICAgICAgICAgICAgICAgICAgICAgUmVnaW9uID09ICJSdXJhbCIpICU+JQogICAgICAgICAgICAgIHN1YnNldChCTUk+MzEgfCBCTUk8MTkgfCBDb3VudHJ5ID09ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiKSwgCiAgICAgICAgICAgICAgYWVzKHggPVllYXIsIHkgPUJNSSwgbGFiZWwgPSBDb3VudHJ5KSkKCmBgYAoKCiMjIyBPdmVyYWxsIGRpZmZlcmVuY2VzCgpMZXQncyB0YWtlIGEgbG9vayBhdCBhbGwgdGhlIGRhdGEgdG9nZXRoZXIsIGluY2x1ZGluZyB0aGUgZGF0YSBmb3IgbWVuOgpgYGB7cn0KZ2dwbG90KEJNSV9sb25nLCBhZXMoeCA9IFllYXIsIHkgPSBCTUksIGNvbCA9IFJlZ2lvbikpICsKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIgLCBhZXMoZmlsbCA9IFJlZ2lvbikpICsgCiAgZmFjZXRfZ3JpZCh+IFNleCkgICAKYGBgCgpUaGF0J3MgdXNlZnVsLCBidXQgbGV0J3MgbG9vayBhdCB0aGUgaW5kaXZpZHVhbCBwb2ludHMgYW5kIGluY2x1ZGUgb3VyIGNvdW50cnkgbGFiZWxzLCB0byBkbyBzbyBsZXRzIGNoYW5nZSBvdXIgVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIGxhYmVsIHRvIFVTQToKYGBge3J9CkJNSV9sb25nW1siQ291bnRyeSJdXSA8LUJNSV9sb25nW1siQ291bnRyeSJdXSAlPiUKICBzdHJfcmVwbGFjZSggcGF0dGVybiA9ICJVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EiLCByZXBsYWNlbWVudCA9ICJVU0EiKQoKCmdncGxvdChCTUlfbG9uZywgYWVzKHggPSBZZWFyLCB5ID0gQk1JLCBjb2wgPSBZZWFyKSkgKyAKICBnZW9tX2JveHBsb3Qob3V0bGllci5zaGFwZSA9IE5BLCBjb2xvciA9ICJibGFjayIgLCBhZXMoZmlsbCA9IFllYXIpKSArIAogIGZhY2V0X2dyaWQofiBTZXggKyBSZWdpb24pICsgCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0PTMwLCBsaW5ldHlwZT0iZGFzaGVkIiwgY29sb3IgPSAicmVkIiwgc2l6ZSA9MSkgKyAKICAjIFRoaXMgd2lsbCBhZGQgYSBob3Jpem9udGFsIGRhc2hlZCBsaW5lIHRvIGluZGljYXRlIHRoZSBvYmVzaXR5IEJNSSB0aHJlc2hvbGQKICBnZW9tX2ppdHRlcihkYXRhPXN1YnNldChCTUlfbG9uZyksIAogICAgICAgICAgICAgIGFlcyh4ID1ZZWFyLCB5ID1CTUkpLCAKICAgICAgICAgICAgICB3aWR0aCA9IC4yLCBzaXplID0yLCBzaGFwZSA9MjEsIGNvbG9yID0gImJsYWNrIiwgZmlsbCA9ICJncmF5IikgKyAKICAjIFRoaXMgd2lsbCBhZGQgdGhlIGluZGl2aWR1YWwgY291bnRyeSBkYXRhIHBvaW50cwogICMgVGhlIHNoYXBlIDIxIGFsbG93cyBmb3IgYSBkaWZmZXJlbnQgZmlsbCBhbmQgb3V0bGluZSBjb2xvcgogICMgVGhlIHdpZHRoIGRldGVybWluZXMgaG93IHdpZGUgdGhlIGppdHRlciBwb2ludHMgYXJlIHBsb3R0ZWQKICBnZW9tX2ppdHRlcihkYXRhPXN1YnNldChCTUlfbG9uZywgQ291bnRyeSA9PSAiVVNBIiksIAogICAgICAgICAgICAgIGFlcyh4ID1ZZWFyLCB5ID1CTUkpLCAKICAgICAgICAgICAgICB3aWR0aCA9IC4wMiwgc2l6ZSA9MTIsIHNoYXBlID0yMSwgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2xvbmcsICBDb3VudHJ5ID09ICJVU0EiKSwgCiAgICAgICAgICAgIGFlcyh4ID1ZZWFyLCB5ID1CTUksbGFiZWw9Q291bnRyeSksIAogICAgICAgICAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCksIAogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIGFuZCBhbmdsZSBvZiB0aGUgeCBheGlzIHBvaW50IGxhYmVscyAKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChzaXplID0gMjApLCAKICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBzdHJpcC50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1KSkgKwogICMgVGhpcyBjaGFuZ2VzIHRoZSBzaXplIG9mIHggYXhpcyBsYWJlbHMgZm9yIHRoZSBmYWNldCAKICAgICAgICBnZ3RpdGxlKCAiRGlmZmVyZW5jZXMgaW4gQk1JIE92ZXIgVGltZSBhbmQgQWNyb3NzIFJlZ2lvbiBUeXBlIGFuZCBHZW5kZXIiKSAKICAjIEFkZCBhICBwbG90IHRpdGxlCiAgIAoKCmBgYAoKSGVyZSB3ZSBjYW4gc2VlIHRoYXQgb3ZlcmFsbCBCTUkgYXBwZWFycyB0byBiZSBpbmNyZWFzaW5nIGdsb2JhbGx5IG92ZXIgdGltZS4gQWRkaXRpb25hbGx5IHdlIGNhbiBzZWUgdGhhdCB0aGlzIGlzIG9jY3VycmluZyBub3QganVzdCBpbiB1cmJhbiBhcmVhcywgYnV0IGFsc28gaW4gcnVyYWwgYXJlYXMuIFRoZSBVUyBpcyBjb25zaXN0ZW50bHkgYWJvdmUgdGhlIG1lZGlhbiBpbiBhbGwgc3RyYXRhIG9mIHRoZSBkYXRhLiBJbiBnZW5lcmFsLCB0aGUgZmVtYWxlIGRhdGEgc2hvd3MgaGlnaGVyIEJNSSB2YWx1ZXMgdGhhbiB0aGUgbWFsZSBkYXRhLiBUaGUgcnVyYWwgVVNBIEJNSSBhcHBlYXJzIHRvIGJlIGhpZ2hlciB0aGFuIHRoZSB1cmJhbiBCTUkgZm9yIGJvdGggbWVuIGFuZCB3b21lbi4gTWFueSBjb3VudHJpZXMgaGF2ZSBhdmVyYWdlIEJNSSBlc3RpbWF0ZXMgYWJvdmUgdGhlIG9iZXNpdHkgdGhyZXNob2xkIG9mIDMwLiBUaHVzIGl0IGFwcGVhcnMgdGhhdCBlZHVjYXRpb24gYW5kIG91dHJlYWNoIHByb2dyYW1zIGZvciB3ZWlnaHQgbWFuYWdlbWVudCBzaG91bGQgZm9jdXMgb24gYm90aCBydXJhbCBhbmQgdXJiYW4gYXJlYXMgYW5kIGJvdGggZ2VuZGVycy4gRWR1Y2F0aW9uIGFuZCBhc3Npc3RhbmNlIGZvciB3b21lbiBtYXkgYmUgZXNwZWNpYWxseSBoZWxwZnVsLiAKCiMjIyBEaWZmZXJlbmNlcyBpbiByYXRlIG9mIGNoYW5nZQoKSG93IGRvZXMgdGhlIHJhdGUgb2YgY2hhbmdlIGluIEJNSSBkaWZmZXIgYmV0d2VlbiBncm91cHM/IFdoaWNoIGdyb3VwIG1pZ2h0IGVzcGVjaWFsbHkgbmVlZCBhdHRlbnRpb24/CgpGaXJzdCBsZXQncyBjYWxjdWxhdGUgdGhlIGRpZmZlcmVuY2VzIGluIEJNSSBmcm9tIDIwMTcgYW5kIDE5ODUgYW5kIGFkZCB0aGlzIHRvIG91ciBCTUlfbG9uZyBkYXRhIG9iamVjdDoKYGBge3J9CgpCTUlfbnVtZXJpY1tbIlJ1cmFsX2RpZmZlcmVuY2UiXV0gPC0gCiAgICAgQk1JX251bWVyaWNbWyJSdXJhbF9CTUlfMjAxNyJdXSAtIEJNSV9udW1lcmljW1siUnVyYWxfQk1JXzE5ODUiXV0KCkJNSV9udW1lcmljW1siVXJiYW5fZGlmZmVyZW5jZSJdXSA8LSAKICAgICBCTUlfbnVtZXJpY1tbIlVyYmFuX0JNSV8yMDE3Il1dIC0gQk1JX251bWVyaWNbWyJVcmJhbl9CTUlfMTk4NSJdXQoKQk1JX251bWVyaWMkTmF0aW9uYWxfZGlmZmVyZW5jZSA8LSAKICAgICBCTUlfbnVtZXJpY1tbIk5hdGlvbmFsX0JNSV8yMDE3Il1dIC0gQk1JX251bWVyaWNbWyJOYXRpb25hbF9CTUlfMTk4NSJdXQoKQk1JX2RpZmZfbG9uZyA8LSBCTUlfbnVtZXJpYyAlPiUgCiAgc2VsZWN0KENvdW50cnk6IE5hdGlvbmFsX2RpZmZlcmVuY2UpICU+JSAKZ2F0aGVyKGtleSA9IFR5cGUsIHZhbHVlID0gRGlmZmVyZW5jZSAsIFJ1cmFsX2RpZmZlcmVuY2U6TmF0aW9uYWxfZGlmZmVyZW5jZSkKCmhlYWQoQk1JX2RpZmZfbG9uZykKYGBgCgpMZXQncyByZXBsYWNlICJVbml0ZWQgc3RhdGVzIG9mIEFtZXJpY2EiIHdpdGggIlVTQSIgYW5kIG1ha2UgYSBwbG90IHdpdGggdGhpcyBkYXRhIHRvIGNvbXBhcmUgdGhlIGNoYW5nZSBpbiBCTUk6CgpgYGB7cn0KCkJNSV9kaWZmX2xvbmdbWyJDb3VudHJ5Il1dIDwtQk1JX2RpZmZfbG9uZ1tbIkNvdW50cnkiXV0gJT4lCiAgc3RyX3JlcGxhY2UoIHBhdHRlcm4gPSAiVW5pdGVkIFN0YXRlcyBvZiBBbWVyaWNhIiwgcmVwbGFjZW1lbnQgPSAiVVNBIikKCgpnZ3Bsb3QoQk1JX2RpZmZfbG9uZywgYWVzKHggPSBUeXBlLCB5ID0gRGlmZmVyZW5jZSwgY29sID0gVHlwZSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBUeXBlKSkgKyAKICBmYWNldF9ncmlkKH4gU2V4KSArCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyksIAogICAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICAgICAgICAgICAgd2lkdGggPSAuMiwgc2l6ZSA9Miwgc2hhcGUgPTIxLCBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHRoZSBpbmRpdmlkdWFsIGNvdW50cnkgZGF0YSBwb2ludHMKICAjIFRoZSBzaGFwZSAyMSBhbGxvd3MgZm9yIGEgZGlmZmVyZW50IGZpbGwgYW5kIG91dGxpbmUgY29sb3IKICAjIFRoZSB3aWR0aCBkZXRlcm1pbmVzIGhvdyB3aWRlIHRoZSBqaXR0ZXIgcG9pbnRzIGFyZSBwbG90dGVkCiAgZ2VvbV9qaXR0ZXIoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZywgQ291bnRyeSA9PSAiVVNBIiksIAogICAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICAgICAgICAgICAgd2lkdGggPSAuMDIsIHNpemUgPTEyLCBzaGFwZSA9MjEsIGNvbG9yID0gImJsYWNrIiwgZmlsbCA9ICJncmF5IikgKyAKICAjIFRoaXMgd2lsbCBhZGQgcG9pbnRzIHRoYXQgYXJlIGxhcmdlciBmb3IgdGhlIFVTQSBkYXRhCiAgZ2VvbV90ZXh0KGRhdGE9c3Vic2V0KEJNSV9kaWZmX2xvbmcsICBDb3VudHJ5ID09ICJVU0EiKSwgCiAgICAgICAgICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlLGxhYmVsPUNvdW50cnkpLCBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCksIAogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIGFuZCBhbmdsZSBvZiB0aGUgeCBheGlzIHBvaW50IGxhYmVscyAKICAgICAgICBheGlzLnRleHQueSA9IGVsZW1lbnRfdGV4dChzaXplID0gMjApLCAKICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBheGlzLnRpdGxlLnggPSBlbGVtZW50X3RleHQoc2l6ZSA9MTUpLCAKICAgICAgICBzdHJpcC50ZXh0LnggPSBlbGVtZW50X3RleHQoc2l6ZSA9IDE1KSkgKwogICAgICAgICMgdGhpcyBjaGFuZ2VzIHRoZSBzaXplIG9mIHggYXhpcyBsYWJlbHMgZm9yIHRoZSBmYWNldAogICAgICAgIGdndGl0bGUoICJDaGFuZ2UgaW4gQk1JIE92ZXIgVGltZSBhbmQgQWNyb3NzIFJlZ2lvbiBUeXBlIGFuZCBHZW5kZXIiKQogICAgICAgICMgQWRkIGEgcGxvdCB0aXRsZSAgCgoKCmBgYAoKV2UgY2FuIG5vdyBzZWUgdGhhdCB0aGUgcmF0ZSBvZiBjaGFuZ2UgZnJvbSAxOTg1IHRvIDIwMTcgYXBwZWFycyB0byBiZSBsYXJnZXIgaW4gdGhlIHdvbWVuIGNvbXBhcmVkIHRvIHRoZSBtZW4gaW4gYWxsIHJlZ2lvbnMuIFRoZSBncm91cCB3aXRoIHRoZSBsYXJnZXN0IGluY3JlYXNlIGluIHRoZSBVU0EgaXMgdGhlIHdvbWVuIGxpdmluZyBpbiBydXJhbCBhcmVhcy4KCkxldCdzIGNoZWNrIHRoZSBkaWZmZXJlbmNlIHdpdGggc29tZSBzdGF0aXN0aWNhbCB0ZXN0czoKCmBgYHtyfQojZmlyc3QgbGV0cyBsb29rIGF0IHRoZSBub3JtYWxpdHkgb2YgdGhlIGRpZmZlcmVuY2UgaW4gQk1JCkJNSV9kaWZmX2xvbmcgJT4lCiAgZ2dwbG90KGFlcyh4PURpZmZlcmVuY2UpKSArCiAgZ2VvbV9oaXN0b2dyYW0oKSArCiAgZmFjZXRfd3JhcCh+IFNleCArIFR5cGUpCiMgaW50ZXJlc3RpbmcuLi50aGUgc3ByZWFkIG9mIGRpZmZlcmVuY2UgaXMgbXVjaCBicm9hZGVyIGZvciB3b21lbiB0aGFuIGZvciBtZW4gCiMgc29tZSB3b21lbiBpbiBzb21lIGNvdW50cmllcyBlc3BlY2lhbGx5IG5lZWQgaGVscCB3aXRoIG9iZXNpdHkKIyB3aGlsZSBvdGhlciBjb3VudHJpZXMgYXJlIGFjdHVhbGx5IHNob3dpbmcgYSBsb3NzIG9mIEJNSQojIHRoZXNlIGNvdW50cmllcyBhcmUgdGhlIHBvaW50cyBvbiBvdXIgcHJldmlvdXMgcGxvdCB3aXRoIGEgZGlmZmVyZW5jZSBiZWxvdyAwCgojTGV0J3Mgc2VlIHdobzoKQk1JX2RpZmZfbG9uZyAlPiUgCiAgYXJyYW5nZShEaWZmZXJlbmNlKQoKIyBJbiBnZW5lcmFsLCBwZW9wbGUgYXBwZWFyIHRvIGhhdmUgbG9zdCB3ZWlnaHQgaW4gR3JlZWNlCgojIExldCdzIGxvb2sgYXQgUS1RIHBsb3RzOgpCTUlfZGlmZl9sb25nICU+JQogIGdncGxvdChhZXMoc2FtcGxlID1EaWZmZXJlbmNlKSkgKwogIHN0YXRfcXEoKSArICMgdG8gYWRkIHRoZSBsaW5lIHdlIG5lZWQgdG8gYWxzbyBpbmNsdWRlIHN0YXRfcXFfbGluZSgpCiAgc3RhdF9xcV9saW5lKCkgKwogIGZhY2V0X3dyYXAofiBTZXggKyBUeXBlKQoKIyBvayBzbyBzb21lIG9mIHRoZSBkYXRhIGZvciBNZW4gbG9va3MgZmFpcmx5IG5vcm1hbCBidXQgbm90IGFzIG11Y2ggZm9yIFdvbWVuCgojIE5vdyB3ZSB3aWxsIGNoZWNrIHRoZSB2YXJpYW5jZQoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlVyYmFuX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSkpCiNyZWplY3QgdGhlIG51bGwgLSBjb25jbHVkZSB0aGF0IHZhcmlhbmNlIGlzIG5vdCBlcXVhbAoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJNZW4iLCAKICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksIAogICAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSkKI2ZhaWwgdG8gcmVqZWN0IHRoZSBudWxsIHRoZSBudWxsIC0gY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBlcXVhbAoKbW9vZC50ZXN0KHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsIAogICAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCAKICAgICAgICAgICAgICAgICAgICAgIFNleCA9PSAiTWVuIiwgCiAgICAgICAgICAgICAgICAgICAgICBUeXBlID09ICJSdXJhbF9kaWZmZXJlbmNlIiksIERpZmZlcmVuY2UpKQojcmVqZWN0IHRoZSBudWxsIC0gY29uY2x1ZGUgdGhhdCB2YXJpYW5jZSBpcyBub3QgZXF1YWwKCgojIGxldCdzIGNvbXBhcmUgdGhlIGdyb3VwcwojIHRoaXMgaXMgYWdhaW4gc3RpbGwgcGFpcmVkIGRhdGEKIyB0aGlzIGlzIGJlY2F1c2UgZWFjaCB2YWx1ZSBvZiAiUnVyYWxfZGlmZmVyZW5jZSIgYW5kICJVcmJhbl9kaWZmZXJlbmNlIiBjb3JyZXNwb25kIHRvIHRoZSBzYW1lIGNvdW50cnkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywgCiAgICAgICAgICAgICAgICAgICAgU2V4ID09ICJXb21lbiIsICAKICAgICAgICAgICAgICAgICAgICBUeXBlID09ICJSdXJhbF9kaWZmZXJlbmNlIiksIERpZmZlcmVuY2UpLCAKICAgICAgICBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLAogICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAgCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiVXJiYW5fZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKSAKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwgCiAgICAgICAgcHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlVyYmFuX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksCiAgICAgICAgcGFpcmVkID0gVFJVRSkKCmtzLnRlc3QocHVsbChmaWx0ZXIoQk1JX2RpZmZfbG9uZywKICAgICAgICAgICAgICAgICAgICBTZXggPT0gIk1lbiIsIAogICAgICAgICAgICAgICAgICAgIFR5cGUgPT0gIlJ1cmFsX2RpZmZlcmVuY2UiKSwgRGlmZmVyZW5jZSksIAogICAgICAgIHB1bGwoZmlsdGVyKEJNSV9kaWZmX2xvbmcsIAogICAgICAgICAgICAgICAgICAgIFNleCA9PSAiV29tZW4iLCAgCiAgICAgICAgICAgICAgICAgICAgVHlwZSA9PSAiUnVyYWxfZGlmZmVyZW5jZSIpLCBEaWZmZXJlbmNlKSwKICAgICAgICBwYWlyZWQgPSBUUlVFKQoKYGBgCk5vdyB3ZSBoYXZlIHBlcmZvcm1lZCBzZXZlbiBjb21wYXJpc29ucyAoNCBlYXJsaWVyKSBzbyB3ZSBzaG91bGQgYXBwbHkgb3VyIG11bHRpcGxlIHRlc3RpbmcgY29ycmVjdGlvbgpgYGB7cn0KLjA1LzcKCmBgYAoKV2Ugc2VlIHRoYXQgdGhlcmUgaXMgYSBzaWduaWZpY2FudCBkaWZmZXJlbmNlIGluIHRoZSBjaGFuZ2UgaW4gQk1JIFJ1cmFsIGNvbW11bml0aWVzIGJldHdlZW4gbWVuIGFuZCB3b21lbi4gVGhpcyBjaGFuZ2UgaXMgbGFyZ2VyIGZvciB3b21lbi4KCkltcG9ydGFudGx5LSB3ZSBub3RpY2VkIHRoYXQgaXQgYXBwZWFycyB0byBiZSBzcGVjaWZpYyBjb3VudHJpZXMgd2hlcmUgQk1JIHNob3dzIGEgcGFydGljdWxhciBpbmNyZWFzZSBlc3BlY2lhbGx5IGZvciB3b21lbi4gV2hpY2ggY291bnRyaWVzIGFyZSB0aG9zZT8gaG93IGRvZXMgdGhhdCBjb21wYXJlIHdpdGggdGhlIFVTPyBDbGVhcmx5IHRoZSBVUyBpcyBhbW9uZyB0aGUgY291bnRyaWVzIHdpdGggdGhlIGhpZ2hlc3QgZGlmZmVyZW5jZXMuIAoKYGBge3J9CkJNSV9kaWZmX2xvbmcgJT4lIAogIGZpbHRlcihDb3VudHJ5ID09ICJVU0EiKQoKYGBgCgpJbiB0aGUgVVMsIGZvY3VzIHNob3VsZCBiZSBwbGFjZWQgb24gPGI+IGJvdGggdXJiYW4gYW5kIHJ1cmFsIDwvYj4gd29tZW4gdG8gaW1wcm92ZSB0aGlzIHB1YmxpYyBoZWFsdGggaXNzdWUuIAoKSGVyZSB3ZSBjYW4gc2VlIHRoZSBjb3VudHJpZXMgaGF2ZSB0aGUgbGFyZ2VzdCBkaWZmZXJlbmNlcyBpbiBCTUkgZnJvbSAxOTg1LTIwMTc6CgpgYGB7cn0KQk1JX2RpZmZfbG9uZyAlPiUKICBmaWx0ZXIoRGlmZmVyZW5jZT40LjkpICU+JQogIGFycmFuZ2UoLURpZmZlcmVuY2UpCiNoZXJlIHdlIHNvcnRlZCBieSB0aGUgaGlnaGVzdCB0byBsb3dlc3QgdmFsdWVzIG9mIEJNSSBEaWZmZXJlbmNlCmBgYAoKCkhvd2V2ZXIgaXQgaXMgaW1wb3J0YW50IHRvIHNlZSB3aGF0IHRoZSBtZWFuIEJNSSB2YWx1ZXMgYXJlIHdlcmUgZm9yIHRoZXNlIGNvdW50cmllcyBpbiAyMDE3LiAKSXQgY291bGQgYmUgdGhhdCB0aGUgYXZlcmFnZSB3YXMgdW5kZXJ3ZWlnaHQgaW4gMTk4NS4uLiBsZXQncyB0YWtlIGEgbG9vay4KCmBgYHtyfQpCTUlfbG9uZyAlPiUgCiAgZmlsdGVyKENvdW50cnkgJWluJSBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCBEaWZmZXJlbmNlPjQuOSksIENvdW50cnkpLCAKICAgICAgICAgICAgICAgICAgICBTZXggJWluJSBwdWxsKGZpbHRlcihCTUlfZGlmZl9sb25nLCBEaWZmZXJlbmNlPjQuOSksIFNleCksCiAgICAgICAgICAgICAgICAgICAgWWVhciA9PSIyMDE3IikgJT4lCiAgYXJyYW5nZSgtQk1JKQoKI0hlcmUgaXMgdGhlIGRhdGEganVzdCBmb3IgdGhlIGNoYW5nZXMgaW4gQk1JIGluIEVneXB0CmZpbHRlcihCTUlfZGlmZl9sb25nLCBDb3VudHJ5ID09ICJFZ3lwdCIpICU+JSAKICBhcnJhbmdlKC1EaWZmZXJlbmNlKQoKYGBgClRodXMgcnVyYWwgd29tZW4gaW4gRWd5cHQgaGFkIHRoZSBncmVhdGVzdCBpbmNyZWFzZSBpbiBCTUkgZnJvbSAxOTg1IHRvIDIwMTcgaW4gdGhpcyBkYXRhICg1LjkpIGFuZCB0aGUgYXZlcmFnZSBCTUkgaXMgbm93IG92ZXIgdGhlIG9iZXNpdHkgdGhyZXNob2xkIG9mIDMwLgoKVGhlIGRhdGEgc3VnZ2VzdHMgdGhhdCBydXJhbCB3b21lbiBpbiBFZ3lwdCBhbmQgb3RoZXIgY291bnRyaWVzIG1heSBlc3BlY2lhbGx5IGJlbmVmaXQgZnJvbSBkaWV0YXJ5IHJlc291cmNlcyBhbmQgb3VyIGludGVydmVudGlvbnMgYW5kIHByb2dyYW1zIHRvIGFzc2lzdCB3aXRoIHdlaWdodCBtYW5hZ2VtZW50LgoKTm93IGxldCdzIG1ha2UgYSBwbG90IHRoYXQgc3VtbWFyaXplcyBvdXIgZmluZGluZ3MuIFRvIGRvIHRoaXMgd2Ugd2lsbCBzaW1wbGlmeSB0aGUgb3RoZXIgcGxvdHMgd2UgbWFkZSBhbmQgdGhlbiBjb21iaW5lIHRoZW0gdG9nZXRoZXIuCgpgYGB7cn0KCiMgc2ltcGxpZmllZCBuYXRpb25hbCBtZWFucyBwbG90Ck1lYW5zX3Bsb3Q8LUJNSV9sb25nICU+JSAKICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksIAogICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICBSZWdpb24gPT0gIk5hdGlvbmFsIikgJT4lCmdncGxvdChhZXMoeCA9IFNleCwgeSA9IEJNSSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBTZXgpKSArIAogc2NhbGVfZmlsbF9tYW51YWwodmFsdWVzPWMoImRvZGdlcmJsdWUiLCAib3JjaGlkMiIpKSArCiAgZmFjZXRfZ3JpZCh+IFllYXIpICsgCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0PTMwLCBsaW5ldHlwZT0iZGFzaGVkIiwgY29sb3IgPSAicmVkIiwgc2l6ZSA9MSkgKyAKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9sb25nICU+JQogICAgICAgICAgICAgICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiKSwKICAgICAgICAgICAgICAgIGFlcyh4ID1TZXgsIHkgPUJNSSksIAogICAgICAgICAgICAgICAgd2lkdGggPSAuMiwgc2l6ZSA9Miwgc2hhcGUgPTIxLCAKICAgICAgICAgICAgICAgIGNvbG9yID0gImJsYWNrIiwgZmlsbCA9ICJncmF5IikgKwogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9sb25nICU+JQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZZWFyICVpbiUgYygiMTk4NSIsICIyMDE3IiksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb3VudHJ5ID09ICJVU0EiKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFlcyh4ID1TZXgsIHkgPUJNSSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gLjAyLCBzaXplID0xMiwgc2hhcGUgPTIxLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIsIGZpbGwgPSAiZ3JheSIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIHBvaW50cyB0aGF0IGFyZSBsYXJnZXIgZm9yIHRoZSBVU0EgZGF0YQogIGdlb21fdGV4dChkYXRhPXN1YnNldChCTUlfbG9uZyU+JQogICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFllYXIgJWluJSBjKCIxOTg1IiwgIjIwMTciKSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlZ2lvbiA9PSAiTmF0aW9uYWwiLCBDb3VudHJ5ID09ICJVU0EiKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgYWVzKHggPVNleCwgeSA9Qk1JLGxhYmVsPUNvdW50cnkpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZV9saW5lZHJhdygpICsKICAjIFRoaXMgd2lsbCBtYWtlIHRoZWJhY2tncm91bmQgb2YgdGhlIHBsb3Qgd2hpdGUgYW5kIHRoZSBmYWNldCBsYWJlbHMgYmxhY2sKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCwgdmp1c3QgPSAwLjUpLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSkpCiAgIAojU2ltcGxpZmllZCBkaWZmZXJlbmNlIHBsb3QgCkJNSV9kaWZmX2xvbmckVHlwZSA8LUJNSV9kaWZmX2xvbmckVHlwZSAlPiUKICBzdHJfcmVwbGFjZSggcGF0dGVybiA9ICJfZGlmZmVyZW5jZSIsIHJlcGxhY2VtZW50ID0gIiIpCgpEaWZmX3Bsb3Q8LUJNSV9kaWZmX2xvbmcgJT4lIAogIGZpbHRlcihTZXggJWluJSBjKCJNZW4iLCAiV29tZW4iKSwgCiAgICAgICAgIFR5cGUgIT0gIk5hdGlvbmFsIikgJT4lCmdncGxvdCggYWVzKHggPSBUeXBlLCB5ID0gRGlmZmVyZW5jZSwgY29sID0gVHlwZSkpICsgCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSwgY29sb3IgPSAiYmxhY2siICwgYWVzKGZpbGwgPSBTZXgpKSArIAogIHNjYWxlX2ZpbGxfbWFudWFsKHZhbHVlcz1jKCJkb2RnZXJibHVlIiwgIm9yY2hpZDIiKSkgKwogIGZhY2V0X2dyaWQofiBTZXgpICsKICBnZW9tX2ppdHRlcihkYXRhPUJNSV9kaWZmX2xvbmcgJT4lIAogICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICBUeXBlICE9ICJOYXRpb25hbCIpLCAKICAgIGFlcyh4ID1UeXBlLCB5ID1EaWZmZXJlbmNlKSwgCiAgICB3aWR0aCA9IC4yLCBzaXplID0yLCBzaGFwZSA9MjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogIGdlb21faml0dGVyKGRhdGE9c3Vic2V0KEJNSV9kaWZmX2xvbmcgJT4lIAogICAgZmlsdGVyKFNleCAlaW4lIGMoIk1lbiIsICJXb21lbiIpLCAKICAgICAgICAgICBUeXBlICE9ICJOYXRpb25hbCIsIAogICAgICAgICAgIENvdW50cnkgPT0gIlVTQSIpKSwgCiAgICBhZXMoeCA9VHlwZSwgeSA9RGlmZmVyZW5jZSksIAogICAgd2lkdGggPSAuMDIsIHNpemUgPTEyLCBzaGFwZSA9MjEsIAogICAgY29sb3IgPSAiYmxhY2siLCBmaWxsID0gImdyYXkiKSArIAogICMgVGhpcyB3aWxsIGFkZCBwb2ludHMgdGhhdCBhcmUgbGFyZ2VyIGZvciB0aGUgVVNBIGRhdGEKICBnZW9tX3RleHQoZGF0YT1zdWJzZXQoQk1JX2RpZmZfbG9uZyAlPiUgCiAgICBmaWx0ZXIoU2V4ICVpbiUgYygiTWVuIiwgIldvbWVuIiksCiAgICAgICAgICAgVHlwZSAhPSAiTmF0aW9uYWwiKSwgCiAgICAgICAgICAgQ291bnRyeSA9PSAiVVNBIiksCiAgICBhZXMoeCA9VHlwZSwgeSA9RGlmZmVyZW5jZSxsYWJlbD1Db3VudHJ5KSwgCiAgICBjb2xvciA9ICJibGFjayIpICsgCiAgIyBUaGlzIHdpbGwgYWRkIFVTQSBsYWJlbHMgdG8gdGhlIFVTQSBwb2ludHMKICB0aGVtZV9saW5lZHJhdygpICsKICAgICMgVGhpcyB3aWxsIG1ha2UgdGhlIGJhY2tncm91bmQgb2YgdGhlIHBsb3Qgd2hpdGUgYW5kIHRoZSBmYWNldCBsYWJlbHMgYmxhY2sKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICMgVGhpcyBpcyB1c2VmdWwgZm9yIHJlbW92aW5nIHRoZSBsZWdlbmQKICAgICAgICBheGlzLnRleHQueCA9IGVsZW1lbnRfdGV4dChzaXplID0gMTUsYW5nbGUgPSAzMCwgdmp1c3QgPSAwLjUpLCAKICAgICAgICAjIHRoaXMgY2hhbmdlcyB0aGUgc2l6ZSBhbmQgYW5nbGUgb2YgdGhlIHggYXhpcyBwb2ludCBsYWJlbHMgCiAgICAgICAgYXhpcy50ZXh0LnkgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDIwKSwgCiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgYXhpcy50aXRsZS54ID0gZWxlbWVudF90ZXh0KHNpemUgPTE1KSwgCiAgICAgICAgc3RyaXAudGV4dC54ID0gZWxlbWVudF90ZXh0KHNpemUgPSAxNSkpCiAgIyB0aGlzIGNoYW5nZXMgdGhlIHNpemUgb2YgeCBheGlzIGxhYmVscyBmb3IgdGhlIGZhY2V0CgojYWRkIGxhYmVscwpEaWZmX3Bsb3Q8LURpZmZfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiQ2hhbmdlIGluIEJNSSBieSByZWdpb24iLCAKICAgICAgICAgICAgIHggPSAiIiwgCiAgICAgICAgICAgICB5ID0gIkNoYW5nZSBpbiBCTUkgXG4gKDE5ODUgdG8gMjAxNykiKSArCiAgICAgICAgdGhlbWUodGl0bGUgPSBlbGVtZW50X3RleHQgKHNpemUgPSAxMiwgZmFjZSA9ICJib2xkIikpCgpNZWFuc19wbG90IDwtTWVhbnNfcGxvdCArIAogICAgICAgIGxhYnModGl0bGUgPSAiTWVhbiBCTUkgb3ZlciB0aW1lIiwgCiAgICAgICAgICAgICB4ID0gIiIsIAogICAgICAgICAgICAgeSA9ICJNZWFuIEJNSSIpICsKICAgICAgICB0aGVtZSh0aXRsZSA9IGVsZW1lbnRfdGV4dCAoc2l6ZSA9IDEyLCBmYWNlID0gImJvbGQiKSkKCgoKb2Jlc2l0eV90ZXh0PC10aWJibGUoWWVhcj1jKDE5ODUpLEJNST1jKDMxKSxTZXg9YygiTWVuIiksbGFiZWw9YygiT2Jlc2l0eSIpKQoKTWVhbnNfcGxvdCA8LU1lYW5zX3Bsb3QgKyAKICAgICAgICAgICAgIGdlb21fdGV4dChkYXRhID0gb2Jlc2l0eV90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgIGxhYmVsPXB1bGwob2Jlc2l0eV90ZXh0LGxhYmVsKSwgCiAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAicmVkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgYWVzKCBmb250ZmFjZSA9ImJvbGQuaXRhbGljIiwgc2l6ZSA9IDEzKSkKCmNvd3Bsb3Q6OnBsb3RfZ3JpZChNZWFuc19wbG90LCBEaWZmX3Bsb3QsIGxhYmVscyA9IGMoIkEiLCAiQiIpKQpgYGAKCldlIGNvdWxkIG1ha2UgYSBzaW1pbGFyIHBsb3Qgd2l0aCB0aGUgYHBhdGNod29ya2AgcGFja2FnZToKYGBge3J9Ck1lYW5zX3Bsb3QgK2xhYnModGFnID0gJ0EnKSArIERpZmZfcGxvdCsgbGFicyh0YWcgPSAnQicpICsKICBwbG90X2xheW91dChndWlkZXMgPSAnY29sbGVjdCcsIG5jb2wgPSAyKQpgYGAKCkdyZWF0LCBub3cgd2UgaGF2ZSBwdXQgdHdvIHBsb3RzIHRvZ2V0aGVyIHVzaW5nIHRoZSBgcGxvdF9ncmlkKClgIGZ1bmN0aW9uIG9mIHRoZSBgY293cGxvdGAgcGFja2FnZS4gVGhpcyB3YXkgd2UgY2FuIGNsZWFybHkgY29tbXVuaWNhdGUgdHdvIG1lc3NhZ2VzLiBUaGUgZmlyc3QgYmVpbmcgdGhhdCBCTUkgaGFzIGluY3JlYXNlZCBvdmVyIHRpbWUgZ2xvYmFsbHkgYW5kIHRoYXQgbWFueSBjb3VudHJpZXMgaW5jbHVkaW5nIHRoZSBVbml0ZWQgU3RhdGVzIG9mIEFtZXJpY2EgYXJlIGFwcHJvYWNoaW5nIGEgbWVhbiBCTUkgdGhhdCBpcyBhYm92ZSB0aGUgb2Jlc2l0eSB0aHJlc2hvbGQgb2YgMzAuIFdlIGNhbiBhbHNvIHNlZSB0aGF0IHdvbWVuIG9uIGF2ZXJhZ2UgaGF2ZSBsYXJnZXIgQk1JIHZhbHVlcyB0aGFuIG1hbGVzLCBidXQgdGhhdCBib3RoIGdlbmRlcnMgc2hvdyBpbmNyZWFzZWQgbGV2ZWxzIG92ZXIgdGltZS4gSW4gdGhlIHNlY29uZCBwbG90IHdlIGNhbiBzZWUgdGhhdCB0aGUgaW5jcmVhc2UgaW4gQk1JIGlzIG5vdCBqdXN0IGhhcHBlbmluZyBpbiAgdXJiYW4gY29tbXVuaXRpZXMsIGJ1dCBpbiBib3RoIHJ1cmFsIGFuZCB1cmJhbiBjb21tdW5pdGllcyBhbmQgcGFydGljdWxhcmx5IGluIHdvbWVuLiAKCk91ciBwbG90IHZpc3VhbGx5IGV4cGxvcmVzIGFsbCBvZiBvdXIgbWFpbiBxdWVzdGlvbnM6CjEpIElzIHRoZXJlIGEgZGlmZmVyZW5jZSBiZXR3ZWVuIHJ1cmFsIGFuZCB1cmJhbiBCTUkgZXN0aW1hdGVzIGFyb3VuZCB0aGUgd29ybGQ/IEluIHBhcnRpY3VsYXIsIGhvdyBkb2VzIHRoaXMgbG9vayBmb3IgZmVtYWxlcz8KMikgSG93IGhhdmUgQk1JIGVzdGltYXRlcyBjaGFuZ2VkIGZyb20gMTk4NSB0byAyMDE3PyBBZ2FpbiwgSW4gcGFydGljdWxhciwgaG93IGRvZXMgdGhpcyBsb29rIGZvciBmZW1hbGVzPwozKSBIb3cgZG8gZGlmZmVyZW50IGNvdW50cmllcyBjb21wYXJlIGZvciBCTUkgZXN0aW1hdGVzPyBJbiBwYXJ0aWN1bGFyLCBob3cgZG9lcyB0aGUgVW5pdGVkIFN0YXRlcyBjb21wYXJlIHRvIHRoZSByZXN0IG9mIHRoZSB3b3JsZD8KCk5vdyBsZXQncyBzYXZlIG91ciBwbG90YXMgYSBwbmcgdXNpbmcgdGhlIGBwbmcoKWAgZnVuY3Rpb246CgpgYGB7cn0KcG5nKGhlcmU6OmhlcmUoImltZyIsICJtYWluX3Bsb3QucG5nIiksIGhlaWdodCA9IDE1MDAsIHdpZHRoID0gMjAwMCwgcmVzID0gMzAwKQpNZWFuc19wbG90ICtsYWJzKHRhZyA9ICdBJykgKyBEaWZmX3Bsb3QrIGxhYnModGFnID0gJ0InKSArCiAgcGxvdF9sYXlvdXQoZ3VpZGVzID0gJ2NvbGxlY3QnLCBuY29sID0gMikKZGV2Lm9mZigpCgoKYGBgCiMjIFN1bW1hcnkKCldlIGhhdmUgZXZhbHVhdGVkIEJNSSBhdmVyYWdlIGVzdGltYXRlcyBmcm9tIDIwMCBkaWZmZXJlbnQgY291bnRyaWVzIGFyb3VuZCB0aGUgd29ybGQuIFRvIGRvIHNvIHdlIGltcG9ydGVkIGRhdGEgZnJvbSBhIHBkZiB1c2luZyB0aGUgYHBkZnRvb2xzYCBwYWNrYWdlLiBXZSB1c2VkIGB0aWR5dmVyc2VgIHBhY2thZ2VzIHN1Y2ggYXMgYGRwbHlyYCwgYHN0cmluZ3JgLCBhbmQgYHRpZHlgIHRvIGNsZWFuIHRoZSBkYXRhIGFuZCBnZXQgaXQgaW4gYSB3b3JrYWJsZSBmb3JtYXQuIE91ciBzdGF0aXN0aWNhbCBhbmFseXNpcyBmb2N1c2VkIG9uIGV2YWx1YXRpbmcgZGlmZmVyZW5jZXMgaW4gQk1JIGluIGZlbWFsZXMgYXJvdW5kIHRoZSB3b3JsZCBhY3Jvc3MgdGltZSBhbmQgYmV0d2VlbiBydXJhbCBhbmQgdXJiYW4gYXJlYXMuIFdlIGZvdW5kIGEgc2lnbmlmaWNhbnQgZGlmZmVyZW5jZSBib3RoIGJldHdlZW4geWVhcnMgYW5kIGJldHdlZW4gdGhlIHR5cGUgb2YgY29tbXVuaXR5IGFtb25nIHdvbWVuIGdsb2JhbGx5IHVzaW5nIFskdCQtdGVzdHNdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dHdvLXNhbXBsZSUyMHQtdGVzdCl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgW25vbnBhcmFtZXRyaWNdKGh0dHBzOi8vd3d3Lm1heW8uZWR1L3Jlc2VhcmNoL2RvY3VtZW50cy9wYXJhbWV0cmljLWFuZC1ub25wYXJhbWV0cmljLWRlbXlzdGlmeWluZy10aGUtdGVybXMvZG9jLTIwNDA4OTYwKXt0YXJnZXQ9Il9ibGFuayJ9IHRlc3RzLiBUaHVzIEJNSSBoYXMgaW5jcmVhc2VkIGluIHdvbWVuIHNpbmNlIDE5ODUuIEFsdGhvdWdoIEJNSSBlc3RpbWF0ZXMgYXJlIHNpZ25pZmljYW50bHkgaGlnaGVyIGluIFVyYmFuIGFyZWFzIGNvbXBhcmVkIHRvIHJ1cmFsIGFyZWFzLCBCTUkgZXN0aW1hdGVzIGhhdmUgaW5jcmVhc2VkIGluIGJvdGggcmVnaW9ucy4gV2UgbGVhcm5lZCB0aGF0IHRoZXJlIGFyZSBhc3N1bXB0aW9ucyBhbmQgY29uc2lkZXJhdGlvbnMgdG8ga2VlcCBpbiBtaW5kIHdoZW4gcGVyZm9ybWluZyB0ZXN0cyB0aGF0IGNvbXBhcmUgdHdvIGdyb3Vwcy4gCgo8dT4gV2UgbGVhcm5lZCB0aGF0IHRoZSAkdCQtdGVzdCByZWxpZXMgb246PC91PgoKMSkgbm9ybWFsaXR5IG9mIHRoZSBkYXRhIGZvciBib3RoIGdyb3VwcyAodGhpcyBpcyBub3QgYXMgbXVjaCBvZiBhbiBpc3N1ZSBpZiB0aGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBpcyByZWxhdGl2ZWx5IGxhcmdlIHRvdGFsIG4+MzApCjIpIGVxdWFsIHZhcmlhbmNlIGJldHdlZW4gdGhlIHR3byBncm91cHMgKG1ha2Ugc3VyZSB5b3UgZG8gdGhlIGNvcnJlY3QgdGVzdCBpZiB0aGUgZGF0YSBpcyBub3Qgbm9ybWFsKQozKSBiYWxhbmNlZCBzYW1wbGUgc2l6ZXMgb2YgdGhlIHR3byBncm91cHMKNCkgaW5kZXBlbmRlbnQgb2JzZXJ2YXRpb25zIChvciBpbmRlcGVuZGVudCBwYWlyZWQgb2JzZXJ2YXRpb25zKQoKV2UgbGVhcm5lZCB0aGF0IHdlIGNhbiBldmFsdWF0ZSBpZiBvdXIgZGF0YSBpcyBbbm9ybWFsbHkgZGlzdHJpYnV0ZWRdKGh0dHBzOi8vd3d3LnBoeXNpb2xvZ3kub3JnL2RvaS9mdWxsLzEwLjExNTIvYWR2YW4uMDAwNjQuMjAxNyl7dGFyZ2V0PSJfYmxhbmsifSBieSBwbG90dGluZyB0aGUgZGlzdHJpYnV0aW9uIGFuZCBieSBjcmVhdGluZyBRLVEgcGxvdHMuCgo8dT5XZSBsZWFybmVkIHRoYXQgaWYgb3VyIGRhdGEgaXMgbm90IG5vcm1hbGx5IGRpc3RyaWJ1dGVkLCB3ZSBjYW4gY29uc2lkZXIgdGhlc2Ugb3B0aW9uczo8L3U+CgoxKSBXZSBjYW4gc3RpbGwgcGVyZm9ybSBhICR0JC10ZXN0IGlmIG91ciBuIGlzIGxhcmdlCjIpIFdlIGNhbiB0cmFuc2Zvcm0gdGhlIGRhdGEgYmVmb3JlIHBlcmZvcm1pbmcgYSAkdCQtdGVzdAozKSBXZSBjYW4gdXNlIGEgbm9ucGFyYW1ldHJpYyB0ZXN0IChXaWxjb3hvbiBzaWduZWQgcmFuayB0ZXN0LCB0aGUgV2lsY294b24gcmFuayBzdW0gdGVzdCwgYW5kIHRoZSBUd28tc2FtcGxlIEtvbG1vZ29yb3YtU21pcm5vdiAoS1MpIHRlc3QpCjQpIFdlIGNhbiBwZXJmb3JtIGEgJHQkLXRlc3Qgd2l0aCByZXNhbXBsaW5nIG1ldGhvZHMgKHdoaWNoIHNob3VsZCBiZSBlc3BlY2lhbGx5IGNvbnNpZGVyZWQgd2hlbiB0aGUgZ3JvdXBzIGFyZSBpbWJhbGFuY2VkKQoKV2UgbGVhcm5lZCB0aGF0IGlmIG91ciBncm91cHMgZG8gbm90IGhhdmUgZXF1YWwgdmFyaWFuY2UsIHRoYXQgd2UgbmVlZCB0byB1c2UgYSBtb2RpZmllZCAkdCQtdGVzdCB0byBhY2NvdW50IGZvciB0aGlzIG9yIHRoZSBjb3JyZWN0IG5vbnBhcmFtZXRyaWMgdGVzdCB0aGF0IGRvZXMgbm90IHJlbHkgb24gdGhpcyBhc3N1bXB0aW9uIChUd28tc2FtcGxlIEtvbG1vZ29yb3YtU21pcm5vdiB0ZXN0KS4KCldlIGFsc28gbGVhcm5lZCB0aGF0IGlmIG91ciBncm91cHMgYXJlIG5vdCB3ZWxsIGJhbGFuY2VkLCB0aGF0IHdlIGNhbiBjb25zaWRlciByZXNhbXBsaW5nIG1ldGhvZHMuCgpGaW5hbGx5IGl0cyBhbHNvIGltcG9ydGFudCB0byByZW1lbWJlciB0aGF0IHdoZW4gd2UgaGF2ZSBbcGFpcmVkIGRhdGFdKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL3BhaXJlZC1kYXRhLyl7dGFyZ2V0PSJfYmxhbmsifSBhbmQgaW50ZW5kIHRvIGNvbXBhcmUgbWVhbnMsIHdlIHNob3VsZCBwZXJmb3JtIGEgcGFpcmVkIHRlc3QgKFtwYWlyZWQgJHQkLXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL2h5cG90aGVzaXMtdGVzdC9wYWlyZWQtbWVhbnMuYXNweCNleGFtcGxlMSl7dGFyZ2V0PSJfYmxhbmsifSwgV2lsY294b24gc2lnbmVkIHJhbmsgdGVzdCwgb3IgcGFpcmVkIEtTIHRlc3QpLiBPdXIgZGF0YSB1c2VkIGluIHRoaXMgY2FzZSBzdHVkeSB3YXMgcGFpcmVkIGJlY2F1c2Ugb2JzZXJ2YXRpb25zIHdlcmUgdGFrZW4gZm9yIHRoZSBzYW1lIGNvdW50cmllcyBmb3IgZGlmZmVyZW50IGNhdGVnb3JpZXMgb2YgcG9wdWxhdGlvbnMgLSB0aHVzLCB3ZSB3YW50ZWQgdG8gY29tcGFyZSB0aGVzZSBwb3B1bGF0aW9ucyB3aXRoaW4gdGhlIHNhbWUgY291bnRyeSAobWFsZSB2cyBmZW1hbGUsIHJ1cmFsIHZzIHVyYmFuIGV0Yy4pLiBPdGhlciBleGFtcGxlcyB3b3VsZCBiZSBpbiBhIGNhc2UtY29udHJvbCBzdHVkeSAoaWYgc2FtcGxlcyBhcmUgbWF0Y2hlZCBmb3IgdmFyaW91cyBkZW1vZ3JhcGhpY3MpIG9yIGEgc3R1ZHkgd2l0aCByZXBlYXRlZCBtZWFzdXJlcyAoZm9yIGV4YW1wbGUsIHN5bXB0b20gbWVhc3VyZXMgZnJvbSB0aGUgc2FtZSBpbmRpdmlkdWFsIGJlZm9yZSBhbmQgYWZ0ZXIgYSB0cmVhdG1lbnQpLiAKCgpVc2luZyB0aGUgYGdncGxvdDJgIHBhY2thZ2Ugd2Ugd2VyZSBhYmxlIHRvIHZpc3VhbGl6ZSB0cmVuZHMgaW4gdGhlIGRhdGEuIEltcG9ydGFudGx5LCB0aGUgbGFyZ2VzdCBpbmNyZWFzZSBhcHBlYXJzIHRvIGJlIGluIHRoZSBydXJhbCBhcmVhcyBwYXJ0aWN1bGFybHkgZm9yIHdvbWVuLiBXZSB3ZXJlIGFsc28gYWJsZSB0byBpZGVudGlmeSBob3cgdGhlIFVTIGNvbXBhcmVkIHRvIG90aGVyIGNvdW50cmllcyBhbmQgd2hpY2ggY291bnRyaWVzIHNob3dlZCB0aGUgbGFyZ2VzdCBpbmNyZWFzZSBpbiBCTUkgb3ZlciB0aW1lLiBBbmFseXNlcyBsaWtlIHRoaXMgYXJlIGltcG9ydGFudCBmb3IgZGVmaW5pbmcgd2hpY2ggZ3JvdXBzIGNvdWxkIGJlbmVmaXQgdGhlIG1vc3QgZnJvbSBpbnRlcnZlbnRpb25zLCBlZHVjYXRpb24sIGFuZCBwb2xpY3kgY2hhbmdlcyB3aGVuIGF0dGVtcHRpbmcgdG8gbWl0aWdhdGUgcHVibGljIGhlYWx0aCBjaGFsbGVuZ2VzLiBZb3UgY2FuIHNlZSBpbiB0aGUgW2FydGljbGVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg2LTAxOS0xMTcxLXgucGRmKXt0YXJnZXQ9Il9ibGFuayJ9IHRoYXQgdGhpcyBkYXRhIGNhbWUgZnJvbSB0aGF0IG1hbnkgYWRkaXRpb25hbCBjb25zaWRlcmF0aW9ucyB3b3VsZCBiZSBpbnZvbHZlZCB0byBwZXJmb3JtIHN1Y2ggYW4gYW5hbHlzaXMuCgoKIyMjIFN1Z2dlc3RlZCBIb21ld29yawoKU3R1ZGVudHMgY2FuIGV2YWx1YXRlIHRoZSBjaGFuZ2UgaW4gQk1JIG92ZXIgdGltZSB1c2luZyB0aGUgZ2xvYmFsIGRhdGEgYXZhaWxhYmxlIGZvciBlYWNoIHllYXIgYmV0d2VlbiAyMDE1IGFuZCAyMDE3LiBUaGUgZGF0YSBjYW4gYmUgZm91bmQgW2hlcmVdKGh0dHA6Ly93d3cubmNkcmlzYy5vcmcvZG93bmxvYWRzL2JtaS9OQ0RfUmlzQ19MYW5jZXRfMjAxN19CTUlfYWdlX3N0YW5kYXJkaXNlZF93b3JsZC5jc3Ype3RhcmdldD0iX2JsYW5rIn0uCgojIyMgSGVscGZ1bCBMaW5rcwoKW0JNSV0oaHR0cHM6Ly93d3cuY2RjLmdvdi9oZWFsdGh5d2VpZ2h0L2Fzc2Vzc2luZy9ibWkvYWR1bHRfYm1pL2luZGV4Lmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbTG9uZyBhbmQgV2lkZSBEYXRhIEZvcm1hdHNdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbRGlzdHJpYnV0aW9uc10oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2ludHJvZHVjdGlvbi9kaXN0cmlidXRpb25zLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0KW05vcm1hbCBEaXN0cmlidXRpb25dKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9pbnRyb2R1Y3Rpb24vZGlzdHJpYnV0aW9ucy5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9CltTa2V3ZWQgRGlzdHJpYnV0aW9uc10oaHR0cDovL29ubGluZXN0YXRib29rLmNvbS8yL2dsb3NzYXJ5L3NrZXcuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAKW0JpbW9kYWwgRGlzdHJpYnV0aW9uXShodHRwOi8vb25saW5lc3RhdGJvb2suY29tLzIvaW50cm9kdWN0aW9uL2Rpc3RyaWJ1dGlvbnMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAKW2dncGxvdDJdKGh0dHBzOi8vb3BlbmNhc2VzdHVkaWVzLmdpdGh1Yi5pby9vY3MtaGVhbHRoZXhwZW5kaXR1cmUvb2NzLWhlYWx0aGV4cGVuZGl0dXJlLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gICAgCltRLVEgUGxvdHNdKGh0dHA6Ly9vbmxpbmVzdGF0Ym9vay5jb20vMi9hZHZhbmNlZF9ncmFwaHMvcS1xX3Bsb3RzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbU2hhcGlyby1XaWxrIFRlc3RdKGh0dHA6Ly93d3cuc3RhdGlzdGljczR1LmluZm8vZnVuZHN0YXRfZW5nL2VlX3NoYXBpcm9fd2lsa190ZXN0Lmh0bWwpICAKW1N0dWRlbnQgJHQkLXRlc3RdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dHdvLXNhbXBsZSUyMHQtdGVzdCkgICAKW1BhaXJlZCBEYXRhXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM1NTc5NDY1Lyl7dGFyZ2V0PSJfYmxhbmsifSAgCltXZWxjaCdzICR0JC10ZXN0XShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS93ZWxjaHMtdGVzdC1mb3ItdW5lcXVhbC12YXJpYW5jZXMvKXt0YXJnZXQ9Il9ibGFuayJ9ICAgIApbUGFyYW1ldHJpYyBhbmQgTm9ucGFyYW1ldHJpYyBNZXRob2RzXShodHRwczovL3d3dy5tYXlvLmVkdS9yZXNlYXJjaC9kb2N1bWVudHMvcGFyYW1ldHJpYy1hbmQtbm9ucGFyYW1ldHJpYy1kZW15c3RpZnlpbmctdGhlLXRlcm1zL2RvYy0yMDQwODk2MCkgIApbVmFyaWFuY2VdKGh0dHBzOi8vc3RhdHRyZWsuY29tL3N0YXRpc3RpY3MvZGljdGlvbmFyeS5hc3B4P2RlZmluaXRpb249dmFyaWFuY2Upe3RhcmdldD0iX2JsYW5rIn0gIApbQmFsYW5jZWQgU3R1ZHkgRGVzaWduXShodHRwczovL3d3dy5zdGF0aXN0aWNzaG93dG8uZGF0YXNjaWVuY2VjZW50cmFsLmNvbS9iYWxhbmNlZC1hbmQtdW5iYWxhbmNlZC1kZXNpZ25zLyl7dGFyZ2V0PSJfYmxhbmsifSAgCltJbmRlcGVuZGVudCBPYnNlcnZhdGlvbnNdKGh0dHBzOi8vd3d3LnN0YXQuY211LmVkdS9+Y3NoYWxpemkvMzYtMjIwL2xlY3R1cmUtNS5wZGYpe3RhcmdldD0iX2JsYW5rIn0gIApbVHJhbnNmb3JtYXRpb25dKGh0dHBzOi8vd3d3LnN0YXRpc3RpY3Nob3d0by5kYXRhc2NpZW5jZWNlbnRyYWwuY29tL3RyYW5zZm9ybWF0aW9uLXN0YXRpc3RpY3MvKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1Blcm11dGF0aW9uL1Jlc2FtcGxpbmcgTWV0aG9kc10oaHR0cHM6Ly9qaHUtYWR2ZGF0YXNjaS5naXRodWIuaW8vMjAxOS9sZWN0dXJlcy8yMS1yZXNhbXBsaW5nLXRlY2huaXF1ZXMuaHRtbCl7dGFyZ2V0PSJfYmxhbmsifSAgIApbQ2VudHJhbCBMaW1pdCBUaGVvcmVtXShodHRwczovL3d3dy5hbmFseXRpY3N2aWRoeWEuY29tL2Jsb2cvMjAxOS8wNS9zdGF0aXN0aWNzLTEwMS1pbnRyb2R1Y3Rpb24tY2VudHJhbC1saW1pdC10aGVvcmVtLyl7dGFyZ2V0PSJfYmxhbmsifSAgCltNb29kJ3MgVHdvLVNhbXBsZSBTY2FsZSBUZXN0XShodHRwczovL2ZpbGVzLmVyaWMuZWQuZ292L2Z1bGx0ZXh0L0VEMDY1NTU5LnBkZil7dGFyZ2V0PSJfYmxhbmsifSAgCltXaWxjb3hvbiBTaWduZWQgUmFuayBUZXN0XShodHRwOi8vd3d3LmJpb3N0YXRoYW5kYm9vay5jb20vd2lsY294b25zaWduZWRyYW5rLmh0bWwpICAgCltXaWxjb3hvbiBSYW5rIFN1bSBUZXN0XShodHRwOi8vc3Bod2ViLmJ1bWMuYnUuZWR1L290bHQvbXBoLW1vZHVsZXMvYnMvYnM3MDRfbm9ucGFyYW1ldHJpYy9CUzcwNF9Ob25wYXJhbWV0cmljNC5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9ICAKW1R3by1zYW1wbGUgS29sbW9nb3Jvdi1TbWlybm92IFRlc3RdKGh0dHBzOi8vd3d3Lml0bC5uaXN0Lmdvdi9kaXY4OTgvc29mdHdhcmUvZGF0YXBsb3QvcmVmbWFuMS9hdXhpbGxhci9rczJzYW1wLmh0bSl7dGFyZ2V0PSJfYmxhbmsifSAgCltUeXBlIDEgRXJyb3JdKGh0dHBzOi8vd2ViLm1hLnV0ZXhhcy5lZHUvdXNlcnMvbWtzL3N0YXRtaXN0YWtlcy9lcnJvcnR5cGVzLmh0bWwpe3RhcmdldD0iX2JsYW5rIn0gIApbcC12YWx1ZV0oaHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL3AtdmFsdWVzLWV4cGxhaW5lZC1ieS1kYXRhLXNjaWVudGlzdC1mNDBhNzQ2Y2ZjOCl7dGFyZ2V0PSJfYmxhbmsifSAgCltNdWx0aXBsZSBUZXN0aW5nXShodHRwczovL3d3dy5ncy53YXNoaW5ndG9uLmVkdS9hY2FkZW1pY3MvY291cnNlcy9ha2V5LzU2MDA4L2xlY3R1cmUvbGVjdHVyZTEwLnBkZil7dGFyZ2V0PSJfYmxhbmsifSAgICAKW0JvbmZlcnJvbmkgTWV0aG9kIG9mIE11bHRpcGxlIFRlc3RpbmcgQ29ycmVjdGlvbl0oaHR0cDovL21hdGh3b3JsZC53b2xmcmFtLmNvbS9Cb25mZXJyb25pQ29ycmVjdGlvbi5odG1sKXt0YXJnZXQ9Il9ibGFuayJ9CgoKCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("index.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
